---
ms.openlocfilehash: 8b804d23247b95381f3ff83bc12c32215a420fb6
ms.sourcegitcommit: e02d17b2cf9c1258dadda4810a5e6072a0089aee
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 07/01/2020
ms.locfileid: "85614956"
---
### <a name="wpf-appdomain-shutdown-handling-may-now-call-dispatcherinvoke-in-cleanup-of-weak-events"></a><span data-ttu-id="a36fa-101">Es posible que el control de apagados de AppDomain en WPF llame a Dispatcher.Invoke durante la limpieza de eventos débiles</span><span class="sxs-lookup"><span data-stu-id="a36fa-101">WPF AppDomain Shutdown Handling May Now Call Dispatcher.Invoke in Cleanup of Weak Events</span></span>

#### <a name="details"></a><span data-ttu-id="a36fa-102">Detalles</span><span class="sxs-lookup"><span data-stu-id="a36fa-102">Details</span></span>

<span data-ttu-id="a36fa-103">En .NET Framework 4.7.1 y versiones anteriores, WPF crea potencialmente un parámetro <xref:System.Windows.Threading.Dispatcher?displayProperty=nameWithType> en el subproceso finalizador de .NET durante el apagado de AppDomain.</span><span class="sxs-lookup"><span data-stu-id="a36fa-103">In .NET Framework 4.7.1 and earlier versions, WPF potentially creates a <xref:System.Windows.Threading.Dispatcher?displayProperty=nameWithType> on the .NET finalizer thread during AppDomain shutdown.</span></span>  <span data-ttu-id="a36fa-104">Esto se ha solucionado en .NET Framework 4.7.2 y versiones posteriores configurando la limpieza de eventos débiles para que tenga en cuenta los subprocesos.</span><span class="sxs-lookup"><span data-stu-id="a36fa-104">This was fixed in .NET Framework 4.7.2 and later versions by making the cleanup of weak events thread-aware.</span></span>  <span data-ttu-id="a36fa-105">Por ello, es posible que WPF llame a <xref:System.Windows.Threading.Dispatcher.Invoke%2A?displayProperty=nameWithType> para completar el proceso de limpieza. En algunas aplicaciones, este cambio en el horario del finalizador podría generar excepciones durante el apagado de AppDomain o de procesos.</span><span class="sxs-lookup"><span data-stu-id="a36fa-105">Due to this, WPF may call <xref:System.Windows.Threading.Dispatcher.Invoke%2A?displayProperty=nameWithType> to complete the cleanup process.In certain applications, this change in finalizer timing can potentially cause exceptions during AppDomain or process shutdown.</span></span>  <span data-ttu-id="a36fa-106">Esto suele detectarse en aplicaciones que no apagan correctamente los distribuidores que se ejecutan en los subprocesos de trabajo antes del apagado de AppDomain o de procesos.</span><span class="sxs-lookup"><span data-stu-id="a36fa-106">This is generally seen in applications that do not correctly shut down dispatchers running on worker threads prior to process or AppDomain shutdown.</span></span>  <span data-ttu-id="a36fa-107">Estas aplicaciones deberían encargarse de administrar correctamente la vigencia de los distribuidores.</span><span class="sxs-lookup"><span data-stu-id="a36fa-107">Such applications should take care to properly manage the lifetime of dispatchers.</span></span>

#### <a name="suggestion"></a><span data-ttu-id="a36fa-108">Sugerencia</span><span class="sxs-lookup"><span data-stu-id="a36fa-108">Suggestion</span></span>

<span data-ttu-id="a36fa-109">En .NET Framework 4.7.2 y versiones posteriores, los desarrolladores pueden deshabilitar esta corrección para reducir (no eliminar) los problemas de horario que se pueden producir debido al cambio en la limpieza. Para deshabilitar dicho cambio, use la siguiente marca de AppContext.</span><span class="sxs-lookup"><span data-stu-id="a36fa-109">In .NET Framework 4.7.2 and later versions, developers can disable this fix in order to help alleviate (but not eliminate) timing issues that may occur due to the cleanup change.To disable the change in cleanup, use the following AppContext flag.</span></span><pre><code class="lang-xml">&lt;configuration&gt;&#13;&#10;&lt;runtime&gt;&#13;&#10;&lt;AppContextSwitchOverrides value=&quot;Switch.MS.Internal.DoNotInvokeInWeakEventTableShutdownListener=true&quot;/&gt;&#13;&#10;&lt;/runtime&gt;&#13;&#10;&lt;/configuration&gt;&#13;&#10;</code></pre>

| <span data-ttu-id="a36fa-110">NOMBRE</span><span class="sxs-lookup"><span data-stu-id="a36fa-110">Name</span></span>    | <span data-ttu-id="a36fa-111">Valor</span><span class="sxs-lookup"><span data-stu-id="a36fa-111">Value</span></span>       |
|:--------|:------------|
| <span data-ttu-id="a36fa-112">Ámbito</span><span class="sxs-lookup"><span data-stu-id="a36fa-112">Scope</span></span>   | <span data-ttu-id="a36fa-113">Borde</span><span class="sxs-lookup"><span data-stu-id="a36fa-113">Edge</span></span>        |
| <span data-ttu-id="a36fa-114">Versión</span><span class="sxs-lookup"><span data-stu-id="a36fa-114">Version</span></span> | <span data-ttu-id="a36fa-115">4.7.2</span><span class="sxs-lookup"><span data-stu-id="a36fa-115">4.7.2</span></span>       |
| <span data-ttu-id="a36fa-116">Tipo</span><span class="sxs-lookup"><span data-stu-id="a36fa-116">Type</span></span>    | <span data-ttu-id="a36fa-117">Redestinación</span><span class="sxs-lookup"><span data-stu-id="a36fa-117">Retargeting</span></span> |
