---
title: Combinación de contenedores y enfoques sin servidor para servicios nativos de la nube
description: Combinación de contenedores y Kubernetes con enfoques sin servidor
ms.date: 05/13/2020
ms.openlocfilehash: b1b85519ce02ddd1d69735d872cf24fadcc81ef7
ms.sourcegitcommit: 5b475c1855b32cf78d2d1bbb4295e4c236f39464
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/24/2020
ms.locfileid: "91160897"
---
# <a name="combining-containers-and-serverless-approaches"></a><span data-ttu-id="42f24-103">Combinación de los enfoques sin servidor y los contenedores</span><span class="sxs-lookup"><span data-stu-id="42f24-103">Combining containers and serverless approaches</span></span>

<span data-ttu-id="42f24-104">Normalmente, las aplicaciones nativas de la nube implementan servicios que aprovechan los contenedores y la orquestación.</span><span class="sxs-lookup"><span data-stu-id="42f24-104">Cloud-native applications typically implement services leveraging containers and orchestration.</span></span> <span data-ttu-id="42f24-105">A menudo, hay oportunidades de exponer algunos de los servicios de la aplicación como Azure Functions.</span><span class="sxs-lookup"><span data-stu-id="42f24-105">There are often opportunities to expose some of the application's services as Azure Functions.</span></span> <span data-ttu-id="42f24-106">Sin embargo, con una aplicación nativa en la nube implementada en Kubernetes, sería estupendo aprovechar Azure Functions dentro de este mismo conjunto de herramientas.</span><span class="sxs-lookup"><span data-stu-id="42f24-106">However, with a cloud-native app deployed to Kubernetes, it would be nice to leverage Azure Functions within this same toolset.</span></span> <span data-ttu-id="42f24-107">Afortunadamente, puede ajustar Azure Functions dentro de contenedores de Docker e implementarlos con los mismos procesos y herramientas que el resto de la aplicación basada en Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="42f24-107">Fortunately, you can wrap Azure Functions inside Docker containers and deploy them using the same processes and tools as the rest of your Kubernetes-based app.</span></span>

## <a name="when-does-it-make-sense-to-use-containers-with-serverless"></a><span data-ttu-id="42f24-108">¿Cuándo tiene sentido usar contenedores sin servidor?</span><span class="sxs-lookup"><span data-stu-id="42f24-108">When does it make sense to use containers with serverless?</span></span>

<span data-ttu-id="42f24-109">La función de Azure no tiene ningún conocimiento de la plataforma en la que se implementa.</span><span class="sxs-lookup"><span data-stu-id="42f24-109">Your Azure Function has no knowledge of the platform on which it's deployed.</span></span> <span data-ttu-id="42f24-110">En algunos escenarios, puede tener requisitos específicos y necesitar personalizar el entorno en el que se ejecutará el código de función.</span><span class="sxs-lookup"><span data-stu-id="42f24-110">For some scenarios, you may have specific requirements and need to customize the environment on which your function code will run.</span></span> <span data-ttu-id="42f24-111">Necesitará una imagen personalizada que admita dependencias o una configuración no admitida por la imagen predeterminada.</span><span class="sxs-lookup"><span data-stu-id="42f24-111">You'll need a custom image that supports dependencies or a configuration not supported by the default image.</span></span> <span data-ttu-id="42f24-112">En estos casos, tiene sentido implementar la función en un contenedor de Docker personalizado.</span><span class="sxs-lookup"><span data-stu-id="42f24-112">In these cases, it makes sense to deploy your function in a custom Docker container.</span></span>

## <a name="when-should-you-avoid-using-containers-with-azure-functions"></a><span data-ttu-id="42f24-113">¿Cuándo debe evitarse el uso de contenedores con Azure Functions?</span><span class="sxs-lookup"><span data-stu-id="42f24-113">When should you avoid using containers with Azure Functions?</span></span>

<span data-ttu-id="42f24-114">Si desea usar la facturación de consumo, no podrá ejecutar la función en un contenedor.</span><span class="sxs-lookup"><span data-stu-id="42f24-114">If you want to use consumption billing, you won't be able to run your function in a container.</span></span> <span data-ttu-id="42f24-115">Además, si implementa la función en un clúster de Kubernetes, ya no se beneficiará del escalado integrado proporcionado por Azure Functions.</span><span class="sxs-lookup"><span data-stu-id="42f24-115">What's more, if you deploy your function to a Kubernetes cluster, you'll no longer benefit from the built-in scaling provided by Azure Functions.</span></span> <span data-ttu-id="42f24-116">Tendrá que usar las características de escalado de Kubernetes, descritas anteriormente en este capítulo.</span><span class="sxs-lookup"><span data-stu-id="42f24-116">You'll need to use Kubernetes' scaling features, described earlier in this chapter.</span></span>

## <a name="how-to-combine-serverless-and-docker-containers"></a><span data-ttu-id="42f24-117">Cómo combinar contenedores de Docker y sin servidor</span><span class="sxs-lookup"><span data-stu-id="42f24-117">How to combine serverless and Docker containers</span></span>

<span data-ttu-id="42f24-118">Para encapsular una función de Azure en un contenedor de Docker, instale el [Azure Functions Core Tools](https://github.com/Azure/azure-functions-core-tools) y, a continuación, ejecute el siguiente comando:</span><span class="sxs-lookup"><span data-stu-id="42f24-118">To wrap an Azure Function in a Docker container, install the [Azure Functions Core Tools](https://github.com/Azure/azure-functions-core-tools) and then run the following command:</span></span>

```console
func init ProjectName --worker-runtime dotnet --docker
```

<span data-ttu-id="42f24-119">Cuando se cree el proyecto, incluirá un Dockerfile y el tiempo de ejecución de trabajo configurado para `dotnet` .</span><span class="sxs-lookup"><span data-stu-id="42f24-119">When the project is created, it will include a Dockerfile and the worker runtime configured to `dotnet`.</span></span> <span data-ttu-id="42f24-120">Ahora puede crear y probar la función de forma local.</span><span class="sxs-lookup"><span data-stu-id="42f24-120">Now, you can create and test your function locally.</span></span> <span data-ttu-id="42f24-121">Compilarlo y ejecutarlo con los  `docker build` `docker run` comandos y.</span><span class="sxs-lookup"><span data-stu-id="42f24-121">Build and run it using the  `docker build` and `docker run` commands.</span></span> <span data-ttu-id="42f24-122">Para obtener pasos detallados para empezar a crear Azure Functions con compatibilidad con Docker, consulte el tutorial [creación de una función en Linux con una imagen personalizada](/azure/azure-functions/functions-create-function-linux-custom-image) .</span><span class="sxs-lookup"><span data-stu-id="42f24-122">For detailed steps to get started building Azure Functions with Docker support, see the [Create a function on Linux using a custom image](/azure/azure-functions/functions-create-function-linux-custom-image) tutorial.</span></span>

## <a name="how-to-combine-serverless-and-kubernetes-with-keda"></a><span data-ttu-id="42f24-123">Cómo combinar sin servidor y Kubernetes con KEDA</span><span class="sxs-lookup"><span data-stu-id="42f24-123">How to combine serverless and Kubernetes with KEDA</span></span>

<span data-ttu-id="42f24-124">En este capítulo, ha visto que la plataforma de Azure Functions se escala horizontalmente de forma automática para satisfacer la demanda.</span><span class="sxs-lookup"><span data-stu-id="42f24-124">In this chapter, you've seen that the Azure Functions' platform automatically scales out to meet demand.</span></span> <span data-ttu-id="42f24-125">Sin embargo, cuando se implementan funciones en contenedor en AKS, se pierde la funcionalidad de escalado integrada.</span><span class="sxs-lookup"><span data-stu-id="42f24-125">When deploying containerized functions to AKS, however, you lose the built-in scaling functionality.</span></span> <span data-ttu-id="42f24-126">Al rescate viene [basado en Kubernetes (keda)](/azure/azure-functions/functions-kubernetes-keda).</span><span class="sxs-lookup"><span data-stu-id="42f24-126">To the rescue comes [Kubernetes-based Event Driven (KEDA)](/azure/azure-functions/functions-kubernetes-keda).</span></span> <span data-ttu-id="42f24-127">Habilita el escalado automático específico para `event-driven Kubernetes workloads,` Incluir funciones en contenedor.</span><span class="sxs-lookup"><span data-stu-id="42f24-127">It enables fine-grained autoscaling for `event-driven Kubernetes workloads,` including containerized functions.</span></span>

<span data-ttu-id="42f24-128">KEDA proporciona funcionalidad de escalado orientada a eventos al tiempo de ejecución de las funciones en un contenedor de Docker.</span><span class="sxs-lookup"><span data-stu-id="42f24-128">KEDA provides event-driven scaling functionality to the Functions' runtime in a Docker container.</span></span> <span data-ttu-id="42f24-129">KEDA se puede escalar desde cero instancias (cuando no se producen eventos) `n instances` , en función de la carga.</span><span class="sxs-lookup"><span data-stu-id="42f24-129">KEDA can scale from zero instances (when no events are occurring) out to `n instances`, based on load.</span></span> <span data-ttu-id="42f24-130">Habilita el escalado automático mediante la exposición de métricas personalizadas al escalador automático de Kubernetes (escalado automático del Pod horizontal).</span><span class="sxs-lookup"><span data-stu-id="42f24-130">It enables autoscaling by exposing custom metrics to the Kubernetes autoscaler (Horizontal Pod Autoscaler).</span></span> <span data-ttu-id="42f24-131">El uso de contenedores de Functions con KEDA hace posible replicar las capacidades de la función sin servidor en cualquier clúster de Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="42f24-131">Using Functions containers with KEDA makes it possible to replicate serverless function capabilities in any Kubernetes cluster.</span></span>

<span data-ttu-id="42f24-132">Merece la pena mencionar que el proyecto KEDA está ahora administrado por Cloud Native Computing Foundation (CNCF).</span><span class="sxs-lookup"><span data-stu-id="42f24-132">It is worth noting that the KEDA project is now managed by the Cloud Native Computing Foundation (CNCF).</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="42f24-133">[Anterior](leverage-serverless-functions.md)
>[Siguiente](deploy-containers-azure.md)</span><span class="sxs-lookup"><span data-stu-id="42f24-133">[Previous](leverage-serverless-functions.md)
[Next](deploy-containers-azure.md)</span></span>
