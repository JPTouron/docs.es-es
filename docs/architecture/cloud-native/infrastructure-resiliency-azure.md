---
title: Resistencia de la plataforma Azure
description: Diseño de aplicaciones .NET nativas en la nube para Azure | Resistencia de la infraestructura de la nube con Azure
author: robvet
ms.date: 05/13/2020
ms.openlocfilehash: 752f1320d9dfa18e52b078763d221a787da15e8e
ms.sourcegitcommit: 27db07ffb26f76912feefba7b884313547410db5
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 05/19/2020
ms.locfileid: "83613985"
---
# <a name="azure-platform-resiliency"></a><span data-ttu-id="8c257-103">Resistencia de la plataforma Azure</span><span class="sxs-lookup"><span data-stu-id="8c257-103">Azure platform resiliency</span></span>

<span data-ttu-id="8c257-104">La creación de una aplicación confiable en la nube es diferente del desarrollo de aplicaciones local tradicional.</span><span class="sxs-lookup"><span data-stu-id="8c257-104">Building a reliable application in the cloud is different from traditional on-premises application development.</span></span> <span data-ttu-id="8c257-105">Aunque históricamente ha adquirido hardware de mayor tamaño para escalar verticalmente, en un entorno de nube que escala horizontalmente. En lugar de intentar evitar errores, el objetivo es minimizar sus efectos y mantener el sistema estable.</span><span class="sxs-lookup"><span data-stu-id="8c257-105">While historically you purchased higher-end hardware to scale up, in a cloud environment you scale out. Instead of trying to prevent failures, the goal is to minimize their effects and keep the system stable.</span></span>

<span data-ttu-id="8c257-106">Dicho esto, las aplicaciones en la nube confiables muestran características distintas:</span><span class="sxs-lookup"><span data-stu-id="8c257-106">That said, reliable cloud applications display distinct characteristics:</span></span>

- <span data-ttu-id="8c257-107">Son resistentes, se recuperan correctamente de los problemas y continúan funcionando.</span><span class="sxs-lookup"><span data-stu-id="8c257-107">They're resilient, recover gracefully from problems, and continue to function.</span></span>
- <span data-ttu-id="8c257-108">Son de alta disponibilidad (HA) y se ejecutan tal y como están diseñados en un estado correcto sin tiempo de inactividad significativo.</span><span class="sxs-lookup"><span data-stu-id="8c257-108">They're highly available (HA) and run as designed in a healthy state with no significant downtime.</span></span>

<span data-ttu-id="8c257-109">Comprender cómo funcionan estas características juntas y cómo afectan al costo: es esencial para crear una aplicación confiable de la nube nativa.</span><span class="sxs-lookup"><span data-stu-id="8c257-109">Understanding how these characteristics work together - and how they affect cost - is essential to building a reliable cloud-native application.</span></span> <span data-ttu-id="8c257-110">A continuación, veremos cómo puede crear resistencia y disponibilidad en las aplicaciones nativas de la nube que aprovechan las características de la nube de Azure.</span><span class="sxs-lookup"><span data-stu-id="8c257-110">We'll next look at ways that you can build resiliency and availability into your cloud-native applications leveraging features from the Azure cloud.</span></span>

## <a name="design-with-resiliency"></a><span data-ttu-id="8c257-111">Diseño con resistencia</span><span class="sxs-lookup"><span data-stu-id="8c257-111">Design with resiliency</span></span>

<span data-ttu-id="8c257-112">Nuestra resistencia permite que la aplicación reaccione ante errores y siga siendo funcional.</span><span class="sxs-lookup"><span data-stu-id="8c257-112">We've said resiliency enables your application to react to failure and still remain functional.</span></span> <span data-ttu-id="8c257-113">En las notas del producto sobre [resistencia de Azure](https://azure.microsoft.com/mediahandler/files/resourcefiles/resilience-in-azure-whitepaper/Resilience%20in%20Azure.pdf), se proporcionan instrucciones para lograr resistencia en la plataforma Azure.</span><span class="sxs-lookup"><span data-stu-id="8c257-113">The whitepaper, [Resilience in Azure whitepaper](https://azure.microsoft.com/mediahandler/files/resourcefiles/resilience-in-azure-whitepaper/Resilience%20in%20Azure.pdf), provides guidance for achieving resilience in the Azure platform.</span></span> <span data-ttu-id="8c257-114">Estas son algunas recomendaciones clave:</span><span class="sxs-lookup"><span data-stu-id="8c257-114">Here are some key recommendations:</span></span>

- <span data-ttu-id="8c257-115">*Error de hardware.*</span><span class="sxs-lookup"><span data-stu-id="8c257-115">*Hardware failure.*</span></span> <span data-ttu-id="8c257-116">Cree redundancia en la aplicación mediante la implementación de componentes en distintos dominios de error.</span><span class="sxs-lookup"><span data-stu-id="8c257-116">Build redundancy into the application by deploying components across different fault domains.</span></span> <span data-ttu-id="8c257-117">Por ejemplo, asegúrese de que las máquinas virtuales de Azure se colocan en bastidores diferentes mediante conjuntos de disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="8c257-117">For example, ensure that Azure VMs are placed in different racks by using Availability Sets.</span></span>

- <span data-ttu-id="8c257-118">*Error del centro de recursos.*</span><span class="sxs-lookup"><span data-stu-id="8c257-118">*Datacenter failure.*</span></span> <span data-ttu-id="8c257-119">Cree redundancia en la aplicación con zonas de aislamiento de errores en los centros de recursos.</span><span class="sxs-lookup"><span data-stu-id="8c257-119">Build redundancy into the application with fault isolation zones across datacenters.</span></span> <span data-ttu-id="8c257-120">Por ejemplo, asegúrese de que las máquinas virtuales de Azure se colocan en distintos centros de recursos aislados por error mediante Azure Availability Zones.</span><span class="sxs-lookup"><span data-stu-id="8c257-120">For example, ensure that Azure VMs are placed in different fault-isolated datacenters by using Azure Availability Zones.</span></span>

- <span data-ttu-id="8c257-121">*Error regional.*</span><span class="sxs-lookup"><span data-stu-id="8c257-121">*Regional failure.*</span></span> <span data-ttu-id="8c257-122">Replique los datos y componentes en otra región para que las aplicaciones puedan recuperarse rápidamente.</span><span class="sxs-lookup"><span data-stu-id="8c257-122">Replicate the data and components into another region so that applications can be quickly recovered.</span></span> <span data-ttu-id="8c257-123">Por ejemplo, use Azure Site Recovery para replicar máquinas virtuales de Azure en otra región de Azure.</span><span class="sxs-lookup"><span data-stu-id="8c257-123">For example, use Azure Site Recovery to replicate Azure VMs to another Azure region.</span></span>

- <span data-ttu-id="8c257-124">*Carga pesada.*</span><span class="sxs-lookup"><span data-stu-id="8c257-124">*Heavy load.*</span></span> <span data-ttu-id="8c257-125">Equilibrio de carga entre instancias para controlar los picos de uso.</span><span class="sxs-lookup"><span data-stu-id="8c257-125">Load balance across instances to handle spikes in usage.</span></span> <span data-ttu-id="8c257-126">Por ejemplo, coloque dos o más máquinas virtuales de Azure detrás de un equilibrador de carga para distribuir el tráfico a todas las máquinas virtuales.</span><span class="sxs-lookup"><span data-stu-id="8c257-126">For example, put two or more Azure VMs behind a load balancer to distribute traffic to all VMs.</span></span>

- <span data-ttu-id="8c257-127">*Eliminación o daños accidentales de los datos.*</span><span class="sxs-lookup"><span data-stu-id="8c257-127">*Accidental data deletion or corruption.*</span></span> <span data-ttu-id="8c257-128">Realice una copia de seguridad de los datos para que se puedan restaurar si hay algún daño o eliminación.</span><span class="sxs-lookup"><span data-stu-id="8c257-128">Back up data so it can be restored if there’s any deletion or corruption.</span></span> <span data-ttu-id="8c257-129">Por ejemplo, use Azure Backup para realizar copias de seguridad periódicas de las máquinas virtuales de Azure.</span><span class="sxs-lookup"><span data-stu-id="8c257-129">For example, use Azure Backup to periodically back up your Azure VMs.</span></span>

## <a name="design-with-redundancy"></a><span data-ttu-id="8c257-130">Diseño con redundancia</span><span class="sxs-lookup"><span data-stu-id="8c257-130">Design with redundancy</span></span>

<span data-ttu-id="8c257-131">Los errores varían en el ámbito del impacto.</span><span class="sxs-lookup"><span data-stu-id="8c257-131">Failures vary in scope of impact.</span></span> <span data-ttu-id="8c257-132">Un error de hardware, como un disco con errores, puede afectar a un solo nodo de un clúster.</span><span class="sxs-lookup"><span data-stu-id="8c257-132">A hardware failure, such as a failed disk, can affect a single node in a cluster.</span></span> <span data-ttu-id="8c257-133">Un conmutador de red con error puede afectar a todo el bastidor del servidor.</span><span class="sxs-lookup"><span data-stu-id="8c257-133">A failed network switch could affect an entire server rack.</span></span> <span data-ttu-id="8c257-134">Los errores menos comunes, como la pérdida de energía, pueden interrumpir todo un centro de recursos.</span><span class="sxs-lookup"><span data-stu-id="8c257-134">Less common failures, such as loss of power, could disrupt a whole datacenter.</span></span> <span data-ttu-id="8c257-135">Rara vez, toda una región deja de estar disponible.</span><span class="sxs-lookup"><span data-stu-id="8c257-135">Rarely, an entire region becomes unavailable.</span></span>

<span data-ttu-id="8c257-136">La [redundancia](https://docs.microsoft.com/azure/architecture/guide/design-principles/redundancy) es una manera de proporcionar resistencia de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="8c257-136">[Redundancy](https://docs.microsoft.com/azure/architecture/guide/design-principles/redundancy) is one way to provide application resilience.</span></span> <span data-ttu-id="8c257-137">El nivel exacto de redundancia necesaria depende de los requisitos de su empresa y afectará tanto al costo como a la complejidad del sistema.</span><span class="sxs-lookup"><span data-stu-id="8c257-137">The exact level of redundancy needed depends upon your business requirements and will affect both the cost and complexity of your system.</span></span> <span data-ttu-id="8c257-138">Por ejemplo, una implementación de varias regiones es más costosa y más compleja de administrar que una implementación de una sola región.</span><span class="sxs-lookup"><span data-stu-id="8c257-138">For example, a multi-region deployment is more expensive and more complex to manage than a single-region deployment.</span></span> <span data-ttu-id="8c257-139">Necesitará procedimientos operativos para administrar la conmutación por error y la conmutación por recuperación.</span><span class="sxs-lookup"><span data-stu-id="8c257-139">You'll need operational procedures to manage failover and failback.</span></span> <span data-ttu-id="8c257-140">El costo y la complejidad adicionales pueden estar justificados en algunos escenarios empresariales, pero no en otros.</span><span class="sxs-lookup"><span data-stu-id="8c257-140">The additional cost and complexity might be justified for some business scenarios, but not others.</span></span>

<span data-ttu-id="8c257-141">Para diseñar la redundancia, debe identificar las rutas críticas en la aplicación y, a continuación, determinar si hay redundancia en cada punto de la ruta de acceso.</span><span class="sxs-lookup"><span data-stu-id="8c257-141">To architect redundancy, you need to identify the critical paths in your application, and then determine if there's redundancy at each point in the path?</span></span> <span data-ttu-id="8c257-142">Si se produce un error en un subsistema, ¿la aplicación conmutará por error a otra cosa?</span><span class="sxs-lookup"><span data-stu-id="8c257-142">If a subsystem should fail, will the application fail over to something else?</span></span> <span data-ttu-id="8c257-143">Por último, necesita comprender claramente las características integradas en la plataforma en la nube de Azure que puede aprovechar para satisfacer sus requisitos de redundancia.</span><span class="sxs-lookup"><span data-stu-id="8c257-143">Finally, you need a clear understanding of those features built into the Azure cloud platform that you can leverage to meet your redundancy requirements.</span></span> <span data-ttu-id="8c257-144">Estas son algunas recomendaciones para la arquitectura de la redundancia:</span><span class="sxs-lookup"><span data-stu-id="8c257-144">Here are recommendations for architecting redundancy:</span></span>

- <span data-ttu-id="8c257-145">*Implemente varias instancias de servicios.*</span><span class="sxs-lookup"><span data-stu-id="8c257-145">*Deploy multiple instances of services.*</span></span> <span data-ttu-id="8c257-146">Si la aplicación depende de una única instancia de un servicio, crea un único punto de error.</span><span class="sxs-lookup"><span data-stu-id="8c257-146">If your application depends on a single instance of a service, it creates a single point of failure.</span></span> <span data-ttu-id="8c257-147">El aprovisionamiento de varias instancias mejora tanto la resistencia como la escalabilidad.</span><span class="sxs-lookup"><span data-stu-id="8c257-147">Provisioning multiple instances improves both resiliency and scalability.</span></span> <span data-ttu-id="8c257-148">Al hospedar en Azure Kubernetes Service, puede configurar mediante declaración instancias redundantes (conjuntos de réplicas) en el archivo de manifiesto Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="8c257-148">When hosting in Azure Kubernetes Service, you can declaratively configure redundant instances (replica sets) in the Kubernetes manifest file.</span></span> <span data-ttu-id="8c257-149">El valor de recuento de réplicas se puede administrar mediante programación, en el portal o a través de las características de escalado automático.</span><span class="sxs-lookup"><span data-stu-id="8c257-149">The replica count value can be managed programmatically, in the portal, or through autoscaling features.</span></span>

- <span data-ttu-id="8c257-150">*Aprovechamiento de un equilibrador de carga.*</span><span class="sxs-lookup"><span data-stu-id="8c257-150">*Leveraging a load balancer.*</span></span> <span data-ttu-id="8c257-151">El equilibrio de carga distribuye las solicitudes de la aplicación a las instancias de servicio en buen estado y quita automáticamente las instancias incorrectas de la rotación.</span><span class="sxs-lookup"><span data-stu-id="8c257-151">Load-balancing distributes your application's requests to healthy service instances and automatically removes unhealthy instances from rotation.</span></span> <span data-ttu-id="8c257-152">Cuando se implementa en Kubernetes, el equilibrio de carga se puede especificar en el archivo de manifiesto Kubernetes en la sección servicios.</span><span class="sxs-lookup"><span data-stu-id="8c257-152">When deploying to Kubernetes, load balancing can be specified in the Kubernetes manifest file in the Services section.</span></span>

- <span data-ttu-id="8c257-153">*Plan para la implementación en la región.*</span><span class="sxs-lookup"><span data-stu-id="8c257-153">*Plan for multiregion deployment.*</span></span> <span data-ttu-id="8c257-154">Si implementa la aplicación en una sola región y dicha región deja de estar disponible, la aplicación también dejará de estar disponible.</span><span class="sxs-lookup"><span data-stu-id="8c257-154">If you deploy your application to a single region, and that region becomes unavailable, your application will also become unavailable.</span></span> <span data-ttu-id="8c257-155">Esto puede ser inaceptable en los términos de los contratos de nivel de servicio de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="8c257-155">This may be unacceptable under the terms of your application's service level agreements.</span></span> <span data-ttu-id="8c257-156">En su lugar, considere la posibilidad de implementar la aplicación y sus servicios en varias regiones.</span><span class="sxs-lookup"><span data-stu-id="8c257-156">Instead, consider deploying your application and its services across multiple regions.</span></span> <span data-ttu-id="8c257-157">Por ejemplo, un clúster de Azure Kubernetes Service (AKS) se implementa en una sola región.</span><span class="sxs-lookup"><span data-stu-id="8c257-157">For example, an Azure Kubernetes Service (AKS) cluster is deployed to a single region.</span></span> <span data-ttu-id="8c257-158">Para proteger el sistema de un error regional, puede implementar la aplicación en varios clústeres de AKS en diferentes regiones y usar la característica de [regiones emparejadas](https://buildazure.com/2017/01/06/azure-region-pairs-explained/) para coordinar las actualizaciones de plataforma y priorizar los esfuerzos de recuperación.</span><span class="sxs-lookup"><span data-stu-id="8c257-158">To protect your system from a regional failure, you might deploy your application to multiple AKS clusters across different regions and use the [Paired Regions](https://buildazure.com/2017/01/06/azure-region-pairs-explained/) feature to coordinate platform updates and prioritize recovery efforts.</span></span>

- <span data-ttu-id="8c257-159">*Habilite [la replicación geográfica](https://docs.microsoft.com/azure/sql-database/sql-database-active-geo-replication).*</span><span class="sxs-lookup"><span data-stu-id="8c257-159">*Enable [geo-replication](https://docs.microsoft.com/azure/sql-database/sql-database-active-geo-replication).*</span></span> <span data-ttu-id="8c257-160">La replicación geográfica para servicios como Azure SQL Database y Cosmos DB creará réplicas secundarias de los datos en varias regiones.</span><span class="sxs-lookup"><span data-stu-id="8c257-160">Geo-replication for services such as Azure SQL Database and Cosmos DB will create secondary replicas of your data across multiple regions.</span></span> <span data-ttu-id="8c257-161">Aunque ambos servicios replicarán automáticamente los datos dentro de la misma región, la replicación geográfica le protege contra una interrupción regional al permitir la conmutación por error a una región secundaria.</span><span class="sxs-lookup"><span data-stu-id="8c257-161">While both services will automatically replicate data within the same region, geo-replication protects you against a regional outage by enabling you to fail over to a secondary region.</span></span> <span data-ttu-id="8c257-162">Otro procedimiento recomendado para los centros de replicación geográfica alrededor del almacenamiento de imágenes de contenedor.</span><span class="sxs-lookup"><span data-stu-id="8c257-162">Another best practice for geo-replication centers around storing container images.</span></span> <span data-ttu-id="8c257-163">Para implementar un servicio en AKS, debe almacenar y extraer la imagen de un repositorio.</span><span class="sxs-lookup"><span data-stu-id="8c257-163">To deploy a service in AKS, you need to store and pull the image from a repository.</span></span> <span data-ttu-id="8c257-164">Azure Container Registry se integra con AKS y puede almacenar imágenes de contenedor de forma segura.</span><span class="sxs-lookup"><span data-stu-id="8c257-164">Azure Container Registry integrates with AKS and can securely store container images.</span></span> <span data-ttu-id="8c257-165">Para mejorar el rendimiento y la disponibilidad, considere la posibilidad de replicar geográficamente las imágenes en un registro en cada región donde tenga un clúster de AKS.</span><span class="sxs-lookup"><span data-stu-id="8c257-165">To improve performance and availability, consider geo-replicating your images to a registry in each region where you have an AKS cluster.</span></span> <span data-ttu-id="8c257-166">Cada clúster de AKS extrae las imágenes de contenedor del registro de contenedor local en su región, tal como se muestra en la figura 6-4:</span><span class="sxs-lookup"><span data-stu-id="8c257-166">Each AKS cluster then pulls container images from the local container registry in its region as shown in Figure 6-4:</span></span>

![Recursos replicados entre regiones](./media/replicated-resources.png)

<span data-ttu-id="8c257-168">**Figura 6-4**.</span><span class="sxs-lookup"><span data-stu-id="8c257-168">**Figure 6-4**.</span></span> <span data-ttu-id="8c257-169">Recursos replicados entre regiones</span><span class="sxs-lookup"><span data-stu-id="8c257-169">Replicated resources across regions</span></span>

- <span data-ttu-id="8c257-170">*Implemente un equilibrador de carga de tráfico DNS.*</span><span class="sxs-lookup"><span data-stu-id="8c257-170">*Implement a DNS traffic load balancer.*</span></span> <span data-ttu-id="8c257-171">[Azure Traffic Manager](https://docs.microsoft.com/azure/traffic-manager/traffic-manager-overview) proporciona alta disponibilidad para las aplicaciones críticas mediante el equilibrio de carga en el nivel de DNS.</span><span class="sxs-lookup"><span data-stu-id="8c257-171">[Azure Traffic Manager](https://docs.microsoft.com/azure/traffic-manager/traffic-manager-overview) provides high-availability for critical applications by load-balancing at the DNS level.</span></span> <span data-ttu-id="8c257-172">Puede enrutar el tráfico a diferentes regiones según la geografía, el tiempo de respuesta del clúster e incluso el estado del punto de conexión de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="8c257-172">It can route traffic to different regions based on geography, cluster response time, and even application endpoint health.</span></span> <span data-ttu-id="8c257-173">Por ejemplo, Azure Traffic Manager puede dirigir a los clientes al clúster de AKS más cercano y a la instancia de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="8c257-173">For example, Azure Traffic Manager can direct customers to the closest AKS cluster and application instance.</span></span> <span data-ttu-id="8c257-174">Si tiene varios clústeres de AKS en distintas regiones, use Traffic Manager para controlar cómo fluye el tráfico a las aplicaciones que se ejecutan en cada clúster.</span><span class="sxs-lookup"><span data-stu-id="8c257-174">If you have multiple AKS clusters in different regions, use Traffic Manager to control how traffic flows to the applications that run in each cluster.</span></span> <span data-ttu-id="8c257-175">En la figura 6-5 se muestra este escenario.</span><span class="sxs-lookup"><span data-stu-id="8c257-175">Figure 6-5 shows this scenario.</span></span>

![AKS y Azure Traffic Manager](./media/aks-traffic-manager.png)

<span data-ttu-id="8c257-177">**Figura 6-5**.</span><span class="sxs-lookup"><span data-stu-id="8c257-177">**Figure 6-5**.</span></span> <span data-ttu-id="8c257-178">AKS y Azure Traffic Manager</span><span class="sxs-lookup"><span data-stu-id="8c257-178">AKS and Azure Traffic Manager</span></span>

## <a name="design-for-scalability"></a><span data-ttu-id="8c257-179">Diseño para escalabilidad</span><span class="sxs-lookup"><span data-stu-id="8c257-179">Design for scalability</span></span>

<span data-ttu-id="8c257-180">La nube prospera en el escalado.</span><span class="sxs-lookup"><span data-stu-id="8c257-180">The cloud thrives on scaling.</span></span> <span data-ttu-id="8c257-181">La capacidad de aumentar o disminuir los recursos del sistema para solucionar el aumento o la disminución de la carga del sistema es un principio clave de la nube de Azure.</span><span class="sxs-lookup"><span data-stu-id="8c257-181">The ability to increase/decrease system resources to address increasing/decreasing system load is a key tenet of the Azure cloud.</span></span> <span data-ttu-id="8c257-182">Sin embargo, para escalar eficazmente una aplicación, necesita comprender las características de escalado de cada servicio de Azure que se incluye en la aplicación.</span><span class="sxs-lookup"><span data-stu-id="8c257-182">But, to effectively scale an application, you need an understanding of the scaling features of each Azure service that you include in your application.</span></span>  <span data-ttu-id="8c257-183">Estas son algunas recomendaciones para implementar eficazmente el escalado en el sistema.</span><span class="sxs-lookup"><span data-stu-id="8c257-183">Here are recommendations for effectively implementing scaling in your system.</span></span>

- <span data-ttu-id="8c257-184">*Diseño para el escalado.*</span><span class="sxs-lookup"><span data-stu-id="8c257-184">*Design for scaling.*</span></span> <span data-ttu-id="8c257-185">Una aplicación debe diseñarse para el escalado.</span><span class="sxs-lookup"><span data-stu-id="8c257-185">An application must be designed for scaling.</span></span> <span data-ttu-id="8c257-186">Para empezar, los servicios no deben tener estado, por lo que las solicitudes se pueden enrutar a cualquier instancia.</span><span class="sxs-lookup"><span data-stu-id="8c257-186">To start, services should be stateless so that requests can be routed to any instance.</span></span> <span data-ttu-id="8c257-187">Tener servicios sin estado también significa que la adición o eliminación de una instancia no afecta negativamente a los usuarios actuales.</span><span class="sxs-lookup"><span data-stu-id="8c257-187">Having stateless services also means that adding or removing an instance doesn't adversely impact current users.</span></span>

- <span data-ttu-id="8c257-188">*Cargas de trabajo de partición*.</span><span class="sxs-lookup"><span data-stu-id="8c257-188">*Partition workloads*.</span></span> <span data-ttu-id="8c257-189">La descomposición de dominios en microservicios independientes y autónomos permite que cada servicio Escale de forma independiente a los demás.</span><span class="sxs-lookup"><span data-stu-id="8c257-189">Decomposing domains into independent, self-contained microservices enable each service to scale independently of others.</span></span> <span data-ttu-id="8c257-190">Normalmente, los servicios tendrán diferentes requisitos y necesidades de escalabilidad.</span><span class="sxs-lookup"><span data-stu-id="8c257-190">Typically, services will have different scalability needs and requirements.</span></span> <span data-ttu-id="8c257-191">La creación de particiones permite escalar solo lo que se debe escalar sin el costo innecesario de escalar una aplicación completa.</span><span class="sxs-lookup"><span data-stu-id="8c257-191">Partitioning enables you to scale only what needs to be scaled without the unnecessary cost of scaling an entire application.</span></span>

- <span data-ttu-id="8c257-192">*Favorecer el escalado horizontal.* Las aplicaciones basadas en la nube favorecen el escalado horizontal de los recursos en lugar de escalar verticalmente.</span><span class="sxs-lookup"><span data-stu-id="8c257-192">*Favor scale-out.* Cloud-based applications favor scaling out resources as opposed to scaling up.</span></span> <span data-ttu-id="8c257-193">El escalado horizontal (también conocido como escala horizontal) implica agregar más recursos de servicio a un sistema existente para cumplir y compartir un nivel de rendimiento deseado.</span><span class="sxs-lookup"><span data-stu-id="8c257-193">Scaling out (also known as horizontal scaling) involves adding more service resources to an existing system to meet and share a desired level of performance.</span></span> <span data-ttu-id="8c257-194">El escalado vertical (también conocido como escala vertical) implica el reemplazo de recursos existentes con hardware más eficaz (más núcleos de disco, memoria y procesamiento).</span><span class="sxs-lookup"><span data-stu-id="8c257-194">Scaling up (also known as vertical scaling) involves replacing existing resources with more powerful hardware (more disk, memory, and processing cores).</span></span> <span data-ttu-id="8c257-195">El escalado horizontal se puede invocar automáticamente con las características de escalado automático disponibles en algunos recursos de la nube de Azure.</span><span class="sxs-lookup"><span data-stu-id="8c257-195">Scaling out can be invoked automatically with the autoscaling features available in some Azure cloud resources.</span></span> <span data-ttu-id="8c257-196">El escalado horizontal entre varios recursos también agrega redundancia al sistema global.</span><span class="sxs-lookup"><span data-stu-id="8c257-196">Scaling out across multiple resources also adds redundancy to the overall system.</span></span> <span data-ttu-id="8c257-197">Por último, el escalado vertical de un solo recurso es normalmente más caro que el escalado horizontal entre muchos recursos más pequeños.</span><span class="sxs-lookup"><span data-stu-id="8c257-197">Finally scaling up a single resource is typically more expensive than scaling out across many smaller resources.</span></span> <span data-ttu-id="8c257-198">En la figura 6-6 se muestran los dos enfoques:</span><span class="sxs-lookup"><span data-stu-id="8c257-198">Figure 6-6 shows the two approaches:</span></span>

![Escalar verticalmente frente a escalabilidad horizontal](./media/scale-up-scale-out.png)

<span data-ttu-id="8c257-200">**Figura 6-6.**</span><span class="sxs-lookup"><span data-stu-id="8c257-200">**Figure 6-6.**</span></span> <span data-ttu-id="8c257-201">Escalar verticalmente frente a escalabilidad horizontal</span><span class="sxs-lookup"><span data-stu-id="8c257-201">Scale up versus scale out</span></span>

- <span data-ttu-id="8c257-202">*Escale proporcionalmente.*</span><span class="sxs-lookup"><span data-stu-id="8c257-202">*Scale proportionally.*</span></span> <span data-ttu-id="8c257-203">Al escalar un servicio, piense en lo que respecta a los *conjuntos de recursos*.</span><span class="sxs-lookup"><span data-stu-id="8c257-203">When scaling a service, think in terms of *resource sets*.</span></span> <span data-ttu-id="8c257-204">Si fuera a escalar considerablemente un servicio específico, ¿qué impacto tendría en los almacenes de datos de back-end, en las memorias caché y en los servicios dependientes?</span><span class="sxs-lookup"><span data-stu-id="8c257-204">If you were to dramatically scale out a specific service, what impact would that have on back-end data stores, caches and dependent services?</span></span> <span data-ttu-id="8c257-205">Algunos recursos como Cosmos DB se pueden escalar horizontalmente de forma proporcional, mientras que muchos otros no.</span><span class="sxs-lookup"><span data-stu-id="8c257-205">Some resources such as Cosmos DB can scale out proportionally, while many others can't.</span></span> <span data-ttu-id="8c257-206">Desea asegurarse de que no se escala horizontalmente un recurso a un punto en el que se agotarán otros recursos asociados.</span><span class="sxs-lookup"><span data-stu-id="8c257-206">You want to ensure that you don't scale out a resource to a point where it will exhaust other associated resources.</span></span>

- <span data-ttu-id="8c257-207">*Evite la afinidad.*</span><span class="sxs-lookup"><span data-stu-id="8c257-207">*Avoid affinity.*</span></span> <span data-ttu-id="8c257-208">Un procedimiento recomendado es asegurarse de que un nodo no requiera afinidad local, lo que a menudo se conoce como una *sesión permanente*.</span><span class="sxs-lookup"><span data-stu-id="8c257-208">A best practice is to ensure a node doesn't require local affinity, often referred to as a *sticky session*.</span></span> <span data-ttu-id="8c257-209">Una solicitud debe ser capaz de enrutar a cualquier instancia de.</span><span class="sxs-lookup"><span data-stu-id="8c257-209">A request should be able to route to any instance.</span></span> <span data-ttu-id="8c257-210">Si necesita conservar el estado, debe guardarse en una caché distribuida, como [Azure Redis cache](https://azure.microsoft.com/services/cache/).</span><span class="sxs-lookup"><span data-stu-id="8c257-210">If you need to persist state, it should be saved to a distributed cache, such as [Azure Redis cache](https://azure.microsoft.com/services/cache/).</span></span>

- <span data-ttu-id="8c257-211">*Aproveche las características de escalado automático de la plataforma.*</span><span class="sxs-lookup"><span data-stu-id="8c257-211">*Take advantage of platform autoscaling features.*</span></span> <span data-ttu-id="8c257-212">Use las características de escalado automático integradas siempre que sea posible, en lugar de mecanismos personalizados o de terceros.</span><span class="sxs-lookup"><span data-stu-id="8c257-212">Use built-in autoscaling features whenever possible, rather than custom or third-party mechanisms.</span></span> <span data-ttu-id="8c257-213">Siempre que sea posible, use reglas de escalado programadas para asegurarse de que los recursos estén disponibles sin un retraso de inicio, pero agregue el escalado automático reactivo a las reglas según corresponda, para hacer frente a los cambios inesperados en la demanda.</span><span class="sxs-lookup"><span data-stu-id="8c257-213">Where possible, use scheduled scaling rules to ensure that resources are available without a startup delay, but add reactive autoscaling to the rules as appropriate, to cope with unexpected changes in demand.</span></span> <span data-ttu-id="8c257-214">Para obtener más información, consulte [Guía de escalado automático](https://docs.microsoft.com/azure/architecture/best-practices/auto-scaling).</span><span class="sxs-lookup"><span data-stu-id="8c257-214">For more information, see [Autoscaling guidance](https://docs.microsoft.com/azure/architecture/best-practices/auto-scaling).</span></span>

- <span data-ttu-id="8c257-215">*Escale horizontalmente de forma agresiva.*</span><span class="sxs-lookup"><span data-stu-id="8c257-215">*Scale out aggressively.*</span></span> <span data-ttu-id="8c257-216">Una práctica final sería escalar horizontalmente de forma agresiva para que pueda satisfacer rápidamente picos inmediatos de tráfico sin perder su negocio.</span><span class="sxs-lookup"><span data-stu-id="8c257-216">A final practice would be to scale out aggressively so that you can quickly meet immediate spikes in traffic without losing business.</span></span> <span data-ttu-id="8c257-217">Y, a continuación, escale horizontalmente (es decir, quite las instancias innecesarias) para mantener el sistema estable.</span><span class="sxs-lookup"><span data-stu-id="8c257-217">And, then scale in (that is, remove unneeded instances) conservatively to keep the system stable.</span></span> <span data-ttu-id="8c257-218">Una manera sencilla de implementar esto es establecer el período de enfriamiento, que es el tiempo de espera entre las operaciones de escalado, hasta cinco minutos para agregar recursos y hasta 15 minutos para quitar instancias.</span><span class="sxs-lookup"><span data-stu-id="8c257-218">A simple way to implement this is to set the cool down period, which is the time to wait between scaling operations, to five minutes for adding resources and up to 15 minutes for removing instances.</span></span>

## <a name="built-in-retry-in-services"></a><span data-ttu-id="8c257-219">Reintento integrado en los servicios</span><span class="sxs-lookup"><span data-stu-id="8c257-219">Built-in retry in services</span></span>

<span data-ttu-id="8c257-220">Se recomienda el procedimiento recomendado para implementar operaciones de reintento mediante programación en una sección anterior.</span><span class="sxs-lookup"><span data-stu-id="8c257-220">We encouraged the best practice of implementing programmatic retry operations in an earlier section.</span></span> <span data-ttu-id="8c257-221">Tenga en cuenta que muchos servicios de Azure y sus SDK de cliente correspondientes también incluyen mecanismos de reintento.</span><span class="sxs-lookup"><span data-stu-id="8c257-221">Keep in mind that many Azure services and their corresponding client SDKs also include retry mechanisms.</span></span> <span data-ttu-id="8c257-222">En la lista siguiente se resumen las características de reintentos de la mayoría de los servicios de Azure que se describen en este libro:</span><span class="sxs-lookup"><span data-stu-id="8c257-222">The following list summarizes retry features in the many of the Azure services that are discussed in this book:</span></span>

- <span data-ttu-id="8c257-223">*Azure Cosmos DB.*</span><span class="sxs-lookup"><span data-stu-id="8c257-223">*Azure Cosmos DB.*</span></span> <span data-ttu-id="8c257-224">La <xref:Microsoft.Azure.Documents.Client.DocumentClient> clase de la API de cliente retira automáticamente los intentos fallidos.</span><span class="sxs-lookup"><span data-stu-id="8c257-224">The <xref:Microsoft.Azure.Documents.Client.DocumentClient> class from the client API automatically retires failed attempts.</span></span> <span data-ttu-id="8c257-225">El número de reintentos y el tiempo de espera máximo se pueden configurar.</span><span class="sxs-lookup"><span data-stu-id="8c257-225">The number of retries and maximum wait time are configurable.</span></span> <span data-ttu-id="8c257-226">Las excepciones iniciadas por la API de cliente son solicitudes que superan la Directiva de reintentos o errores no transitorios.</span><span class="sxs-lookup"><span data-stu-id="8c257-226">Exceptions thrown by the client API are either requests that exceed the retry policy or non-transient errors.</span></span>

- <span data-ttu-id="8c257-227">*Azure Redis Cache.*</span><span class="sxs-lookup"><span data-stu-id="8c257-227">*Azure Redis Cache.*</span></span> <span data-ttu-id="8c257-228">El cliente de StackExchange de Redis usa una clase de administrador de conexiones que incluye reintentos en intentos con error.</span><span class="sxs-lookup"><span data-stu-id="8c257-228">The Redis StackExchange client uses a connection manager class that includes retries on failed attempts.</span></span> <span data-ttu-id="8c257-229">El número de reintentos, la Directiva de reintentos específica y el tiempo de espera se pueden configurar.</span><span class="sxs-lookup"><span data-stu-id="8c257-229">The number of retries, specific retry policy and wait time are all configurable.</span></span>

- <span data-ttu-id="8c257-230">*Azure Service Bus.*</span><span class="sxs-lookup"><span data-stu-id="8c257-230">*Azure Service Bus.*</span></span> <span data-ttu-id="8c257-231">El cliente Service Bus expone una [clase RetryPolicy](xref:Microsoft.ServiceBus.RetryPolicy) que se puede configurar con un intervalo de interrupción, un recuento de reintentos y <xref:Microsoft.ServiceBus.RetryExponential.TerminationTimeBuffer%2A> , que especifica el tiempo máximo que puede tardar una operación.</span><span class="sxs-lookup"><span data-stu-id="8c257-231">The Service Bus client exposes a [RetryPolicy class](xref:Microsoft.ServiceBus.RetryPolicy) that can be configured with a back-off interval, retry count, and <xref:Microsoft.ServiceBus.RetryExponential.TerminationTimeBuffer%2A>, which specifies the maximum time an operation can take.</span></span> <span data-ttu-id="8c257-232">La directiva predeterminada es nueve reintentos máximos con un período de interrupción de 30 segundos entre los intentos.</span><span class="sxs-lookup"><span data-stu-id="8c257-232">The default policy is nine maximum retry attempts with a 30-second backoff period between attempts.</span></span>

- <span data-ttu-id="8c257-233">*Azure SQL Database.*</span><span class="sxs-lookup"><span data-stu-id="8c257-233">*Azure SQL Database.*</span></span> <span data-ttu-id="8c257-234">Se proporciona compatibilidad con el reintento cuando se usa la biblioteca de [Entity Framework Core](https://docs.microsoft.com/ef/core/miscellaneous/connection-resiliency) .</span><span class="sxs-lookup"><span data-stu-id="8c257-234">Retry support is provided when using the [Entity Framework Core](https://docs.microsoft.com/ef/core/miscellaneous/connection-resiliency) library.</span></span>

- <span data-ttu-id="8c257-235">*Azure Storage.*</span><span class="sxs-lookup"><span data-stu-id="8c257-235">*Azure Storage.*</span></span> <span data-ttu-id="8c257-236">La biblioteca de cliente de almacenamiento admite operaciones de reintento.</span><span class="sxs-lookup"><span data-stu-id="8c257-236">The storage client library support retry operations.</span></span> <span data-ttu-id="8c257-237">Las estrategias varían en las tablas, los blobs y las colas de Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="8c257-237">The strategies vary across Azure storage tables, blobs, and queues.</span></span> <span data-ttu-id="8c257-238">Además, los reintentos alternativos cambian entre las ubicaciones de servicios de almacenamiento principales y secundarios cuando la característica de redundancia geográfica está habilitada.</span><span class="sxs-lookup"><span data-stu-id="8c257-238">As well, alternate retries switch between primary and secondary storage services locations when the geo-redundancy feature is enabled.</span></span>

- <span data-ttu-id="8c257-239">*Azure Event Hubs.*</span><span class="sxs-lookup"><span data-stu-id="8c257-239">*Azure Event Hubs.*</span></span> <span data-ttu-id="8c257-240">La biblioteca de cliente del centro de eventos presenta una propiedad RetryPolicy, que incluye una característica de retroceso exponencial configurable.</span><span class="sxs-lookup"><span data-stu-id="8c257-240">The Event Hub client library features a RetryPolicy property, which includes a configurable exponential backoff feature.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="8c257-241">[Anterior](application-resiliency-patterns.md)
>[Siguiente](resilient-communications.md)</span><span class="sxs-lookup"><span data-stu-id="8c257-241">[Previous](application-resiliency-patterns.md)
[Next](resilient-communications.md)</span></span>
