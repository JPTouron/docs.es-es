---
title: Equivalencia de tipos y tipos de interoperabilidad incrustados
description: Comprenda la equivalencia de tipos entre los tipos y miembros de .NET con un ensamblado administrado y los tipos COM que se insertan en ese ensamblado. Para .NET 4 y versiones posteriores.
ms.date: 03/30/2017
helpviewer_keywords:
- type equivalence
- embedded interop types
- primary interop assemblies,not necessary in CLR version 4
- NoPIA
ms.assetid: 78892eba-2a58-4165-b4b1-0250ee2f41dc
ms.openlocfilehash: a096c6bd0703c19c6049ad5ab2532b4b05f6ede0
ms.sourcegitcommit: 27a15a55019f6b5f2733961738babe94aec0def3
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 09/15/2020
ms.locfileid: "90558828"
---
# <a name="type-equivalence-and-embedded-interop-types"></a><span data-ttu-id="e7ec8-104">Equivalencia de tipos y tipos de interoperabilidad incrustados</span><span class="sxs-lookup"><span data-stu-id="e7ec8-104">Type equivalence and embedded interop types</span></span>

<span data-ttu-id="e7ec8-105">A partir de .NET Framework 4, Common Language Runtime admite la incrustación de información de tipos COM directamente en ensamblados administrados, en lugar de exigir a los ensamblados administrados obtener información de tipos COM de ensamblados de interoperabilidad.</span><span class="sxs-lookup"><span data-stu-id="e7ec8-105">Beginning with the .NET Framework 4, the common language runtime supports embedding type information for COM types directly into managed assemblies, instead of requiring the managed assemblies to obtain type information for COM types from interop assemblies.</span></span> <span data-ttu-id="e7ec8-106">Dado que la información de tipos incrustada solo incluye los tipos y miembros que realmente usa un ensamblado administrado, dos ensamblados administrados pueden tener vistas muy diferentes del mismo tipo COM.</span><span class="sxs-lookup"><span data-stu-id="e7ec8-106">Because the embedded type information includes only the types and members that are actually used by a managed assembly, two managed assemblies might have very different views of the same COM type.</span></span> <span data-ttu-id="e7ec8-107">Cada ensamblado administrado tiene un objeto <xref:System.Type> diferente para representar su vista del tipo COM.</span><span class="sxs-lookup"><span data-stu-id="e7ec8-107">Each managed assembly has a different <xref:System.Type> object to represent its view of the COM type.</span></span> <span data-ttu-id="e7ec8-108">Common Language Runtime admite la equivalencia de tipos entre estas distintas vistas de interfaces, estructuras, enumeraciones y delegados.</span><span class="sxs-lookup"><span data-stu-id="e7ec8-108">The common language runtime supports type equivalence between these different views for interfaces, structures, enumerations, and delegates.</span></span>

<span data-ttu-id="e7ec8-109">La equivalencia de tipos significa que un objeto COM que se pasa de un ensamblado administrado a otro se puede convertir al tipo administrado adecuado en el ensamblado receptor.</span><span class="sxs-lookup"><span data-stu-id="e7ec8-109">Type equivalence means that a COM object that is passed from one managed assembly to another can be cast to the appropriate managed type in the receiving assembly.</span></span>

> [!NOTE]
> <span data-ttu-id="e7ec8-110">La equivalencia de tipos y los tipos de interoperabilidad incrustados simplifican la implementación de aplicaciones y complementos que usan componentes COM, porque no es necesario implementar ensamblados de interoperabilidad con las aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="e7ec8-110">Type equivalence and embedded interop types simplify the deployment of applications and add-ins that use COM components, because it is not necessary to deploy interop assemblies with the applications.</span></span> <span data-ttu-id="e7ec8-111">Los desarrolladores de componentes COM compartidos siguen teniendo que crear ensamblados de interoperabilidad primarios (PIA) si quieren que las versiones anteriores de .NET Framework usen sus componentes.</span><span class="sxs-lookup"><span data-stu-id="e7ec8-111">Developers of shared COM components still have to create primary interop assemblies (PIAs) if they want their components to be used by earlier versions of the .NET Framework.</span></span>

## <a name="type-equivalence"></a><span data-ttu-id="e7ec8-112">Equivalencia de tipos</span><span class="sxs-lookup"><span data-stu-id="e7ec8-112">Type equivalence</span></span>

 <span data-ttu-id="e7ec8-113">Se admite la equivalencia de tipos COM para interfaces, estructuras, enumeraciones y delegados.</span><span class="sxs-lookup"><span data-stu-id="e7ec8-113">Equivalence of COM types is supported for interfaces, structures, enumerations, and delegates.</span></span> <span data-ttu-id="e7ec8-114">Los tipos COM se consideran equivalentes si se cumplen todas las condiciones siguientes:</span><span class="sxs-lookup"><span data-stu-id="e7ec8-114">COM types qualify as equivalent if all of the following are true:</span></span>

- <span data-ttu-id="e7ec8-115">Ambos tipos son interfaces, estructuras, enumeraciones o delegados.</span><span class="sxs-lookup"><span data-stu-id="e7ec8-115">The types are both interfaces, or both structures, or both enumerations, or both delegates.</span></span>

- <span data-ttu-id="e7ec8-116">Los tipos tienen la misma identidad, como se explica en la sección siguiente.</span><span class="sxs-lookup"><span data-stu-id="e7ec8-116">The types have the same identity, as described in the next section.</span></span>

- <span data-ttu-id="e7ec8-117">Ambos tipos son aptos para la equivalencia de tipos, como se explica en la sección [Marcado de tipos COM para la equivalencia de tipos](#marking-com-types-for-type-equivalence).</span><span class="sxs-lookup"><span data-stu-id="e7ec8-117">Both types are eligible for type equivalence, as described in the [Marking COM types for type equivalence](#marking-com-types-for-type-equivalence) section.</span></span>

### <a name="type-identity"></a><span data-ttu-id="e7ec8-118">Identidad de tipos</span><span class="sxs-lookup"><span data-stu-id="e7ec8-118">Type identity</span></span>

<span data-ttu-id="e7ec8-119">Se considera que dos tipos tienen la misma identidad cuando sus ámbitos e identidades coinciden, es decir, si cada uno de ellos tiene el atributo <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> y los dos atributos tienen propiedades <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> y <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A> coincidentes.</span><span class="sxs-lookup"><span data-stu-id="e7ec8-119">Two types are determined to have the same identity when their scopes and identities match, in other words, if they each have the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> attribute, and the two attributes have matching <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> and <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A> properties.</span></span> <span data-ttu-id="e7ec8-120">La comparación de <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> no distingue mayúsculas de minúsculas.</span><span class="sxs-lookup"><span data-stu-id="e7ec8-120">The comparison for <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> is case-insensitive.</span></span>

<span data-ttu-id="e7ec8-121">Si un tipo no tiene el atributo <xref:System.Runtime.InteropServices.TypeIdentifierAttribute>, o si tiene un atributo <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> que no especifica ámbito ni identificador, se puede seguir considerando para la equivalencia como se indica a continuación:</span><span class="sxs-lookup"><span data-stu-id="e7ec8-121">If a type does not have the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> attribute, or if it has a <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> attribute that does not specify scope and identifier, the type can still be considered for equivalence as follows:</span></span>

- <span data-ttu-id="e7ec8-122">En las interfaces se usa el valor de la propiedad <xref:System.Runtime.InteropServices.GuidAttribute> en lugar de <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A?displayProperty=nameWithType> y se emplea la propiedad <xref:System.Type.FullName%2A?displayProperty=nameWithType> (es decir, el nombre del tipo, incluido el espacio de nombres) en lugar de la propiedad <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="e7ec8-122">For interfaces, the value of the <xref:System.Runtime.InteropServices.GuidAttribute> is used instead of the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A?displayProperty=nameWithType> property, and the <xref:System.Type.FullName%2A?displayProperty=nameWithType> property (that is, the type name, including the namespace) is used instead of the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A?displayProperty=nameWithType> property.</span></span>

- <span data-ttu-id="e7ec8-123">En estructuras, enumeraciones y delegados, se usa el elemento <xref:System.Runtime.InteropServices.GuidAttribute> del ensamblado contenedor en lugar de la propiedad <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> y se emplea la propiedad <xref:System.Type.FullName%2A?displayProperty=nameWithType> en lugar de la propiedad <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A>.</span><span class="sxs-lookup"><span data-stu-id="e7ec8-123">For structures, enumerations, and delegates, the <xref:System.Runtime.InteropServices.GuidAttribute> of the containing assembly is used instead of the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> property, and the <xref:System.Type.FullName%2A?displayProperty=nameWithType> property is used instead of the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A> property.</span></span>

### <a name="marking-com-types-for-type-equivalence"></a><span data-ttu-id="e7ec8-124">Marcado de tipos COM para la equivalencia de tipos</span><span class="sxs-lookup"><span data-stu-id="e7ec8-124">Marking COM types for type equivalence</span></span>

 <span data-ttu-id="e7ec8-125">Puede marcar un tipo como apto para la equivalencia de tipos de dos maneras:</span><span class="sxs-lookup"><span data-stu-id="e7ec8-125">You can mark a type as eligible for type equivalence in two ways:</span></span>

- <span data-ttu-id="e7ec8-126">Aplique el atributo <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> al tipo.</span><span class="sxs-lookup"><span data-stu-id="e7ec8-126">Apply the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> attribute to the type.</span></span>

- <span data-ttu-id="e7ec8-127">Convierta el tipo en un tipo de importación de COM.</span><span class="sxs-lookup"><span data-stu-id="e7ec8-127">Make the type a COM import type.</span></span> <span data-ttu-id="e7ec8-128">Una interfaz es un tipo de importación de COM si tiene el atributo <xref:System.Runtime.InteropServices.ComImportAttribute>.</span><span class="sxs-lookup"><span data-stu-id="e7ec8-128">An interface is a COM import type if it has the <xref:System.Runtime.InteropServices.ComImportAttribute> attribute.</span></span> <span data-ttu-id="e7ec8-129">Una interfaz, una estructura, una enumeración o un delegado es un tipo de importación de COM si el ensamblado en el que se define tiene el atributo <xref:System.Runtime.InteropServices.ImportedFromTypeLibAttribute>.</span><span class="sxs-lookup"><span data-stu-id="e7ec8-129">An interface, structure, enumeration, or delegate is a COM import type if the assembly in which it is defined has the <xref:System.Runtime.InteropServices.ImportedFromTypeLibAttribute> attribute.</span></span>

## <a name="see-also"></a><span data-ttu-id="e7ec8-130">Vea también</span><span class="sxs-lookup"><span data-stu-id="e7ec8-130">See also</span></span>

- <xref:System.Type.IsEquivalentTo%2A>
- <span data-ttu-id="e7ec8-131">[Uso de tipos COM en código administrado](/previous-versions/dotnet/netframework-4.0/3y76b69k(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="e7ec8-131">[Using COM Types in Managed Code](/previous-versions/dotnet/netframework-4.0/3y76b69k(v=vs.100))</span></span>
- [<span data-ttu-id="e7ec8-132">Importar una biblioteca de tipos como un ensamblado</span><span class="sxs-lookup"><span data-stu-id="e7ec8-132">Importing a Type Library as an Assembly</span></span>](importing-a-type-library-as-an-assembly.md)
