---
title: Envío y recepción de errores
description: Obtenga información sobre cómo un cliente de servicio o dúplex puede enviar errores de SOAP cuando se produce una condición de error y cómo una aplicación de cliente o de servicio controla estos errores.
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- handling faults [WCF], sending
ms.assetid: 7be6fb96-ce2a-450b-aebe-f932c6a4bc5d
ms.openlocfilehash: 23f63fde2755a29cd545d3aefe699cad8dbecb3b
ms.sourcegitcommit: 358a28048f36a8dca39a9fe6e6ac1f1913acadd5
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/23/2020
ms.locfileid: "85244327"
---
# <a name="sending-and-receiving-faults"></a><span data-ttu-id="b97fc-103">Envío y recepción de errores</span><span class="sxs-lookup"><span data-stu-id="b97fc-103">Sending and Receiving Faults</span></span>

<span data-ttu-id="b97fc-104">Los errores de SOAP transportan información de condición de errores desde un servicio a un cliente y, en caso de comunicación dúplex, desde un cliente a un servicio de manera interoperable.</span><span class="sxs-lookup"><span data-stu-id="b97fc-104">SOAP faults convey error condition information from a service to a client and in the duplex case from a client to a service in an interoperable way.</span></span> <span data-ttu-id="b97fc-105">Normalmente, un servicio define el contenido del error personalizado y especifica qué operaciones pueden devolverlos.</span><span class="sxs-lookup"><span data-stu-id="b97fc-105">Typically a service defines custom fault content and specifies which operations can return them.</span></span> <span data-ttu-id="b97fc-106">(Para obtener más información, vea [definir y especificar errores](defining-and-specifying-faults.md)). En este tema se describe cómo un cliente de servicio o dúplex puede enviar esos errores cuando se ha producido la condición de error correspondiente y cómo un cliente o una aplicación de servicio controla estos errores.</span><span class="sxs-lookup"><span data-stu-id="b97fc-106">(For more information, see [Defining and Specifying Faults](defining-and-specifying-faults.md).) This topic discusses how a service or duplex client can send those faults when the corresponding error condition has occurred and how a client or service application handles these faults.</span></span> <span data-ttu-id="b97fc-107">Para obtener información general sobre el control de errores en las aplicaciones de Windows Communication Foundation (WCF), consulte [especificar y controlar errores en contratos y servicios](specifying-and-handling-faults-in-contracts-and-services.md).</span><span class="sxs-lookup"><span data-stu-id="b97fc-107">For an overview of error handling in Windows Communication Foundation (WCF) applications, see [Specifying and Handling Faults in Contracts and Services](specifying-and-handling-faults-in-contracts-and-services.md).</span></span>

## <a name="sending-soap-faults"></a><span data-ttu-id="b97fc-108">Envío de errores SOAP</span><span class="sxs-lookup"><span data-stu-id="b97fc-108">Sending SOAP Faults</span></span>

<span data-ttu-id="b97fc-109">Los errores de SOAP declarados son aquéllos en los que una operación tiene <xref:System.ServiceModel.FaultContractAttribute?displayProperty=nameWithType> que especifica un tipo de error de SOAP personalizado.</span><span class="sxs-lookup"><span data-stu-id="b97fc-109">Declared SOAP faults are those in which an operation has a <xref:System.ServiceModel.FaultContractAttribute?displayProperty=nameWithType> that specifies a custom SOAP fault type.</span></span> <span data-ttu-id="b97fc-110">Los errores de SOAP no declarados son aquéllos que no se especifican en el contrato para una operación.</span><span class="sxs-lookup"><span data-stu-id="b97fc-110">Undeclared SOAP faults are those that are not specified in the contract for an operation.</span></span>

### <a name="sending-declared-faults"></a><span data-ttu-id="b97fc-111">Envío de errores declarados</span><span class="sxs-lookup"><span data-stu-id="b97fc-111">Sending Declared Faults</span></span>

<span data-ttu-id="b97fc-112">Para enviar un error de SOAP declarado, detecte la condición de error para la que el error de SOAP es adecuado y genere una nueva <xref:System.ServiceModel.FaultException%601?displayProperty=nameWithType>, donde el parámetro de tipo es un nuevo objeto del tipo especificado en <xref:System.ServiceModel.FaultContractAttribute> para esa operación.</span><span class="sxs-lookup"><span data-stu-id="b97fc-112">To send a declared SOAP fault, detect the error condition for which the SOAP fault is appropriate and throw a new <xref:System.ServiceModel.FaultException%601?displayProperty=nameWithType> where the type parameter is a new object of the type specified in the <xref:System.ServiceModel.FaultContractAttribute> for that operation.</span></span> <span data-ttu-id="b97fc-113">El ejemplo de código siguiente muestra el uso de <xref:System.ServiceModel.FaultContractAttribute> para especificar que la operación `SampleMethod` puede devolver un error de SOAP con el tipo de detalle de `GreetingFault`.</span><span class="sxs-lookup"><span data-stu-id="b97fc-113">The following code example shows the use of <xref:System.ServiceModel.FaultContractAttribute> to specify that the `SampleMethod` operation can return a SOAP fault with the detail type of `GreetingFault`.</span></span>

[!code-csharp[FaultContractAttribute#4](../../../samples/snippets/csharp/VS_Snippets_CFX/faultcontractattribute/cs/services.cs#4)]
[!code-vb[FaultContractAttribute#4](../../../samples/snippets/visualbasic/VS_Snippets_CFX/faultcontractattribute/vb/services.vb#4)]

<span data-ttu-id="b97fc-114">Para transportar la información de error `GreetingFault` al cliente, detecte la condición de error adecuada y genere una nueva <xref:System.ServiceModel.FaultException%601?displayProperty=nameWithType> de tipo `GreetingFault` con un nuevo objeto `GreetingFault` como el argumento, como en el ejemplo de código siguiente.</span><span class="sxs-lookup"><span data-stu-id="b97fc-114">To convey the `GreetingFault` error information to the client, catch the appropriate error condition and throw a new <xref:System.ServiceModel.FaultException%601?displayProperty=nameWithType> of type `GreetingFault` with a new `GreetingFault` object as the argument, as in the following code example.</span></span> <span data-ttu-id="b97fc-115">Si el cliente es una aplicación cliente de WCF, lo experimenta como una excepción administrada en la que el tipo es <xref:System.ServiceModel.FaultException%601?displayProperty=nameWithType> de tipo `GreetingFault` .</span><span class="sxs-lookup"><span data-stu-id="b97fc-115">If the client is an WCF client application, it experiences this as a managed exception where the type is <xref:System.ServiceModel.FaultException%601?displayProperty=nameWithType> of type `GreetingFault`.</span></span>

[!code-csharp[FaultContractAttribute#5](../../../samples/snippets/csharp/VS_Snippets_CFX/faultcontractattribute/cs/services.cs#5)]
[!code-vb[FaultContractAttribute#5](../../../samples/snippets/visualbasic/VS_Snippets_CFX/faultcontractattribute/vb/services.vb#5)]

### <a name="sending-undeclared-faults"></a><span data-ttu-id="b97fc-116">Envío de errores no declarados</span><span class="sxs-lookup"><span data-stu-id="b97fc-116">Sending Undeclared Faults</span></span>

<span data-ttu-id="b97fc-117">El envío de errores no declarados puede ser muy útil para diagnosticar y depurar rápidamente problemas en aplicaciones WCF, pero su utilidad como herramienta de depuración está limitada.</span><span class="sxs-lookup"><span data-stu-id="b97fc-117">Sending undeclared faults can be very useful to quickly diagnose and debug problems in WCF applications, but its usefulness as a debugging tool is limited.</span></span> <span data-ttu-id="b97fc-118">Más generalmente, se recomienda al depurar que utilice la propiedad <xref:System.ServiceModel.Description.ServiceDebugBehavior.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="b97fc-118">More generally, when debugging it is recommended that you use the <xref:System.ServiceModel.Description.ServiceDebugBehavior.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="b97fc-119">Al establecer este valor en true, los clientes experimentan tales errores como excepciones <xref:System.ServiceModel.FaultException%601> de tipo <xref:System.ServiceModel.ExceptionDetail>.</span><span class="sxs-lookup"><span data-stu-id="b97fc-119">When you set this value to true, clients experience such faults as <xref:System.ServiceModel.FaultException%601> exceptions of type <xref:System.ServiceModel.ExceptionDetail>.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="b97fc-120">Dado que las excepciones administradas pueden exponer información interna de la aplicación, establecer <xref:System.ServiceModel.ServiceBehaviorAttribute.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> o <xref:System.ServiceModel.Description.ServiceDebugBehavior.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> en `true` puede permitir que los clientes de WCF obtengan información sobre las excepciones de operaciones de servicio internas, incluida la información de identificación personal u otra información confidencial.</span><span class="sxs-lookup"><span data-stu-id="b97fc-120">Because managed exceptions can expose internal application information, setting <xref:System.ServiceModel.ServiceBehaviorAttribute.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> or <xref:System.ServiceModel.Description.ServiceDebugBehavior.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> to `true` can permit WCF clients to obtain information about internal service operation exceptions, including personally identifiable or other sensitive information.</span></span>
>
> <span data-ttu-id="b97fc-121">Por consiguiente, establecer <xref:System.ServiceModel.ServiceBehaviorAttribute.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> o <xref:System.ServiceModel.Description.ServiceDebugBehavior.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> en `true` solo está recomendado como una manera de depurar temporalmente una aplicación de servicio.</span><span class="sxs-lookup"><span data-stu-id="b97fc-121">Therefore, setting <xref:System.ServiceModel.ServiceBehaviorAttribute.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> or <xref:System.ServiceModel.Description.ServiceDebugBehavior.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> to `true` is only recommended as a way of temporarily debugging a service application.</span></span> <span data-ttu-id="b97fc-122">Además, el WSDL de un método que devuelve excepciones administradas no controladas de esta manera no contiene el contrato para la <xref:System.ServiceModel.FaultException%601> de tipo <xref:System.ServiceModel.ExceptionDetail>.</span><span class="sxs-lookup"><span data-stu-id="b97fc-122">In addition, the WSDL for a method that returns unhandled managed exceptions in this way does not contain the contract for the <xref:System.ServiceModel.FaultException%601> of type <xref:System.ServiceModel.ExceptionDetail>.</span></span> <span data-ttu-id="b97fc-123">Los clientes deben esperar la posibilidad de un error de SOAP desconocido (devuelto a los clientes de WCF como <xref:System.ServiceModel.FaultException?displayProperty=nameWithType> objetos) para obtener la información de depuración correctamente.</span><span class="sxs-lookup"><span data-stu-id="b97fc-123">Clients must expect the possibility of an unknown SOAP fault (returned to WCF clients as <xref:System.ServiceModel.FaultException?displayProperty=nameWithType> objects) to obtain the debugging information properly.</span></span>

<span data-ttu-id="b97fc-124">Para enviar un error de SOAP no declarado, genere un objeto de <xref:System.ServiceModel.FaultException?displayProperty=nameWithType> (esto es, no del tipo genérico <xref:System.ServiceModel.FaultException%601>) y pase la cadena al constructor.</span><span class="sxs-lookup"><span data-stu-id="b97fc-124">To send an undeclared SOAP fault, throw a <xref:System.ServiceModel.FaultException?displayProperty=nameWithType> object (that is, not the generic type <xref:System.ServiceModel.FaultException%601>) and pass the string to the constructor.</span></span> <span data-ttu-id="b97fc-125">Esto se expone a las aplicaciones cliente de WCF como una excepción iniciada en la <xref:System.ServiceModel.FaultException?displayProperty=nameWithType> que la cadena está disponible mediante una llamada al <xref:System.ServiceModel.FaultException%601.ToString%2A?displayProperty=nameWithType> método.</span><span class="sxs-lookup"><span data-stu-id="b97fc-125">This is exposed to the WCF client applications as a thrown <xref:System.ServiceModel.FaultException?displayProperty=nameWithType> exception where the string is available by calling the <xref:System.ServiceModel.FaultException%601.ToString%2A?displayProperty=nameWithType> method.</span></span>

> [!NOTE]
> <span data-ttu-id="b97fc-126">Si declara un error de SOAP de tipo cadena y, a continuación, lo genera en su servicio como una <xref:System.ServiceModel.FaultException%601> donde el tipo del parámetro es una <xref:System.String?displayProperty=nameWithType>, el valor de la cadena está asignado a la propiedad <xref:System.ServiceModel.FaultException%601.Detail%2A?displayProperty=nameWithType>, y no está disponible desde <xref:System.ServiceModel.FaultException%601.ToString%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="b97fc-126">If you declare a SOAP fault of type string, and then throw this in your service as a <xref:System.ServiceModel.FaultException%601> where the type parameter is a <xref:System.String?displayProperty=nameWithType> the string value is assigned to the <xref:System.ServiceModel.FaultException%601.Detail%2A?displayProperty=nameWithType> property, and is not available from <xref:System.ServiceModel.FaultException%601.ToString%2A?displayProperty=nameWithType>.</span></span>

## <a name="handling-faults"></a><span data-ttu-id="b97fc-127">Control de errores</span><span class="sxs-lookup"><span data-stu-id="b97fc-127">Handling Faults</span></span>

<span data-ttu-id="b97fc-128">En los clientes de WCF, los errores de SOAP que se producen durante la comunicación que son de interés para las aplicaciones cliente se generan como excepciones administradas.</span><span class="sxs-lookup"><span data-stu-id="b97fc-128">In WCF clients, SOAP faults that occur during communication that are of interest to client applications are raised as managed exceptions.</span></span> <span data-ttu-id="b97fc-129">Aunque hay muchas excepciones que pueden producirse durante la ejecución de cualquier programa, las aplicaciones que usan el modelo de programación de cliente de WCF pueden esperar controlar las excepciones de los dos tipos siguientes como resultado de la comunicación.</span><span class="sxs-lookup"><span data-stu-id="b97fc-129">While there are many exceptions that can occur during the execution of any program, applications using the WCF client programming model can expect to handle exceptions of the following two types as a result of communication.</span></span>

- <xref:System.TimeoutException>

- <xref:System.ServiceModel.CommunicationException>

<span data-ttu-id="b97fc-130">Los objetos <xref:System.TimeoutException> se producen cuando una operación supera el período de tiempo de espera especificado.</span><span class="sxs-lookup"><span data-stu-id="b97fc-130"><xref:System.TimeoutException> objects are thrown when an operation exceeds the specified timeout period.</span></span>

<span data-ttu-id="b97fc-131">Los objetos <xref:System.ServiceModel.CommunicationException> se producen cuando hay alguna condición de error de comunicación recuperable en el servicio o el cliente.</span><span class="sxs-lookup"><span data-stu-id="b97fc-131"><xref:System.ServiceModel.CommunicationException> objects are thrown when there is some recoverable communication error condition on either the service or the client.</span></span>

<span data-ttu-id="b97fc-132">La clase <xref:System.ServiceModel.CommunicationException> tiene dos tipos derivados importantes: <xref:System.ServiceModel.FaultException> y el tipo <xref:System.ServiceModel.FaultException%601> genérico</span><span class="sxs-lookup"><span data-stu-id="b97fc-132">The <xref:System.ServiceModel.CommunicationException> class has two important derived types, <xref:System.ServiceModel.FaultException> and the generic <xref:System.ServiceModel.FaultException%601> type.</span></span>

<span data-ttu-id="b97fc-133">Las excepciones <xref:System.ServiceModel.FaultException> se producen cuando un agente de escucha recibe un error que no se espera o especifica en el contrato de operación; normalmente esto sucede cuando se depura la aplicación y el servicio tiene la propiedad <xref:System.ServiceModel.Description.ServiceDebugBehavior.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> establecida en `true`.</span><span class="sxs-lookup"><span data-stu-id="b97fc-133"><xref:System.ServiceModel.FaultException> exceptions are thrown when a listener receives a fault that is not expected or specified in the operation contract; usually this occurs when the application is being debugged and the service has the <xref:System.ServiceModel.Description.ServiceDebugBehavior.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> property set to `true`.</span></span>

<span data-ttu-id="b97fc-134">Las excepciones <xref:System.ServiceModel.FaultException%601> se producen en el cliente cuando se recibe un error de SOAP especificado en el contrato de la operación en respuesta a una operación bidireccional (es decir, un método con un atributo <xref:System.ServiceModel.OperationContractAttribute> con <xref:System.ServiceModel.OperationContractAttribute.IsOneWay%2A> establecido en `false`).</span><span class="sxs-lookup"><span data-stu-id="b97fc-134"><xref:System.ServiceModel.FaultException%601> exceptions are thrown on the client when a fault that is specified in the operation contract is received in response to a two-way operation (that is, a method with an <xref:System.ServiceModel.OperationContractAttribute> attribute with <xref:System.ServiceModel.OperationContractAttribute.IsOneWay%2A> set to `false`).</span></span>

> [!NOTE]
> <span data-ttu-id="b97fc-135">Cuando un servicio WCF tiene la <xref:System.ServiceModel.ServiceBehaviorAttribute.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> <xref:System.ServiceModel.Description.ServiceDebugBehavior.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> propiedad o establecida en `true` el cliente experimenta esto como un tipo no declarado <xref:System.ServiceModel.FaultException%601> <xref:System.ServiceModel.ExceptionDetail> .</span><span class="sxs-lookup"><span data-stu-id="b97fc-135">When an WCF service has the <xref:System.ServiceModel.ServiceBehaviorAttribute.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> or <xref:System.ServiceModel.Description.ServiceDebugBehavior.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> property set to `true` the client experiences this as an undeclared <xref:System.ServiceModel.FaultException%601> of type <xref:System.ServiceModel.ExceptionDetail>.</span></span> <span data-ttu-id="b97fc-136">Los clientes pueden detectar este error concreto o administrar el error en un bloque de detección de <xref:System.ServiceModel.FaultException>.</span><span class="sxs-lookup"><span data-stu-id="b97fc-136">Clients can either catch this specific fault or handle the fault in a catch block for <xref:System.ServiceModel.FaultException>.</span></span>

<span data-ttu-id="b97fc-137">Normalmente, solo las excepciones <xref:System.ServiceModel.FaultException%601>, <xref:System.TimeoutException> y <xref:System.ServiceModel.CommunicationException> son de interés para los clientes y servicios.</span><span class="sxs-lookup"><span data-stu-id="b97fc-137">Typically, only <xref:System.ServiceModel.FaultException%601>, <xref:System.TimeoutException>, and <xref:System.ServiceModel.CommunicationException> exceptions are of interest to clients and services.</span></span>

> [!NOTE]
> <span data-ttu-id="b97fc-138">Por supuesto, se producen otras excepciones.</span><span class="sxs-lookup"><span data-stu-id="b97fc-138">Other exceptions, of course, do occur.</span></span> <span data-ttu-id="b97fc-139">Entre las excepciones no esperadas se incluyen errores catastróficos como <xref:System.OutOfMemoryException?displayProperty=nameWithType>; normalmente las aplicaciones no deberían detectar ese tipo de métodos.</span><span class="sxs-lookup"><span data-stu-id="b97fc-139">Unexpected exceptions include catastrophic failures like <xref:System.OutOfMemoryException?displayProperty=nameWithType>; typically applications should not catch such methods.</span></span>

### <a name="catch-fault-exceptions-in-the-correct-order"></a><span data-ttu-id="b97fc-140">Detectar excepciones de errores en el orden correcto</span><span class="sxs-lookup"><span data-stu-id="b97fc-140">Catch Fault Exceptions in the Correct Order</span></span>

<span data-ttu-id="b97fc-141">Puesto que <xref:System.ServiceModel.FaultException%601> deriva de <xref:System.ServiceModel.FaultException>, y <xref:System.ServiceModel.FaultException> deriva de <xref:System.ServiceModel.CommunicationException>, es importante detectar estas excepciones en el orden apropiado.</span><span class="sxs-lookup"><span data-stu-id="b97fc-141">Because <xref:System.ServiceModel.FaultException%601> derives from <xref:System.ServiceModel.FaultException>, and <xref:System.ServiceModel.FaultException> derives from <xref:System.ServiceModel.CommunicationException>, it is important to catch these exceptions in the proper order.</span></span> <span data-ttu-id="b97fc-142">Por ejemplo, si tiene un bloque de intento/detección en el que primero detecta <xref:System.ServiceModel.CommunicationException>, todos los errores SOAP especificados y no especificados se administran ahí; los bloques de detección posteriores para administrar una excepción <xref:System.ServiceModel.FaultException%601> personalizada nunca se invocan.</span><span class="sxs-lookup"><span data-stu-id="b97fc-142">If, for example, you have a try/catch block in which you first catch <xref:System.ServiceModel.CommunicationException>, all specified and unspecified SOAP faults are handled there; any subsequent catch blocks to handle a custom <xref:System.ServiceModel.FaultException%601> exception are never invoked.</span></span>

<span data-ttu-id="b97fc-143">Recuerde que una operación puede devolver un número indefinido de errores especificados.</span><span class="sxs-lookup"><span data-stu-id="b97fc-143">Remember that one operation can return any number of specified faults.</span></span> <span data-ttu-id="b97fc-144">Cada error es de un tipo único y se ha de administrar separadamente.</span><span class="sxs-lookup"><span data-stu-id="b97fc-144">Each fault is a unique type and must be handled separately.</span></span>

### <a name="handle-exceptions-when-closing-the-channel"></a><span data-ttu-id="b97fc-145">Administre las excepciones al cerrar el canal</span><span class="sxs-lookup"><span data-stu-id="b97fc-145">Handle Exceptions When Closing the Channel</span></span>

<span data-ttu-id="b97fc-146">La mayor parte de la explicación anterior tiene que hacer con los errores enviados en el transcurso del procesamiento de mensajes de la aplicación, es decir, los mensajes enviados explícitamente por el cliente cuando la aplicación cliente llama a las operaciones en el objeto de cliente de WCF.</span><span class="sxs-lookup"><span data-stu-id="b97fc-146">Most of the preceding discussion has to do with faults sent in the course of processing application messages, that is, messages explicitly sent by the client when the client application calls operations on the WCF client object.</span></span>

<span data-ttu-id="b97fc-147">Incluso con la disposición de objetos locales, el objeto puede elevar o enmascara excepciones que tienen lugar durante el proceso de reciclaje.</span><span class="sxs-lookup"><span data-stu-id="b97fc-147">Even with local objects disposing the object can either raise or mask exceptions that occur during the recycling process.</span></span> <span data-ttu-id="b97fc-148">Se puede producir algo similar al utilizar objetos de cliente WCF.</span><span class="sxs-lookup"><span data-stu-id="b97fc-148">Something similar can occur when you use WCF client objects.</span></span> <span data-ttu-id="b97fc-149">Al llamar a operaciones, está enviando mensajes a través de una conexión establecida.</span><span class="sxs-lookup"><span data-stu-id="b97fc-149">When you call operations you are sending messages over an established connection.</span></span> <span data-ttu-id="b97fc-150">Cerrar el canal puede producir excepciones si la conexión no se puede cerrar limpiamente o ya está cerrada, aun cuando todas las operaciones hayan devuelto correctamente.</span><span class="sxs-lookup"><span data-stu-id="b97fc-150">Closing the channel can throw exceptions if the connection cannot be cleanly closed or is already closed, even if all the operations returned properly.</span></span>

<span data-ttu-id="b97fc-151">Normalmente, los canales de objeto de cliente se cierran de una de las siguientes maneras:</span><span class="sxs-lookup"><span data-stu-id="b97fc-151">Typically, client object channels are closed in one of the following ways:</span></span>

- <span data-ttu-id="b97fc-152">Cuando se recicla el objeto de cliente de WCF.</span><span class="sxs-lookup"><span data-stu-id="b97fc-152">When the WCF client object is recycled.</span></span>

- <span data-ttu-id="b97fc-153">Cuando la aplicación de cliente llama <xref:System.ServiceModel.ClientBase%601.Close%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="b97fc-153">When the client application calls <xref:System.ServiceModel.ClientBase%601.Close%2A?displayProperty=nameWithType>.</span></span>

- <span data-ttu-id="b97fc-154">Cuando la aplicación de cliente llama <xref:System.ServiceModel.ICommunicationObject.Close%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="b97fc-154">When the client application calls <xref:System.ServiceModel.ICommunicationObject.Close%2A?displayProperty=nameWithType>.</span></span>

- <span data-ttu-id="b97fc-155">Cuando la aplicación de cliente llama a una operación que es una operación de finalización para una sesión.</span><span class="sxs-lookup"><span data-stu-id="b97fc-155">When the client application calls an operation that is a terminating operation for a session.</span></span>

<span data-ttu-id="b97fc-156">En todos los casos, cerrar el canal indica al canal que comience a cerrar todos los canales subyacentes que puedan estar enviando mensajes para admitir una funcionalidad compleja en el nivel de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="b97fc-156">In all cases, closing the channel instructs the channel to begin closing any underlying channels that may be sending messages to support complex functionality at the application level.</span></span> <span data-ttu-id="b97fc-157">Por ejemplo, cuando un contrato requiere sesiones, un enlace intenta establecer una sesión mediante el intercambio de mensajes con el canal del servicio hasta que se establezca una sesión.</span><span class="sxs-lookup"><span data-stu-id="b97fc-157">For example, when a contract requires sessions a binding attempts to establish a session by exchanging messages with the service channel until a session is established.</span></span> <span data-ttu-id="b97fc-158">Cuando se cierre el canal, el canal de la sesión subyacente notifica al servicio que la sesión se ha terminado.</span><span class="sxs-lookup"><span data-stu-id="b97fc-158">When the channel is closed, the underlying session channel notifies the service that the session is terminated.</span></span> <span data-ttu-id="b97fc-159">En este caso, si el canal ya se ha anulado, cerrado o es inutilizable (por ejemplo, cuando se desconecta un cable de red), el canal de cliente no puede informar al canal del servicio que se finaliza la sesión y es posible que se produzca una excepción.</span><span class="sxs-lookup"><span data-stu-id="b97fc-159">In this case, if the channel has already aborted, closed, or is otherwise unusable (for example, when a network cable is unplugged), the client channel cannot inform the service channel that the session is terminated and an exception can result.</span></span>

### <a name="abort-the-channel-if-necessary"></a><span data-ttu-id="b97fc-160">Anule el canal si fuese necesario</span><span class="sxs-lookup"><span data-stu-id="b97fc-160">Abort the Channel If Necessary</span></span>

<span data-ttu-id="b97fc-161">Dado que cerrar el canal también puede producir excepciones, se recomienda que además de detectar las excepciones de error en el orden correcto, es importante anular el canal que se utilizó para realizar la llamada en el bloque de detección.</span><span class="sxs-lookup"><span data-stu-id="b97fc-161">Because closing the channel can also throw exceptions, then, it is recommended that in addition to catching fault exceptions in the correct order, it is important to abort the channel that was used in making the call in the catch block.</span></span>

<span data-ttu-id="b97fc-162">Si el error transporta información de error específica de una operación y sigue siendo posible que otros puedan utilizarla, no hay ninguna necesidad de anular el canal (aunque estos casos son aislados).</span><span class="sxs-lookup"><span data-stu-id="b97fc-162">If the fault conveys error information specific to an operation and it remains possible that others can use it, there is no need to abort the channel (although these cases are rare).</span></span> <span data-ttu-id="b97fc-163">En el resto de casos, se recomienda que anule el canal.</span><span class="sxs-lookup"><span data-stu-id="b97fc-163">In all other cases, it is recommended that you abort the channel.</span></span> <span data-ttu-id="b97fc-164">Para obtener un ejemplo que muestra todos estos puntos, vea [excepciones esperadas](./samples/expected-exceptions.md).</span><span class="sxs-lookup"><span data-stu-id="b97fc-164">For a sample that demonstrates all of these points, see [Expected Exceptions](./samples/expected-exceptions.md).</span></span>

<span data-ttu-id="b97fc-165">El siguiente ejemplo de código muestra cómo administrar las excepciones de errores de SOAP en una aplicación de cliente básica, incluyendo un error declarado y uno no declarado.</span><span class="sxs-lookup"><span data-stu-id="b97fc-165">The following code example shows how to handle SOAP fault exceptions in a basic client application, including a declared fault and an undeclared fault.</span></span>

> [!NOTE]
> <span data-ttu-id="b97fc-166">Este código de ejemplo no utiliza la construcción `using`.</span><span class="sxs-lookup"><span data-stu-id="b97fc-166">This sample code does not use the `using` construct.</span></span> <span data-ttu-id="b97fc-167">Dado que los canales de cierre pueden producir excepciones, se recomienda que las aplicaciones creen primero un cliente WCF y, a continuación, abran, utilicen y cierren el cliente WCF en el mismo bloque try.</span><span class="sxs-lookup"><span data-stu-id="b97fc-167">Because closing channels can throw exceptions, it is recommended that applications create a WCF client first, and then open, use, and close the WCF client in the same try block.</span></span> <span data-ttu-id="b97fc-168">Para obtener más información, vea [información general del cliente de WCF](wcf-client-overview.md) y [usar cerrar y anular para liberar los recursos de cliente de WCF](./samples/use-close-abort-release-wcf-client-resources.md).</span><span class="sxs-lookup"><span data-stu-id="b97fc-168">For details, see [WCF Client Overview](wcf-client-overview.md) and [Use Close and Abort to release WCF client resources](./samples/use-close-abort-release-wcf-client-resources.md).</span></span>

[!code-csharp[FaultContractAttribute#3](../../../samples/snippets/csharp/VS_Snippets_CFX/faultcontractattribute/cs/client.cs#3)]
[!code-vb[FaultContractAttribute#3](../../../samples/snippets/visualbasic/VS_Snippets_CFX/faultcontractattribute/vb/client.vb#3)]

## <a name="see-also"></a><span data-ttu-id="b97fc-169">Vea también</span><span class="sxs-lookup"><span data-stu-id="b97fc-169">See also</span></span>

- <xref:System.ServiceModel.FaultException>
- <xref:System.ServiceModel.FaultException%601>
- <xref:System.ServiceModel.CommunicationException?displayProperty=nameWithType>
- [<span data-ttu-id="b97fc-170">Excepciones esperadas</span><span class="sxs-lookup"><span data-stu-id="b97fc-170">Expected Exceptions</span></span>](./samples/expected-exceptions.md)
- [<span data-ttu-id="b97fc-171">Uso de Close y Abort para liberar los recursos del cliente WCF</span><span class="sxs-lookup"><span data-stu-id="b97fc-171">Use Close and Abort to release WCF client resources</span></span>](./samples/use-close-abort-release-wcf-client-resources.md)
