---
title: Configuración del registro de mensajes
description: Aprenda a configurar el registro de mensajes, incluido cómo habilitar el registro, los niveles de registro, los filtros de mensajes y cómo configurar un agente de escucha personalizado en WCF.
ms.date: 03/30/2017
helpviewer_keywords:
- message logging [WCF]
ms.assetid: 0ff4c857-8f09-4b85-9dc0-89084706e4c9
ms.openlocfilehash: 5203f19a18e5fa6b0ed7f68e1d1de0447da41abd
ms.sourcegitcommit: 358a28048f36a8dca39a9fe6e6ac1f1913acadd5
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/23/2020
ms.locfileid: "85247667"
---
# <a name="configuring-message-logging"></a><span data-ttu-id="87594-103">Configuración del registro de mensajes</span><span class="sxs-lookup"><span data-stu-id="87594-103">Configuring Message Logging</span></span>

<span data-ttu-id="87594-104">En este tema se describe cómo puede configurar el registro de mensajes para distintos escenarios.</span><span class="sxs-lookup"><span data-stu-id="87594-104">This topic describes how you can configure message logging for different scenarios.</span></span>

## <a name="enabling-message-logging"></a><span data-ttu-id="87594-105">Cómo habilitar el registro de mensajes</span><span class="sxs-lookup"><span data-stu-id="87594-105">Enabling Message Logging</span></span>

<span data-ttu-id="87594-106">Windows Communication Foundation (WCF) no registra mensajes de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="87594-106">Windows Communication Foundation (WCF) does not log messages by default.</span></span> <span data-ttu-id="87594-107">Para activar el registro de mensajes, debe agregar un agente de escucha de seguimiento al origen de seguimiento `System.ServiceModel.MessageLogging` y definir atributos para el elemento `<messagelogging>` en el archivo de configuración.</span><span class="sxs-lookup"><span data-stu-id="87594-107">To activate message logging, you must add a trace listener to the `System.ServiceModel.MessageLogging` trace source and set attributes for the `<messagelogging>` element in the configuration file.</span></span>

<span data-ttu-id="87594-108">En el siguiente ejemplo, se muestra cómo habilitar el registro y especificar opciones adicionales.</span><span class="sxs-lookup"><span data-stu-id="87594-108">The following example shows how to enable logging and specify additional options.</span></span>

```xml
<system.diagnostics>
  <sources>
    <source name="System.ServiceModel.MessageLogging">
      <listeners>
         <add name="messages"
              type="System.Diagnostics.XmlWriterTraceListener"
              initializeData="c:\logs\messages.svclog" />
        </listeners>
    </source>
  </sources>
</system.diagnostics>

<system.serviceModel>
  <diagnostics>
    <messageLogging
         logEntireMessage="true"
         logMalformedMessages="false"
         logMessagesAtServiceLevel="true"
         logMessagesAtTransportLevel="false"
         maxMessagesToLog="3000"
         maxSizeOfMessageToLog="2000"/>
  </diagnostics>
</system.serviceModel>
```

<span data-ttu-id="87594-109">Para obtener más información acerca de la configuración del registro de mensajes, vea [configuración recomendada para el seguimiento y el registro de mensajes](./tracing/recommended-settings-for-tracing-and-message-logging.md).</span><span class="sxs-lookup"><span data-stu-id="87594-109">For more information about message logging settings, see [Recommended Settings for Tracing and Message Logging](./tracing/recommended-settings-for-tracing-and-message-logging.md).</span></span>

<span data-ttu-id="87594-110">Puede utilizar `add` para especificar el nombre y tipo del agente de escucha que desea utilizar.</span><span class="sxs-lookup"><span data-stu-id="87594-110">You can use `add` to specify the name and type of the listener you want to use.</span></span> <span data-ttu-id="87594-111">En la configuración de ejemplo, el agente de escucha se denomina "mensajes" y agrega el agente de escucha de seguimiento de .NET Framework estándar (`System.Diagnostics.XmlWriterTraceListener`) como el tipo que se va a utilizar.</span><span class="sxs-lookup"><span data-stu-id="87594-111">In the example configuration, the Listener is named "messages" and adds the standard .NET Framework trace listener (`System.Diagnostics.XmlWriterTraceListener`) as the type to use.</span></span> <span data-ttu-id="87594-112">Si utiliza `System.Diagnostics.XmlWriterTraceListener`, debe especificar la ubicación y el nombre del archivo de resultados en el archivo de configuración.</span><span class="sxs-lookup"><span data-stu-id="87594-112">If you use `System.Diagnostics.XmlWriterTraceListener`, you must specify the output file location and name in the configuration file.</span></span> <span data-ttu-id="87594-113">Esto se hace estableciendo `initializeData` en el nombre del archivo de registro.</span><span class="sxs-lookup"><span data-stu-id="87594-113">This is done by setting `initializeData` to the name of the log file.</span></span> <span data-ttu-id="87594-114">De lo contrario, el sistema produce una excepción.</span><span class="sxs-lookup"><span data-stu-id="87594-114">Otherwise, the system throws an exception.</span></span> <span data-ttu-id="87594-115">También puede implementar un agente de escucha personalizado que emita registros en un archivo predeterminado.</span><span class="sxs-lookup"><span data-stu-id="87594-115">You can also implement a custom listener that emits logs to a default file.</span></span>

> [!NOTE]
> <span data-ttu-id="87594-116">Dado que el registro de mensajes accede al espacio en disco, debería limitar el número de mensajes que se escriben en el disco para un servicio determinado.</span><span class="sxs-lookup"><span data-stu-id="87594-116">Because message logging accesses disk space, you should limit the number of messages that are written to disk for a particular service.</span></span> <span data-ttu-id="87594-117">Cuando se alcanza el límite de mensajes, se genera un seguimiento en el nivel de información y todas las actividades de registro de mensajes se detienen.</span><span class="sxs-lookup"><span data-stu-id="87594-117">When the message limit is reached, a trace at the Information level is produced and all message logging activities stop.</span></span>

<span data-ttu-id="87594-118">El nivel de registro, así como las opciones adicionales, se tratan en la sección Registro de niveles y opciones.</span><span class="sxs-lookup"><span data-stu-id="87594-118">The logging level, as well as the additional options, are discussed in the Logging Level and Options section.</span></span>

<span data-ttu-id="87594-119">El atributo `switchValue` de `source` solo es válido para seguimientos.</span><span class="sxs-lookup"><span data-stu-id="87594-119">The `switchValue` attribute of a `source` is only valid for tracing.</span></span> <span data-ttu-id="87594-120">Si especifica un atributo `switchValue` para el origen de seguimiento `System.ServiceModel.MessageLogging` tal y como se indica a continuación, no tendrá ningún efecto.</span><span class="sxs-lookup"><span data-stu-id="87594-120">If you specify a `switchValue` attribute for the `System.ServiceModel.MessageLogging` trace source as follows, it has no effect.</span></span>

```xml
<source name="System.ServiceModel.MessageLogging" switchValue="Verbose">
</source>
```

<span data-ttu-id="87594-121">Si desea deshabilitar el origen de seguimiento, debería utilizar en su lugar los atributos `logMessagesAtServiceLevel`, `logMalformedMessages` y `logMessagesAtTransportLevel` del elemento `messageLogging`.</span><span class="sxs-lookup"><span data-stu-id="87594-121">If you want to disable the trace source, you should use the `logMessagesAtServiceLevel`, `logMalformedMessages`, and `logMessagesAtTransportLevel` attributes of the `messageLogging` element instead.</span></span> <span data-ttu-id="87594-122">Debería establecer todos estos atributos en `false`.</span><span class="sxs-lookup"><span data-stu-id="87594-122">You should set all these attributes to `false`.</span></span> <span data-ttu-id="87594-123">Esta acción puede realizarse utilizando el archivo de configuración en el ejemplo de código anterior, mediante la interfaz del usuario del editor de configuración, o mediante WMI.</span><span class="sxs-lookup"><span data-stu-id="87594-123">This can be done by using the configuration file in the previous code example, through the Configuration Editor UI interface, or using WMI.</span></span> <span data-ttu-id="87594-124">Para obtener más información sobre la herramienta editor de configuración, vea [herramienta editor de configuración (SvcConfigEditor.exe)](../configuration-editor-tool-svcconfigeditor-exe.md).</span><span class="sxs-lookup"><span data-stu-id="87594-124">For more information about the Configuration Editor tool, see [Configuration Editor Tool (SvcConfigEditor.exe)](../configuration-editor-tool-svcconfigeditor-exe.md).</span></span> <span data-ttu-id="87594-125">Para obtener más información acerca de WMI, consulte [uso de instrumental de administración de Windows para diagnósticos](./wmi/index.md).</span><span class="sxs-lookup"><span data-stu-id="87594-125">For more information about WMI, see [Using Windows Management Instrumentation for Diagnostics](./wmi/index.md).</span></span>

## <a name="logging-levels-and-options"></a><span data-ttu-id="87594-126">Registro de niveles y opciones</span><span class="sxs-lookup"><span data-stu-id="87594-126">Logging Levels and Options</span></span>

<span data-ttu-id="87594-127">En el caso de los mensajes entrantes, el registro se produce inmediatamente después de que se haya formado el mensaje, inmediatamente antes de que el mensaje obtenga el código de usuario en el nivel de servicio y cuando se detecten los mensajes incorrectos.</span><span class="sxs-lookup"><span data-stu-id="87594-127">For incoming messages, logging happens immediately after the message is formed, immediately before the message gets to user code in the service level, and when malformed messages are detected.</span></span>

<span data-ttu-id="87594-128">En el caso de los mensajes salientes, el registro se produce inmediatamente después de que el mensaje deje el código de usuario e inmediatamente antes de que el mensaje esté en tránsito.</span><span class="sxs-lookup"><span data-stu-id="87594-128">For outgoing messages, logging happens immediately after the message leaves user code and immediately before the message goes on the wire.</span></span>

<span data-ttu-id="87594-129">WCF registra mensajes en dos niveles diferentes, servicio y transporte.</span><span class="sxs-lookup"><span data-stu-id="87594-129">WCF logs messages at two different levels, service and transport.</span></span> <span data-ttu-id="87594-130">Los mensajes incorrectos también se registran.</span><span class="sxs-lookup"><span data-stu-id="87594-130">Malformed messages are also logged.</span></span> <span data-ttu-id="87594-131">Las tres categorías son independientes entre sí y pueden activarse por separado en la configuración.</span><span class="sxs-lookup"><span data-stu-id="87594-131">The three categories are independent from each other and can be activated separately in configuration.</span></span>

<span data-ttu-id="87594-132">Puede controlar el nivel de registro definiendo los atributos `logMessagesAtServiceLevel`, `logMalformedMessages` y `logMessagesAtTransportLevel` del elemento `messageLogging`.</span><span class="sxs-lookup"><span data-stu-id="87594-132">You can control the logging level by setting the `logMessagesAtServiceLevel`, `logMalformedMessages`, and `logMessagesAtTransportLevel` attributes of the `messageLogging` element.</span></span>

### <a name="service-level"></a><span data-ttu-id="87594-133">Nivel de servicio</span><span class="sxs-lookup"><span data-stu-id="87594-133">Service Level</span></span>

<span data-ttu-id="87594-134">Los mensajes registrados en este nivel están a punto de introducir (al recibir) o dejar (al enviar) código de usuario.</span><span class="sxs-lookup"><span data-stu-id="87594-134">Messages logged at this layer are about to enter (on receiving) or leave (on sending) user code.</span></span> <span data-ttu-id="87594-135">Si se han definido los filtros, solo se registrarán los mensajes que coincidan con los filtros.</span><span class="sxs-lookup"><span data-stu-id="87594-135">If filters have been defined, only messages that match the filters are logged.</span></span> <span data-ttu-id="87594-136">De lo contrario, se registrarán todos los mensajes en el nivel de servicio.</span><span class="sxs-lookup"><span data-stu-id="87594-136">Otherwise, all messages at the service level are logged.</span></span> <span data-ttu-id="87594-137">Los mensajes de infraestructura (transacciones, canal del mismo nivel y seguridad) también se registran en este nivel, salvo los mensajes de la mensajería de confianza.</span><span class="sxs-lookup"><span data-stu-id="87594-137">Infrastructure messages (transactions, peer channel, and security) are also logged at this level, except for Reliable Messaging messages.</span></span> <span data-ttu-id="87594-138">En los mensajes transmitidos, solo se registran los encabezados.</span><span class="sxs-lookup"><span data-stu-id="87594-138">On streamed messages, only the headers are logged.</span></span> <span data-ttu-id="87594-139">Además, los mensajes seguros se registran descifrados en este nivel.</span><span class="sxs-lookup"><span data-stu-id="87594-139">In addition, secure messages are logged decrypted at this level.</span></span>

### <a name="transport-level"></a><span data-ttu-id="87594-140">Nivel de transporte</span><span class="sxs-lookup"><span data-stu-id="87594-140">Transport Level</span></span>

<span data-ttu-id="87594-141">Los mensajes registrados en este nivel están listos para ser codificados o descodificados para el transporte o para después de éste en tránsito.</span><span class="sxs-lookup"><span data-stu-id="87594-141">Messages logged at this layer are ready to be encoded or decoded for or after transportation on the wire.</span></span> <span data-ttu-id="87594-142">Si se han definido los filtros, solo se registrarán los mensajes que coincidan con los filtros.</span><span class="sxs-lookup"><span data-stu-id="87594-142">If filters have been defined, only messages that match the filters are logged.</span></span> <span data-ttu-id="87594-143">De lo contrario, se registrarán todos los mensajes en el nivel de transporte.</span><span class="sxs-lookup"><span data-stu-id="87594-143">Otherwise, all messages at the transport layer are logged.</span></span> <span data-ttu-id="87594-144">Todos los mensajes de la infraestructura se registran en este nivel, incluidos los mensajes de la mensajería de confianza.</span><span class="sxs-lookup"><span data-stu-id="87594-144">All infrastructure messages are logged at this layer, including reliable messaging messages.</span></span> <span data-ttu-id="87594-145">En los mensajes transmitidos, solo se registran los encabezados.</span><span class="sxs-lookup"><span data-stu-id="87594-145">On streamed messages, only the headers are logged.</span></span> <span data-ttu-id="87594-146">Además, los mensajes seguros se registran como cifrados en este nivel, excepto si se utiliza un transporte seguro como HTTPS.</span><span class="sxs-lookup"><span data-stu-id="87594-146">In addition, secure messages are logged as encrypted at this level, except if a secure transport such as HTTPS is used.</span></span>

### <a name="malformed-level"></a><span data-ttu-id="87594-147">Nivel incorrecto</span><span class="sxs-lookup"><span data-stu-id="87594-147">Malformed Level</span></span>

<span data-ttu-id="87594-148">Los mensajes con formato incorrecto son mensajes rechazados por la pila de WCF en cualquier fase de procesamiento.</span><span class="sxs-lookup"><span data-stu-id="87594-148">Malformed messages are messages that are rejected by the WCF stack at any stage of processing.</span></span> <span data-ttu-id="87594-149">Los mensajes con formato incorrecto se registran tal cual: cifrados si lo están, con XML inadecuado, etc.</span><span class="sxs-lookup"><span data-stu-id="87594-149">Malformed messages are logged as-is: encrypted if they are so, with non-proper XML, and so on.</span></span> <span data-ttu-id="87594-150">`maxSizeOfMessageToLog` definió el tamaño del mensaje que se debía registrar como CDATA.</span><span class="sxs-lookup"><span data-stu-id="87594-150">`maxSizeOfMessageToLog` defined the size of the message to be logged as CDATA.</span></span> <span data-ttu-id="87594-151">De forma predeterminada, `maxSizeOfMessageToLog` es igual a 256 K.</span><span class="sxs-lookup"><span data-stu-id="87594-151">By default, `maxSizeOfMessageToLog` is equal to 256K.</span></span> <span data-ttu-id="87594-152">Para obtener más información acerca de este atributo, vea la sección otras opciones.</span><span class="sxs-lookup"><span data-stu-id="87594-152">For more information about this attribute, see the Other Options section.</span></span>

### <a name="other-options"></a><span data-ttu-id="87594-153">Otras opciones</span><span class="sxs-lookup"><span data-stu-id="87594-153">Other Options</span></span>

<span data-ttu-id="87594-154">Además de los niveles del registro, el usuario puede especificar las opciones siguientes:</span><span class="sxs-lookup"><span data-stu-id="87594-154">In addition to the logging levels, the user can specify the following options:</span></span>

- <span data-ttu-id="87594-155">Registro del mensaje completo (atributo `logEntireMessage`): este valor especifica si se registró el mensaje completo (encabezado y cuerpo del mensaje).</span><span class="sxs-lookup"><span data-stu-id="87594-155">Log Entire Message (`logEntireMessage` attribute): This value specifies whether the entire message (message header and body) is logged.</span></span> <span data-ttu-id="87594-156">El valor predeterminado es `false`, lo que significa que solo se registra el encabezado.</span><span class="sxs-lookup"><span data-stu-id="87594-156">The default value is `false`, meaning that only the header is logged.</span></span> <span data-ttu-id="87594-157">Esta configuración afecta a los niveles de registro de mensajes de servicio y transporte.</span><span class="sxs-lookup"><span data-stu-id="87594-157">This setting affects service and transport message logging levels..</span></span>

- <span data-ttu-id="87594-158">Número máximo de mensajes que registrar (atributo `maxMessagesToLog`): este valor especifica el número máximo de mensajes que se van a registrar.</span><span class="sxs-lookup"><span data-stu-id="87594-158">Max messages to log (`maxMessagesToLog` attribute): This value specifies the maximum number of messages to log.</span></span> <span data-ttu-id="87594-159">Se contarán todos los mensajes (servicio, transporte y mensajes incorrectos) hacia esta cuota.</span><span class="sxs-lookup"><span data-stu-id="87594-159">All messages (service, transport, and malformed messages) are counted towards this quota.</span></span> <span data-ttu-id="87594-160">Cuando se alcance, se emitirá un seguimiento y no se registrará ningún mensaje adicional.</span><span class="sxs-lookup"><span data-stu-id="87594-160">When the quota is reached, a trace is emitted and no additional message is logged.</span></span> <span data-ttu-id="87594-161">El valor predeterminado es 10000.</span><span class="sxs-lookup"><span data-stu-id="87594-161">The default value is 10000.</span></span>

- <span data-ttu-id="87594-162">Tamaño máximo del mensaje que registrar (atributo `maxSizeOfMessageToLog`): este valor especifica el tamaño máximo de los mensajes que registrar en bytes.</span><span class="sxs-lookup"><span data-stu-id="87594-162">Max size of message to log (`maxSizeOfMessageToLog` attribute): This value specifies the maximum size of messages to log in bytes.</span></span> <span data-ttu-id="87594-163">Los mensajes que superan el límite de tamaño no están registrados y no se realizará ninguna otra actividad para ese mensaje.</span><span class="sxs-lookup"><span data-stu-id="87594-163">Messages that exceed the size limit are not logged, and no other activity is performed for that message.</span></span> <span data-ttu-id="87594-164">Este valor afecta a todos los niveles de seguimiento.</span><span class="sxs-lookup"><span data-stu-id="87594-164">This setting affects all trace levels.</span></span> <span data-ttu-id="87594-165">Si el seguimiento de ServiceModel está activado, se emitirá el seguimiento de nivel de advertencia en el primer punto de registro (ServiceModelSend \* o TransportReceive) para notificar al usuario.</span><span class="sxs-lookup"><span data-stu-id="87594-165">If ServiceModel tracing is on, a Warning level trace is emitted at the first logging point (ServiceModelSend\* or TransportReceive) to notify the user.</span></span> <span data-ttu-id="87594-166">El valor predeterminado para los mensajes de nivel de servicio y de transporte es 256 K, mientras que el valor predeterminado para los mensajes incorrectos es 4 K.</span><span class="sxs-lookup"><span data-stu-id="87594-166">The default value for service level and transport level messages is 256K, while the default value for malformed messages is 4K.</span></span>

  > [!CAUTION]
  > <span data-ttu-id="87594-167">El tamaño del mensaje que se calcula para comparar con el valor de `maxSizeOfMessageToLog` es el tamaño del mensaje en memoria antes de la serialización.</span><span class="sxs-lookup"><span data-stu-id="87594-167">The message size that is computed to compare against `maxSizeOfMessageToLog` is the message size in memory before serialization.</span></span> <span data-ttu-id="87594-168">Este tamaño puede diferir de la longitud real de la cadena del mensaje que está registrando y, en muchas ocasiones, es mayor que el tamaño real.</span><span class="sxs-lookup"><span data-stu-id="87594-168">This size can differ from the actual length of the message string that is being logged, and in many occasions is bigger than the actual size.</span></span> <span data-ttu-id="87594-169">Como resultado, es posible que los mensajes no estén registrados.</span><span class="sxs-lookup"><span data-stu-id="87594-169">As a result, messages may not be logged.</span></span> <span data-ttu-id="87594-170">Puede consignar este hecho al especificar el atributo `maxSizeOfMessageToLog` para que sea un 10% mayor que el tamaño del mensaje esperado.</span><span class="sxs-lookup"><span data-stu-id="87594-170">You can account for this fact by specifying the `maxSizeOfMessageToLog` attribute to be 10% larger than the expected message size.</span></span> <span data-ttu-id="87594-171">Además, si los mensajes incorrectos se registran, el espacio en disco real utilizado por los registros de los mensajes puede ser hasta 5 veces más que el tamaño del valor especificado por `maxSizeOfMessageToLog`.</span><span class="sxs-lookup"><span data-stu-id="87594-171">In addition, if malformed messages are logged, the actual disk space utilized by the message logs can be up to 5 times the size of the value specified by `maxSizeOfMessageToLog`.</span></span>

<span data-ttu-id="87594-172">Si ningún agente de escucha de seguimiento se define en el archivo de configuración, no se generará ninguna salida de registro sin tener en cuenta el nivel de registro especificado.</span><span class="sxs-lookup"><span data-stu-id="87594-172">If no trace listener is defined in the configuration file, no logging output is generated regardless of the specified logging level.</span></span>

<span data-ttu-id="87594-173">Las opciones de registro de mensajes, como los atributos descritos en esta sección, se pueden cambiar en el tiempo de ejecución mediante el Instrumental de administración de Windows (WMI).</span><span class="sxs-lookup"><span data-stu-id="87594-173">Message logging options, such as the attributes described in this section, can be changed at runtime using Windows Management Instrumentation (WMI).</span></span> <span data-ttu-id="87594-174">Esto puede hacerse mediante el acceso a la instancia de [AppDomainInfo](./wmi/appdomaininfo.md) , que expone estas propiedades booleanas: `LogMessagesAtServiceLevel` , `LogMessagesAtTransportLevel` y `LogMalformedMessages` .</span><span class="sxs-lookup"><span data-stu-id="87594-174">This can be done by accessing the [AppDomainInfo](./wmi/appdomaininfo.md) instance, which exposes these Boolean properties: `LogMessagesAtServiceLevel`, `LogMessagesAtTransportLevel`, and `LogMalformedMessages`.</span></span> <span data-ttu-id="87594-175">Por consiguiente, si configura un agente de escucha de traza para el registro de mensajes, pero define estas opciones en `false`, en la configuración, puede cambiarlas después a `true`, una vez se esté ejecutando la aplicación.</span><span class="sxs-lookup"><span data-stu-id="87594-175">Therefore, if you configure a trace listener for message logging, but set these options to `false` in configuration, you can later change them to `true` when the application is running.</span></span> <span data-ttu-id="87594-176">Esto habilita en efecto el registro de mensajes en el tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="87594-176">This effectively enables message logging at runtime.</span></span> <span data-ttu-id="87594-177">De igual forma, si habilita el registro de mensajes en su archivo de configuración, puede deshabilitarlo en el tiempo de ejecución mediante WMI.</span><span class="sxs-lookup"><span data-stu-id="87594-177">Similarly, if you enable message logging in your configuration file, you can disable it at runtime using WMI.</span></span> <span data-ttu-id="87594-178">Para obtener más información, consulte [uso de instrumental de administración de Windows para diagnósticos](./wmi/index.md).</span><span class="sxs-lookup"><span data-stu-id="87594-178">For more information, see [Using Windows Management Instrumentation for Diagnostics](./wmi/index.md).</span></span>

<span data-ttu-id="87594-179">El campo `source` de un registro de mensajes especifica en qué contexto se registra el mensaje: al enviar o recibir un mensaje de solicitud, para una solicitud-respuesta o una solicitud unidireccional, en el modelo de servicio o capa de transporte, o en el caso de un mensaje con formato incorrecto.</span><span class="sxs-lookup"><span data-stu-id="87594-179">The `source` field in a message log specifies in which context the message is logged: when sending/receiving a request message, for a request-reply or 1-way request, at service model or transport layer, or in the case of a malformed message.</span></span>

<span data-ttu-id="87594-180">En el caso de los mensajes con formato incorrecto, `source` es igual a `Malformed` .</span><span class="sxs-lookup"><span data-stu-id="87594-180">For malformed messages, `source`  is equal to `Malformed`.</span></span> <span data-ttu-id="87594-181">De lo contrario, el origen tiene los valores siguientes basados en el contexto.</span><span class="sxs-lookup"><span data-stu-id="87594-181">Otherwise, source has the following values based on the context.</span></span>

<span data-ttu-id="87594-182">Para solicitud/respuesta</span><span class="sxs-lookup"><span data-stu-id="87594-182">For Request/Reply</span></span>

||<span data-ttu-id="87594-183">Enviar solicitud</span><span class="sxs-lookup"><span data-stu-id="87594-183">Send Request</span></span>|<span data-ttu-id="87594-184">Recibir solicitud</span><span class="sxs-lookup"><span data-stu-id="87594-184">Receive Request</span></span>|<span data-ttu-id="87594-185">Enviar respuesta</span><span class="sxs-lookup"><span data-stu-id="87594-185">Send Reply</span></span>|<span data-ttu-id="87594-186">Recibir respuesta</span><span class="sxs-lookup"><span data-stu-id="87594-186">Receive Reply</span></span>|
|-|------------------|---------------------|----------------|-------------------|
|<span data-ttu-id="87594-187">Nivel de modelo de servicio</span><span class="sxs-lookup"><span data-stu-id="87594-187">Service Model layer</span></span>|<span data-ttu-id="87594-188">Servicio</span><span class="sxs-lookup"><span data-stu-id="87594-188">Service</span></span><br /><br /> <span data-ttu-id="87594-189">Nivel</span><span class="sxs-lookup"><span data-stu-id="87594-189">Level</span></span><br /><br /> <span data-ttu-id="87594-190">Envío</span><span class="sxs-lookup"><span data-stu-id="87594-190">Send</span></span><br /><br /> <span data-ttu-id="87594-191">Request</span><span class="sxs-lookup"><span data-stu-id="87594-191">Request</span></span>|<span data-ttu-id="87594-192">Servicio</span><span class="sxs-lookup"><span data-stu-id="87594-192">Service</span></span><br /><br /> <span data-ttu-id="87594-193">Nivel</span><span class="sxs-lookup"><span data-stu-id="87594-193">Level</span></span><br /><br /> <span data-ttu-id="87594-194">Recepción</span><span class="sxs-lookup"><span data-stu-id="87594-194">Receive</span></span><br /><br /> <span data-ttu-id="87594-195">Request</span><span class="sxs-lookup"><span data-stu-id="87594-195">Request</span></span>|<span data-ttu-id="87594-196">Servicio</span><span class="sxs-lookup"><span data-stu-id="87594-196">Service</span></span><br /><br /> <span data-ttu-id="87594-197">Nivel</span><span class="sxs-lookup"><span data-stu-id="87594-197">Level</span></span><br /><br /> <span data-ttu-id="87594-198">Envío</span><span class="sxs-lookup"><span data-stu-id="87594-198">Send</span></span><br /><br /> <span data-ttu-id="87594-199">Reply</span><span class="sxs-lookup"><span data-stu-id="87594-199">Reply</span></span>|<span data-ttu-id="87594-200">Servicio</span><span class="sxs-lookup"><span data-stu-id="87594-200">Service</span></span><br /><br /> <span data-ttu-id="87594-201">Nivel</span><span class="sxs-lookup"><span data-stu-id="87594-201">Level</span></span><br /><br /> <span data-ttu-id="87594-202">Recepción</span><span class="sxs-lookup"><span data-stu-id="87594-202">Receive</span></span><br /><br /> <span data-ttu-id="87594-203">Reply</span><span class="sxs-lookup"><span data-stu-id="87594-203">Reply</span></span>|
|<span data-ttu-id="87594-204">Nivel de transporte</span><span class="sxs-lookup"><span data-stu-id="87594-204">Transport layer</span></span>|<span data-ttu-id="87594-205">Transporte</span><span class="sxs-lookup"><span data-stu-id="87594-205">Transport</span></span><br /><br /> <span data-ttu-id="87594-206">Envío</span><span class="sxs-lookup"><span data-stu-id="87594-206">Send</span></span>|<span data-ttu-id="87594-207">Transporte</span><span class="sxs-lookup"><span data-stu-id="87594-207">Transport</span></span><br /><br /> <span data-ttu-id="87594-208">Recepción</span><span class="sxs-lookup"><span data-stu-id="87594-208">Receive</span></span>|<span data-ttu-id="87594-209">Transporte</span><span class="sxs-lookup"><span data-stu-id="87594-209">Transport</span></span><br /><br /> <span data-ttu-id="87594-210">Envío</span><span class="sxs-lookup"><span data-stu-id="87594-210">Send</span></span>|<span data-ttu-id="87594-211">Transporte</span><span class="sxs-lookup"><span data-stu-id="87594-211">Transport</span></span><br /><br /> <span data-ttu-id="87594-212">Recepción</span><span class="sxs-lookup"><span data-stu-id="87594-212">Receive</span></span>|

<span data-ttu-id="87594-213">Para solicitud unidireccional</span><span class="sxs-lookup"><span data-stu-id="87594-213">For One-way Request</span></span>

||<span data-ttu-id="87594-214">Enviar solicitud</span><span class="sxs-lookup"><span data-stu-id="87594-214">Send Request</span></span>|<span data-ttu-id="87594-215">Recibir solicitud</span><span class="sxs-lookup"><span data-stu-id="87594-215">Receive Request</span></span>|
|-|------------------|---------------------|
|<span data-ttu-id="87594-216">Nivel de modelo de servicio</span><span class="sxs-lookup"><span data-stu-id="87594-216">Service Model layer</span></span>|<span data-ttu-id="87594-217">Servicio</span><span class="sxs-lookup"><span data-stu-id="87594-217">Service</span></span><br /><br /> <span data-ttu-id="87594-218">Nivel</span><span class="sxs-lookup"><span data-stu-id="87594-218">Level</span></span><br /><br /> <span data-ttu-id="87594-219">Envío</span><span class="sxs-lookup"><span data-stu-id="87594-219">Send</span></span><br /><br /> <span data-ttu-id="87594-220">Datagrama</span><span class="sxs-lookup"><span data-stu-id="87594-220">Datagram</span></span>|<span data-ttu-id="87594-221">Servicio</span><span class="sxs-lookup"><span data-stu-id="87594-221">Service</span></span><br /><br /> <span data-ttu-id="87594-222">Nivel</span><span class="sxs-lookup"><span data-stu-id="87594-222">Level</span></span><br /><br /> <span data-ttu-id="87594-223">Recepción</span><span class="sxs-lookup"><span data-stu-id="87594-223">Receive</span></span><br /><br /> <span data-ttu-id="87594-224">Datagrama</span><span class="sxs-lookup"><span data-stu-id="87594-224">Datagram</span></span>|
|<span data-ttu-id="87594-225">Nivel de transporte</span><span class="sxs-lookup"><span data-stu-id="87594-225">Transport layer</span></span>|<span data-ttu-id="87594-226">Transporte</span><span class="sxs-lookup"><span data-stu-id="87594-226">Transport</span></span><br /><br /> <span data-ttu-id="87594-227">Envío</span><span class="sxs-lookup"><span data-stu-id="87594-227">Send</span></span>|<span data-ttu-id="87594-228">Transporte</span><span class="sxs-lookup"><span data-stu-id="87594-228">Transport</span></span><br /><br /> <span data-ttu-id="87594-229">Recepción</span><span class="sxs-lookup"><span data-stu-id="87594-229">Receive</span></span>|

## <a name="message-filters"></a><span data-ttu-id="87594-230">Filtros de mensajes</span><span class="sxs-lookup"><span data-stu-id="87594-230">Message Filters</span></span>

<span data-ttu-id="87594-231">Los filtros de mensajes se definen en el elemento de configuración `messageLogging` de la sección de configuración `diagnostics`.</span><span class="sxs-lookup"><span data-stu-id="87594-231">Message filters are defined in the `messageLogging` configuration element of the `diagnostics` configuration section.</span></span> <span data-ttu-id="87594-232">Se aplican en los niveles de servicio y transporte.</span><span class="sxs-lookup"><span data-stu-id="87594-232">They are applied at the service and transport level.</span></span> <span data-ttu-id="87594-233">Cuando se definen uno o más filtros, sólo se registran los mensajes que coinciden por lo menos con uno de los filtros.</span><span class="sxs-lookup"><span data-stu-id="87594-233">When one or more filters are defined, only messages that match at least one of the filters are logged.</span></span> <span data-ttu-id="87594-234">Si no se define ningún filtro, todos los mensajes atraviesan.</span><span class="sxs-lookup"><span data-stu-id="87594-234">If no filter is defined, all messages pass through.</span></span>

<span data-ttu-id="87594-235">Los filtros admiten la sintaxis de XPath completa y se aplican en el orden que aparecen en el archivo de configuración.</span><span class="sxs-lookup"><span data-stu-id="87594-235">Filters support the full XPath syntax and are applied in the order they appear in the configuration file.</span></span> <span data-ttu-id="87594-236">Un filtro con sintaxis incorrecta provoca una excepción de configuración.</span><span class="sxs-lookup"><span data-stu-id="87594-236">A syntactically incorrect filter results in a configuration exception.</span></span>

<span data-ttu-id="87594-237">Los filtros también proporcionan una característica de seguridad mediante el atributo `nodeQuota`, que limita el número máximo de nodos en Xpath DOM que se puede examinar para coincidir con el filtro.</span><span class="sxs-lookup"><span data-stu-id="87594-237">Filters also provide a safety feature using the `nodeQuota` attribute, which limits the maximum number of nodes in the XPath DOM that can be examined to match the filter.</span></span>

<span data-ttu-id="87594-238">El siguiente ejemplo muestra cómo configurar un filtro que solo graba mensajes que tienen una sección de encabezado SOAP.</span><span class="sxs-lookup"><span data-stu-id="87594-238">The following example shows how to configure a filter that records only messages that have a SOAP header section.</span></span>

```xml
<messageLogging logEntireMessage="true"
    logMalformedMessages="true"
    logMessagesAtServiceLevel="true"
    logMessagesAtTransportLevel="true"
    maxMessagesToLog="420">
    <filters>
        <add nodeQuota="10" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
                 /soap:Envelope/soap:Header
        </add>
     </filters>
</messageLogging>
```

<span data-ttu-id="87594-239">Los filtros no se pueden aplicar al cuerpo de un mensaje.</span><span class="sxs-lookup"><span data-stu-id="87594-239">Filters cannot be applied to the body of a message.</span></span> <span data-ttu-id="87594-240">Los filtros que intentan manipular el cuerpo de un mensaje se quitan de la lista de filtros.</span><span class="sxs-lookup"><span data-stu-id="87594-240">Filters that attempt to manipulate the body of a message are removed from the list of filters.</span></span> <span data-ttu-id="87594-241">También se emite un evento que indica esto.</span><span class="sxs-lookup"><span data-stu-id="87594-241">An event is also emitted that indicates this.</span></span> <span data-ttu-id="87594-242">Por ejemplo, el filtro siguiente se quitaría de la tabla de filtro.</span><span class="sxs-lookup"><span data-stu-id="87594-242">For example, the following filter would be removed from the filter table.</span></span>

```xml
<add xmlns:s="http://schemas.xmlsoap.org/soap/envelope/">/s:Envelope/s:Body[contains(text(), "Hello")]</add>
```

## <a name="configuring-a-custom-listener"></a><span data-ttu-id="87594-243">Configuración de un agente de escucha personalizado</span><span class="sxs-lookup"><span data-stu-id="87594-243">Configuring a Custom Listener</span></span>

<span data-ttu-id="87594-244">También puede configurar un agente de escucha personalizado con opciones adicionales.</span><span class="sxs-lookup"><span data-stu-id="87594-244">You can also configure a custom listener with additional options.</span></span> <span data-ttu-id="87594-245">Un agente de escucha personalizado puede ser útil para filtrar los elementos PII específicos de la aplicación de los mensajes antes de registrar.</span><span class="sxs-lookup"><span data-stu-id="87594-245">A custom listener can be useful in filtering application-specific PII elements from messages before logging.</span></span> <span data-ttu-id="87594-246">El ejemplo siguiente muestra una configuración personalizada del agente de escucha.</span><span class="sxs-lookup"><span data-stu-id="87594-246">The following example demonstrates a custom listener configuration.</span></span>

```xml
<system.diagnostics>
   <sources>
     <source name="System.ServiceModel.MessageLogging">
           <listeners>
             <add name="MyListener"
                    type="YourCustomListener"
                    initializeData="c:\logs\messages.svclog"
                    maxDiskSpace="1000"/>
           </listeners>
     </source>
   </sources>
</system.diagnostics>
```

<span data-ttu-id="87594-247">Debería tener en cuenta que el atributo `type` debería estar establecido en un nombre de ensamblado certificado del tipo.</span><span class="sxs-lookup"><span data-stu-id="87594-247">You should be aware that the `type` attribute should be set to a qualified assembly name of the type.</span></span>

## <a name="see-also"></a><span data-ttu-id="87594-248">Vea también</span><span class="sxs-lookup"><span data-stu-id="87594-248">See also</span></span>

- [\<messageLogging>](../../configure-apps/file-schema/wcf/messagelogging.md)
- [<span data-ttu-id="87594-249">Registro de mensajes</span><span class="sxs-lookup"><span data-stu-id="87594-249">Message Logging</span></span>](message-logging.md)
- [<span data-ttu-id="87594-250">Configuración recomendada para el seguimiento y el registro de mensajes</span><span class="sxs-lookup"><span data-stu-id="87594-250">Recommended Settings for Tracing and Message Logging</span></span>](./tracing/recommended-settings-for-tracing-and-message-logging.md)
