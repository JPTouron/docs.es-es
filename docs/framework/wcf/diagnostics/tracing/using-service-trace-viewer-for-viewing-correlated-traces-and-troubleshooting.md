---
title: Uso del visor de seguimiento de servicios para ver seguimientos asociados y para la solución de problemas
ms.date: 03/30/2017
ms.assetid: 05d2321c-8acb-49d7-a6cd-8ef2220c6775
ms.openlocfilehash: e1cd1443e96e7195127cb95e7ef1b2c4d6d9c176
ms.sourcegitcommit: cdb295dd1db589ce5169ac9ff096f01fd0c2da9d
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/09/2020
ms.locfileid: "84587760"
---
# <a name="using-service-trace-viewer-for-viewing-correlated-traces-and-troubleshooting"></a><span data-ttu-id="9c09e-102">Uso del visor de seguimiento de servicios para ver seguimientos asociados y para la solución de problemas</span><span class="sxs-lookup"><span data-stu-id="9c09e-102">Using Service Trace Viewer for Viewing Correlated Traces and Troubleshooting</span></span>

<span data-ttu-id="9c09e-103">En este tema se describe el formato de datos de seguimiento, cómo verlo y enfoques sobre el uso de Service Trace Viewer para solucionar problemas de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="9c09e-103">This topic describes the format of trace data, how to view it, and approaches that use the Service Trace Viewer to troubleshoot your application.</span></span>

## <a name="using-the-service-trace-viewer-tool"></a><span data-ttu-id="9c09e-104">Utilizar la herramienta de visor de seguimiento de servicio</span><span class="sxs-lookup"><span data-stu-id="9c09e-104">Using the Service Trace Viewer Tool</span></span>

<span data-ttu-id="9c09e-105">La herramienta del visor de seguimiento del servicio Windows Communication Foundation (WCF) le ayuda a correlacionar los seguimientos de diagnóstico generados por los agentes de escucha de WCF para localizar la causa raíz de un error.</span><span class="sxs-lookup"><span data-stu-id="9c09e-105">The Windows Communication Foundation (WCF) Service Trace Viewer tool helps you correlate diagnostic traces produced by WCF listeners to locate the root cause of an error.</span></span> <span data-ttu-id="9c09e-106">La herramienta le permite ver, agrupar y filtrar fácilmente los seguimientos de forma que pueda diagnosticar, reparar y comprobar los problemas con los servicios WCF.</span><span class="sxs-lookup"><span data-stu-id="9c09e-106">The tool gives you a way to easily view, group, and filter traces so that you can diagnose, repair and verify issues with WCF services.</span></span> <span data-ttu-id="9c09e-107">Para obtener más información acerca del uso de esta herramienta, vea [Service Trace Viewer Tool (SvcTraceViewer. exe)](../../service-trace-viewer-tool-svctraceviewer-exe.md).</span><span class="sxs-lookup"><span data-stu-id="9c09e-107">For more information about using this tool, see [Service Trace Viewer Tool (SvcTraceViewer.exe)](../../service-trace-viewer-tool-svctraceviewer-exe.md).</span></span>

<span data-ttu-id="9c09e-108">Este tema contiene capturas de pantallas de los seguimientos generados mediante la ejecución del ejemplo de [seguimiento y registro de mensajes](../../samples/tracing-and-message-logging.md) , cuando se ve mediante la [herramienta de visor de seguimiento de servicio (SvcTraceViewer. exe)](../../service-trace-viewer-tool-svctraceviewer-exe.md).</span><span class="sxs-lookup"><span data-stu-id="9c09e-108">This topic contains screenshots of traces generated by running the [Tracing and Message Logging](../../samples/tracing-and-message-logging.md) sample, when viewed using the [Service Trace Viewer Tool (SvcTraceViewer.exe)](../../service-trace-viewer-tool-svctraceviewer-exe.md).</span></span> <span data-ttu-id="9c09e-109">En este tema se muestra cómo entender el contenido de los seguimientos, las actividades y su correlación y cómo analizar grandes cantidades de seguimientos al solucionar problemas.</span><span class="sxs-lookup"><span data-stu-id="9c09e-109">This topic demonstrates how to understand trace content, activities and their correlation, and how to analyze large numbers of traces when troubleshooting.</span></span>

## <a name="viewing-trace-content"></a><span data-ttu-id="9c09e-110">Ver el contenido del seguimiento</span><span class="sxs-lookup"><span data-stu-id="9c09e-110">Viewing Trace Content</span></span>

<span data-ttu-id="9c09e-111">Un evento de seguimiento contiene la siguiente información más significativa:</span><span class="sxs-lookup"><span data-stu-id="9c09e-111">A trace event contains the following most significant information:</span></span>

- <span data-ttu-id="9c09e-112">Nombre de actividad cuando se establece.</span><span class="sxs-lookup"><span data-stu-id="9c09e-112">Activity name when set.</span></span>

- <span data-ttu-id="9c09e-113">Hora de emisión.</span><span class="sxs-lookup"><span data-stu-id="9c09e-113">Emission time.</span></span>

- <span data-ttu-id="9c09e-114">Nivel de seguimiento.</span><span class="sxs-lookup"><span data-stu-id="9c09e-114">Trace level.</span></span>

- <span data-ttu-id="9c09e-115">Nombre de origen de seguimiento.</span><span class="sxs-lookup"><span data-stu-id="9c09e-115">Trace source name.</span></span>

- <span data-ttu-id="9c09e-116">Nombre de proceso.</span><span class="sxs-lookup"><span data-stu-id="9c09e-116">Process name.</span></span>

- <span data-ttu-id="9c09e-117">Identificador del subproceso.</span><span class="sxs-lookup"><span data-stu-id="9c09e-117">Thread id.</span></span>

- <span data-ttu-id="9c09e-118">Identificador de seguimiento único, que es una dirección URL que apunta a un destino en Microsoft Docs, desde el que puede obtener más información relacionada con el seguimiento.</span><span class="sxs-lookup"><span data-stu-id="9c09e-118">A unique trace identifier, which is a URL that points to a destination in Microsoft Docs, from which you can obtain more information related to the trace.</span></span>

 <span data-ttu-id="9c09e-119">Todos ellos se pueden ver en el panel superior derecho del visor de seguimiento de servicio o en la sección **información básica** de la vista con formato del panel inferior derecho al seleccionar un seguimiento.</span><span class="sxs-lookup"><span data-stu-id="9c09e-119">All of these can be seen in the upper right panel in the Service Trace Viewer, or in the **Basic Information** section in the formatted view of the lower-right panel when selecting a trace.</span></span>

> [!NOTE]
> <span data-ttu-id="9c09e-120">Si el cliente y el servicio están en el mismo equipo, los seguimientos estarán presentes para ambas aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="9c09e-120">If the client and the service are on the same machine, the traces for both applications will be present.</span></span> <span data-ttu-id="9c09e-121">Se pueden filtrar mediante la columna **nombre del proceso** .</span><span class="sxs-lookup"><span data-stu-id="9c09e-121">These can be filtered using the **Process Name** column.</span></span>

<span data-ttu-id="9c09e-122">Además, la vista con formato también proporciona una descripción del seguimiento e información detallada adicional cuando esté disponible.</span><span class="sxs-lookup"><span data-stu-id="9c09e-122">In addition, the formatted view also provides a description for the trace and additional detailed information when available.</span></span> <span data-ttu-id="9c09e-123">Lo último puede incluir el tipo y mensaje de excepción, pilas de llamadas, la acción del mensaje, campos desde/hasta y otras informaciones de la excepción.</span><span class="sxs-lookup"><span data-stu-id="9c09e-123">The latter can include exception type and message, call stacks, message action, from/to fields, and other exception information.</span></span>

<span data-ttu-id="9c09e-124">En la vista XML, entre las etiquetas xml útiles se encuentran las siguientes:</span><span class="sxs-lookup"><span data-stu-id="9c09e-124">In the XML view, useful xml tags include the following:</span></span>

- <span data-ttu-id="9c09e-125">`<SubType>`(nivel de seguimiento).</span><span class="sxs-lookup"><span data-stu-id="9c09e-125">`<SubType>` (trace level).</span></span>

- <span data-ttu-id="9c09e-126">`<TimeCreated>`.</span><span class="sxs-lookup"><span data-stu-id="9c09e-126">`<TimeCreated>`.</span></span>

- <span data-ttu-id="9c09e-127">`<Source>`(nombre del origen de seguimiento).</span><span class="sxs-lookup"><span data-stu-id="9c09e-127">`<Source>` (trace source name).</span></span>

- <span data-ttu-id="9c09e-128">`<Correlation>`(ID. de actividad establecido al emitir el seguimiento).</span><span class="sxs-lookup"><span data-stu-id="9c09e-128">`<Correlation>` (activity id set when emitting the trace).</span></span>

- <span data-ttu-id="9c09e-129">`<Execution>`(ID. de proceso y subproceso).</span><span class="sxs-lookup"><span data-stu-id="9c09e-129">`<Execution>` (process and thread id).</span></span>

- <span data-ttu-id="9c09e-130">`<Computer>`.</span><span class="sxs-lookup"><span data-stu-id="9c09e-130">`<Computer>`.</span></span>

- <span data-ttu-id="9c09e-131">`<ExtendedData>`, incluido `<Action>` , `<MessageID>` y el `<ActivityId>` conjunto en el encabezado del mensaje cuando se envía un mensaje.</span><span class="sxs-lookup"><span data-stu-id="9c09e-131">`<ExtendedData>`, including `<Action>`, `<MessageID>` and the `<ActivityId>` set in the message header when sending a message.</span></span>

<span data-ttu-id="9c09e-132">Si examina el seguimiento "Se envió un mensaje a través de un canal", puede ver el contenido siguiente.</span><span class="sxs-lookup"><span data-stu-id="9c09e-132">If you examine the "Sent a message over a channel" trace, you may see the following content.</span></span>

```xml
<E2ETraceEvent xmlns="http://schemas.microsoft.com/2004/06/E2ETraceEvent">
   <System xmlns="http://schemas.microsoft.com/2004/06/windows/eventlog/system">
      <EventID>262163</EventID>
      <Type>3</Type>
      <SubType Name="Information">0</SubType>
      <Level>8</Level>
      <TimeCreated SystemTime="2006-08-04T18:45:30.8491051Z" />
      <Source Name="System.ServiceModel" />
       <Correlation ActivityID="{27c6331d-8998-43aa-a382-03239013a6bd}"/>
       <Execution ProcessName="client" ProcessID="1808" ThreadID="1" />
       <Channel />
       <Computer>TEST1</Computer>
   </System>
   <ApplicationData>
       <TraceData>
          <DataItem>
             <TraceRecord xmlns="http://schemas.microsoft.com/2004/10/E2ETraceEvent/TraceRecord" Severity="Information">
                 <TraceIdentifier>http://msdn.microsoft.com/library/System.ServiceModel.Channels.MessageSent.aspx</TraceIdentifier>
                 <Description>Sent a message over a channel.</Description>
                 <AppDomain>client.exe</AppDomain>
                 <Source>System.ServiceModel.Channels.ClientFramingDuplexSessionChannel/35191196</Source>
                <ExtendedData xmlns="http://schemas.microsoft.com/2006/08/ServiceModel/MessageTransmitTraceRecord">

                  <MessageProperties>
                     <AllowOutputBatching>False</AllowOutputBatching>
                  </MessageProperties>
                  <MessageHeaders>
                     <Action d4p1:mustUnderstand="1" xmlns:d4p1="http://www.w3.org/2003/05/soap-envelope" xmlns="http://www.w3.org/2005/08/addressing">http://Microsoft.ServiceModel.Samples/ICalculator/Multiply</Action>
                     <MessageID xmlns="http://www.w3.org/2005/08/addressing">urn:uuid:7c6670d8-4c9c-496e-b6a0-2ceb6db35338</MessageID>
                     <ActivityId CorrelationId="b02e2189-0816-4387-980c-dd8e306440f5" xmlns="http://schemas.microsoft.com/2004/09/ServiceModel/Diagnostics">27c6331d-8998-43aa-a382-03239013a6bd</ActivityId>
                     <ReplyTo xmlns="http://www.w3.org/2005/08/addressing">
                        <Address>http://www.w3.org/2005/08/addressing/anonymous</Address>
                    </ReplyTo>
                    <To d4p1:mustUnderstand="1" xmlns:d4p1="http://www.w3.org/2003/05/soap-envelope" xmlns="http://www.w3.org/2005/08/addressing">net.tcp://localhost/servicemodelsamples/service</To>
                  </MessageHeaders>
                  <RemoteAddress>net.tcp://localhost/servicemodelsamples/service</RemoteAddress>
                </ExtendedData>
            </TraceRecord>
          </DataItem>
       </TraceData>
   </ApplicationData>
</E2ETraceEvent>
```

## <a name="servicemodel-e2e-tracing"></a><span data-ttu-id="9c09e-133">Seguimiento ServiceModel E2E</span><span class="sxs-lookup"><span data-stu-id="9c09e-133">ServiceModel E2E Tracing</span></span>

<span data-ttu-id="9c09e-134">Cuando el `System.ServiceModel` origen de seguimiento se establece con un `switchValue` distinto de OFF, `ActivityTracing` WCF crea actividades y transferencias para el procesamiento de WCF.</span><span class="sxs-lookup"><span data-stu-id="9c09e-134">When the `System.ServiceModel` trace source is set with a `switchValue` other than Off, and `ActivityTracing`, WCF creates activities and transfers for WCF processing.</span></span>

<span data-ttu-id="9c09e-135">Una actividad es una unidad lógica de procesamiento que agrupa todos los seguimientos relacionados con esa unidad de procesamiento.</span><span class="sxs-lookup"><span data-stu-id="9c09e-135">An activity is a logical unit of processing that groups all traces related to that processing unit.</span></span> <span data-ttu-id="9c09e-136">Por ejemplo, puede definir una actividad para cada solicitud.</span><span class="sxs-lookup"><span data-stu-id="9c09e-136">For example, you can define one activity for each request.</span></span> <span data-ttu-id="9c09e-137">Las transferencias crean una relación causal entre las actividades dentro de puntos de conexión.</span><span class="sxs-lookup"><span data-stu-id="9c09e-137">Transfers create a causal relationship between activities within endpoints.</span></span> <span data-ttu-id="9c09e-138">La propagación del identificador de actividad le permite relacionar actividades en los puntos de conexión.</span><span class="sxs-lookup"><span data-stu-id="9c09e-138">Propagating the activity ID enables you to relate activities across endpoints.</span></span> <span data-ttu-id="9c09e-139">Esto puede hacerse estableciendo la `propagateActivity` = `true` configuración en cada extremo.</span><span class="sxs-lookup"><span data-stu-id="9c09e-139">This can be done by setting `propagateActivity`=`true` in configuration at every endpoint.</span></span> <span data-ttu-id="9c09e-140">Las actividades, transferencias y la propagación le permiten realizar la correlación de errores.</span><span class="sxs-lookup"><span data-stu-id="9c09e-140">Activities, transfers, and propagation allow you to perform error correlation.</span></span> <span data-ttu-id="9c09e-141">De esta manera, puede encontrar más rápidamente la causa raíz de un error.</span><span class="sxs-lookup"><span data-stu-id="9c09e-141">In this way, you can find the root cause of an error more quickly.</span></span>

<span data-ttu-id="9c09e-142">En el cliente, se crea una actividad de WCF para cada llamada del modelo de objetos (por ejemplo, abrir ChannelFactory, agregar, dividir, etc.) Cada una de las llamadas de operación se procesa en una actividad "procesar acción".</span><span class="sxs-lookup"><span data-stu-id="9c09e-142">On the client, one WCF activity is created for each object model call (for example, Open ChannelFactory, Add, Divide, and so on.) Each of the operation calls is processed in a "Process Action" activity.</span></span>

<span data-ttu-id="9c09e-143">En la siguiente captura de pantalla, extraída del ejemplo de [registro de seguimiento y de mensajes](../../samples/tracing-and-message-logging.md) , el panel izquierdo muestra la lista de actividades creadas en el proceso del cliente, ordenadas por hora de creación.</span><span class="sxs-lookup"><span data-stu-id="9c09e-143">In the following screenshot, extracted from the [Tracing and Message Logging](../../samples/tracing-and-message-logging.md) sample the left panel displays the list of activities created in the client process, sorted by creation time.</span></span> <span data-ttu-id="9c09e-144">A continuación, se muestra una lista cronológica de actividades.</span><span class="sxs-lookup"><span data-stu-id="9c09e-144">The following is a chronological list of activities:</span></span>

- <span data-ttu-id="9c09e-145">Construyó el generador de canales (ClientBase).</span><span class="sxs-lookup"><span data-stu-id="9c09e-145">Constructed the channel factory (ClientBase).</span></span>

- <span data-ttu-id="9c09e-146">Abrió el generador de canales.</span><span class="sxs-lookup"><span data-stu-id="9c09e-146">Opened the channel factory.</span></span>

- <span data-ttu-id="9c09e-147">Procesó la acción Agregar.</span><span class="sxs-lookup"><span data-stu-id="9c09e-147">Processed the Add action.</span></span>

- <span data-ttu-id="9c09e-148">Configuró la sesión segura (esto OCURRIÓ en la primera solicitud) y procesó tres mensajes de respuesta de la infraestructura de seguridad: RST, RSTR, SCT (Mensaje de proceso 1, 2, 3).</span><span class="sxs-lookup"><span data-stu-id="9c09e-148">Set up the Secure Session (this OCCURRED on the first request) and processed three security infrastructure response messages: RST, RSTR, SCT (Process message 1, 2, 3).</span></span>

- <span data-ttu-id="9c09e-149">Procesó las solicitudes de sustracción, multiplicación y división.</span><span class="sxs-lookup"><span data-stu-id="9c09e-149">Processed the Subtract, Multiply, and Divide requests.</span></span>

- <span data-ttu-id="9c09e-150">Cerró el generador de canales y, debido a ello, cerró la sesión segura y procesó la anulación de la respuesta del mensaje de seguridad.</span><span class="sxs-lookup"><span data-stu-id="9c09e-150">Closed the channel factory, and doing so closed the Secure session and processed the security message response Cancel.</span></span>

 <span data-ttu-id="9c09e-151">Vemos los mensajes de la infraestructura de seguridad debido al wsHttpBinding.</span><span class="sxs-lookup"><span data-stu-id="9c09e-151">We see the security infrastructure messages because of the wsHttpBinding.</span></span>

> [!NOTE]
> <span data-ttu-id="9c09e-152">En WCF, se muestran los mensajes de respuesta que se procesan inicialmente en una actividad independiente (mensaje de proceso) antes de correlacionarlos con la actividad procesar acción correspondiente que incluye el mensaje de solicitud, a través de una transferencia.</span><span class="sxs-lookup"><span data-stu-id="9c09e-152">In WCF, we show response messages being processed initially in a separate activity (Process message) before we correlate them to the corresponding Process Action activity that includes the request message, through a transfer.</span></span> <span data-ttu-id="9c09e-153">Esto sucede para los mensajes de infraestructura y para las solicitudes asincrónicas y se debe al hecho de que debemos inspeccionar el mensaje, leer el encabezado activityId e identificar la actividad Procesar acción existente con ese identificador para correlacionarlo con él.</span><span class="sxs-lookup"><span data-stu-id="9c09e-153">This happens for infrastructure messages and asynchronous requests and is due to the fact that we must inspect the message, read the activityId header, and identify the existing Process Action activity with that id to correlate to it.</span></span> <span data-ttu-id="9c09e-154">Para solicitudes sincrónicas, bloqueamos la respuesta y, por lo tanto, conocemos con qué actividad Procesar acción se relaciona la respuesta.</span><span class="sxs-lookup"><span data-stu-id="9c09e-154">For synchronous requests, we are blocking for the response and hence know which Process action the response relates to.</span></span>

<span data-ttu-id="9c09e-155">En la imagen siguiente se muestran las actividades de cliente de WCF enumeradas por hora de creación (panel izquierdo) y sus actividades y seguimientos anidados (panel superior derecho):</span><span class="sxs-lookup"><span data-stu-id="9c09e-155">The following image shows WCF client activities listed by creation time (left panel) and their nested activities and traces (upper right panel):</span></span>

![Captura de pantalla que muestra las actividades del cliente WCF enumeradas por hora de creación.](./media/using-service-trace-viewer-for-viewing-correlated-traces-and-troubleshooting/wcf-client-activities-creation-time.gif)

<span data-ttu-id="9c09e-157">Cuando seleccionamos una actividad en el panel izquierdo, podemos ver actividades y seguimientos anidados en el panel derecho superior.</span><span class="sxs-lookup"><span data-stu-id="9c09e-157">When we select an activity in the left panel, we can see nested activities and traces on the upper right panel.</span></span> <span data-ttu-id="9c09e-158">Por consiguiente, ésta es una vista jerárquica reducida de la lista de actividades a la izquierda, en función de la actividad primaria seleccionada.</span><span class="sxs-lookup"><span data-stu-id="9c09e-158">Therefore, this is a reduced hierarchical view of the list of activities on the left, based on the selected parent activity.</span></span> <span data-ttu-id="9c09e-159">Debido a que la actividad Procesar acción Agregar es la primera solicitud realizada, esta actividad contiene la actividad Configurar sesión segura (transferir a, transferir desde) y seguimientos para el procesamiento real de la acción Agregar.</span><span class="sxs-lookup"><span data-stu-id="9c09e-159">Because the selected Process action Add is the first request made, this activity contains the Set Up Secure Session activity (transfer to, transfer back from), and traces for the actual processing of the Add action.</span></span>

<span data-ttu-id="9c09e-160">Si hacemos doble clic en el proceso acción agregar actividad en el panel izquierdo, podemos ver una representación gráfica de las actividades de WCF de cliente relacionadas con agregar.</span><span class="sxs-lookup"><span data-stu-id="9c09e-160">If we double click the Process action Add activity in the left panel, we can see a graphical representation of the client WCF activities related to Add.</span></span> <span data-ttu-id="9c09e-161">La primera actividad de la izquierda es la actividad raíz (0000), que es la actividad predeterminada.</span><span class="sxs-lookup"><span data-stu-id="9c09e-161">The first activity on the left is the root activity (0000), which is the default activity.</span></span> <span data-ttu-id="9c09e-162">La transferencia de WCF fuera de la actividad ambiente.</span><span class="sxs-lookup"><span data-stu-id="9c09e-162">WCF transfers out of the ambient activity.</span></span> <span data-ttu-id="9c09e-163">Si no se define, WCF transfiere fuera de 0000.</span><span class="sxs-lookup"><span data-stu-id="9c09e-163">If this is not defined, WCF transfers out of 0000.</span></span> <span data-ttu-id="9c09e-164">Aquí, la segunda actividad, Procesar acción Agregar, transfiere fuera de 0.</span><span class="sxs-lookup"><span data-stu-id="9c09e-164">Here, the second activity, Process Action Add, transfers out of 0.</span></span> <span data-ttu-id="9c09e-165">A continuación, vemos Configurar sesión segura.</span><span class="sxs-lookup"><span data-stu-id="9c09e-165">Then we see Setup Secure Session.</span></span>

<span data-ttu-id="9c09e-166">En la imagen siguiente se muestra una vista de gráfico de las actividades de cliente de WCF, concretamente, la actividad ambiente (aquí 0), la acción de proceso y la configuración de una sesión segura:</span><span class="sxs-lookup"><span data-stu-id="9c09e-166">The following image shows a graph view of WCF client activities, specifically Ambient Activity (here 0), Process action, and Set Up Secure Session:</span></span>

![Gráfico en el visor de seguimiento que muestra la actividad de ambiente y la acción de proceso.](./media/using-service-trace-viewer-for-viewing-correlated-traces-and-troubleshooting/wcf-activities-graph-ambient-process.gif)

<span data-ttu-id="9c09e-168">En el panel superior derecho, podemos ver todos los seguimientos relacionados con la actividad Procesar acción Agregar.</span><span class="sxs-lookup"><span data-stu-id="9c09e-168">On the upper right panel, we can see all traces related to the Process Action Add activity.</span></span> <span data-ttu-id="9c09e-169">Específicamente, hemos enviado el mensaje de solicitud ("Envía un mensaje sobre un canal") y hemos recibido la respuesta ("Se envió un mensaje a través de un canal") en la misma actividad.</span><span class="sxs-lookup"><span data-stu-id="9c09e-169">Specifically, we have sent the request message ("Sent a message over a channel") and received the response ("Received a message over a channel") in the same activity.</span></span> <span data-ttu-id="9c09e-170">Esto se muestra en el siguiente gráfico.</span><span class="sxs-lookup"><span data-stu-id="9c09e-170">This is shown in the following graph.</span></span> <span data-ttu-id="9c09e-171">Para ofrecer claridad, la actividad Configurar sesión segura se contrae en el gráfico.</span><span class="sxs-lookup"><span data-stu-id="9c09e-171">For clarity, the Set up Secure Session activity is collapsed in the graph.</span></span>

<span data-ttu-id="9c09e-172">En la imagen siguiente se muestra una lista de seguimientos para la actividad procesar acción.</span><span class="sxs-lookup"><span data-stu-id="9c09e-172">The following image shows a list of traces for the Process Action activity.</span></span> <span data-ttu-id="9c09e-173">Se envía la solicitud y se recibe la respuesta en la misma actividad.</span><span class="sxs-lookup"><span data-stu-id="9c09e-173">We send the request and receive the response in the same activity.</span></span>

![Captura de pantalla del visor de seguimiento que muestra una lista de seguimientos para la actividad procesar acción](./media/using-service-trace-viewer-for-viewing-correlated-traces-and-troubleshooting/process-action-traces.gif)

<span data-ttu-id="9c09e-175">En este caso, cargamos los seguimientos de cliente solo para mayor claridad, pero los seguimientos de servicio (mensaje de solicitud recibido y mensaje de respuesta enviado) aparecen en la misma actividad si también se cargan en la herramienta y se estableció en, `propagateActivity` `true.` se muestra en una ilustración posterior.</span><span class="sxs-lookup"><span data-stu-id="9c09e-175">Here, we load client traces only for clarity, but service traces (request message received and response message sent) appear in the same activity if they are also loaded in the tool and `propagateActivity` was set to `true.` This is shown in a later illustration.</span></span>

<span data-ttu-id="9c09e-176">En el servicio, el modelo de actividad se asigna a los conceptos de WCF de la siguiente manera:</span><span class="sxs-lookup"><span data-stu-id="9c09e-176">On the service, the activity model maps to the WCF concepts as follows:</span></span>

1. <span data-ttu-id="9c09e-177">Construimos y abrimos un ServiceHost (esto puede crear varias actividades relacionadas con el hospedaje, por ejemplo, en el caso de la seguridad).</span><span class="sxs-lookup"><span data-stu-id="9c09e-177">We construct and open a ServiceHost (this may create several host-related activities, for instance, in the case of security).</span></span>

2. <span data-ttu-id="9c09e-178">Creamos una actividad Escuchar a para cada agente de escucha en el ServiceHost (con transferencias dentro y fuera de Abrir ServiceHost).</span><span class="sxs-lookup"><span data-stu-id="9c09e-178">We create a Listen At activity for each listener in the ServiceHost (with transfers in and out of Open ServiceHost).</span></span>

3. <span data-ttu-id="9c09e-179">Cuando el agente de escucha detecta una solicitud de comunicación iniciada por el cliente, se transfiere a una actividad de "recepción de bytes", en la que se procesan todos los bytes enviados desde el cliente.</span><span class="sxs-lookup"><span data-stu-id="9c09e-179">When the listener detects a communication request initiated by the client, it transfers to a "Receive Bytes" activity, in which all bytes sent from the client are processed.</span></span> <span data-ttu-id="9c09e-180">En esta actividad, podemos ver los errores de conexión que han sucedido durante la interacción entre cliente y servicio.</span><span class="sxs-lookup"><span data-stu-id="9c09e-180">In this activity, we can see any connection errors that have happened during the client-service interaction.</span></span>

4. <span data-ttu-id="9c09e-181">Para cada conjunto de bytes que se recibe que corresponde a un mensaje, se procesan estos bytes en una actividad "procesar mensaje", donde se crea el objeto de mensaje de WCF.</span><span class="sxs-lookup"><span data-stu-id="9c09e-181">For each set of bytes that is received that corresponds to a message, we process these bytes in a "Process Message" activity, where we create the WCF Message object.</span></span> <span data-ttu-id="9c09e-182">En esta actividad, vemos errores relacionados con un sobre no válido o un mensaje con formato incorrecto.</span><span class="sxs-lookup"><span data-stu-id="9c09e-182">In this activity, we see errors related to a bad envelope or a malformed message.</span></span>

5. <span data-ttu-id="9c09e-183">Una vez que se ha formado el mensaje, transferimos a una actividad Procesar acción.</span><span class="sxs-lookup"><span data-stu-id="9c09e-183">Once the message is formed, we transfer to a Process Action activity.</span></span> <span data-ttu-id="9c09e-184">Si `propagateActivity` está establecida en `true` en el cliente y el servicio, esta actividad tiene el mismo identificador que la definida en el cliente, descrita previamente.</span><span class="sxs-lookup"><span data-stu-id="9c09e-184">If `propagateActivity` is set to `true` on both the client and service, this activity has the same id as the one defined in the client, and described previously.</span></span> <span data-ttu-id="9c09e-185">Desde esta fase, empezamos a beneficiarnos de la correlación directa entre los puntos de conexión, ya que todos los seguimientos emitidos en WCF que están relacionados con la solicitud están en esa misma actividad, incluido el procesamiento del mensaje de respuesta.</span><span class="sxs-lookup"><span data-stu-id="9c09e-185">From this stage we start to benefit from direct correlation across endpoints, because all traces emitted in WCF that are related to the request are in that same activity, including the response message processing.</span></span>

6. <span data-ttu-id="9c09e-186">En el caso de una acción fuera de proceso, se crea una actividad "ejecutar código de usuario" para aislar los seguimientos emitidos en el código de usuario de los emitidos en WCF.</span><span class="sxs-lookup"><span data-stu-id="9c09e-186">For out-of-process action, we create an "Execute user code" activity to isolate traces emitted in user code from the ones emitted in WCF.</span></span> <span data-ttu-id="9c09e-187">En el ejemplo anterior, el seguimiento "el servicio envía una respuesta de adición" se emite en la actividad "ejecutar código de usuario", no en la actividad propagada por el cliente, si procede.</span><span class="sxs-lookup"><span data-stu-id="9c09e-187">In the preceding example, the "Service sends Add response" trace is emitted in the "Execute User code" activity not in the activity propagated by the client, if applicable.</span></span>

<span data-ttu-id="9c09e-188">En la siguiente ilustración, la primera actividad en la izquierda es la actividad raíz (0000), que es la actividad predeterminada.</span><span class="sxs-lookup"><span data-stu-id="9c09e-188">In the illustration that follows, the first activity on the left is the root activity (0000), which is the default activity.</span></span> <span data-ttu-id="9c09e-189">Las tres actividades siguientes sirven para abrir el ServiceHost.</span><span class="sxs-lookup"><span data-stu-id="9c09e-189">The next three activities are to open the ServiceHost.</span></span> <span data-ttu-id="9c09e-190">La actividad en la columna 5 es el agente de escuchas y las actividades restantes (6 a 8) describen el procesamiento de WCF de un mensaje, desde el procesamiento de bytes hasta la activación del código de usuario.</span><span class="sxs-lookup"><span data-stu-id="9c09e-190">The activity in column 5 is the listener, and the remaining activities (6 to 8) describe the WCF processing of a message, from bytes processing to user code activation.</span></span>

<span data-ttu-id="9c09e-191">En la imagen siguiente se muestra una vista gráfica de las actividades de servicio WCF:</span><span class="sxs-lookup"><span data-stu-id="9c09e-191">The following image shows a graph view of WCF service activities:</span></span>

![Captura de pantalla del visor de seguimiento que muestra una lista de actividades de servicio WCF](./media/using-service-trace-viewer-for-viewing-correlated-traces-and-troubleshooting/wcf-service-activities.gif)

<span data-ttu-id="9c09e-193">La siguiente captura de pantalla muestra las actividades de cliente y servicio, y resalta la actividad Procesar acción Agregar en los procesos (naranja).</span><span class="sxs-lookup"><span data-stu-id="9c09e-193">The following screenshot shows the activities for both the client and service, and highlights the Process Action Add activity across processes (orange).</span></span> <span data-ttu-id="9c09e-194">Las flechas relacionan los mensajes de solicitud y respuesta enviados y recibidos por el cliente y el servicio.</span><span class="sxs-lookup"><span data-stu-id="9c09e-194">Arrows relate the request and response messages sent and received by the client and service.</span></span> <span data-ttu-id="9c09e-195">Los seguimientos de la actividad Procesar acción se separan en los procesos del gráfico, pero se muestran como parte de la misma actividad en el panel superior derecho.</span><span class="sxs-lookup"><span data-stu-id="9c09e-195">The traces of Process Action are separated across processes in the graph, but shown as part of the same activity in the upper-right panel.</span></span> <span data-ttu-id="9c09e-196">En este panel, podemos ver los seguimientos de cliente de los mensajes enviados seguidos por seguimientos de servicio de los mensajes recibidos y procesados.</span><span class="sxs-lookup"><span data-stu-id="9c09e-196">In this panel, we can see client traces for sent messages followed by service traces for received and processed messages.</span></span>

<span data-ttu-id="9c09e-197">En las imágenes siguientes se muestra una vista gráfica de las actividades de cliente y servicio de WCF</span><span class="sxs-lookup"><span data-stu-id="9c09e-197">The following images shows a graph view of both WCF client and service activities</span></span>

![Gráfico del visor de seguimiento que muestra las actividades de cliente y servicio de WCF.](./media/using-service-trace-viewer-for-viewing-correlated-traces-and-troubleshooting/wcf-client-service-activities.gif)

<span data-ttu-id="9c09e-199">En el siguiente escenario de error, se relacionan los seguimientos de errores y advertencias en el servicio y el cliente.</span><span class="sxs-lookup"><span data-stu-id="9c09e-199">In the following error scenario, error and warning traces at the service and client are related.</span></span> <span data-ttu-id="9c09e-200">Primero se inicia una excepción mediante código de usuario en el servicio (actividad verde situada más a la derecha que incluye un seguimiento de advertencia para la excepción "El servicio no puede procesar esta solicitud mediante código de usuario").</span><span class="sxs-lookup"><span data-stu-id="9c09e-200">An exception is first thrown in user code on the service (right-most green activity that includes a warning trace for the exception "The service cannot process this request in user code.").</span></span> <span data-ttu-id="9c09e-201">Cuando se envía la respuesta al cliente, un seguimiento de advertencia se vuelve a emitir para denotar el mensaje de error (actividad fucsia a la izquierda).</span><span class="sxs-lookup"><span data-stu-id="9c09e-201">When the response is sent to the client, a warning trace is again emitted to denote the fault message (left pink activity).</span></span> <span data-ttu-id="9c09e-202">El cliente cierra a continuación su cliente WCF (actividad amarilla en el lado inferior izquierdo), que anula la conexión al servicio.</span><span class="sxs-lookup"><span data-stu-id="9c09e-202">The client then closes its WCF client (yellow activity on the lower-left side), which aborts the connection to the service.</span></span> <span data-ttu-id="9c09e-203">El servicio genera un error (la actividad fucsia más larga en el lado derecho).</span><span class="sxs-lookup"><span data-stu-id="9c09e-203">The service throws an error (longest pink activity on the right).</span></span>

<span data-ttu-id="9c09e-204">![Utilización del visor de seguimiento](media/wcfc-e2etrace9s.gif "wcfc_e2etrace9s")</span><span class="sxs-lookup"><span data-stu-id="9c09e-204">![Using the Trace Viewer](media/wcfc-e2etrace9s.gif "wcfc_e2etrace9s")</span></span>

<span data-ttu-id="9c09e-205">Correlación de errores en el servicio y cliente</span><span class="sxs-lookup"><span data-stu-id="9c09e-205">Error correlation across the service and client</span></span>

<span data-ttu-id="9c09e-206">El ejemplo utilizado para generar estos seguimientos es una serie de solicitudes sincrónicas utilizando el wsHttpBinding.</span><span class="sxs-lookup"><span data-stu-id="9c09e-206">The sample used to generate these traces is a series of synchronous requests using the wsHttpBinding.</span></span> <span data-ttu-id="9c09e-207">Hay desviaciones de este gráfico para escenarios sin seguridad o con solicitudes asincrónicas, donde la actividad Procesar acción abarca las operaciones de comienzo y final que forman la llamada asincrónica, y muestra las transferencias a una actividad de devolución de llamada.</span><span class="sxs-lookup"><span data-stu-id="9c09e-207">There are deviations from this graph for scenarios without security, or with asynchronous requests, where the Process Action activity encompasses the begin and end operations that constitute the asynchronous call, and shows transfers to a callback activity.</span></span> <span data-ttu-id="9c09e-208">Para obtener más información acerca de escenarios adicionales, consulte [escenarios de seguimiento de un extremo a otro](end-to-end-tracing-scenarios.md).</span><span class="sxs-lookup"><span data-stu-id="9c09e-208">For more information about additional scenarios, see [End-To-End Tracing Scenarios](end-to-end-tracing-scenarios.md).</span></span>

## <a name="troubleshooting-using-the-service-trace-viewer"></a><span data-ttu-id="9c09e-209">Solución de problemas mediante Service Trace Viewer</span><span class="sxs-lookup"><span data-stu-id="9c09e-209">Troubleshooting Using the Service Trace Viewer</span></span>

<span data-ttu-id="9c09e-210">Al cargar archivos de seguimiento en la herramienta Service Trace Viewer, puede seleccionar cualquier actividad roja o amarilla en el panel izquierdo para llegar hasta la causa de un problema de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="9c09e-210">When you load trace files in the Service Trace Viewer Tool, you can select any red or yellow activity on the left panel to track down the cause of a problem in your application.</span></span> <span data-ttu-id="9c09e-211">La actividad 000 tiene, por lo general, excepciones no controladas que llegan hasta el usuario.</span><span class="sxs-lookup"><span data-stu-id="9c09e-211">The 000 activity typically has unhandled exceptions that bubble up to the user.</span></span>

<span data-ttu-id="9c09e-212">En la imagen siguiente se muestra cómo seleccionar una actividad roja o amarilla para localizar la raíz de un problema.</span><span class="sxs-lookup"><span data-stu-id="9c09e-212">The following image shows how to select a red or yellow activity to locate the root of a problem.</span></span>
<span data-ttu-id="9c09e-213">![Captura de pantalla de actividades rojas o amarillas para localizar la raíz de un problema.](./media/using-service-trace-viewer-for-viewing-correlated-traces-and-troubleshooting/service-trace-viewer.gif)</span><span class="sxs-lookup"><span data-stu-id="9c09e-213">![Screenshot of red or yellow activities for locating the root of a problem.](./media/using-service-trace-viewer-for-viewing-correlated-traces-and-troubleshooting/service-trace-viewer.gif)</span></span>

<span data-ttu-id="9c09e-214">En el panel superior derecho puede examinar los seguimientos de la actividad que seleccionó en la izquierda.</span><span class="sxs-lookup"><span data-stu-id="9c09e-214">On the upper right panel, you can examine traces for the activity you selected on the left.</span></span> <span data-ttu-id="9c09e-215">Puede examinar, a continuación, los seguimientos rojos o amarillos en ese panel y ver cómo se correlacionan.</span><span class="sxs-lookup"><span data-stu-id="9c09e-215">You can then examine red or yellow traces in that panel and see how they are correlated.</span></span> <span data-ttu-id="9c09e-216">En el gráfico anterior, vemos los seguimientos de advertencias de cliente y servicio en la misma actividad Procesar acción.</span><span class="sxs-lookup"><span data-stu-id="9c09e-216">In the preceding graph, we see warning traces both for the client and service in the same Process Action activity.</span></span>

<span data-ttu-id="9c09e-217">Si estos seguimientos no le ofrecen la causa raíz del error, puede utilizar el gráfico haciendo doble clic en la actividad seleccionada en el panel izquierdo (aquí Procesar acción).</span><span class="sxs-lookup"><span data-stu-id="9c09e-217">If these traces do not provide you with the root cause of the error, you can utilize the graph by double-clicking the selected activity on the left panel (here Process action).</span></span> <span data-ttu-id="9c09e-218">A continuación, se muestra el gráfico con actividades relacionadas.</span><span class="sxs-lookup"><span data-stu-id="9c09e-218">The graph with related activities is then displayed.</span></span> <span data-ttu-id="9c09e-219">Después, puede expandir las actividades relacionadas (haciendo clic en los signos "+") para buscar el primer seguimiento emitido en rojo o amarillo en una actividad relacionada.</span><span class="sxs-lookup"><span data-stu-id="9c09e-219">You can then expand related activities (by clicking the "+" signs) to find the first emitted trace in red or yellow in a related activity.</span></span> <span data-ttu-id="9c09e-220">Siga expandiendo las actividades que sucedieron justo antes del seguimiento rojo o amarillo en cuestión, siguiendo las transferencias a actividades relacionadas o flujos de mensajes en los extremos, hasta que llegue a la causa principal del problema.</span><span class="sxs-lookup"><span data-stu-id="9c09e-220">Keep expanding the activities that happened just before the red or yellow trace of interest, following transfers to related activities or message flows across endpoints, until you track the root cause of the problem.</span></span>

<span data-ttu-id="9c09e-221">![Utilización del visor de seguimiento](media/wcfc-e2etrace9s.gif "wcfc_e2etrace9s")</span><span class="sxs-lookup"><span data-stu-id="9c09e-221">![Using the Trace Viewer](media/wcfc-e2etrace9s.gif "wcfc_e2etrace9s")</span></span>

<span data-ttu-id="9c09e-222">Expansión de actividades para llegar hasta la causa principal de un problema</span><span class="sxs-lookup"><span data-stu-id="9c09e-222">Expanding activities to track the root cause of a problem</span></span>

<span data-ttu-id="9c09e-223">Si `ActivityTracing` de ServiceModel está desactivado, pero el seguimiento de ServiceModel está activado, puede ver seguimientos de ServiceModel emitidos en la actividad 0000.</span><span class="sxs-lookup"><span data-stu-id="9c09e-223">If ServiceModel `ActivityTracing` is off but ServiceModel tracing is on, you can see ServiceModel traces emitted in the 0000 activity.</span></span> <span data-ttu-id="9c09e-224">Sin embargo, en este caso es más difícil comprender la correlación de estos seguimientos.</span><span class="sxs-lookup"><span data-stu-id="9c09e-224">However, this requires more effort to understand the correlation of these traces.</span></span>

<span data-ttu-id="9c09e-225">Si el registro de mensajes está habilitado, puede utilizar la pestaña Mensaje para ver a qué mensaje ha afectado el error.</span><span class="sxs-lookup"><span data-stu-id="9c09e-225">If Message Logging is enabled, you can use the Message Tab to see which message is impacted by the error.</span></span> <span data-ttu-id="9c09e-226">Si hace doble clic en un mensaje en rojo o amarillo, puede ver la vista gráfica de las actividades relacionadas.</span><span class="sxs-lookup"><span data-stu-id="9c09e-226">By double-clicking a message in red or yellow, you can see the graph view of the related activities.</span></span> <span data-ttu-id="9c09e-227">Estas actividades son las que están más estrechamente relacionadas con la solicitud en la que se produjo un error.</span><span class="sxs-lookup"><span data-stu-id="9c09e-227">These activities are the ones most closely related to the request where an error happened.</span></span>

![Captura de pantalla del visor de seguimiento con el registro de mensajes habilitado.](./media/using-service-trace-viewer-for-viewing-correlated-traces-and-troubleshooting/message-logging-enabled.gif)

<span data-ttu-id="9c09e-229">Para iniciar la solución de problemas, también puede elegir un seguimiento de mensajes rojo o amarillo y hacer doble clic en él para realizar el seguimiento de la causa principal.</span><span class="sxs-lookup"><span data-stu-id="9c09e-229">To start troubleshooting, you can also pick a red or yellow message trace and double click it to track the root cause.</span></span>

## <a name="see-also"></a><span data-ttu-id="9c09e-230">Vea también</span><span class="sxs-lookup"><span data-stu-id="9c09e-230">See also</span></span>

- [<span data-ttu-id="9c09e-231">Escenarios de seguimiento de traza de un extremo a otro</span><span class="sxs-lookup"><span data-stu-id="9c09e-231">End-To-End Tracing Scenarios</span></span>](end-to-end-tracing-scenarios.md)
- [<span data-ttu-id="9c09e-232">Herramienta del visor de seguimiento de servicio (SvcTraceViewer.exe)</span><span class="sxs-lookup"><span data-stu-id="9c09e-232">Service Trace Viewer Tool (SvcTraceViewer.exe)</span></span>](../../service-trace-viewer-tool-svctraceviewer-exe.md)
- [<span data-ttu-id="9c09e-233">Seguimiento</span><span class="sxs-lookup"><span data-stu-id="9c09e-233">Tracing</span></span>](index.md)
