---
title: Configurar parámetros y tipos de datos de parámetros
description: Los objetos de comando usan parámetros para pasar valores a instrucciones SQL o procedimientos almacenados, lo que proporciona comprobación de tipos y validación en ADO.NET.
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: 537d8a2c-d40b-4000-83eb-bc1fcc93f707
ms.openlocfilehash: a426eeae785274b0484a84a2fae2dce4572fb4c4
ms.sourcegitcommit: 33deec3e814238fb18a49b2a7e89278e27888291
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/02/2020
ms.locfileid: "84287121"
---
# <a name="configuring-parameters-and-parameter-data-types"></a><span data-ttu-id="290fe-103">Configurar parámetros y tipos de datos de parámetros</span><span class="sxs-lookup"><span data-stu-id="290fe-103">Configuring parameters and parameter data types</span></span>

<span data-ttu-id="290fe-104">Los objetos de comando usan parámetros para pasar valores a instrucciones SQL o procedimientos almacenados que permiten realizar operaciones de comprobación de tipos y validación.</span><span class="sxs-lookup"><span data-stu-id="290fe-104">Command objects use parameters to pass values to SQL statements or stored procedures, providing type checking and validation.</span></span> <span data-ttu-id="290fe-105">A diferencia del texto de comando, la entrada de parámetros se trata como un valor literal, y no como código ejecutable.</span><span class="sxs-lookup"><span data-stu-id="290fe-105">Unlike command text, parameter input is treated as a literal value, not as executable code.</span></span> <span data-ttu-id="290fe-106">De esta forma, se protege contra ataques por "inyección de código SQL", en los que un atacante inserta un comando que pone en peligro la seguridad del servidor en una instrucción SQL.</span><span class="sxs-lookup"><span data-stu-id="290fe-106">This helps guard against "SQL injection" attacks, in which an attacker inserts a command that compromises security on the server into an SQL statement.</span></span>

<span data-ttu-id="290fe-107">Los comandos parametrizados también pueden mejorar el rendimiento de ejecución de la consulta, ya que ayudan al servidor de bases de datos a que haga coincidir precisamente el comando entrante con un plan de consulta almacenado en caché adecuado.</span><span class="sxs-lookup"><span data-stu-id="290fe-107">Parameterized commands can also improve query execution performance, because they help the database server accurately match the incoming command with a proper cached query plan.</span></span> <span data-ttu-id="290fe-108">Para obtener más información, consulte [almacenamiento en caché y reutilización del plan de ejecución](/sql/relational-databases/query-processing-architecture-guide#execution-plan-caching-and-reuse) y [parámetros y reutilización del plan de ejecución](/sql/relational-databases/query-processing-architecture-guide#PlanReuse).</span><span class="sxs-lookup"><span data-stu-id="290fe-108">For more information, see [Execution Plan Caching and Reuse](/sql/relational-databases/query-processing-architecture-guide#execution-plan-caching-and-reuse) and [Parameters and Execution Plan Reuse](/sql/relational-databases/query-processing-architecture-guide#PlanReuse).</span></span> <span data-ttu-id="290fe-109">Además de las ventajas en la seguridad y el rendimiento, los comandos con parámetros proporcionan un método práctico para organizar los valores que se pasan a un origen de datos.</span><span class="sxs-lookup"><span data-stu-id="290fe-109">In addition to the security and performance benefits, parameterized commands provide a convenient method for organizing values passed to a data source.</span></span>

<span data-ttu-id="290fe-110">Para crear un objeto <xref:System.Data.Common.DbParameter> , se puede usar su constructor o bien se puede agregar a <xref:System.Data.Common.DbCommand.DbParameterCollection%2A> mediante una llamada al método `Add` de la colección <xref:System.Data.Common.DbParameterCollection> .</span><span class="sxs-lookup"><span data-stu-id="290fe-110">A <xref:System.Data.Common.DbParameter> object can be created by using its constructor, or by adding it to the <xref:System.Data.Common.DbCommand.DbParameterCollection%2A> by calling the `Add` method of the <xref:System.Data.Common.DbParameterCollection> collection.</span></span> <span data-ttu-id="290fe-111">El método `Add` acepta como entrada argumentos del constructor o cualquier objeto de parámetro ya existente, en función del proveedor de datos.</span><span class="sxs-lookup"><span data-stu-id="290fe-111">The `Add` method will take as input either constructor arguments or an existing parameter object, depending on the data provider.</span></span>

## <a name="supplying-the-parameterdirection-property"></a><span data-ttu-id="290fe-112">Proporcionar la propiedad ParameterDirection</span><span class="sxs-lookup"><span data-stu-id="290fe-112">Supplying the ParameterDirection property</span></span>

<span data-ttu-id="290fe-113">Cuando se agregan parámetros distintos de los parámetros de entrada, se debe proporcionar una propiedad <xref:System.Data.ParameterDirection> .</span><span class="sxs-lookup"><span data-stu-id="290fe-113">When adding parameters, you must supply a <xref:System.Data.ParameterDirection> property for parameters other than input parameters.</span></span> <span data-ttu-id="290fe-114">En la tabla siguiente se muestran los valores de `ParameterDirection` que se pueden usar con la enumeración <xref:System.Data.ParameterDirection> .</span><span class="sxs-lookup"><span data-stu-id="290fe-114">The following table shows the `ParameterDirection` values that you can use with the <xref:System.Data.ParameterDirection> enumeration.</span></span>

|<span data-ttu-id="290fe-115">Nombre del miembro</span><span class="sxs-lookup"><span data-stu-id="290fe-115">Member name</span></span>|<span data-ttu-id="290fe-116">Descripción</span><span class="sxs-lookup"><span data-stu-id="290fe-116">Description</span></span>|
|-----------------|-----------------|
|<xref:System.Data.ParameterDirection.Input>|<span data-ttu-id="290fe-117">Se trata de un parámetro de entrada.</span><span class="sxs-lookup"><span data-stu-id="290fe-117">The parameter is an input parameter.</span></span> <span data-ttu-id="290fe-118">Este es el valor predeterminado.</span><span class="sxs-lookup"><span data-stu-id="290fe-118">This is the default.</span></span>|
|<xref:System.Data.ParameterDirection.InputOutput>|<span data-ttu-id="290fe-119">El parámetro se puede comportar tanto de entrada como de salida.</span><span class="sxs-lookup"><span data-stu-id="290fe-119">The parameter can perform both input and output.</span></span>|
|<xref:System.Data.ParameterDirection.Output>|<span data-ttu-id="290fe-120">Se trata de un parámetro de salida.</span><span class="sxs-lookup"><span data-stu-id="290fe-120">The parameter is an output parameter.</span></span>|
|<xref:System.Data.ParameterDirection.ReturnValue>|<span data-ttu-id="290fe-121">El parámetro representa un valor devuelto de una operación como, por ejemplo, un procedimiento almacenado, una función integrada o una función definida por el usuario.</span><span class="sxs-lookup"><span data-stu-id="290fe-121">The parameter represents a return value from an operation such as a stored procedure, built-in function, or user-defined function.</span></span>|

## <a name="working-with-parameter-placeholders"></a><span data-ttu-id="290fe-122">Trabajar con marcadores de posición de parámetros</span><span class="sxs-lookup"><span data-stu-id="290fe-122">Working with parameter placeholders</span></span>

<span data-ttu-id="290fe-123">La sintaxis de los marcadores de posición de parámetros depende del origen de datos.</span><span class="sxs-lookup"><span data-stu-id="290fe-123">The syntax for parameter placeholders depends on the data source.</span></span> <span data-ttu-id="290fe-124">Los proveedores de datos .NET Framework administran la asignación de nombres y la especificación de parámetros y marcadores de posición de parámetros de diferente forma.</span><span class="sxs-lookup"><span data-stu-id="290fe-124">The .NET Framework data providers handle naming and specifying parameters and parameter placeholders differently.</span></span> <span data-ttu-id="290fe-125">Esta sintaxis se personaliza para un origen de datos específico, como se describe en la tabla siguiente.</span><span class="sxs-lookup"><span data-stu-id="290fe-125">This syntax is customized to a specific data source, as described in the following table.</span></span>

|<span data-ttu-id="290fe-126">Proveedor de datos</span><span class="sxs-lookup"><span data-stu-id="290fe-126">Data provider</span></span>|<span data-ttu-id="290fe-127">Sintaxis de nomenclatura de parámetros</span><span class="sxs-lookup"><span data-stu-id="290fe-127">Parameter naming syntax</span></span>|
|-------------------|-----------------------------|
|<xref:System.Data.SqlClient>|<span data-ttu-id="290fe-128">Usa parámetros con nombre, con el formato `@`*nombreDeParámetro*.</span><span class="sxs-lookup"><span data-stu-id="290fe-128">Uses named parameters in the format `@`*parametername*.</span></span>|
|<xref:System.Data.OleDb>|<span data-ttu-id="290fe-129">Usa marcadores de parámetro de posición, indicados por un signo de interrogación (`?`).</span><span class="sxs-lookup"><span data-stu-id="290fe-129">Uses positional parameter markers indicated by a question mark (`?`).</span></span>|
|<xref:System.Data.Odbc>|<span data-ttu-id="290fe-130">Usa marcadores de parámetro de posición, indicados por un signo de interrogación (`?`).</span><span class="sxs-lookup"><span data-stu-id="290fe-130">Uses positional parameter markers indicated by a question mark (`?`).</span></span>|
|<xref:System.Data.OracleClient>|<span data-ttu-id="290fe-131">Usa parámetros con nombre, con el formato `:`*nombreDeParámetro* (o *nombreDeParámetro*).</span><span class="sxs-lookup"><span data-stu-id="290fe-131">Uses named parameters in the format `:`*parmname* (or *parmname*).</span></span>|

## <a name="specifying-parameter-data-types"></a><span data-ttu-id="290fe-132">Especificar tipos de datos de parámetros</span><span class="sxs-lookup"><span data-stu-id="290fe-132">Specifying parameter data types</span></span>

<span data-ttu-id="290fe-133">El tipo de datos de un parámetro es específico del proveedor de datos .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="290fe-133">The data type of a parameter is specific to the .NET Framework data provider.</span></span> <span data-ttu-id="290fe-134">Al especificar el tipo se convierte el valor de `Parameter` en el tipo de proveedor de datos .NET Framework antes de pasar el valor al origen de datos.</span><span class="sxs-lookup"><span data-stu-id="290fe-134">Specifying the type converts the value of the `Parameter` to the .NET Framework data provider type before passing the value to the data source.</span></span> <span data-ttu-id="290fe-135">Si lo desea, puede especificar el tipo de un objeto `Parameter` de forma genérica estableciendo la propiedad `DbType` del objeto `Parameter` en un <xref:System.Data.DbType>determinado.</span><span class="sxs-lookup"><span data-stu-id="290fe-135">You may also specify the type of a `Parameter` in a generic manner by setting the `DbType` property of the `Parameter` object to a particular <xref:System.Data.DbType>.</span></span>

<span data-ttu-id="290fe-136">El tipo de proveedor de datos .NET Framework de un `Parameter` objeto se deduce del tipo de .NET Framework del `Value` objeto o del objeto `Parameter` `DbType` `Parameter` .</span><span class="sxs-lookup"><span data-stu-id="290fe-136">The .NET Framework data provider type of a `Parameter` object is inferred from the .NET Framework type of the `Value` of the `Parameter` object, or from the `DbType` of the `Parameter` object.</span></span> <span data-ttu-id="290fe-137">En la siguiente tabla se muestra el tipo deducido de `Parameter` en función del objeto que se ha pasado como valor `Parameter` o del `DbType`especificado.</span><span class="sxs-lookup"><span data-stu-id="290fe-137">The following table shows the inferred `Parameter` type based on the object passed as the `Parameter` value or the specified `DbType`.</span></span>

|<span data-ttu-id="290fe-138">Tipo de .NET Framework</span><span class="sxs-lookup"><span data-stu-id="290fe-138">.NET Framework type</span></span>|<span data-ttu-id="290fe-139">DbType</span><span class="sxs-lookup"><span data-stu-id="290fe-139">DbType</span></span>|<span data-ttu-id="290fe-140">SqlDbType</span><span class="sxs-lookup"><span data-stu-id="290fe-140">SqlDbType</span></span>|<span data-ttu-id="290fe-141">OleDbType</span><span class="sxs-lookup"><span data-stu-id="290fe-141">OleDbType</span></span>|<span data-ttu-id="290fe-142">OdbcType</span><span class="sxs-lookup"><span data-stu-id="290fe-142">OdbcType</span></span>|<span data-ttu-id="290fe-143">OracleType</span><span class="sxs-lookup"><span data-stu-id="290fe-143">OracleType</span></span>|
|-------------------------|------------|---------------|---------------|--------------|----------------|
|<xref:System.Boolean>|<span data-ttu-id="290fe-144">Boolean</span><span class="sxs-lookup"><span data-stu-id="290fe-144">Boolean</span></span>|<span data-ttu-id="290fe-145">bit</span><span class="sxs-lookup"><span data-stu-id="290fe-145">Bit</span></span>|<span data-ttu-id="290fe-146">Boolean</span><span class="sxs-lookup"><span data-stu-id="290fe-146">Boolean</span></span>|<span data-ttu-id="290fe-147">bit</span><span class="sxs-lookup"><span data-stu-id="290fe-147">Bit</span></span>|<span data-ttu-id="290fe-148">Byte</span><span class="sxs-lookup"><span data-stu-id="290fe-148">Byte</span></span>|
|<xref:System.Byte>|<span data-ttu-id="290fe-149">Byte</span><span class="sxs-lookup"><span data-stu-id="290fe-149">Byte</span></span>|<span data-ttu-id="290fe-150">TinyInt</span><span class="sxs-lookup"><span data-stu-id="290fe-150">TinyInt</span></span>|<span data-ttu-id="290fe-151">UnsignedTinyInt</span><span class="sxs-lookup"><span data-stu-id="290fe-151">UnsignedTinyInt</span></span>|<span data-ttu-id="290fe-152">TinyInt</span><span class="sxs-lookup"><span data-stu-id="290fe-152">TinyInt</span></span>|<span data-ttu-id="290fe-153">Byte</span><span class="sxs-lookup"><span data-stu-id="290fe-153">Byte</span></span>|
|<span data-ttu-id="290fe-154">byte[]</span><span class="sxs-lookup"><span data-stu-id="290fe-154">byte[]</span></span>|<span data-ttu-id="290fe-155">Binario</span><span class="sxs-lookup"><span data-stu-id="290fe-155">Binary</span></span>|<span data-ttu-id="290fe-156">VarBinary.</span><span class="sxs-lookup"><span data-stu-id="290fe-156">VarBinary.</span></span> <span data-ttu-id="290fe-157">Esta conversión implícita producirá un error si la matriz de bytes es mayor que el tamaño máximo de VarBinary, que es de 8000 bytes. En el caso de las matrices de bytes de más de 8000 bytes, establezca explícitamente <xref:System.Data.SqlDbType> .</span><span class="sxs-lookup"><span data-stu-id="290fe-157">This implicit conversion will fail if the byte array is larger than the maximum size of a VarBinary, which is 8000 bytes.For byte arrays larger than 8000 bytes, explicitly set the <xref:System.Data.SqlDbType>.</span></span>|<span data-ttu-id="290fe-158">VarBinary</span><span class="sxs-lookup"><span data-stu-id="290fe-158">VarBinary</span></span>|<span data-ttu-id="290fe-159">Binario</span><span class="sxs-lookup"><span data-stu-id="290fe-159">Binary</span></span>|<span data-ttu-id="290fe-160">Raw</span><span class="sxs-lookup"><span data-stu-id="290fe-160">Raw</span></span>|
|<xref:System.Char>| |<span data-ttu-id="290fe-161">No se admite la deducción de un tipo <xref:System.Data.SqlDbType> a partir de char.</span><span class="sxs-lookup"><span data-stu-id="290fe-161">Inferring a <xref:System.Data.SqlDbType> from char is not supported.</span></span>|<span data-ttu-id="290fe-162">Char</span><span class="sxs-lookup"><span data-stu-id="290fe-162">Char</span></span>|<span data-ttu-id="290fe-163">Char</span><span class="sxs-lookup"><span data-stu-id="290fe-163">Char</span></span>|<span data-ttu-id="290fe-164">Byte</span><span class="sxs-lookup"><span data-stu-id="290fe-164">Byte</span></span>|
|<xref:System.DateTime>|<span data-ttu-id="290fe-165">DateTime</span><span class="sxs-lookup"><span data-stu-id="290fe-165">DateTime</span></span>|<span data-ttu-id="290fe-166">DateTime</span><span class="sxs-lookup"><span data-stu-id="290fe-166">DateTime</span></span>|<span data-ttu-id="290fe-167">DBTimeStamp</span><span class="sxs-lookup"><span data-stu-id="290fe-167">DBTimeStamp</span></span>|<span data-ttu-id="290fe-168">DateTime</span><span class="sxs-lookup"><span data-stu-id="290fe-168">DateTime</span></span>|<span data-ttu-id="290fe-169">DateTime</span><span class="sxs-lookup"><span data-stu-id="290fe-169">DateTime</span></span>|
|<xref:System.DateTimeOffset>|<span data-ttu-id="290fe-170">DateTimeOffset</span><span class="sxs-lookup"><span data-stu-id="290fe-170">DateTimeOffset</span></span>|<span data-ttu-id="290fe-171">DateTimeOffset en SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="290fe-171">DateTimeOffset in SQL Server 2008.</span></span> <span data-ttu-id="290fe-172">La deducción de un elemento <xref:System.Data.SqlDbType> a partir de DateTimeOffset no se admite en versiones de SQL Server anteriores a SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="290fe-172">Inferring a <xref:System.Data.SqlDbType> from DateTimeOffset is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|||<span data-ttu-id="290fe-173">DateTime</span><span class="sxs-lookup"><span data-stu-id="290fe-173">DateTime</span></span>|
|<xref:System.Decimal>|<span data-ttu-id="290fe-174">Decimal</span><span class="sxs-lookup"><span data-stu-id="290fe-174">Decimal</span></span>|<span data-ttu-id="290fe-175">Decimal</span><span class="sxs-lookup"><span data-stu-id="290fe-175">Decimal</span></span>|<span data-ttu-id="290fe-176">Decimal</span><span class="sxs-lookup"><span data-stu-id="290fe-176">Decimal</span></span>|<span data-ttu-id="290fe-177">Numeric</span><span class="sxs-lookup"><span data-stu-id="290fe-177">Numeric</span></span>|<span data-ttu-id="290fe-178">Number</span><span class="sxs-lookup"><span data-stu-id="290fe-178">Number</span></span>|
|<xref:System.Double>|<span data-ttu-id="290fe-179">Double</span><span class="sxs-lookup"><span data-stu-id="290fe-179">Double</span></span>|<span data-ttu-id="290fe-180">Float</span><span class="sxs-lookup"><span data-stu-id="290fe-180">Float</span></span>|<span data-ttu-id="290fe-181">Double</span><span class="sxs-lookup"><span data-stu-id="290fe-181">Double</span></span>|<span data-ttu-id="290fe-182">Double</span><span class="sxs-lookup"><span data-stu-id="290fe-182">Double</span></span>|<span data-ttu-id="290fe-183">Double</span><span class="sxs-lookup"><span data-stu-id="290fe-183">Double</span></span>|
|<xref:System.Single>|<span data-ttu-id="290fe-184">Single</span><span class="sxs-lookup"><span data-stu-id="290fe-184">Single</span></span>|<span data-ttu-id="290fe-185">Real</span><span class="sxs-lookup"><span data-stu-id="290fe-185">Real</span></span>|<span data-ttu-id="290fe-186">Single</span><span class="sxs-lookup"><span data-stu-id="290fe-186">Single</span></span>|<span data-ttu-id="290fe-187">Real</span><span class="sxs-lookup"><span data-stu-id="290fe-187">Real</span></span>|<span data-ttu-id="290fe-188">Float</span><span class="sxs-lookup"><span data-stu-id="290fe-188">Float</span></span>|
|<xref:System.Guid>|<span data-ttu-id="290fe-189">Guid</span><span class="sxs-lookup"><span data-stu-id="290fe-189">Guid</span></span>|<span data-ttu-id="290fe-190">UniqueIdentifier</span><span class="sxs-lookup"><span data-stu-id="290fe-190">UniqueIdentifier</span></span>|<span data-ttu-id="290fe-191">Guid</span><span class="sxs-lookup"><span data-stu-id="290fe-191">Guid</span></span>|<span data-ttu-id="290fe-192">UniqueIdentifier</span><span class="sxs-lookup"><span data-stu-id="290fe-192">UniqueIdentifier</span></span>|<span data-ttu-id="290fe-193">Raw</span><span class="sxs-lookup"><span data-stu-id="290fe-193">Raw</span></span>|
|<xref:System.Int16>|<span data-ttu-id="290fe-194">Int16</span><span class="sxs-lookup"><span data-stu-id="290fe-194">Int16</span></span>|<span data-ttu-id="290fe-195">SmallInt</span><span class="sxs-lookup"><span data-stu-id="290fe-195">SmallInt</span></span>|<span data-ttu-id="290fe-196">SmallInt</span><span class="sxs-lookup"><span data-stu-id="290fe-196">SmallInt</span></span>|<span data-ttu-id="290fe-197">SmallInt</span><span class="sxs-lookup"><span data-stu-id="290fe-197">SmallInt</span></span>|<span data-ttu-id="290fe-198">Int16</span><span class="sxs-lookup"><span data-stu-id="290fe-198">Int16</span></span>|
|<xref:System.Int32>|<span data-ttu-id="290fe-199">Int32</span><span class="sxs-lookup"><span data-stu-id="290fe-199">Int32</span></span>|<span data-ttu-id="290fe-200">Int</span><span class="sxs-lookup"><span data-stu-id="290fe-200">Int</span></span>|<span data-ttu-id="290fe-201">Int</span><span class="sxs-lookup"><span data-stu-id="290fe-201">Int</span></span>|<span data-ttu-id="290fe-202">Int</span><span class="sxs-lookup"><span data-stu-id="290fe-202">Int</span></span>|<span data-ttu-id="290fe-203">Int32</span><span class="sxs-lookup"><span data-stu-id="290fe-203">Int32</span></span>|
|<xref:System.Int64>|<span data-ttu-id="290fe-204">Int64</span><span class="sxs-lookup"><span data-stu-id="290fe-204">Int64</span></span>|<span data-ttu-id="290fe-205">BigInt</span><span class="sxs-lookup"><span data-stu-id="290fe-205">BigInt</span></span>|<span data-ttu-id="290fe-206">BigInt</span><span class="sxs-lookup"><span data-stu-id="290fe-206">BigInt</span></span>|<span data-ttu-id="290fe-207">BigInt</span><span class="sxs-lookup"><span data-stu-id="290fe-207">BigInt</span></span>|<span data-ttu-id="290fe-208">Number</span><span class="sxs-lookup"><span data-stu-id="290fe-208">Number</span></span>|
|<xref:System.Object>|<span data-ttu-id="290fe-209">Object</span><span class="sxs-lookup"><span data-stu-id="290fe-209">Object</span></span>|<span data-ttu-id="290fe-210">Variante</span><span class="sxs-lookup"><span data-stu-id="290fe-210">Variant</span></span>|<span data-ttu-id="290fe-211">Variante</span><span class="sxs-lookup"><span data-stu-id="290fe-211">Variant</span></span>|<span data-ttu-id="290fe-212">No se admite la deducción de un tipo OdbcType a partir de Object.</span><span class="sxs-lookup"><span data-stu-id="290fe-212">Inferring an OdbcType from Object is not supported.</span></span>|<span data-ttu-id="290fe-213">Blob</span><span class="sxs-lookup"><span data-stu-id="290fe-213">Blob</span></span>|
|<xref:System.String>|<span data-ttu-id="290fe-214">String</span><span class="sxs-lookup"><span data-stu-id="290fe-214">String</span></span>|<span data-ttu-id="290fe-215">NVarChar.</span><span class="sxs-lookup"><span data-stu-id="290fe-215">NVarChar.</span></span> <span data-ttu-id="290fe-216">Esta conversión implícita generará un error en el caso de que la cadena tenga un tamaño superior al tamaño máximo de un tipo NVarChar, que es de 4.000 caracteres.</span><span class="sxs-lookup"><span data-stu-id="290fe-216">This implicit conversion will fail if the string is larger than the maximum size of an NVarChar, which is 4000 characters.</span></span> <span data-ttu-id="290fe-217">En cadenas con más de 4.000 caracteres, establezca de forma explícita el tipo <xref:System.Data.SqlDbType>.</span><span class="sxs-lookup"><span data-stu-id="290fe-217">For strings larger than 4000 characters, explicitly set the <xref:System.Data.SqlDbType>.</span></span>|<span data-ttu-id="290fe-218">VarWChar</span><span class="sxs-lookup"><span data-stu-id="290fe-218">VarWChar</span></span>|<span data-ttu-id="290fe-219">NVarChar</span><span class="sxs-lookup"><span data-stu-id="290fe-219">NVarChar</span></span>|<span data-ttu-id="290fe-220">NVarChar</span><span class="sxs-lookup"><span data-stu-id="290fe-220">NVarChar</span></span>|
|<xref:System.TimeSpan>|<span data-ttu-id="290fe-221">Hora</span><span class="sxs-lookup"><span data-stu-id="290fe-221">Time</span></span>|<span data-ttu-id="290fe-222">Time en SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="290fe-222">Time in SQL Server 2008.</span></span> <span data-ttu-id="290fe-223">La deducción de un elemento <xref:System.Data.SqlDbType> a partir de TimeSpan no se admite en versiones de SQL Server anteriores a SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="290fe-223">Inferring a <xref:System.Data.SqlDbType> from TimeSpan is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|<span data-ttu-id="290fe-224">DBTime</span><span class="sxs-lookup"><span data-stu-id="290fe-224">DBTime</span></span>|<span data-ttu-id="290fe-225">Time</span><span class="sxs-lookup"><span data-stu-id="290fe-225">Time</span></span>|<span data-ttu-id="290fe-226">DateTime</span><span class="sxs-lookup"><span data-stu-id="290fe-226">DateTime</span></span>|
|<xref:System.UInt16>|<span data-ttu-id="290fe-227">UInt16</span><span class="sxs-lookup"><span data-stu-id="290fe-227">UInt16</span></span>|<span data-ttu-id="290fe-228">No se admite la deducción de un tipo <xref:System.Data.SqlDbType> a partir de UInt16.</span><span class="sxs-lookup"><span data-stu-id="290fe-228">Inferring a <xref:System.Data.SqlDbType> from UInt16 is not supported.</span></span>|<span data-ttu-id="290fe-229">UnsignedSmallInt</span><span class="sxs-lookup"><span data-stu-id="290fe-229">UnsignedSmallInt</span></span>|<span data-ttu-id="290fe-230">Int</span><span class="sxs-lookup"><span data-stu-id="290fe-230">Int</span></span>|<span data-ttu-id="290fe-231">UInt16</span><span class="sxs-lookup"><span data-stu-id="290fe-231">UInt16</span></span>|
|<xref:System.UInt32>|<span data-ttu-id="290fe-232">UInt32</span><span class="sxs-lookup"><span data-stu-id="290fe-232">UInt32</span></span>|<span data-ttu-id="290fe-233">No se admite la deducción de un tipo <xref:System.Data.SqlDbType> a partir de UInt32.</span><span class="sxs-lookup"><span data-stu-id="290fe-233">Inferring a <xref:System.Data.SqlDbType> from UInt32 is not supported.</span></span>|<span data-ttu-id="290fe-234">UnsignedInt</span><span class="sxs-lookup"><span data-stu-id="290fe-234">UnsignedInt</span></span>|<span data-ttu-id="290fe-235">BigInt</span><span class="sxs-lookup"><span data-stu-id="290fe-235">BigInt</span></span>|<span data-ttu-id="290fe-236">UInt32</span><span class="sxs-lookup"><span data-stu-id="290fe-236">UInt32</span></span>|
|<xref:System.UInt64>|<span data-ttu-id="290fe-237">UInt64</span><span class="sxs-lookup"><span data-stu-id="290fe-237">UInt64</span></span>|<span data-ttu-id="290fe-238">No se admite la deducción de un tipo <xref:System.Data.SqlDbType> a partir de UInt64.</span><span class="sxs-lookup"><span data-stu-id="290fe-238">Inferring a <xref:System.Data.SqlDbType> from UInt64 is not supported.</span></span>|<span data-ttu-id="290fe-239">UnsignedBigInt</span><span class="sxs-lookup"><span data-stu-id="290fe-239">UnsignedBigInt</span></span>|<span data-ttu-id="290fe-240">Numérica</span><span class="sxs-lookup"><span data-stu-id="290fe-240">Numeric</span></span>|<span data-ttu-id="290fe-241">Number</span><span class="sxs-lookup"><span data-stu-id="290fe-241">Number</span></span>|
||<span data-ttu-id="290fe-242">AnsiString</span><span class="sxs-lookup"><span data-stu-id="290fe-242">AnsiString</span></span>|<span data-ttu-id="290fe-243">VarChar</span><span class="sxs-lookup"><span data-stu-id="290fe-243">VarChar</span></span>|<span data-ttu-id="290fe-244">VarChar</span><span class="sxs-lookup"><span data-stu-id="290fe-244">VarChar</span></span>|<span data-ttu-id="290fe-245">VarChar</span><span class="sxs-lookup"><span data-stu-id="290fe-245">VarChar</span></span>|<span data-ttu-id="290fe-246">VarChar</span><span class="sxs-lookup"><span data-stu-id="290fe-246">VarChar</span></span>|
||<span data-ttu-id="290fe-247">AnsiStringFixedLength</span><span class="sxs-lookup"><span data-stu-id="290fe-247">AnsiStringFixedLength</span></span>|<span data-ttu-id="290fe-248">Char</span><span class="sxs-lookup"><span data-stu-id="290fe-248">Char</span></span>|<span data-ttu-id="290fe-249">Char</span><span class="sxs-lookup"><span data-stu-id="290fe-249">Char</span></span>|<span data-ttu-id="290fe-250">Char</span><span class="sxs-lookup"><span data-stu-id="290fe-250">Char</span></span>|<span data-ttu-id="290fe-251">Char</span><span class="sxs-lookup"><span data-stu-id="290fe-251">Char</span></span>|
||<span data-ttu-id="290fe-252">Moneda</span><span class="sxs-lookup"><span data-stu-id="290fe-252">Currency</span></span>|<span data-ttu-id="290fe-253">Money</span><span class="sxs-lookup"><span data-stu-id="290fe-253">Money</span></span>|<span data-ttu-id="290fe-254">Moneda</span><span class="sxs-lookup"><span data-stu-id="290fe-254">Currency</span></span>|<span data-ttu-id="290fe-255">No es posible deducir el valor de `OdbcType` a partir de `Currency` .</span><span class="sxs-lookup"><span data-stu-id="290fe-255">Inferring an `OdbcType` from `Currency` is not supported.</span></span>|<span data-ttu-id="290fe-256">Number</span><span class="sxs-lookup"><span data-stu-id="290fe-256">Number</span></span>|
||<span data-ttu-id="290fe-257">Date</span><span class="sxs-lookup"><span data-stu-id="290fe-257">Date</span></span>|<span data-ttu-id="290fe-258">Date en SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="290fe-258">Date in SQL Server 2008.</span></span> <span data-ttu-id="290fe-259">La deducción de un elemento <xref:System.Data.SqlDbType> a partir de Date no se admite en versiones de SQL Server anteriores a SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="290fe-259">Inferring a <xref:System.Data.SqlDbType> from Date is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|<span data-ttu-id="290fe-260">DBDate</span><span class="sxs-lookup"><span data-stu-id="290fe-260">DBDate</span></span>|<span data-ttu-id="290fe-261">Date</span><span class="sxs-lookup"><span data-stu-id="290fe-261">Date</span></span>|<span data-ttu-id="290fe-262">DateTime</span><span class="sxs-lookup"><span data-stu-id="290fe-262">DateTime</span></span>|
||<span data-ttu-id="290fe-263">SByte</span><span class="sxs-lookup"><span data-stu-id="290fe-263">SByte</span></span>|<span data-ttu-id="290fe-264">No se admite la deducción de un elemento <xref:System.Data.SqlDbType> a partir de SByte.</span><span class="sxs-lookup"><span data-stu-id="290fe-264">Inferring a <xref:System.Data.SqlDbType> from SByte is not supported.</span></span>|<span data-ttu-id="290fe-265">TinyInt</span><span class="sxs-lookup"><span data-stu-id="290fe-265">TinyInt</span></span>|<span data-ttu-id="290fe-266">No se admite la deducción de un tipo `OdbcType` a partir de SByte.</span><span class="sxs-lookup"><span data-stu-id="290fe-266">Inferring an `OdbcType` from SByte is not supported.</span></span>|<span data-ttu-id="290fe-267">SByte</span><span class="sxs-lookup"><span data-stu-id="290fe-267">SByte</span></span>|
||<span data-ttu-id="290fe-268">StringFixedLength</span><span class="sxs-lookup"><span data-stu-id="290fe-268">StringFixedLength</span></span>|<span data-ttu-id="290fe-269">NChar</span><span class="sxs-lookup"><span data-stu-id="290fe-269">NChar</span></span>|<span data-ttu-id="290fe-270">WChar</span><span class="sxs-lookup"><span data-stu-id="290fe-270">WChar</span></span>|<span data-ttu-id="290fe-271">NChar</span><span class="sxs-lookup"><span data-stu-id="290fe-271">NChar</span></span>|<span data-ttu-id="290fe-272">NChar</span><span class="sxs-lookup"><span data-stu-id="290fe-272">NChar</span></span>|
||<span data-ttu-id="290fe-273">Hora</span><span class="sxs-lookup"><span data-stu-id="290fe-273">Time</span></span>|<span data-ttu-id="290fe-274">Time en SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="290fe-274">Time in SQL Server 2008.</span></span> <span data-ttu-id="290fe-275">La deducción de un elemento <xref:System.Data.SqlDbType> a partir de Time no se admite en versiones de SQL Server anteriores a SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="290fe-275">Inferring a <xref:System.Data.SqlDbType> from Time is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|<span data-ttu-id="290fe-276">DBTime</span><span class="sxs-lookup"><span data-stu-id="290fe-276">DBTime</span></span>|<span data-ttu-id="290fe-277">Time</span><span class="sxs-lookup"><span data-stu-id="290fe-277">Time</span></span>|<span data-ttu-id="290fe-278">DateTime</span><span class="sxs-lookup"><span data-stu-id="290fe-278">DateTime</span></span>|
||<span data-ttu-id="290fe-279">VarNumeric</span><span class="sxs-lookup"><span data-stu-id="290fe-279">VarNumeric</span></span>|<span data-ttu-id="290fe-280">No se admite la deducción de un elemento <xref:System.Data.SqlDbType> a partir de VarNumeric.</span><span class="sxs-lookup"><span data-stu-id="290fe-280">Inferring a <xref:System.Data.SqlDbType> from VarNumeric is not supported.</span></span>|<span data-ttu-id="290fe-281">VarNumeric</span><span class="sxs-lookup"><span data-stu-id="290fe-281">VarNumeric</span></span>|<span data-ttu-id="290fe-282">No se admite la deducción de un tipo `OdbcType` a partir de VarNumeric.</span><span class="sxs-lookup"><span data-stu-id="290fe-282">Inferring an `OdbcType` from VarNumeric is not supported.</span></span>|<span data-ttu-id="290fe-283">Number</span><span class="sxs-lookup"><span data-stu-id="290fe-283">Number</span></span>|
|<span data-ttu-id="290fe-284">tipo definido por el usuario (un objeto con <xref:Microsoft.SqlServer.Server.SqlUserDefinedAggregateAttribute></span><span class="sxs-lookup"><span data-stu-id="290fe-284">user-defined type (an object with <xref:Microsoft.SqlServer.Server.SqlUserDefinedAggregateAttribute></span></span>|<span data-ttu-id="290fe-285">Object o String según el proveedor (SqlClient siempre devuelve Object, ODBC siempre devuelve String y el proveedor de datos administrados OleDb puede ver ambos)</span><span class="sxs-lookup"><span data-stu-id="290fe-285">Object or String, depending the provider (SqlClient always returns an Object, Odbc always returns a String, and the OleDb managed data provider can see either</span></span>|<span data-ttu-id="290fe-286">SqlDbType.Udt si <xref:Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute> está presente; de lo contrario, Variant.</span><span class="sxs-lookup"><span data-stu-id="290fe-286">SqlDbType.Udt if <xref:Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute> is present, otherwise Variant</span></span>|<span data-ttu-id="290fe-287">OleDbType.VarWChar (si el valor es NULL); de lo contrario, OleDbType.Variant.</span><span class="sxs-lookup"><span data-stu-id="290fe-287">OleDbType.VarWChar (if value is null) otherwise OleDbType.Variant.</span></span>|<span data-ttu-id="290fe-288">OdbcType.NVarChar</span><span class="sxs-lookup"><span data-stu-id="290fe-288">OdbcType.NVarChar</span></span>|<span data-ttu-id="290fe-289">no admitido</span><span class="sxs-lookup"><span data-stu-id="290fe-289">not supported</span></span>|

> [!NOTE]
> <span data-ttu-id="290fe-290">Las conversiones de valores de tipo decimal en otros tipos de valor son conversiones de restricción que redondean el valor decimal al valor entero más próximo a cero.</span><span class="sxs-lookup"><span data-stu-id="290fe-290">Conversions from decimal to other types are narrowing conversions that round the decimal value to the nearest integer value toward zero.</span></span> <span data-ttu-id="290fe-291">Si el resultado de la conversión no puede representarse en el tipo de destino, se produce <xref:System.OverflowException> .</span><span class="sxs-lookup"><span data-stu-id="290fe-291">If the result of the conversion is not representable in the destination type, an <xref:System.OverflowException> is thrown.</span></span>

> [!NOTE]
> <span data-ttu-id="290fe-292">Cuando se envía un valor de parámetro null al servidor, se debe especificar <xref:System.DBNull> , no `null` ( `Nothing` en Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="290fe-292">When you send a null parameter value to the server, you must specify <xref:System.DBNull>, not `null` (`Nothing` in Visual Basic).</span></span> <span data-ttu-id="290fe-293">El valor null del sistema es un objeto vacío que no tiene ningún valor.</span><span class="sxs-lookup"><span data-stu-id="290fe-293">The null value in the system is an empty object that has no value.</span></span> <span data-ttu-id="290fe-294">Se usa <xref:System.DBNull> para representar valores null.</span><span class="sxs-lookup"><span data-stu-id="290fe-294"><xref:System.DBNull> is used to represent null values.</span></span> <span data-ttu-id="290fe-295">Para obtener más información acerca de los valores NULL de base de datos, vea [administrar valores NULL](./sql/handling-null-values.md).</span><span class="sxs-lookup"><span data-stu-id="290fe-295">For more information about database nulls, see [Handling Null Values](./sql/handling-null-values.md).</span></span>

## <a name="deriving-parameter-information"></a><span data-ttu-id="290fe-296">Derivar información de parámetros</span><span class="sxs-lookup"><span data-stu-id="290fe-296">Deriving parameter information</span></span>

<span data-ttu-id="290fe-297">Los parámetros también se pueden derivar de un procedimiento almacenado mediante la clase `DbCommandBuilder` .</span><span class="sxs-lookup"><span data-stu-id="290fe-297">Parameters can also be derived from a stored procedure using the `DbCommandBuilder` class.</span></span> <span data-ttu-id="290fe-298">Las clases `SqlCommandBuilder` y `OleDbCommandBuilder` proporcionan un método estático, `DeriveParameters`, que rellena automáticamente la colección de parámetros de un objeto de comando que usa información de parámetros procedente de un procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="290fe-298">Both the `SqlCommandBuilder` and `OleDbCommandBuilder` classes provide a static method, `DeriveParameters`, which automatically populates the parameters collection of a command object that uses parameter information from a stored procedure.</span></span> <span data-ttu-id="290fe-299">Tenga en cuenta que `DeriveParameters` sobrescribirá toda la información de parámetros existente en el comando.</span><span class="sxs-lookup"><span data-stu-id="290fe-299">Note that `DeriveParameters` overwrites any existing parameter information for the command.</span></span>

> [!NOTE]
> <span data-ttu-id="290fe-300">La derivación de información de parámetros afecta al rendimiento, ya que precisa un viaje adicional de ida y vuelta (round trip) al origen de datos para recuperar la información.</span><span class="sxs-lookup"><span data-stu-id="290fe-300">Deriving parameter information incurs a performance penalty because it requires an additional round trip to the data source to retrieve the information.</span></span> <span data-ttu-id="290fe-301">Si la información de los parámetros se conoce en tiempo de diseño, se puede mejorar el rendimiento de la aplicación si se establecen los parámetros con los valores correspondientes de forma explícita.</span><span class="sxs-lookup"><span data-stu-id="290fe-301">If parameter information is known at design time, you can improve the performance of your application by setting the parameters explicitly.</span></span>

<span data-ttu-id="290fe-302">Para obtener más información, vea [generar comandos con objetos CommandBuilder](generating-commands-with-commandbuilders.md).</span><span class="sxs-lookup"><span data-stu-id="290fe-302">For more information, see [Generating Commands with CommandBuilders](generating-commands-with-commandbuilders.md).</span></span>

## <a name="using-parameters-with-a-sqlcommand-and-a-stored-procedure"></a><span data-ttu-id="290fe-303">Usar parámetros con SqlCommand y un procedimiento almacenado</span><span class="sxs-lookup"><span data-stu-id="290fe-303">Using parameters with a SqlCommand and a stored procedure</span></span>

<span data-ttu-id="290fe-304">Los procedimientos almacenados ofrecen numerosas ventajas en el caso de aplicaciones que procesan datos.</span><span class="sxs-lookup"><span data-stu-id="290fe-304">Stored procedures offer many advantages in data-driven applications.</span></span> <span data-ttu-id="290fe-305">Mediante el uso de procedimientos almacenados, las operaciones de bases de datos se pueden encapsular en un solo comando, optimizar para lograr el mejor rendimiento, y mejorar con seguridad adicional.</span><span class="sxs-lookup"><span data-stu-id="290fe-305">By using stored procedures, database operations can be encapsulated in a single command, optimized for best performance, and enhanced with additional security.</span></span> <span data-ttu-id="290fe-306">Aunque se puede llamar a un procedimiento almacenado pasando el nombre del procedimiento almacenado seguido de los argumentos de parámetro como una instrucción SQL, el uso <xref:System.Data.Common.DbCommand.Parameters%2A> de la colección del <xref:System.Data.Common.DbCommand> objeto ADO.net permite definir más explícitamente los parámetros de los procedimientos almacenados y obtener acceso a los parámetros de salida y valores devueltos.</span><span class="sxs-lookup"><span data-stu-id="290fe-306">Although a stored procedure can be called by passing the stored procedure name followed by parameter arguments as an SQL statement, by using the <xref:System.Data.Common.DbCommand.Parameters%2A> collection of the ADO.NET <xref:System.Data.Common.DbCommand> object enables you to more explicitly define stored procedure parameters, and to access output parameters and return values.</span></span>

> [!NOTE]
> <span data-ttu-id="290fe-307">Las instrucciones con parámetros se ejecutan en el servidor utilizando `sp_executesql,` ; esto permite volver a utilizar el plan de consultas.</span><span class="sxs-lookup"><span data-stu-id="290fe-307">Parameterized statements are executed on the server by using `sp_executesql,` which allows for query plan reuse.</span></span> <span data-ttu-id="290fe-308">Los cursores o las variables locales del lote de `sp_executesql` no son visibles para el lote que llama a `sp_executesql`.</span><span class="sxs-lookup"><span data-stu-id="290fe-308">Local cursors or variables in the `sp_executesql` batch are not visible to the batch that calls `sp_executesql`.</span></span> <span data-ttu-id="290fe-309">Los cambios en el contexto de base de datos solo se mantienen hasta el final de la instrucción `sp_executesql` .</span><span class="sxs-lookup"><span data-stu-id="290fe-309">Changes in database context last only to the end of the `sp_executesql` statement.</span></span> <span data-ttu-id="290fe-310">Para obtener más información, vea [sp_executesql (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-executesql-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="290fe-310">For more information, see [sp_executesql (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-executesql-transact-sql).</span></span>

<span data-ttu-id="290fe-311">Cuando se usan parámetros con <xref:System.Data.SqlClient.SqlCommand> para ejecutar un procedimiento almacenado de SQL Server, los nombres de los parámetros agregados a la colección <xref:System.Data.SqlClient.SqlCommand.Parameters%2A> deben coincidir con los nombres de los marcadores de parámetro del procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="290fe-311">When using parameters with a <xref:System.Data.SqlClient.SqlCommand> to execute a SQL Server stored procedure, the names of the parameters added to the <xref:System.Data.SqlClient.SqlCommand.Parameters%2A> collection must match the names of the parameter markers in the stored procedure.</span></span> <span data-ttu-id="290fe-312">El proveedor de datos de .NET Framework para SQL Server no admite el marcador de posición del signo de interrogación (?) para pasar parámetros a una instrucción SQL o a un procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="290fe-312">The .NET Framework Data Provider for SQL Server does not support the question mark (?) placeholder for passing parameters to an SQL statement or a stored procedure.</span></span> <span data-ttu-id="290fe-313">Este proveedor trata los parámetros del procedimiento almacenado como parámetros con nombre y busca marcadores de parámetros coincidentes.</span><span class="sxs-lookup"><span data-stu-id="290fe-313">It treats parameters in the stored procedure as named parameters and searches for matching parameter markers.</span></span> <span data-ttu-id="290fe-314">Por ejemplo, el procedimiento almacenado `CustOrderHist` se define usando un parámetro denominado `@CustomerID`.</span><span class="sxs-lookup"><span data-stu-id="290fe-314">For example, the `CustOrderHist` stored procedure is defined by using a parameter named `@CustomerID`.</span></span> <span data-ttu-id="290fe-315">Cuando el código ejecuta el procedimiento almacenado, también debe usar un parámetro denominado `@CustomerID`.</span><span class="sxs-lookup"><span data-stu-id="290fe-315">When your code executes the stored procedure, it must also use a parameter named `@CustomerID`.</span></span>

```sql
CREATE PROCEDURE dbo.CustOrderHist @CustomerID varchar(5)
```

### <a name="example"></a><span data-ttu-id="290fe-316">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="290fe-316">Example</span></span>

<span data-ttu-id="290fe-317">En este ejemplo se muestra cómo llamar a un procedimiento almacenado de SQL Server en la base de datos de ejemplo `Northwind` .</span><span class="sxs-lookup"><span data-stu-id="290fe-317">This example demonstrates how to call a SQL Server stored procedure in the `Northwind` sample database.</span></span> <span data-ttu-id="290fe-318">El nombre del procedimiento almacenado es `dbo.SalesByCategory` e incluye un parámetro de entrada denominado `@CategoryName` con el tipo de datos `nvarchar(15)`.</span><span class="sxs-lookup"><span data-stu-id="290fe-318">The name of the stored procedure is `dbo.SalesByCategory` and it has an input parameter named `@CategoryName` with a data type of `nvarchar(15)`.</span></span> <span data-ttu-id="290fe-319">El código crea una nueva clase <xref:System.Data.SqlClient.SqlConnection> dentro de un bloque en uso, de forma que la conexión se cierre cuando finalice el procedimiento.</span><span class="sxs-lookup"><span data-stu-id="290fe-319">The code creates a new <xref:System.Data.SqlClient.SqlConnection> inside a using block so that the connection is disposed when the procedure ends.</span></span> <span data-ttu-id="290fe-320">Se crean los objetos <xref:System.Data.SqlClient.SqlCommand> y <xref:System.Data.SqlClient.SqlParameter> , y se establecen sus propiedades.</span><span class="sxs-lookup"><span data-stu-id="290fe-320">The <xref:System.Data.SqlClient.SqlCommand> and <xref:System.Data.SqlClient.SqlParameter> objects are created, and their properties set.</span></span> <span data-ttu-id="290fe-321"><xref:System.Data.SqlClient.SqlDataReader> ejecuta `SqlCommand` y devuelve el conjunto de resultados del procedimiento almacenado, mostrándolos en la ventana de consola.</span><span class="sxs-lookup"><span data-stu-id="290fe-321">A <xref:System.Data.SqlClient.SqlDataReader> executes the `SqlCommand` and returns the result set from the stored procedure, displaying the output in the console window.</span></span>

> [!NOTE]
> <span data-ttu-id="290fe-322">En lugar de crear objetos `SqlCommand` y `SqlParameter` y, a continuación, establecer propiedades en instrucciones independientes, puede usar uno de los constructores sobrecargados para establecer varias propiedades en una única instrucción.</span><span class="sxs-lookup"><span data-stu-id="290fe-322">Instead of creating `SqlCommand` and `SqlParameter` objects and then setting properties in separate statements, you can instead elect to use one of the overloaded constructors to set multiple properties in a single statement.</span></span>

[!code-csharp[DataWorks SqlClient.StoredProcedure#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlClient.StoredProcedure/CS/source.cs#1)]
[!code-vb[DataWorks SqlClient.StoredProcedure#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlClient.StoredProcedure/VB/source.vb#1)]

## <a name="using-parameters-with-an-oledbcommand-or-odbccommand"></a><span data-ttu-id="290fe-323">Usar parámetros con un OleDbCommand o OdbcCommand</span><span class="sxs-lookup"><span data-stu-id="290fe-323">Using parameters with an OleDbCommand or OdbcCommand</span></span>

<span data-ttu-id="290fe-324">Cuando se usan parámetros con <xref:System.Data.OleDb.OleDbCommand> o con <xref:System.Data.Odbc.OdbcCommand>, el orden de los parámetros agregados a la colección `Parameters` debe coincidir con el de los parámetros definidos en el procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="290fe-324">When using parameters with an <xref:System.Data.OleDb.OleDbCommand> or <xref:System.Data.Odbc.OdbcCommand>, the order of the parameters added to the `Parameters` collection must match the order of the parameters defined in your stored procedure.</span></span> <span data-ttu-id="290fe-325">El proveedor de datos de .NET Framework para OLE DB y .NET Framework proveedor de datos para ODBC tratan los parámetros de un procedimiento almacenado como marcadores de posición y aplican los valores de los parámetros en orden.</span><span class="sxs-lookup"><span data-stu-id="290fe-325">The .NET Framework Data Provider for OLE DB and .NET Framework Data Provider for ODBC treat parameters in a stored procedure as placeholders and apply parameter values in order.</span></span> <span data-ttu-id="290fe-326">Además, los parámetros de valores devueltos deben ser los primeros que se agreguen a la colección `Parameters` .</span><span class="sxs-lookup"><span data-stu-id="290fe-326">In addition, return value parameters must be the first parameters added to the `Parameters` collection.</span></span>

<span data-ttu-id="290fe-327">El proveedor de datos de .NET Framework para OLE DB y .NET Framework proveedor de datos de para ODBC no admiten parámetros con nombre para pasar parámetros a una instrucción SQL o a un procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="290fe-327">The .NET Framework Data Provider for OLE DB and .NET Framework Data Provider for ODBC do not support named parameters for passing parameters to an SQL statement or a stored procedure.</span></span> <span data-ttu-id="290fe-328">En este caso, se debe utilizar el marcador de posición de signo interrogación de cierre (?), como se muestra en el ejemplo siguiente.</span><span class="sxs-lookup"><span data-stu-id="290fe-328">In this case, you must use the question mark (?) placeholder, as in the following example.</span></span>

```sql
SELECT * FROM Customers WHERE CustomerID = ?
```

<span data-ttu-id="290fe-329">Por eso, el orden en que se agregan los objetos `Parameter` a la colección `Parameters` debe coincidir exactamente con la posición del</span><span class="sxs-lookup"><span data-stu-id="290fe-329">As a result, the order in which `Parameter` objects are added to the `Parameters` collection must directly correspond to the position of the ?</span></span> <span data-ttu-id="290fe-330">marcador de posición de interrogación de cierre correspondiente al parámetro.</span><span class="sxs-lookup"><span data-stu-id="290fe-330">placeholder for the parameter.</span></span>

### <a name="oledb-example"></a><span data-ttu-id="290fe-331">Ejemplo de OleDb</span><span class="sxs-lookup"><span data-stu-id="290fe-331">OleDb Example</span></span>

```vb
Dim command As OleDbCommand = New OleDbCommand( _
  "SampleProc", connection)
command.CommandType = CommandType.StoredProcedure

Dim parameter As OleDbParameter = command.Parameters.Add( _
  "RETURN_VALUE", OleDbType.Integer)
parameter.Direction = ParameterDirection.ReturnValue

parameter = command.Parameters.Add( _
  "@InputParm", OleDbType.VarChar, 12)
parameter.Value = "Sample Value"

parameter = command.Parameters.Add( _
  "@OutputParm", OleDbType.VarChar, 28)
parameter.Direction = ParameterDirection.Output
```

```csharp
OleDbCommand command = new OleDbCommand("SampleProc", connection);
command.CommandType = CommandType.StoredProcedure;

OleDbParameter parameter = command.Parameters.Add(
  "RETURN_VALUE", OleDbType.Integer);
parameter.Direction = ParameterDirection.ReturnValue;

parameter = command.Parameters.Add(
  "@InputParm", OleDbType.VarChar, 12);
parameter.Value = "Sample Value";

parameter = command.Parameters.Add(
  "@OutputParm", OleDbType.VarChar, 28);
parameter.Direction = ParameterDirection.Output;
```

## <a name="odbc-example"></a><span data-ttu-id="290fe-332">Ejemplo de Odbc</span><span class="sxs-lookup"><span data-stu-id="290fe-332">Odbc Example</span></span>

```vb
Dim command As OdbcCommand = New OdbcCommand( _
  "{ ? = CALL SampleProc(?, ?) }", connection)
command.CommandType = CommandType.StoredProcedure

Dim parameter As OdbcParameter = command.Parameters.Add("RETURN_VALUE", OdbcType.Int)
parameter.Direction = ParameterDirection.ReturnValue

parameter = command.Parameters.Add( _
  "@InputParm", OdbcType.VarChar, 12)
parameter.Value = "Sample Value"

parameter = command.Parameters.Add( _
  "@OutputParm", OdbcType.VarChar, 28)
parameter.Direction = ParameterDirection.Output
```

```csharp
OdbcCommand command = new OdbcCommand( _
  "{ ? = CALL SampleProc(?, ?) }", connection);
command.CommandType = CommandType.StoredProcedure;

OdbcParameter parameter = command.Parameters.Add( _
  "RETURN_VALUE", OdbcType.Int);
parameter.Direction = ParameterDirection.ReturnValue;

parameter = command.Parameters.Add( _
  "@InputParm", OdbcType.VarChar, 12);
parameter.Value = "Sample Value";

parameter = command.Parameters.Add( _
  "@OutputParm", OdbcType.VarChar, 28);
parameter.Direction = ParameterDirection.Output;
```

## <a name="see-also"></a><span data-ttu-id="290fe-333">Consulte también</span><span class="sxs-lookup"><span data-stu-id="290fe-333">See also</span></span>

- [<span data-ttu-id="290fe-334">Comandos y parámetros</span><span class="sxs-lookup"><span data-stu-id="290fe-334">Commands and Parameters</span></span>](commands-and-parameters.md)
- [<span data-ttu-id="290fe-335">Parámetros de DataAdapter</span><span class="sxs-lookup"><span data-stu-id="290fe-335">DataAdapter Parameters</span></span>](dataadapter-parameters.md)
- [<span data-ttu-id="290fe-336">Asignaciones de tipos de datos en ADO.NET</span><span class="sxs-lookup"><span data-stu-id="290fe-336">Data Type Mappings in ADO.NET</span></span>](data-type-mappings-in-ado-net.md)
- [<span data-ttu-id="290fe-337">Información general de ADO.NET</span><span class="sxs-lookup"><span data-stu-id="290fe-337">ADO.NET Overview</span></span>](ado-net-overview.md)
