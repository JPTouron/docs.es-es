---
title: Consultas en LINQ to DataSet
description: Obtenga información sobre cómo crear consultas en LINQ to DataSet obteniendo el origen o los orígenes de datos, creando la consulta y ejecutando la consulta.
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: c1a78fa8-9f0c-40bc-a372-5575a48708fe
ms.openlocfilehash: 79026f66137b9e008de2ef7c3d33cb8bbd3b8ec3
ms.sourcegitcommit: 5b475c1855b32cf78d2d1bbb4295e4c236f39464
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/24/2020
ms.locfileid: "91177402"
---
# <a name="queries-in-linq-to-dataset"></a><span data-ttu-id="394a5-103">Consultas en LINQ to DataSet</span><span class="sxs-lookup"><span data-stu-id="394a5-103">Queries in LINQ to DataSet</span></span>

<span data-ttu-id="394a5-104">Una consulta es una expresión que recupera datos de un origen de datos.</span><span class="sxs-lookup"><span data-stu-id="394a5-104">A query is an expression that retrieves data from a data source.</span></span> <span data-ttu-id="394a5-105">Las consultas se suelen expresar en un lenguaje de consulta especializado, como SQL para bases de datos relacionales y XQuery para XML.</span><span class="sxs-lookup"><span data-stu-id="394a5-105">Queries are usually expressed in a specialized query language, such as SQL for relational databases and XQuery for XML.</span></span> <span data-ttu-id="394a5-106">Por lo tanto, los programadores han tenido que aprender un lenguaje de consultas nuevo para cada tipo de origen de datos o formato de datos que consultan.</span><span class="sxs-lookup"><span data-stu-id="394a5-106">Therefore, developers have had to learn a new query language for each type of data source or data format that they query.</span></span> <span data-ttu-id="394a5-107">Language-Integrated Query (LINQ) ofrece un modelo coherente y más sencillo para trabajar con los datos de varios formatos y orígenes de datos.</span><span class="sxs-lookup"><span data-stu-id="394a5-107">Language-Integrated Query (LINQ) offers a simpler, consistent model for working with data across various kinds of data sources and formats.</span></span> <span data-ttu-id="394a5-108">En una consulta de LINQ siempre se trabaja con objetos de programación.</span><span class="sxs-lookup"><span data-stu-id="394a5-108">In a LINQ query, you always work with programming objects.</span></span>  
  
 <span data-ttu-id="394a5-109">Una operación de consulta de LINQ consta de tres acciones: obtener el origen o los orígenes de datos, crear la consulta y ejecutar la consulta.</span><span class="sxs-lookup"><span data-stu-id="394a5-109">A LINQ query operation consists of three actions: obtain the data source or sources, create the query, and execute the query.</span></span>  
  
 <span data-ttu-id="394a5-110">Los orígenes de datos que implementan la <xref:System.Collections.Generic.IEnumerable%601> interfaz genérica se pueden consultar a través de Linq.</span><span class="sxs-lookup"><span data-stu-id="394a5-110">Data sources that implement the <xref:System.Collections.Generic.IEnumerable%601> generic interface can be queried through LINQ.</span></span> <span data-ttu-id="394a5-111">Al llamar a <xref:System.Data.DataTableExtensions.AsEnumerable%2A> en <xref:System.Data.DataTable> , se devuelve un objeto que implementa la <xref:System.Collections.Generic.IEnumerable%601> interfaz genérica, que actúa como origen de datos para las consultas de LINQ to DataSet.</span><span class="sxs-lookup"><span data-stu-id="394a5-111">Calling <xref:System.Data.DataTableExtensions.AsEnumerable%2A> on a <xref:System.Data.DataTable> returns an object which implements the generic <xref:System.Collections.Generic.IEnumerable%601> interface, which serves as the data source for LINQ to DataSet queries.</span></span>  
  
 <span data-ttu-id="394a5-112">En la consulta se especifica exactamente la información que se desea recuperar del origen de datos.</span><span class="sxs-lookup"><span data-stu-id="394a5-112">In the query, you specify exactly the information that you want to retrieve from the data source.</span></span> <span data-ttu-id="394a5-113">Una consulta también puede especificar cómo se debe ordenar, agrupar y conformar esa información antes de que se devuelva.</span><span class="sxs-lookup"><span data-stu-id="394a5-113">A query can also specify how that information should be sorted, grouped, and shaped before it is returned.</span></span> <span data-ttu-id="394a5-114">En LINQ, una consulta se almacena en una variable.</span><span class="sxs-lookup"><span data-stu-id="394a5-114">In LINQ, a query is stored in a variable.</span></span> <span data-ttu-id="394a5-115">Si la consulta está diseñada para devolver una secuencia de valores, la variable misma de la consulta debe ser de tipo enumerable.</span><span class="sxs-lookup"><span data-stu-id="394a5-115">If the query is designed to return a sequence of values, the query variable itself must be a enumerable type.</span></span> <span data-ttu-id="394a5-116">Esta variable de consulta no realiza ninguna acción y no devuelve datos; solamente almacena la información de la consulta.</span><span class="sxs-lookup"><span data-stu-id="394a5-116">This query variable takes no action and returns no data; it only stores the query information.</span></span> <span data-ttu-id="394a5-117">Tras crear una consulta debe ejecutarla para recuperar los datos.</span><span class="sxs-lookup"><span data-stu-id="394a5-117">After you create a query you must execute that query to retrieve any data.</span></span>  
  
 <span data-ttu-id="394a5-118">En una consulta que devuelve una secuencia de valores, la variable de consulta por sí misma nunca conserva los resultados de la consulta y solo almacena los comandos de la misma.</span><span class="sxs-lookup"><span data-stu-id="394a5-118">In a query that returns a sequence of values, the query variable itself never holds the query results and only stores the query commands.</span></span> <span data-ttu-id="394a5-119">La ejecución de la consulta se aplaza hasta que la variable de consulta se recorre en iteración en un bucle `foreach` o `For Each`.</span><span class="sxs-lookup"><span data-stu-id="394a5-119">Execution of the query is deferred until the query variable is iterated over in a `foreach` or `For Each` loop.</span></span> <span data-ttu-id="394a5-120">Esto se denomina *ejecución aplazada*; es decir, la ejecución de la consulta se produce una vez después de la construcción de la consulta.</span><span class="sxs-lookup"><span data-stu-id="394a5-120">This is called *deferred execution*; that is, query execution occurs some time after the query is constructed.</span></span> <span data-ttu-id="394a5-121">Esto significa que se puede ejecutar una consulta con la frecuencia que se desee.</span><span class="sxs-lookup"><span data-stu-id="394a5-121">This means that you can execute a query as often as you want to.</span></span> <span data-ttu-id="394a5-122">Esto es útil cuando, por ejemplo, se tiene una base de datos que otras aplicaciones están actualizando.</span><span class="sxs-lookup"><span data-stu-id="394a5-122">This is useful when, for example, you have a database that is being updated by other applications.</span></span> <span data-ttu-id="394a5-123">En su aplicación puede crear una consulta para recuperar la información más reciente y ejecutar de forma repetida la consulta, devolviendo cada vez la información actualizada.</span><span class="sxs-lookup"><span data-stu-id="394a5-123">In your application, you can create a query to retrieve the latest information and repeatedly execute the query, returning the updated information every time.</span></span>  
  
 <span data-ttu-id="394a5-124">A diferencia de las consultas en diferido, que devuelven una secuencia de valores, las consultas que devuelven un valor singleton se ejecutan inmediatamente.</span><span class="sxs-lookup"><span data-stu-id="394a5-124">In contrast to deferred queries, which return a sequence of values, queries that return a singleton value are executed immediately.</span></span> <span data-ttu-id="394a5-125">Algunos ejemplos de consultas singleton son <xref:System.Linq.Enumerable.Count%2A>, <xref:System.Linq.Enumerable.Max%2A>, <xref:System.Linq.Enumerable.Average%2A> y <xref:System.Linq.Enumerable.First%2A>.</span><span class="sxs-lookup"><span data-stu-id="394a5-125">Some examples of singleton queries are <xref:System.Linq.Enumerable.Count%2A>, <xref:System.Linq.Enumerable.Max%2A>, <xref:System.Linq.Enumerable.Average%2A>, and <xref:System.Linq.Enumerable.First%2A>.</span></span> <span data-ttu-id="394a5-126">Se ejecutan inmediatamente porque se necesitan los resultados de la consulta para calcular el resultado singleton.</span><span class="sxs-lookup"><span data-stu-id="394a5-126">These execute immediately because the query results are required to calculate the singleton result.</span></span> <span data-ttu-id="394a5-127">Por ejemplo, para buscar la media de los resultados de consultas, debe ejecutarse la consulta para que la función de cálculo de media tenga datos de entrada con los que trabajar.</span><span class="sxs-lookup"><span data-stu-id="394a5-127">For example, in order to find the average of the query results the query must be executed so that the averaging function has input data to work with.</span></span> <span data-ttu-id="394a5-128">También puede usar los métodos <xref:System.Linq.Enumerable.ToList%2A> o <xref:System.Linq.Enumerable.ToArray%2A> en una consulta para forzar la ejecución inmediata de una consulta que no crea un valor singleton.</span><span class="sxs-lookup"><span data-stu-id="394a5-128">You can also use the <xref:System.Linq.Enumerable.ToList%2A> or <xref:System.Linq.Enumerable.ToArray%2A> methods on a query to force immediate execution of a query that does not produce a singleton value.</span></span> <span data-ttu-id="394a5-129">Esas técnicas para forzar la ejecución inmediata pueden ser útiles si desea almacenar en caché los resultados de una consulta.</span><span class="sxs-lookup"><span data-stu-id="394a5-129">These techniques to force immediate execution can be useful when you want to cache the results of a query.</span></span>
  
## <a name="queries"></a><span data-ttu-id="394a5-130">Consultas</span><span class="sxs-lookup"><span data-stu-id="394a5-130">Queries</span></span>  

 <span data-ttu-id="394a5-131">LINQ to DataSet consultas se pueden formular en dos sintaxis diferentes: sintaxis de expresiones de consulta y sintaxis de consulta basada en métodos.</span><span class="sxs-lookup"><span data-stu-id="394a5-131">LINQ to DataSet queries can be formulated in two different syntaxes: query expression syntax and method-based query syntax.</span></span>  
  
### <a name="query-expression-syntax"></a><span data-ttu-id="394a5-132">Sintaxis de expresiones de consulta</span><span class="sxs-lookup"><span data-stu-id="394a5-132">Query Expression Syntax</span></span>  

 <span data-ttu-id="394a5-133">Las expresiones de consulta son una sintaxis de consulta declarativa.</span><span class="sxs-lookup"><span data-stu-id="394a5-133">Query expressions are a declarative query syntax.</span></span> <span data-ttu-id="394a5-134">Esta sintaxis permite a un desarrollador escribir consultas en C# o Visual Basic en un formato similar a SQL.</span><span class="sxs-lookup"><span data-stu-id="394a5-134">This syntax enables a developer to write queries in C# or Visual Basic in a format similar to SQL.</span></span> <span data-ttu-id="394a5-135">Si se utiliza la sintaxis de expresiones de consulta, se pueden realizar incluso operaciones complejas de filtrado, ordenación y agrupamiento en orígenes de datos con código mínimo.</span><span class="sxs-lookup"><span data-stu-id="394a5-135">By using query expression syntax, you can perform even complex filtering, ordering, and grouping operations on data sources with minimal code.</span></span> <span data-ttu-id="394a5-136">Para obtener más información, vea [expresiones de consulta LINQ](../../../csharp/linq/index.md#query-expression-overview) y [operaciones básicas de consulta (Visual Basic)](../../../visual-basic/programming-guide/concepts/linq/basic-query-operations.md).</span><span class="sxs-lookup"><span data-stu-id="394a5-136">For more information, see [LINQ Query Expressions](../../../csharp/linq/index.md#query-expression-overview) and [Basic Query Operations (Visual Basic)](../../../visual-basic/programming-guide/concepts/linq/basic-query-operations.md).</span></span>
  
 <span data-ttu-id="394a5-137">El Common Language Runtime de .NET Framework (CLR) no puede leer la sintaxis de expresiones de consulta en sí.</span><span class="sxs-lookup"><span data-stu-id="394a5-137">The .NET Framework common language runtime (CLR) cannot read the query expression syntax itself.</span></span> <span data-ttu-id="394a5-138">Por lo tanto, en tiempo de compilación, las expresiones de consulta se traducen a algo que CLR no comprende: las llamadas a métodos.</span><span class="sxs-lookup"><span data-stu-id="394a5-138">Therefore, at compile time, query expressions are translated to something that the CLR does understand: method calls.</span></span> <span data-ttu-id="394a5-139">Estos métodos se conocen como operadores de *consulta estándar*.</span><span class="sxs-lookup"><span data-stu-id="394a5-139">These methods are referred to as the *standard query operators*.</span></span> <span data-ttu-id="394a5-140">Como programador, tiene la opción de llamarlos directamente utilizando la sintaxis de método en lugar de la sintaxis de consulta.</span><span class="sxs-lookup"><span data-stu-id="394a5-140">As a developer, you have the option of calling them directly by using method syntax, instead of using query syntax.</span></span> <span data-ttu-id="394a5-141">Para obtener más información, vea [Query Syntax and Method Syntax in LINQ](../../../csharp/programming-guide/concepts/linq/query-syntax-and-method-syntax-in-linq.md) (Sintaxis de consulta y sintaxis de método en LINQ).</span><span class="sxs-lookup"><span data-stu-id="394a5-141">For more information, see [Query Syntax and Method Syntax in LINQ](../../../csharp/programming-guide/concepts/linq/query-syntax-and-method-syntax-in-linq.md).</span></span> <span data-ttu-id="394a5-142">Para obtener más información acerca de los operadores de consulta estándar, vea [información general sobre operadores de consulta estándar](../../../csharp/programming-guide/concepts/linq/standard-query-operators-overview.md).</span><span class="sxs-lookup"><span data-stu-id="394a5-142">For more information about the standard query operators, see [Standard Query Operators Overview](../../../csharp/programming-guide/concepts/linq/standard-query-operators-overview.md).</span></span>  
  
 <span data-ttu-id="394a5-143">El siguiente ejemplo usa <xref:System.Linq.Enumerable.Select%2A> para devolver todas las filas de la tabla `Product` y mostrar los nombres de producto.</span><span class="sxs-lookup"><span data-stu-id="394a5-143">The following example uses <xref:System.Linq.Enumerable.Select%2A> to return all the rows from `Product` table and display the product names.</span></span>  
  
 [!code-csharp[DP LINQ to DataSet Examples#SelectSimple1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/CS/Program.cs#selectsimple1)]
 [!code-vb[DP LINQ to DataSet Examples#SelectSimple1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/VB/Module1.vb#selectsimple1)]  
  
### <a name="method-based-query-syntax"></a><span data-ttu-id="394a5-144">Sintaxis de consultas basadas en métodos</span><span class="sxs-lookup"><span data-stu-id="394a5-144">Method-Based Query Syntax</span></span>  

 <span data-ttu-id="394a5-145">La otra forma de formular consultas LINQ to DataSet es mediante el uso de consultas basadas en métodos.</span><span class="sxs-lookup"><span data-stu-id="394a5-145">The other way to formulate LINQ to DataSet queries is by using method-based queries.</span></span> <span data-ttu-id="394a5-146">La sintaxis de consultas basadas en métodos es una secuencia de llamadas directas a los métodos de operador de LINQ que pasan expresiones lambda como parámetros.</span><span class="sxs-lookup"><span data-stu-id="394a5-146">The method-based query syntax is a sequence of direct method calls to LINQ operator methods, passing lambda expressions as the parameters.</span></span> <span data-ttu-id="394a5-147">Para obtener más información, vea [Expresiones lambda](../../../csharp/language-reference/operators/lambda-expressions.md).</span><span class="sxs-lookup"><span data-stu-id="394a5-147">For more information, see [Lambda Expressions](../../../csharp/language-reference/operators/lambda-expressions.md).</span></span>  
  
 <span data-ttu-id="394a5-148">Este ejemplo usa <xref:System.Linq.Enumerable.Select%2A> para devolver todas las filas de `Product` y mostrar los nombres de producto.</span><span class="sxs-lookup"><span data-stu-id="394a5-148">This example uses <xref:System.Linq.Enumerable.Select%2A> to return all the rows from `Product` and display the product names.</span></span>  
  
 [!code-csharp[DP LINQ to DataSet Examples#SelectAnonymousTypes_MQ](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/CS/Program.cs#selectanonymoustypes_mq)]
 [!code-vb[DP LINQ to DataSet Examples#SelectAnonymousTypes_MQ](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/VB/Module1.vb#selectanonymoustypes_mq)]  
  
## <a name="composing-queries"></a><span data-ttu-id="394a5-149">Crear consultas</span><span class="sxs-lookup"><span data-stu-id="394a5-149">Composing Queries</span></span>  

 <span data-ttu-id="394a5-150">Tal y como se ha mencionado anteriormente en este tema, la variable de consulta solo almacena los comandos de la consulta cuando ésta se diseña para devolver una secuencia de valores.</span><span class="sxs-lookup"><span data-stu-id="394a5-150">As mentioned earlier in this topic, the query variable itself only stores the query commands when the query is designed to return a sequence of values.</span></span> <span data-ttu-id="394a5-151">Si la consulta no contiene un método que cause una ejecución inmediata, la ejecución real de la consulta se aplaza hasta que la variable de consulta se recorra en iteración en un bucle `foreach` o `For Each`.</span><span class="sxs-lookup"><span data-stu-id="394a5-151">If the query does not contain a method that will cause immediate execution, the actual execution of the query is deferred until you iterate over the query variable in a `foreach` or `For Each` loop.</span></span> <span data-ttu-id="394a5-152">La ejecución aplazada permite combinar varias consultas o ampliar una consulta.</span><span class="sxs-lookup"><span data-stu-id="394a5-152">Deferred execution enables multiple queries to be combined or a query to be extended.</span></span> <span data-ttu-id="394a5-153">Cuando se amplía una consulta, se modifica para incluir las nuevas operaciones. La ejecución eventual reflejará los cambios.</span><span class="sxs-lookup"><span data-stu-id="394a5-153">When a query is extended, it is modified to include the new operations, and the eventual execution will reflect the changes.</span></span> <span data-ttu-id="394a5-154">En el siguiente ejemplo, la primera consulta devuelve todos los productos.</span><span class="sxs-lookup"><span data-stu-id="394a5-154">In the following example, the first query returns all the products.</span></span> <span data-ttu-id="394a5-155">La segunda consulta amplía la primera usando `Where` para devolver todos los productos del tamaño "L":</span><span class="sxs-lookup"><span data-stu-id="394a5-155">The second query extends the first by using `Where` to return all the products of size "L":</span></span>  
  
 [!code-csharp[DP LINQ to DataSet Examples#Composing](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/CS/Program.cs#composing)]
 [!code-vb[DP LINQ to DataSet Examples#Composing](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/VB/Module1.vb#composing)]  
  
 <span data-ttu-id="394a5-156">Una vez que se ha ejecutado una consulta, no se pueden crear consultas adicionales y todas las consultas posteriores utilizarán los operadores de LINQ en memoria.</span><span class="sxs-lookup"><span data-stu-id="394a5-156">After a query has been executed, no additional queries can be composed, and all subsequent queries will use the in-memory LINQ operators.</span></span> <span data-ttu-id="394a5-157">La ejecución de la consulta se producirá cuando se recorra en iteración la variable de consulta en una `foreach` `For Each` instrucción o, o mediante una llamada a uno de los operadores de conversión de LINQ que causan la ejecución inmediata.</span><span class="sxs-lookup"><span data-stu-id="394a5-157">Query execution will occur when you iterate over the query variable in a `foreach` or `For Each` statement, or by a call to one of the LINQ conversion operators that cause immediate execution.</span></span> <span data-ttu-id="394a5-158">Entre estos operadores se incluyen los siguientes: <xref:System.Linq.Enumerable.ToList%2A>, <xref:System.Linq.Enumerable.ToArray%2A>, <xref:System.Linq.Enumerable.ToLookup%2A> y <xref:System.Linq.Enumerable.ToDictionary%2A>.</span><span class="sxs-lookup"><span data-stu-id="394a5-158">These operators include the following: <xref:System.Linq.Enumerable.ToList%2A>, <xref:System.Linq.Enumerable.ToArray%2A>, <xref:System.Linq.Enumerable.ToLookup%2A>, and <xref:System.Linq.Enumerable.ToDictionary%2A>.</span></span>  
  
 <span data-ttu-id="394a5-159">En el siguiente ejemplo, la primera consulta devuelve todos los productos ordenados por el precio de la lista.</span><span class="sxs-lookup"><span data-stu-id="394a5-159">In the following example, the first query returns all the products ordered by list price.</span></span> <span data-ttu-id="394a5-160">El método <xref:System.Linq.Enumerable.ToArray%2A> se usa para forzar la ejecución inmediata de la consulta:</span><span class="sxs-lookup"><span data-stu-id="394a5-160">The <xref:System.Linq.Enumerable.ToArray%2A> method is used to force immediate query execution:</span></span>  
  
 [!code-csharp[DP LINQ to DataSet Examples#ToArray2](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/CS/Program.cs#toarray2)]
 [!code-vb[DP LINQ to DataSet Examples#ToArray2](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/VB/Module1.vb#toarray2)]  
  
## <a name="see-also"></a><span data-ttu-id="394a5-161">Consulte también</span><span class="sxs-lookup"><span data-stu-id="394a5-161">See also</span></span>

- [<span data-ttu-id="394a5-162">Guía de programación</span><span class="sxs-lookup"><span data-stu-id="394a5-162">Programming Guide</span></span>](programming-guide-linq-to-dataset.md)
- [<span data-ttu-id="394a5-163">Consulta de conjuntos de datos</span><span class="sxs-lookup"><span data-stu-id="394a5-163">Querying DataSets</span></span>](querying-datasets-linq-to-dataset.md)
- [<span data-ttu-id="394a5-164">Introducción a LINQ en C#</span><span class="sxs-lookup"><span data-stu-id="394a5-164">Getting Started with LINQ in C#</span></span>](../../../csharp/programming-guide/concepts/linq/index.md)
- [<span data-ttu-id="394a5-165">Introducción a LINQ en Visual Basic</span><span class="sxs-lookup"><span data-stu-id="394a5-165">Getting Started with LINQ in Visual Basic</span></span>](../../../visual-basic/programming-guide/concepts/linq/getting-started-with-linq.md)
