---
title: Generar comandos con objetos CommandBuilder
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: 6e3fb8b5-373b-4f9e-ab03-a22693df8e91
ms.openlocfilehash: d88f5772e038766d49baf8c758c547e6d5667904
ms.sourcegitcommit: 5b475c1855b32cf78d2d1bbb4295e4c236f39464
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/24/2020
ms.locfileid: "91200724"
---
# <a name="generating-commands-with-commandbuilders"></a><span data-ttu-id="9df36-102">Generar comandos con objetos CommandBuilder</span><span class="sxs-lookup"><span data-stu-id="9df36-102">Generating Commands with CommandBuilders</span></span>

<span data-ttu-id="9df36-103">Cuando la propiedad `SelectCommand` se especifica de forma dinámica en tiempo de ejecución, por ejemplo a través de una herramienta de consulta que acepta un comando de texto del usuario, existe la posibilidad de que no se pueda especificar adecuadamente en tiempo de diseño el comando `InsertCommand`, `UpdateCommand` o `DeleteCommand` correspondiente.</span><span class="sxs-lookup"><span data-stu-id="9df36-103">When the `SelectCommand` property is dynamically specified at run time, such as through a query tool that takes a textual command from the user, you may not be able to specify the appropriate `InsertCommand`, `UpdateCommand`, or `DeleteCommand` at design time.</span></span> <span data-ttu-id="9df36-104">Si el objeto <xref:System.Data.DataTable> se asigna a una única tabla de base de datos o se genera a partir de ella, puede utilizar el objeto <xref:System.Data.Common.DbCommandBuilder> para generar automáticamente las propiedades `DeleteCommand`, `InsertCommand` y `UpdateCommand` de <xref:System.Data.Common.DbDataAdapter>.</span><span class="sxs-lookup"><span data-stu-id="9df36-104">If your <xref:System.Data.DataTable> maps to or is generated from a single database table, you can take advantage of the <xref:System.Data.Common.DbCommandBuilder> object to automatically generate the `DeleteCommand`, `InsertCommand`, and `UpdateCommand` of the <xref:System.Data.Common.DbDataAdapter>.</span></span>  
  
 <span data-ttu-id="9df36-105">El requisito mínimo para que la generación automática de comandos funcione correctamente consiste en establecer la propiedad `SelectCommand`.</span><span class="sxs-lookup"><span data-stu-id="9df36-105">As a minimum requirement, you must set the `SelectCommand` property in order for automatic command generation to work.</span></span> <span data-ttu-id="9df36-106">El esquema de tabla que recupera la propiedad `SelectCommand` determina la sintaxis de las instrucciones INSERT, UPDATE y DELETE generadas automáticamente.</span><span class="sxs-lookup"><span data-stu-id="9df36-106">The table schema retrieved by the `SelectCommand` property determines the syntax of the automatically generated INSERT, UPDATE, and DELETE statements.</span></span>  
  
 <span data-ttu-id="9df36-107"><xref:System.Data.Common.DbCommandBuilder> debe ejecutar `SelectCommand` con el objeto de devolver los metadatos necesarios para construir los comandos SQL INSERT, UPDATE y DELETE.</span><span class="sxs-lookup"><span data-stu-id="9df36-107">The <xref:System.Data.Common.DbCommandBuilder> must execute the `SelectCommand` in order to return the metadata necessary to construct the INSERT, UPDATE, and DELETE SQL commands.</span></span> <span data-ttu-id="9df36-108">Por eso es necesario realizar un viaje adicional al origen de datos, con el consiguiente efecto adverso en el rendimiento.</span><span class="sxs-lookup"><span data-stu-id="9df36-108">As a result, an extra trip to the data source is necessary, and this can hinder performance.</span></span> <span data-ttu-id="9df36-109">Para mejorar el rendimiento, debe especificar los comandos de forma explícita, en lugar de utilizar <xref:System.Data.Common.DbCommandBuilder>.</span><span class="sxs-lookup"><span data-stu-id="9df36-109">To achieve optimal performance, specify your commands explicitly rather than using the <xref:System.Data.Common.DbCommandBuilder>.</span></span>  
  
 <span data-ttu-id="9df36-110">`SelectCommand` también debe devolver como mínimo una clave principal o una columna única.</span><span class="sxs-lookup"><span data-stu-id="9df36-110">The `SelectCommand` must also return at least one primary key or unique column.</span></span> <span data-ttu-id="9df36-111">Si no hay ninguna, se genera una excepción `InvalidOperation` y no se genera ningún comando.</span><span class="sxs-lookup"><span data-stu-id="9df36-111">If none are present, an `InvalidOperation` exception is generated, and the commands are not generated.</span></span>  
  
 <span data-ttu-id="9df36-112">Cuando se asocia con un objeto `DataAdapter`, <xref:System.Data.Common.DbCommandBuilder> genera automáticamente las propiedades `InsertCommand`, `UpdateCommand` y `DeleteCommand` del objeto `DataAdapter` si son referencias nulas.</span><span class="sxs-lookup"><span data-stu-id="9df36-112">When associated with a `DataAdapter`, the <xref:System.Data.Common.DbCommandBuilder> automatically generates the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties of the `DataAdapter` if they are null references.</span></span> <span data-ttu-id="9df36-113">Si ya existe algún objeto `Command` para una propiedad, se utilizará el objeto `Command` existente.</span><span class="sxs-lookup"><span data-stu-id="9df36-113">If a `Command` already exists for a property, the existing `Command` is used.</span></span>  
  
 <span data-ttu-id="9df36-114">Las vistas de bases de datos creadas al unir una o varias tablas no se consideran una tabla única de base de datos.</span><span class="sxs-lookup"><span data-stu-id="9df36-114">Database views that are created by joining two or more tables together are not considered a single database table.</span></span> <span data-ttu-id="9df36-115">En este caso no puede utilizar <xref:System.Data.Common.DbCommandBuilder> para generar comandos automáticamente y deberá especificarlos de manera explícita.</span><span class="sxs-lookup"><span data-stu-id="9df36-115">In this instance you cannot use the <xref:System.Data.Common.DbCommandBuilder> to automatically generate commands; you must specify your commands explicitly.</span></span> <span data-ttu-id="9df36-116">Para obtener información acerca de cómo establecer explícitamente los comandos para resolver las actualizaciones en `DataSet` el origen de datos, vea [Actualizar orígenes de datos con DataAdapters](updating-data-sources-with-dataadapters.md).</span><span class="sxs-lookup"><span data-stu-id="9df36-116">For information about explicitly setting commands to resolve updates to a `DataSet` back to the data source, see [Updating Data Sources with DataAdapters](updating-data-sources-with-dataadapters.md).</span></span>  
  
 <span data-ttu-id="9df36-117">Es posible que desee asignar parámetros de salida a la fila actualizada de un `DataSet`.</span><span class="sxs-lookup"><span data-stu-id="9df36-117">You might want to map output parameters back to the updated row of a `DataSet`.</span></span> <span data-ttu-id="9df36-118">Una tarea habitual consiste en recuperar, a partir del origen de datos, el valor de un campo de identidad de generación automática o una marca de tiempo.</span><span class="sxs-lookup"><span data-stu-id="9df36-118">One common task would be retrieving the value of an automatically generated identity field or time stamp from the data source.</span></span> <span data-ttu-id="9df36-119"><xref:System.Data.Common.DbCommandBuilder> no asigna de forma predeterminada los parámetros de salida a las columnas de una fila actualizada.</span><span class="sxs-lookup"><span data-stu-id="9df36-119">The <xref:System.Data.Common.DbCommandBuilder> will not map output parameters to columns in an updated row by default.</span></span> <span data-ttu-id="9df36-120">En este caso, debe especificar el comando de forma explícita.</span><span class="sxs-lookup"><span data-stu-id="9df36-120">In this instance you must specify your command explicitly.</span></span> <span data-ttu-id="9df36-121">Para obtener un ejemplo de asignación de un campo de identidad generado automáticamente a una columna de una fila insertada, vea [recuperar valores de identidad o Autonuméricos](retrieving-identity-or-autonumber-values.md).</span><span class="sxs-lookup"><span data-stu-id="9df36-121">For an example of mapping an automatically generated identity field back to a column of an inserted row, see [Retrieving Identity or Autonumber Values](retrieving-identity-or-autonumber-values.md).</span></span>  
  
## <a name="rules-for-automatically-generated-commands"></a><span data-ttu-id="9df36-122">Reglas para comandos generados automáticamente</span><span class="sxs-lookup"><span data-stu-id="9df36-122">Rules for Automatically Generated Commands</span></span>  

 <span data-ttu-id="9df36-123">En la tabla siguiente se muestran las reglas de la generación automática de comandos.</span><span class="sxs-lookup"><span data-stu-id="9df36-123">The following table shows the rules for how automatically generated commands are generated.</span></span>  
  
|<span data-ttu-id="9df36-124">Get-Help</span><span class="sxs-lookup"><span data-stu-id="9df36-124">Command</span></span>|<span data-ttu-id="9df36-125">Regla</span><span class="sxs-lookup"><span data-stu-id="9df36-125">Rule</span></span>|  
|-------------|----------|  
|`InsertCommand`|<span data-ttu-id="9df36-126">Inserta una fila en el origen de datos para todas las filas de la tabla con una <xref:System.Data.DataRow.RowState%2A> con el valor <xref:System.Data.DataRowState.Added>.</span><span class="sxs-lookup"><span data-stu-id="9df36-126">Inserts a row at the data source for all rows in the table with a <xref:System.Data.DataRow.RowState%2A> of <xref:System.Data.DataRowState.Added>.</span></span> <span data-ttu-id="9df36-127">Inserta valores para todas las columnas actualizables, pero no para determinadas columnas como identidades, expresiones o marcas de tiempo.</span><span class="sxs-lookup"><span data-stu-id="9df36-127">Inserts values for all columns that are updateable (but not columns such as identities, expressions, or timestamps).</span></span>|  
|`UpdateCommand`|<span data-ttu-id="9df36-128">Actualiza filas en el origen de datos para todas las filas de la tabla con una propiedad `RowState` con el valor <xref:System.Data.DataRowState.Modified>.</span><span class="sxs-lookup"><span data-stu-id="9df36-128">Updates rows at the data source for all rows in the table with a `RowState` of <xref:System.Data.DataRowState.Modified>.</span></span> <span data-ttu-id="9df36-129">Actualiza los valores de todas las columnas, con excepción de las que no son actualizables, como identidades o expresiones.</span><span class="sxs-lookup"><span data-stu-id="9df36-129">Updates the values of all columns except for columns that are not updateable, such as identities or expressions.</span></span> <span data-ttu-id="9df36-130">Actualiza todas las filas en las que los valores de columna en el origen de datos coinciden con los valores de la columna de clave principal de la fila, siempre que las restantes columnas del origen de datos coincidan con los valores originales de la fila.</span><span class="sxs-lookup"><span data-stu-id="9df36-130">Updates all rows where the column values at the data source match the primary key column values of the row, and where the remaining columns at the data source match the original values of the row.</span></span> <span data-ttu-id="9df36-131">Para obtener más información, vea la sección "Modelo de simultaneidad optimista para actualizaciones y eliminaciones" de este mismo tema.</span><span class="sxs-lookup"><span data-stu-id="9df36-131">For more information, see "Optimistic Concurrency Model for Updates and Deletes," later in this topic.</span></span>|  
|`DeleteCommand`|<span data-ttu-id="9df36-132">Elimina filas en el origen de datos para todas las filas de la tabla con una propiedad `RowState` con el valor <xref:System.Data.DataRowState.Deleted>.</span><span class="sxs-lookup"><span data-stu-id="9df36-132">Deletes rows at the data source for all rows in the table with a `RowState` of <xref:System.Data.DataRowState.Deleted>.</span></span> <span data-ttu-id="9df36-133">Elimina todas las filas en las que los valores de columna coinciden con los valores de la columna de clave principal de la fila, siempre que las restantes columnas del origen de datos coincidan con los valores originales de la fila.</span><span class="sxs-lookup"><span data-stu-id="9df36-133">Deletes all rows where the column values match the primary key column values of the row, and where the remaining columns at the data source match the original values of the row.</span></span> <span data-ttu-id="9df36-134">Para obtener más información, vea la sección "Modelo de simultaneidad optimista para actualizaciones y eliminaciones" de este mismo tema.</span><span class="sxs-lookup"><span data-stu-id="9df36-134">For more information, see "Optimistic Concurrency Model for Updates and Deletes," later in this topic.</span></span>|  
  
## <a name="optimistic-concurrency-model-for-updates-and-deletes"></a><span data-ttu-id="9df36-135">Modelo de simultaneidad optimista para actualizaciones y eliminaciones</span><span class="sxs-lookup"><span data-stu-id="9df36-135">Optimistic Concurrency Model for Updates and Deletes</span></span>  

 <span data-ttu-id="9df36-136">La lógica para generar comandos automáticamente para las instrucciones UPDATE y DELETE se basa en la *simultaneidad optimista*, es decir, los registros no se bloquean para su edición y pueden ser modificados por otros usuarios o procesos en cualquier momento.</span><span class="sxs-lookup"><span data-stu-id="9df36-136">The logic for generating commands automatically for UPDATE and DELETE statements is based on *optimistic concurrency*--that is, records are not locked for editing and can be modified by other users or processes at any time.</span></span> <span data-ttu-id="9df36-137">Dado que existe la posibilidad de que un registro haya sido modificado después de que haya sido devuelto por la instrucción SELECT y antes de que se emita la instrucción UPDATE o DELETE, la instrucción UPDATE o DELETE generada automáticamente incluye una cláusula WHERE que especifica que la fila solo se actualiza cuando contiene todos los valores originales y no ha sido eliminada del origen de datos.</span><span class="sxs-lookup"><span data-stu-id="9df36-137">Because a record could have been modified after it was returned from the SELECT statement, but before the UPDATE or DELETE statement is issued, the automatically generated UPDATE or DELETE statement contains a WHERE clause, specifying that a row is only updated if it contains all original values and has not been deleted from the data source.</span></span> <span data-ttu-id="9df36-138">Esto evita que se sobrescriban los datos nuevos.</span><span class="sxs-lookup"><span data-stu-id="9df36-138">This is done to avoid overwriting new data.</span></span> <span data-ttu-id="9df36-139">Si una actualización generada automáticamente intenta actualizar una fila que ha sido eliminada o que no contiene los valores originales del <xref:System.Data.DataSet>, el comando no tienen ningún efecto en los registros y se inicia una excepción <xref:System.Data.DBConcurrencyException>.</span><span class="sxs-lookup"><span data-stu-id="9df36-139">Where an automatically generated update attempts to update a row that has been deleted or that does not contain the original values found in the <xref:System.Data.DataSet>, the command does not affect any records, and a <xref:System.Data.DBConcurrencyException> is thrown.</span></span>  
  
 <span data-ttu-id="9df36-140">Si desea que la instrucción UPDATE o DELETE se ejecute sin tener en cuenta los valores originales, debe establecer de forma explícita la propiedad `UpdateCommand` del `DataAdapter` sin utilizar la generación automática de comandos.</span><span class="sxs-lookup"><span data-stu-id="9df36-140">If you want the UPDATE or DELETE to complete regardless of original values, you must explicitly set the `UpdateCommand` for the `DataAdapter` and not rely on automatic command generation.</span></span>  
  
## <a name="limitations-of-automatic-command-generation-logic"></a><span data-ttu-id="9df36-141">Limitaciones de la lógica de generación automática de comandos</span><span class="sxs-lookup"><span data-stu-id="9df36-141">Limitations of Automatic Command Generation Logic</span></span>  

 <span data-ttu-id="9df36-142">La generación automática de comandos tiene las siguientes limitaciones.</span><span class="sxs-lookup"><span data-stu-id="9df36-142">The following limitations apply to automatic command generation.</span></span>  
  
### <a name="unrelated-tables-only"></a><span data-ttu-id="9df36-143">Solo tablas no relacionadas</span><span class="sxs-lookup"><span data-stu-id="9df36-143">Unrelated Tables Only</span></span>  

 <span data-ttu-id="9df36-144">La lógica de generación automática de comandos crea instrucciones INSERT, UPDATE o DELETE para tablas independientes sin tener en cuenta las relaciones que éstas puedan tener con otras tablas en el origen de datos.</span><span class="sxs-lookup"><span data-stu-id="9df36-144">The automatic command generation logic generates INSERT, UPDATE, or DELETE statements for stand-alone tables without taking into account any relationships to other tables at the data source.</span></span> <span data-ttu-id="9df36-145">Por eso, se puede producir un error al llamar a `Update` para realizar cambios en una columna que participa de una restricción de clave externa en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="9df36-145">As a result, you may encounter a failure when calling `Update` to submit changes for a column that participates in a foreign key constraint in the database.</span></span> <span data-ttu-id="9df36-146">Para evitar esa excepción, no utilice <xref:System.Data.Common.DbCommandBuilder> al actualizar las columnas que participan en una restricción de clave externa. En este caso debe especificar de forma explícita las instrucciones que se van a utilizar para llevar a cabo la operación.</span><span class="sxs-lookup"><span data-stu-id="9df36-146">To avoid this exception, do not use the <xref:System.Data.Common.DbCommandBuilder> for updating columns involved in a foreign key constraint; instead, explicitly specify the statements used to perform the operation.</span></span>  
  
### <a name="table-and-column-names"></a><span data-ttu-id="9df36-147">Nombres de tabla y columna</span><span class="sxs-lookup"><span data-stu-id="9df36-147">Table and Column Names</span></span>  

 <span data-ttu-id="9df36-148">La lógica de generación automática de comandos puede ocasionar un error cuando los nombres de las tablas o de las columnas incluyen algún carácter especial, como espacios, puntos, comillas y otros caracteres no alfanuméricos, incluso si están delimitados por corchetes.</span><span class="sxs-lookup"><span data-stu-id="9df36-148">Automatic command generation logic may fail if column names or table names contain any special characters, such as spaces, periods, quotation marks, or other nonalphanumeric characters, even if delimited by brackets.</span></span> <span data-ttu-id="9df36-149">En función del proveedor, el establecimiento de los parámetros QuotePrefix y QuoteSuffix puede permitir que la lógica de generación procese espacios, pero los caracteres especiales no pueden convertirse en caracteres de escape.</span><span class="sxs-lookup"><span data-stu-id="9df36-149">Depending on the provider, setting the QuotePrefix and QuoteSuffix parameters may allow the generation logic to process spaces, but it cannot escape special characters.</span></span> <span data-ttu-id="9df36-150">Se admiten nombres de tabla completos con el formato *Catalog. Schema. Table* .</span><span class="sxs-lookup"><span data-stu-id="9df36-150">Fully qualified table names in the form of *catalog.schema.table* are supported.</span></span>  
  
## <a name="using-the-commandbuilder-to-automatically-generate-an-sql-statement"></a><span data-ttu-id="9df36-151">Utilizar CommandBuilder para generar automáticamente una instrucción SQL</span><span class="sxs-lookup"><span data-stu-id="9df36-151">Using the CommandBuilder to Automatically Generate an SQL Statement</span></span>  

 <span data-ttu-id="9df36-152">Para generar instrucciones SQL automáticamente para un `DataAdapter`, defina en primer lugar la propiedad `SelectCommand` del `DataAdapter` y, a continuación, cree un objeto `CommandBuilder` y especifique como argumento el `DataAdapter` para el que `CommandBuilder` generará automáticamente las instrucciones SQL.</span><span class="sxs-lookup"><span data-stu-id="9df36-152">To automatically generate SQL statements for a `DataAdapter`, first set the `SelectCommand` property of the `DataAdapter`, then create a `CommandBuilder` object, and specify as an argument the `DataAdapter` for which the `CommandBuilder` will automatically generate SQL statements.</span></span>  
  
```vb  
' Assumes that connection is a valid SqlConnection object
' inside of a Using block.  
Dim adapter As SqlDataAdapter = New SqlDataAdapter( _  
  "SELECT * FROM dbo.Customers", connection)  
Dim builder As SqlCommandBuilder = New SqlCommandBuilder(adapter)  
builder.QuotePrefix = "["  
builder.QuoteSuffix = "]"  
```  
  
```csharp  
// Assumes that connection is a valid SqlConnection object  
// inside of a using block.  
SqlDataAdapter adapter = new SqlDataAdapter(  
  "SELECT * FROM dbo.Customers", connection);  
SqlCommandBuilder builder = new SqlCommandBuilder(adapter);  
builder.QuotePrefix = "[";  
builder.QuoteSuffix = "]";  
```  
  
## <a name="modifying-the-selectcommand"></a><span data-ttu-id="9df36-153">Modificar SelectCommand</span><span class="sxs-lookup"><span data-stu-id="9df36-153">Modifying the SelectCommand</span></span>  

 <span data-ttu-id="9df36-154">Es posible que se inicie una excepción si modifica valor `CommandText` de `SelectCommand` después de generar automáticamente los comandos INSERT, UPDATE o DELETE.</span><span class="sxs-lookup"><span data-stu-id="9df36-154">If you modify the `CommandText` of the `SelectCommand` after the INSERT, UPDATE, or DELETE commands have been automatically generated, an exception may occur.</span></span> <span data-ttu-id="9df36-155">Si el valor `SelectCommand.CommandText` modificado contiene información del esquema que sea incoherente con el valor `SelectCommand.CommandText` utilizado en el momento de la generación automática de los comandos de inserción, actualización o eliminación, las futuras llamadas al método `DataAdapter.Update` pueden tratar de obtener acceso a columnas que ya no existen en la tabla actual a la que hace referencia `SelectCommand`, con lo que se iniciará una excepción.</span><span class="sxs-lookup"><span data-stu-id="9df36-155">If the modified `SelectCommand.CommandText` contains schema information that is inconsistent with the `SelectCommand.CommandText` used when the insert, update, or delete commands were automatically generated, future calls to the `DataAdapter.Update` method may attempt to access columns that no longer exist in the current table referenced by the `SelectCommand`, and an exception will be thrown.</span></span>  
  
 <span data-ttu-id="9df36-156">Puede actualizar la información del esquema que utiliza `CommandBuilder` para generar automáticamente los comandos; para ello, basta con llamar al método `RefreshSchema` de `CommandBuilder`.</span><span class="sxs-lookup"><span data-stu-id="9df36-156">You can refresh the schema information used by the `CommandBuilder` to automatically generate commands by calling the `RefreshSchema` method of the `CommandBuilder`.</span></span>  
  
 <span data-ttu-id="9df36-157">Si desea conocer el comando generado automáticamente, puede obtener una referencia a los comandos generados automáticamente mediante los métodos `GetInsertCommand`, `GetUpdateCommand` y `GetDeleteCommand` del objeto `CommandBuilder` y la comprobación de la propiedad `CommandText` del comando asociado.</span><span class="sxs-lookup"><span data-stu-id="9df36-157">If you want to know what command was automatically generated, you can obtain a reference to the automatically generated commands by using the `GetInsertCommand`, `GetUpdateCommand`, and `GetDeleteCommand` methods of the `CommandBuilder` object and checking the `CommandText` property of the associated command.</span></span>  
  
 <span data-ttu-id="9df36-158">En el ejemplo de código siguiente se escribe en la consola el comando de actualización generado automáticamente.</span><span class="sxs-lookup"><span data-stu-id="9df36-158">The following code example writes to the console the update command that was automatically generated.</span></span>  
  
```vb
Console.WriteLine(builder.GetUpdateCommand().CommandText)  
```

```csharp
Console.WriteLine(builder.GetUpdateCommand().CommandText);
```
  
 <span data-ttu-id="9df36-159">En el siguiente ejemplo se vuelve a crear la tabla `Customers` en el conjunto de datos `custDS`.</span><span class="sxs-lookup"><span data-stu-id="9df36-159">The following example recreates the `Customers` table in the `custDS` dataset.</span></span> <span data-ttu-id="9df36-160">Se llama al método **RefreshSchema** para actualizar los comandos generados automáticamente con esta nueva información de columna.</span><span class="sxs-lookup"><span data-stu-id="9df36-160">The **RefreshSchema** method is called to refresh the automatically generated commands with this new column information.</span></span>  
  
```vb  
' Assumes an open SqlConnection and SqlDataAdapter inside of a Using block.  
adapter.SelectCommand.CommandText = _  
  "SELECT CustomerID, ContactName FROM dbo.Customers"  
builder.RefreshSchema()  
  
custDS.Tables.Remove(custDS.Tables("Customers"))  
adapter.Fill(custDS, "Customers")  
```  
  
```csharp  
// Assumes an open SqlConnection and SqlDataAdapter inside of a using block.  
adapter.SelectCommand.CommandText =
  "SELECT CustomerID, ContactName FROM dbo.Customers";  
builder.RefreshSchema();  
  
custDS.Tables.Remove(custDS.Tables["Customers"]);  
adapter.Fill(custDS, "Customers");  
```  
  
## <a name="see-also"></a><span data-ttu-id="9df36-161">Consulte también</span><span class="sxs-lookup"><span data-stu-id="9df36-161">See also</span></span>

- [<span data-ttu-id="9df36-162">Comandos y parámetros</span><span class="sxs-lookup"><span data-stu-id="9df36-162">Commands and Parameters</span></span>](commands-and-parameters.md)
- [<span data-ttu-id="9df36-163">Ejecutar un comando</span><span class="sxs-lookup"><span data-stu-id="9df36-163">Executing a Command</span></span>](executing-a-command.md)
- [<span data-ttu-id="9df36-164">DbConnection, DbCommand y DbException</span><span class="sxs-lookup"><span data-stu-id="9df36-164">DbConnection, DbCommand and DbException</span></span>](dbconnection-dbcommand-and-dbexception.md)
- [<span data-ttu-id="9df36-165">Información general de ADO.NET</span><span class="sxs-lookup"><span data-stu-id="9df36-165">ADO.NET Overview</span></span>](ado-net-overview.md)
