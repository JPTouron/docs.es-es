---
title: Sintaxis de cadenas de conexión
description: Obtenga información sobre la sintaxis de las cadenas de conexión en ADO.NET. La sintaxis de cada proveedor se documenta en la propiedad ConnectionString.
ms.date: 05/22/2018
ms.assetid: 0977aeee-04d1-4cce-bbed-750c77fce06e
ms.openlocfilehash: 5942307535e9a6e10009f193289daf94a07cd950
ms.sourcegitcommit: 5b475c1855b32cf78d2d1bbb4295e4c236f39464
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/24/2020
ms.locfileid: "91148415"
---
# <a name="connection-string-syntax"></a><span data-ttu-id="f57c3-104">Sintaxis de cadenas de conexión</span><span class="sxs-lookup"><span data-stu-id="f57c3-104">Connection String Syntax</span></span>

<span data-ttu-id="f57c3-105">Cada proveedor de datos .NET Framework tiene un objeto `Connection` que hereda de la clase <xref:System.Data.Common.DbConnection>, así como una propiedad <xref:System.Data.Common.DbConnection.ConnectionString%2A> específica del proveedor.</span><span class="sxs-lookup"><span data-stu-id="f57c3-105">Each .NET Framework data provider has a `Connection` object that inherits from <xref:System.Data.Common.DbConnection> as well as a provider-specific <xref:System.Data.Common.DbConnection.ConnectionString%2A> property.</span></span> <span data-ttu-id="f57c3-106">La sintaxis de la cadena de conexión específica de cada proveedor se indica en su propiedad `ConnectionString`.</span><span class="sxs-lookup"><span data-stu-id="f57c3-106">The specific connection string syntax for each provider is documented in its `ConnectionString` property.</span></span> <span data-ttu-id="f57c3-107">En la tabla siguiente se muestran los cuatro proveedores de datos que se incluyen en .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="f57c3-107">The following table lists the four data providers that are included in the .NET Framework.</span></span>  
  
|<span data-ttu-id="f57c3-108">proveedor de datos de .NET Framework (.NET Framework data provider)</span><span class="sxs-lookup"><span data-stu-id="f57c3-108">.NET Framework data provider</span></span>|<span data-ttu-id="f57c3-109">Descripción</span><span class="sxs-lookup"><span data-stu-id="f57c3-109">Description</span></span>|  
|----------------------------------|-----------------|  
|<xref:System.Data.SqlClient>|<span data-ttu-id="f57c3-110">Proporciona acceso de datos para Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="f57c3-110">Provides data access for Microsoft SQL Server.</span></span> <span data-ttu-id="f57c3-111">Para obtener más información acerca de la sintaxis de la cadena de conexión, vea <xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A>.</span><span class="sxs-lookup"><span data-stu-id="f57c3-111">For more information on connection string syntax, see <xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A>.</span></span>|  
|<xref:System.Data.OleDb>|<span data-ttu-id="f57c3-112">Proporciona acceso de datos para orígenes de datos que se exponen mediante OLE DB.</span><span class="sxs-lookup"><span data-stu-id="f57c3-112">Provides data access for data sources exposed using OLE DB.</span></span> <span data-ttu-id="f57c3-113">Para obtener más información acerca de la sintaxis de la cadena de conexión, vea <xref:System.Data.OleDb.OleDbConnection.ConnectionString%2A>.</span><span class="sxs-lookup"><span data-stu-id="f57c3-113">For more information on connection string syntax, see <xref:System.Data.OleDb.OleDbConnection.ConnectionString%2A>.</span></span>|  
|<xref:System.Data.Odbc>|<span data-ttu-id="f57c3-114">Proporciona acceso de datos para orígenes de datos que se exponen mediante ODBC.</span><span class="sxs-lookup"><span data-stu-id="f57c3-114">Provides data access for data sources exposed using ODBC.</span></span> <span data-ttu-id="f57c3-115">Para obtener más información acerca de la sintaxis de la cadena de conexión, vea <xref:System.Data.Odbc.OdbcConnection.ConnectionString%2A>.</span><span class="sxs-lookup"><span data-stu-id="f57c3-115">For more information on connection string syntax, see <xref:System.Data.Odbc.OdbcConnection.ConnectionString%2A>.</span></span>|  
|<xref:System.Data.OracleClient>|<span data-ttu-id="f57c3-116">Proporciona acceso de datos para Oracle versión 8.1.7 o superior.</span><span class="sxs-lookup"><span data-stu-id="f57c3-116">Provides data access for Oracle version 8.1.7 or later.</span></span> <span data-ttu-id="f57c3-117">Para obtener más información acerca de la sintaxis de la cadena de conexión, vea <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A>.</span><span class="sxs-lookup"><span data-stu-id="f57c3-117">For more information on connection string syntax, see <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A>.</span></span>|  
  
## <a name="connection-string-builders"></a><span data-ttu-id="f57c3-118">Generadores de cadenas de conexión</span><span class="sxs-lookup"><span data-stu-id="f57c3-118">Connection String Builders</span></span>  

 <span data-ttu-id="f57c3-119">ADO.NET 2.0 presentó los siguientes compiladores de cadenas de conexión para los proveedores de datos .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="f57c3-119">ADO.NET 2.0 introduced the following connection string builders for the .NET Framework data providers.</span></span>  
  
- <xref:System.Data.SqlClient.SqlConnectionStringBuilder>  
  
- <xref:System.Data.OleDb.OleDbConnectionStringBuilder>  
  
- <xref:System.Data.Odbc.OdbcConnectionStringBuilder>  
  
- <xref:System.Data.OracleClient.OracleConnectionStringBuilder>  
  
 <span data-ttu-id="f57c3-120">Los compiladores de cadenas de conexión permiten crear cadenas de conexión sintácticamente válidas en tiempo de ejecución. Por tanto, el usuario no tiene que concatenar manualmente los valores de las cadenas de conexión del código.</span><span class="sxs-lookup"><span data-stu-id="f57c3-120">The connection string builders allow you to construct syntactically valid connection strings at run time, so you do not have to manually concatenate connection string values in your code.</span></span> <span data-ttu-id="f57c3-121">Para obtener más información, vea [Generadores de cadenas de conexión](connection-string-builders.md).</span><span class="sxs-lookup"><span data-stu-id="f57c3-121">For more information, see [Connection String Builders](connection-string-builders.md).</span></span>  

## <a name="windows-authentication"></a><span data-ttu-id="f57c3-122">Autenticación de Windows</span><span class="sxs-lookup"><span data-stu-id="f57c3-122">Windows Authentication</span></span>  

 <span data-ttu-id="f57c3-123">Se recomienda usar la autenticación de Windows (a veces denominada *seguridad integrada*) para conectarse a los orígenes de datos que lo admiten.</span><span class="sxs-lookup"><span data-stu-id="f57c3-123">We recommend using Windows Authentication (sometimes referred to as *integrated security*) to connect to data sources that support it.</span></span> <span data-ttu-id="f57c3-124">La sintaxis utilizada en la cadena de conexión varía dependiendo del proveedor.</span><span class="sxs-lookup"><span data-stu-id="f57c3-124">The syntax employed in the connection string varies by provider.</span></span> <span data-ttu-id="f57c3-125">En la siguiente tabla se muestra la sintaxis de autenticación de Windows utilizada con los proveedores de datos .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="f57c3-125">The following table shows the Windows Authentication syntax used with the .NET Framework data providers.</span></span>  
  
|<span data-ttu-id="f57c3-126">Proveedor</span><span class="sxs-lookup"><span data-stu-id="f57c3-126">Provider</span></span>|<span data-ttu-id="f57c3-127">Syntax</span><span class="sxs-lookup"><span data-stu-id="f57c3-127">Syntax</span></span>|  
|--------------|------------|  
|`SqlClient`|`Integrated Security=true;`<br /><br /> `-- or --`<br /><br /> `Integrated Security=SSPI;`|  
|`OleDb`|`Integrated Security=SSPI;`|  
|`Odbc`|`Trusted_Connection=yes;`|  
|`OracleClient`|`Integrated Security=yes;`|  
  
> [!NOTE]
> <span data-ttu-id="f57c3-128">`Integrated Security=true` produce una excepción cuando se usa con el proveedor `OleDb`.</span><span class="sxs-lookup"><span data-stu-id="f57c3-128">`Integrated Security=true` throws an exception when used with the `OleDb` provider.</span></span>  
  
## <a name="sqlclient-connection-strings"></a><span data-ttu-id="f57c3-129">Cadenas de conexión SqlClient</span><span class="sxs-lookup"><span data-stu-id="f57c3-129">SqlClient Connection Strings</span></span>  

<span data-ttu-id="f57c3-130">La sintaxis de una cadena de conexión de <xref:System.Data.SqlClient.SqlConnection> se documenta en la propiedad <xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="f57c3-130">The syntax for a <xref:System.Data.SqlClient.SqlConnection> connection string is documented in the <xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="f57c3-131">Puede usar la propiedad <xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A> para obtener o establecer una cadena de conexión para una base de datos de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="f57c3-131">You can use the <xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A> property to get or set a connection string for a SQL Server database.</span></span> <span data-ttu-id="f57c3-132">Si necesita conectarse a una versión anterior de SQL Server, debe usar el proveedor de datos .NET Framework para OleDb (<xref:System.Data.OleDb>).</span><span class="sxs-lookup"><span data-stu-id="f57c3-132">If you need to connect to an earlier version of SQL Server, you must use the .NET Framework Data Provider for OleDb (<xref:System.Data.OleDb>).</span></span> <span data-ttu-id="f57c3-133">La mayoría de las palabras clave de cadenas de conexión se corresponden también con las propiedades de <xref:System.Data.SqlClient.SqlConnectionStringBuilder>.</span><span class="sxs-lookup"><span data-stu-id="f57c3-133">Most connection string keywords also map to properties in the <xref:System.Data.SqlClient.SqlConnectionStringBuilder>.</span></span>  

> [!IMPORTANT]
> <span data-ttu-id="f57c3-134">La configuración predeterminada de la `Persist Security Info` palabra clave es `false` .</span><span class="sxs-lookup"><span data-stu-id="f57c3-134">The default setting for the `Persist Security Info` keyword is `false`.</span></span> <span data-ttu-id="f57c3-135">Si se establece en `true` o `yes`, permite obtener información de seguridad confidencial de la conexión, incluidos el identificador de usuario y la contraseña, una vez abierta la conexión.</span><span class="sxs-lookup"><span data-stu-id="f57c3-135">Setting it to `true` or `yes` allows security-sensitive information, including the user ID and password, to be obtained from the connection after the connection has been opened.</span></span> <span data-ttu-id="f57c3-136">Mantenga `Persist Security Info` establecido en `false` para asegurarse de que un origen que no es de confianza no tiene acceso a información confidencial de la cadena de conexión.</span><span class="sxs-lookup"><span data-stu-id="f57c3-136">Keep `Persist Security Info` set to `false` to ensure that an untrusted source does not have access to sensitive connection string information.</span></span>  

### <a name="windows-authentication-with-sqlclient"></a><span data-ttu-id="f57c3-137">Autenticación de Windows con SqlClient</span><span class="sxs-lookup"><span data-stu-id="f57c3-137">Windows authentication with SqlClient</span></span>

 <span data-ttu-id="f57c3-138">Cada una de las siguientes formas de sintaxis utiliza la autenticación de Windows para conectarse a la base de datos **AdventureWorks** en un servidor local.</span><span class="sxs-lookup"><span data-stu-id="f57c3-138">Each of the following forms of syntax uses Windows Authentication to connect to the **AdventureWorks** database on a local server.</span></span>  
  
```csharp  
"Persist Security Info=False;Integrated Security=true;  
    Initial Catalog=AdventureWorks;Server=MSSQL1"  
"Persist Security Info=False;Integrated Security=SSPI;  
    database=AdventureWorks;server=(local)"  
"Persist Security Info=False;Trusted_Connection=True;  
    database=AdventureWorks;server=(local)"  
```  
  
### <a name="sql-server-authentication-with-sqlclient"></a><span data-ttu-id="f57c3-139">Autenticación SQL Server con SqlClient</span><span class="sxs-lookup"><span data-stu-id="f57c3-139">SQL Server authentication with SqlClient</span></span>

 <span data-ttu-id="f57c3-140">Es preferible utilizar la autenticación de Windows para conectarse a SQL Server.</span><span class="sxs-lookup"><span data-stu-id="f57c3-140">Windows Authentication is preferred for connecting to SQL Server.</span></span> <span data-ttu-id="f57c3-141">No obstante, si se requiere autenticación de SQL Server, deberá utilizar la siguiente sintaxis para especificar un nombre de usuario y una contraseña.</span><span class="sxs-lookup"><span data-stu-id="f57c3-141">However, if SQL Server Authentication is required, use the following syntax to specify a user name and password.</span></span> <span data-ttu-id="f57c3-142">En este ejemplo, los asteriscos representan un nombre de usuario y una contraseña válidos.</span><span class="sxs-lookup"><span data-stu-id="f57c3-142">In this example, asterisks are used to represent a valid user name and password.</span></span>  
  
```csharp  
"Persist Security Info=False;User ID=*****;Password=*****;Initial Catalog=AdventureWorks;Server=MySqlServer"  
```  

<span data-ttu-id="f57c3-143">Cuando se conecte a Azure SQL Database o a Azure SQL Data Warehouse y proporcione un inicio de sesión en el formato, asegúrese de `user@servername` que el `servername` valor del inicio de sesión coincida con el valor proporcionado para `Server=` .</span><span class="sxs-lookup"><span data-stu-id="f57c3-143">When you connect to Azure SQL Database or to Azure SQL Data Warehouse and provide a login in the format `user@servername`, make sure that the `servername` value in the login matches the value provided for `Server=`.</span></span>

> [!NOTE]
> <span data-ttu-id="f57c3-144">La autenticación de Windows tiene prioridad sobre los inicios de sesión de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="f57c3-144">Windows authentication takes precedence over SQL Server logins.</span></span> <span data-ttu-id="f57c3-145">Si especifica Integrated Security=true junto con un nombre de usuario y una contraseña, se ignorarán el nombre de usuario y la contraseña, y se usará la autenticación de Windows.</span><span class="sxs-lookup"><span data-stu-id="f57c3-145">If you specify both Integrated Security=true as well as a user name and password, the user name and password will be ignored and Windows authentication will be used.</span></span>  

### <a name="connect-to-a-named-instance-of-sql-server"></a><span data-ttu-id="f57c3-146">Conectarse a una instancia con nombre de SQL Server</span><span class="sxs-lookup"><span data-stu-id="f57c3-146">Connect to a named instance of SQL Server</span></span>

<span data-ttu-id="f57c3-147">Para conectarse a una instancia con nombre de SQL Server, use la sintaxis del *nombre nombre\instancia del servidor* .</span><span class="sxs-lookup"><span data-stu-id="f57c3-147">To connect to a named instance of SQL Server, use the *server name\instance name* syntax.</span></span>  
  
```csharp  
"Data Source=MySqlServer\MSSQL1;"  
```  

<span data-ttu-id="f57c3-148">A la hora de crear una cadena de conexión, también puede establecer la propiedad <xref:System.Data.SqlClient.SqlConnectionStringBuilder.DataSource%2A> del `SqlConnectionStringBuilder` en el nombre de instancia.</span><span class="sxs-lookup"><span data-stu-id="f57c3-148">You can also set the <xref:System.Data.SqlClient.SqlConnectionStringBuilder.DataSource%2A> property of the `SqlConnectionStringBuilder` to the instance name when building a connection string.</span></span> <span data-ttu-id="f57c3-149">La propiedad <xref:System.Data.SqlClient.SqlConnection.DataSource%2A> de un objeto <xref:System.Data.SqlClient.SqlConnection> es de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="f57c3-149">The <xref:System.Data.SqlClient.SqlConnection.DataSource%2A> property of a <xref:System.Data.SqlClient.SqlConnection> object is read-only.</span></span>  
  
### <a name="type-system-version-changes"></a><span data-ttu-id="f57c3-150">Cambios en Type System Version</span><span class="sxs-lookup"><span data-stu-id="f57c3-150">Type System Version Changes</span></span>  

 <span data-ttu-id="f57c3-151">La `Type System Version` palabra clave en un <xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A?displayProperty=nameWithType> especifica la representación del lado cliente de los tipos de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="f57c3-151">The `Type System Version` keyword in a <xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A?displayProperty=nameWithType> specifies the client-side representation of SQL Server types.</span></span> <span data-ttu-id="f57c3-152">Para obtener más información sobre la palabra clave <xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A?displayProperty=nameWithType>, vea `Type System Version`.</span><span class="sxs-lookup"><span data-stu-id="f57c3-152">See <xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A?displayProperty=nameWithType> for more information about the `Type System Version` keyword.</span></span>  
  
## <a name="connecting-and-attaching-to-sql-server-express-user-instances"></a><span data-ttu-id="f57c3-153">Concatenar y adjuntar a instancias de usuario de SQL Server Express</span><span class="sxs-lookup"><span data-stu-id="f57c3-153">Connecting and Attaching to SQL Server Express User Instances</span></span>  

 <span data-ttu-id="f57c3-154">Las instancias de usuario son una característica de SQL Server Express.</span><span class="sxs-lookup"><span data-stu-id="f57c3-154">User instances are a feature in SQL Server Express.</span></span> <span data-ttu-id="f57c3-155">Permiten que un usuario que ejecuta una cuenta de Windows local y con privilegios mínimos adjunte y ejecute una base de datos de SQL Server sin necesidad de tener privilegios administrativos.</span><span class="sxs-lookup"><span data-stu-id="f57c3-155">They allow a user running on a least-privileged local Windows account to attach and run a SQL Server database without requiring administrative privileges.</span></span> <span data-ttu-id="f57c3-156">Una instancia de usuario se ejecuta con las credenciales de Windows del usuario, no como un servicio.</span><span class="sxs-lookup"><span data-stu-id="f57c3-156">A user instance executes with the user's Windows credentials, not as a service.</span></span>  
  
 <span data-ttu-id="f57c3-157">Para obtener más información sobre cómo trabajar con instancias de usuario, vea [SQL Server Express las instancias de usuario](./sql/sql-server-express-user-instances.md).</span><span class="sxs-lookup"><span data-stu-id="f57c3-157">For more information on working with user instances, see [SQL Server Express User Instances](./sql/sql-server-express-user-instances.md).</span></span>  
  
## <a name="using-trustservercertificate"></a><span data-ttu-id="f57c3-158">Usar TrustServerCertificate</span><span class="sxs-lookup"><span data-stu-id="f57c3-158">Using TrustServerCertificate</span></span>  

 <span data-ttu-id="f57c3-159">La `TrustServerCertificate` palabra clave solo es válida cuando se conecta a una instancia de SQL Server con un certificado válido.</span><span class="sxs-lookup"><span data-stu-id="f57c3-159">The `TrustServerCertificate` keyword is valid only when connecting to a SQL Server instance with a valid certificate.</span></span> <span data-ttu-id="f57c3-160">Cuando `TrustServerCertificate` se establece en `true`, la capa de transporte utilizará SSL para cifrar el canal y evitar recorrer la cadena de certificados para validar la confianza.</span><span class="sxs-lookup"><span data-stu-id="f57c3-160">When `TrustServerCertificate` is set to `true`, the transport layer will use SSL to encrypt the channel and bypass walking the certificate chain to validate trust.</span></span>  
  
```csharp  
"TrustServerCertificate=true;"
```  
  
> [!NOTE]
> <span data-ttu-id="f57c3-161">Si `TrustServerCertificate` se establece en `true` y se activa el cifrado, se utilizará el nivel de cifrado especificado en el servidor aunque `Encrypt` esté establecido en `false` en la cadena de conexión.</span><span class="sxs-lookup"><span data-stu-id="f57c3-161">If `TrustServerCertificate` is set to `true` and encryption is turned on, the encryption level specified on the server will be used even if `Encrypt` is set to `false` in the connection string.</span></span> <span data-ttu-id="f57c3-162">De lo contrario, se producirá un error en la conexión.</span><span class="sxs-lookup"><span data-stu-id="f57c3-162">The connection will fail otherwise.</span></span>  
  
### <a name="enabling-encryption"></a><span data-ttu-id="f57c3-163">Habilitar el cifrado</span><span class="sxs-lookup"><span data-stu-id="f57c3-163">Enabling Encryption</span></span>  

 <span data-ttu-id="f57c3-164">Para habilitar el cifrado cuando no se ha aprovisionado un certificado en el servidor, las opciones **forzar cifrado de protocolo** y **confiar en certificado de servidor** deben establecerse en Administrador de configuración de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="f57c3-164">To enable encryption when a certificate has not been provisioned on the server, the **Force Protocol Encryption** and the **Trust Server Certificate** options must be set in SQL Server Configuration Manager.</span></span> <span data-ttu-id="f57c3-165">En ese caso, el cifrado utilizará un certificado de servidor autofirmado sin validación si no se ha proporcionado ningún certificado comprobable en el servidor.</span><span class="sxs-lookup"><span data-stu-id="f57c3-165">In this case, encryption will use a self-signed server certificate without validation if no verifiable certificate has been provisioned on the server.</span></span>  
  
 <span data-ttu-id="f57c3-166">La configuración de las aplicaciones no puede reducir el nivel de seguridad configurado en SQL Server, sino que en todo caso puede reforzarlo.</span><span class="sxs-lookup"><span data-stu-id="f57c3-166">Application settings cannot reduce the level of security configured in SQL Server, but can optionally strengthen it.</span></span> <span data-ttu-id="f57c3-167">Una aplicación puede solicitar el cifrado estableciendo `TrustServerCertificate` las `Encrypt` palabras clave y en `true` , garantizando que el cifrado se realiza incluso cuando no se ha aprovisionado un certificado de servidor y no se ha configurado el **cifrado de protocolo** para el cliente.</span><span class="sxs-lookup"><span data-stu-id="f57c3-167">An application can request encryption by setting the `TrustServerCertificate` and `Encrypt` keywords to `true`, guaranteeing that encryption takes place even when a server certificate has not been provisioned and **Force Protocol Encryption** has not been configured for the client.</span></span> <span data-ttu-id="f57c3-168">Sin embargo, si en la configuración del cliente no está habilitado `TrustServerCertificate`, seguirá siendo necesario un certificado de servidor.</span><span class="sxs-lookup"><span data-stu-id="f57c3-168">However, if `TrustServerCertificate` is not enabled in the client configuration, a provisioned server certificate is still required.</span></span>  
  
 <span data-ttu-id="f57c3-169">En la siguiente tabla se describen todos los casos.</span><span class="sxs-lookup"><span data-stu-id="f57c3-169">The following table describes all cases.</span></span>  
  
|<span data-ttu-id="f57c3-170">Cliente configurado con Forzar cifrado de protocolo</span><span class="sxs-lookup"><span data-stu-id="f57c3-170">Force Protocol Encryption client setting</span></span>|<span data-ttu-id="f57c3-171">Cliente configurado con Confiar en certificado de servidor</span><span class="sxs-lookup"><span data-stu-id="f57c3-171">Trust Server Certificate client setting</span></span>|<span data-ttu-id="f57c3-172">Cadena de conexión/atributo Cifrar/Utilizar cifrado para los datos</span><span class="sxs-lookup"><span data-stu-id="f57c3-172">Encrypt/Use Encryption for Data connection string/attribute</span></span>|<span data-ttu-id="f57c3-173">Cadena de conexión/atributo Confiar en certificado de servidor</span><span class="sxs-lookup"><span data-stu-id="f57c3-173">Trust Server Certificate connection string/attribute</span></span>|<span data-ttu-id="f57c3-174">Resultado</span><span class="sxs-lookup"><span data-stu-id="f57c3-174">Result</span></span>|  
|----------------------------------------------|---------------------------------------------|-------------------------------------------------------------------|-----------------------------------------------------------|------------|  
|<span data-ttu-id="f57c3-175">No</span><span class="sxs-lookup"><span data-stu-id="f57c3-175">No</span></span>|<span data-ttu-id="f57c3-176">N/D</span><span class="sxs-lookup"><span data-stu-id="f57c3-176">N/A</span></span>|<span data-ttu-id="f57c3-177">No (valor predeterminado)</span><span class="sxs-lookup"><span data-stu-id="f57c3-177">No (default)</span></span>|<span data-ttu-id="f57c3-178">Omitido</span><span class="sxs-lookup"><span data-stu-id="f57c3-178">Ignored</span></span>|<span data-ttu-id="f57c3-179">No se produce el cifrado.</span><span class="sxs-lookup"><span data-stu-id="f57c3-179">No encryption occurs.</span></span>|  
|<span data-ttu-id="f57c3-180">No</span><span class="sxs-lookup"><span data-stu-id="f57c3-180">No</span></span>|<span data-ttu-id="f57c3-181">N/D</span><span class="sxs-lookup"><span data-stu-id="f57c3-181">N/A</span></span>|<span data-ttu-id="f57c3-182">Sí</span><span class="sxs-lookup"><span data-stu-id="f57c3-182">Yes</span></span>|<span data-ttu-id="f57c3-183">No (valor predeterminado)</span><span class="sxs-lookup"><span data-stu-id="f57c3-183">No (default)</span></span>|<span data-ttu-id="f57c3-184">El cifrado solamente se produce si hay un certificado de servidor comprobable; de lo contrario, se produce un error en el intento de conexión.</span><span class="sxs-lookup"><span data-stu-id="f57c3-184">Encryption occurs only if there is a verifiable server certificate, otherwise the connection attempt fails.</span></span>|  
|<span data-ttu-id="f57c3-185">No</span><span class="sxs-lookup"><span data-stu-id="f57c3-185">No</span></span>|<span data-ttu-id="f57c3-186">N/D</span><span class="sxs-lookup"><span data-stu-id="f57c3-186">N/A</span></span>|<span data-ttu-id="f57c3-187">Sí</span><span class="sxs-lookup"><span data-stu-id="f57c3-187">Yes</span></span>|<span data-ttu-id="f57c3-188">Sí</span><span class="sxs-lookup"><span data-stu-id="f57c3-188">Yes</span></span>|<span data-ttu-id="f57c3-189">El cifrado se produce siempre, pero puede que se utilice un certificado de servidor autofirmado.</span><span class="sxs-lookup"><span data-stu-id="f57c3-189">Encryption always occurs, but may use a self-signed server certificate.</span></span>|  
|<span data-ttu-id="f57c3-190">Sí</span><span class="sxs-lookup"><span data-stu-id="f57c3-190">Yes</span></span>|<span data-ttu-id="f57c3-191">No</span><span class="sxs-lookup"><span data-stu-id="f57c3-191">No</span></span>|<span data-ttu-id="f57c3-192">Omitido</span><span class="sxs-lookup"><span data-stu-id="f57c3-192">Ignored</span></span>|<span data-ttu-id="f57c3-193">Omitido</span><span class="sxs-lookup"><span data-stu-id="f57c3-193">Ignored</span></span>|<span data-ttu-id="f57c3-194">El cifrado solo se produce si hay un certificado de servidor que se pueda comprobar; de lo contrario, se produce un error en el intento de conexión.</span><span class="sxs-lookup"><span data-stu-id="f57c3-194">Encryption occurs only if there is a verifiable server certificate; otherwise, the connection attempt fails.</span></span>|  
|<span data-ttu-id="f57c3-195">Sí</span><span class="sxs-lookup"><span data-stu-id="f57c3-195">Yes</span></span>|<span data-ttu-id="f57c3-196">Sí</span><span class="sxs-lookup"><span data-stu-id="f57c3-196">Yes</span></span>|<span data-ttu-id="f57c3-197">No (valor predeterminado)</span><span class="sxs-lookup"><span data-stu-id="f57c3-197">No (default)</span></span>|<span data-ttu-id="f57c3-198">Omitido</span><span class="sxs-lookup"><span data-stu-id="f57c3-198">Ignored</span></span>|<span data-ttu-id="f57c3-199">El cifrado se produce siempre, pero puede que se utilice un certificado de servidor autofirmado.</span><span class="sxs-lookup"><span data-stu-id="f57c3-199">Encryption always occurs, but may use a self-signed server certificate.</span></span>|  
|<span data-ttu-id="f57c3-200">Sí</span><span class="sxs-lookup"><span data-stu-id="f57c3-200">Yes</span></span>|<span data-ttu-id="f57c3-201">Sí</span><span class="sxs-lookup"><span data-stu-id="f57c3-201">Yes</span></span>|<span data-ttu-id="f57c3-202">Sí</span><span class="sxs-lookup"><span data-stu-id="f57c3-202">Yes</span></span>|<span data-ttu-id="f57c3-203">No (valor predeterminado)</span><span class="sxs-lookup"><span data-stu-id="f57c3-203">No (default)</span></span>|<span data-ttu-id="f57c3-204">El cifrado solo se produce si hay un certificado de servidor que se pueda comprobar; de lo contrario, se produce un error en el intento de conexión.</span><span class="sxs-lookup"><span data-stu-id="f57c3-204">Encryption occurs only if there is a verifiable server certificate; otherwise, the connection attempt fails.</span></span>|  
|<span data-ttu-id="f57c3-205">Sí</span><span class="sxs-lookup"><span data-stu-id="f57c3-205">Yes</span></span>|<span data-ttu-id="f57c3-206">Sí</span><span class="sxs-lookup"><span data-stu-id="f57c3-206">Yes</span></span>|<span data-ttu-id="f57c3-207">Sí</span><span class="sxs-lookup"><span data-stu-id="f57c3-207">Yes</span></span>|<span data-ttu-id="f57c3-208">Sí</span><span class="sxs-lookup"><span data-stu-id="f57c3-208">Yes</span></span>|<span data-ttu-id="f57c3-209">El cifrado se produce siempre, pero puede que se utilice un certificado de servidor autofirmado.</span><span class="sxs-lookup"><span data-stu-id="f57c3-209">Encryption always occurs, but may use a self-signed server certificate.</span></span>|  
  
 <span data-ttu-id="f57c3-210">Para obtener más información, vea [Usar el cifrado sin validación](/sql/relational-databases/native-client/features/using-encryption-without-validation).</span><span class="sxs-lookup"><span data-stu-id="f57c3-210">For more information, see [Using Encryption Without Validation](/sql/relational-databases/native-client/features/using-encryption-without-validation).</span></span>
  
## <a name="oledb-connection-strings"></a><span data-ttu-id="f57c3-211">Cadenas de conexión OleDb</span><span class="sxs-lookup"><span data-stu-id="f57c3-211">OleDb Connection Strings</span></span>  

 <span data-ttu-id="f57c3-212">La propiedad <xref:System.Data.OleDb.OleDbConnection.ConnectionString%2A> de un objeto <xref:System.Data.OleDb.OleDbConnection> permite obtener o establecer una cadena de conexión para un origen de datos OLE DB, como Microsoft Access.</span><span class="sxs-lookup"><span data-stu-id="f57c3-212">The <xref:System.Data.OleDb.OleDbConnection.ConnectionString%2A> property of a <xref:System.Data.OleDb.OleDbConnection> allows you to get or set a connection string for an OLE DB data source, such as Microsoft Access.</span></span> <span data-ttu-id="f57c3-213">Asimismo puede crear una cadena de conexión de `OleDb` en tiempo de ejecución mediante la clase <xref:System.Data.OleDb.OleDbConnectionStringBuilder>.</span><span class="sxs-lookup"><span data-stu-id="f57c3-213">You can also create an `OleDb` connection string at run time by using the <xref:System.Data.OleDb.OleDbConnectionStringBuilder> class.</span></span>  
  
### <a name="oledb-connection-string-syntax"></a><span data-ttu-id="f57c3-214">Sintaxis de cadena de conexión OleDb</span><span class="sxs-lookup"><span data-stu-id="f57c3-214">OleDb Connection String Syntax</span></span>  

 <span data-ttu-id="f57c3-215">Para una cadena de conexión <xref:System.Data.OleDb.OleDbConnection>, debe proporcionar un nombre de proveedor.</span><span class="sxs-lookup"><span data-stu-id="f57c3-215">You must specify a provider name for an <xref:System.Data.OleDb.OleDbConnection> connection string.</span></span> <span data-ttu-id="f57c3-216">La siguiente cadena de conexión conecta a una base de datos Microsoft Access mediante el proveedor Jet.</span><span class="sxs-lookup"><span data-stu-id="f57c3-216">The following connection string connects to a Microsoft Access database using the Jet provider.</span></span> <span data-ttu-id="f57c3-217">Tenga en cuenta que las palabras clave `User ID` y `Password` son opcionales si la base de datos no está protegida (opción predeterminada).</span><span class="sxs-lookup"><span data-stu-id="f57c3-217">Note that the `User ID` and `Password` keywords are optional if the database is unsecured (the default).</span></span>  
  
```csharp
Provider=Microsoft.Jet.OLEDB.4.0; Data Source=d:\Northwind.mdb;User ID=Admin;Password=;
```  
  
 <span data-ttu-id="f57c3-218">Si la base de datos Jet está protegida mediante la seguridad de nivel de usuario, debe proporcionar la ubicación del archivo de información de grupo de trabajo (.mdw).</span><span class="sxs-lookup"><span data-stu-id="f57c3-218">If the Jet database is secured using user-level security, you must provide the location of the workgroup information file (.mdw).</span></span> <span data-ttu-id="f57c3-219">Este archivo se usa para validar las credenciales presentadas en la cadena de conexión.</span><span class="sxs-lookup"><span data-stu-id="f57c3-219">The workgroup information file is used to validate the credentials presented in the connection string.</span></span>  
  
```csharp
Provider=Microsoft.Jet.OLEDB.4.0;Data Source=d:\Northwind.mdb;Jet OLEDB:System Database=d:\NorthwindSystem.mdw;User ID=*****;Password=*****;  
```  
  
> [!IMPORTANT]
> <span data-ttu-id="f57c3-220">Es posible proporcionar información de conexión para un **OleDbConnection** en un archivo de vínculo de datos universal (UdL); sin embargo, debe evitar hacerlo.</span><span class="sxs-lookup"><span data-stu-id="f57c3-220">It is possible to supply connection information for an **OleDbConnection** in a Universal Data Link (UDL) file; however you should avoid doing so.</span></span> <span data-ttu-id="f57c3-221">Los archivos UDL no están cifrados y exponen la información de cadena de conexión en texto sin cifrar.</span><span class="sxs-lookup"><span data-stu-id="f57c3-221">UDL files are not encrypted, and expose connection string information in clear text.</span></span> <span data-ttu-id="f57c3-222">Un archivo UDL no se puede proteger mediante .NET Framework, ya que se trata de un recurso basado en un archivo externo a la aplicación.</span><span class="sxs-lookup"><span data-stu-id="f57c3-222">Because a UDL file is an external file-based resource to your application, it cannot be secured using the .NET Framework.</span></span> <span data-ttu-id="f57c3-223">Los archivos UDL no se admiten en **SqlClient**.</span><span class="sxs-lookup"><span data-stu-id="f57c3-223">UDL files are not supported for **SqlClient**.</span></span>  
  
### <a name="using-datadirectory-to-connect-to-accessjet"></a><span data-ttu-id="f57c3-224">Utilizar DataDirectory para conectarse a Access/Jet</span><span class="sxs-lookup"><span data-stu-id="f57c3-224">Using DataDirectory to Connect to Access/Jet</span></span>  

 <span data-ttu-id="f57c3-225">`DataDirectory` no es exclusivo de `SqlClient`.</span><span class="sxs-lookup"><span data-stu-id="f57c3-225">`DataDirectory` is not exclusive to `SqlClient`.</span></span> <span data-ttu-id="f57c3-226">También se puede utilizar con los proveedores de datos de .NET <xref:System.Data.OleDb> y <xref:System.Data.Odbc>.</span><span class="sxs-lookup"><span data-stu-id="f57c3-226">It can also be used with the <xref:System.Data.OleDb> and <xref:System.Data.Odbc> .NET data providers.</span></span> <span data-ttu-id="f57c3-227">La siguiente cadena <xref:System.Data.OleDb.OleDbConnection> de ejemplo muestra la sintaxis necesaria para conectarse a la base de datos Northwind.mdb situada en la carpeta app_data de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="f57c3-227">The following sample <xref:System.Data.OleDb.OleDbConnection> string demonstrates the syntax required to connect to the Northwind.mdb located in the application's app_data folder.</span></span> <span data-ttu-id="f57c3-228">La base de datos del sistema (System.mdw) también está almacenada en esa ubicación.</span><span class="sxs-lookup"><span data-stu-id="f57c3-228">The system database (System.mdw) is also stored in that location.</span></span>  
  
```csharp  
"Provider=Microsoft.Jet.OLEDB.4.0;  
Data Source=|DataDirectory|\Northwind.mdb;  
Jet OLEDB:System Database=|DataDirectory|\System.mdw;"  
```  
  
> [!IMPORTANT]
> <span data-ttu-id="f57c3-229">No es necesario especificar la ubicación de la base de datos del sistema en la cadena de conexión si la base de datos Access/Jet no está protegida.</span><span class="sxs-lookup"><span data-stu-id="f57c3-229">Specifying the location of the system database in the connection string is not required if the Access/Jet database is unsecured.</span></span> <span data-ttu-id="f57c3-230">La seguridad está desactivada de forma predeterminada y todos los usuarios se conectan como el usuario Admin integrado, con una contraseña en blanco.</span><span class="sxs-lookup"><span data-stu-id="f57c3-230">Security is off by default, with all users connecting as the built-in Admin user with a blank password.</span></span> <span data-ttu-id="f57c3-231">Aun cuando la seguridad a nivel de usuario esté correctamente implementada, una base de datos Jet sigue siendo vulnerable a los ataques.</span><span class="sxs-lookup"><span data-stu-id="f57c3-231">Even when user-level security is correctly implemented, a Jet database remains vulnerable to attack.</span></span> <span data-ttu-id="f57c3-232">Por eso no se recomienda almacenar información delicada en una base de datos Access/Jet a causa de la fragilidad inherente a su esquema de seguridad basado en archivos.</span><span class="sxs-lookup"><span data-stu-id="f57c3-232">Therefore, storing sensitive information in an Access/Jet database is not recommended because of the inherent weakness of its file-based security scheme.</span></span>  
  
### <a name="connecting-to-excel"></a><span data-ttu-id="f57c3-233">Conectarse a Excel</span><span class="sxs-lookup"><span data-stu-id="f57c3-233">Connecting to Excel</span></span>  

 <span data-ttu-id="f57c3-234">Para conectarse a un libro de Excel se utiliza el proveedor Microsoft Jet.</span><span class="sxs-lookup"><span data-stu-id="f57c3-234">The Microsoft Jet provider is used to connect to an Excel workbook.</span></span> <span data-ttu-id="f57c3-235">En la siguiente cadena de conexión, la palabra clave `Extended Properties` establece propiedades que son específicas de Excel.</span><span class="sxs-lookup"><span data-stu-id="f57c3-235">In the following connection string, the `Extended Properties` keyword sets properties that are specific to Excel.</span></span> <span data-ttu-id="f57c3-236">"HDR=Yes;" indica que la primera fila contiene nombres de columna, no datos, e "IMEX=1;" indica al controlador que siempre lea las columnas de datos "entremezclados" como texto.</span><span class="sxs-lookup"><span data-stu-id="f57c3-236">"HDR=Yes;" indicates that the first row contains column names, not data, and "IMEX=1;" tells the driver to always read "intermixed" data columns as text.</span></span>  
  
```csharp
Provider=Microsoft.Jet.OLEDB.4.0;Data Source=D:\MyExcel.xls;Extended Properties=""Excel 8.0;HDR=Yes;IMEX=1""  
```  
  
 <span data-ttu-id="f57c3-237">Tenga en cuenta que el carácter de comilla doble necesario en `Extended Properties` también debe ir incluido entre comillas dobles.</span><span class="sxs-lookup"><span data-stu-id="f57c3-237">Note that the double quotation character required for the `Extended Properties` must also be enclosed in double quotation marks.</span></span>  
  
### <a name="data-shape-provider-connection-string-syntax"></a><span data-ttu-id="f57c3-238">Sintaxis de cadena de conexión del proveedor de formas de datos</span><span class="sxs-lookup"><span data-stu-id="f57c3-238">Data Shape Provider Connection String Syntax</span></span>  

 <span data-ttu-id="f57c3-239">Utilice las palabras clave `Provider` y `Data Provider` cuando use el proveedor de formas de datos de Microsoft.</span><span class="sxs-lookup"><span data-stu-id="f57c3-239">Use both the `Provider` and the `Data Provider` keywords when using the Microsoft Data Shape provider.</span></span> <span data-ttu-id="f57c3-240">En el siguiente ejemplo se utiliza el proveedor de formas para conectarse a una instancia local de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="f57c3-240">The following example uses the Shape provider to connect to a local instance of SQL Server.</span></span>  
  
```csharp  
"Provider=MSDataShape;Data Provider=SQLOLEDB;Data Source=(local);Initial Catalog=pubs;Integrated Security=SSPI;"
```  
  
## <a name="odbc-connection-strings"></a><span data-ttu-id="f57c3-241">Cadenas de conexión Odbc</span><span class="sxs-lookup"><span data-stu-id="f57c3-241">Odbc Connection Strings</span></span>  

 <span data-ttu-id="f57c3-242">La propiedad <xref:System.Data.Odbc.OdbcConnection.ConnectionString%2A> de una <xref:System.Data.Odbc.OdbcConnection> permite obtener o establecer una cadena de conexión para un origen de datos OLE DB.</span><span class="sxs-lookup"><span data-stu-id="f57c3-242">The <xref:System.Data.Odbc.OdbcConnection.ConnectionString%2A> property of a <xref:System.Data.Odbc.OdbcConnection> allows you to get or set a connection string for an OLE DB data source.</span></span> <span data-ttu-id="f57c3-243">Las cadenas de conexión Odbc también son compatibles con <xref:System.Data.Odbc.OdbcConnectionStringBuilder>.</span><span class="sxs-lookup"><span data-stu-id="f57c3-243">Odbc connection strings are also supported by the <xref:System.Data.Odbc.OdbcConnectionStringBuilder>.</span></span>  
  
 <span data-ttu-id="f57c3-244">En la siguiente cadena de conexión se utiliza el Controlador de texto de Microsoft.</span><span class="sxs-lookup"><span data-stu-id="f57c3-244">The following connection string uses the Microsoft Text Driver.</span></span>  
  
```csharp  
Driver={Microsoft Text Driver (*.txt; *.csv)};DBQ=d:\bin  
```  
  
### <a name="using-datadirectory-to-connect-to-visual-foxpro"></a><span data-ttu-id="f57c3-245">Utilizar DataDirectory para conectarse a Visual FoxPro</span><span class="sxs-lookup"><span data-stu-id="f57c3-245">Using DataDirectory to Connect to Visual FoxPro</span></span>  

 <span data-ttu-id="f57c3-246">El siguiente ejemplo de cadena de conexión <xref:System.Data.Odbc.OdbcConnection> muestra cómo se utiliza `DataDirectory` para conectarse a un archivo de Microsoft Visual FoxPro.</span><span class="sxs-lookup"><span data-stu-id="f57c3-246">The following <xref:System.Data.Odbc.OdbcConnection> connection string sample demonstrates using `DataDirectory` to connect to a Microsoft Visual FoxPro file.</span></span>  
  
```csharp  
"Driver={Microsoft Visual FoxPro Driver};  
SourceDB=|DataDirectory|\MyData.DBC;SourceType=DBC;"  
```  
  
## <a name="oracle-connection-strings"></a><span data-ttu-id="f57c3-247">Cadenas de conexión Oracle</span><span class="sxs-lookup"><span data-stu-id="f57c3-247">Oracle Connection Strings</span></span>  

 <span data-ttu-id="f57c3-248">La propiedad <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A> de una <xref:System.Data.OracleClient.OracleConnection> permite obtener o establecer una cadena de conexión para un origen de datos OLE DB.</span><span class="sxs-lookup"><span data-stu-id="f57c3-248">The <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A> property of a <xref:System.Data.OracleClient.OracleConnection> allows you to get or set a connection string for an OLE DB data source.</span></span> <span data-ttu-id="f57c3-249">Las cadenas de conexión Oracle también son compatibles con <xref:System.Data.OracleClient.OracleConnectionStringBuilder>.</span><span class="sxs-lookup"><span data-stu-id="f57c3-249">Oracle connection strings are also supported by the <xref:System.Data.OracleClient.OracleConnectionStringBuilder> .</span></span>  
  
```csharp
Data Source=Oracle9i;User ID=*****;Password=*****;  
```  
  
 <span data-ttu-id="f57c3-250">Para obtener más información acerca de la sintaxis de cadena de conexión ODBC, vea <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A>.</span><span class="sxs-lookup"><span data-stu-id="f57c3-250">For more information on ODBC connection string syntax, see <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A>.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f57c3-251">Vea también</span><span class="sxs-lookup"><span data-stu-id="f57c3-251">See also</span></span>

- [<span data-ttu-id="f57c3-252">Cadenas de conexión</span><span class="sxs-lookup"><span data-stu-id="f57c3-252">Connection Strings</span></span>](connection-strings.md)
- [<span data-ttu-id="f57c3-253">Conectarse a un origen de datos</span><span class="sxs-lookup"><span data-stu-id="f57c3-253">Connecting to a Data Source</span></span>](connecting-to-a-data-source.md)
- [<span data-ttu-id="f57c3-254">Información general de ADO.NET</span><span class="sxs-lookup"><span data-stu-id="f57c3-254">ADO.NET Overview</span></span>](ado-net-overview.md)
