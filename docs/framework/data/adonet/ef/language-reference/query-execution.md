---
title: Ejecución de la consulta
description: Obtenga información sobre las distintas formas en que se ejecuta una consulta LINQ to Entities, incluida la ejecución diferida de consultas, la ejecución inmediata de consultas y la ejecución de la tienda.
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: c0e6cf23-63ac-47dd-bfe9-d5bdca826fac
ms.openlocfilehash: e776df6d35b6cc8c24cd83e902bc4d050347343b
ms.sourcegitcommit: 33deec3e814238fb18a49b2a7e89278e27888291
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/02/2020
ms.locfileid: "84286797"
---
# <a name="query-execution"></a><span data-ttu-id="f17ea-103">Ejecución de la consulta</span><span class="sxs-lookup"><span data-stu-id="f17ea-103">Query Execution</span></span>
<span data-ttu-id="f17ea-104">Una vez creada por un usuario una consulta LINQ, se convierte en un árbol de comandos.</span><span class="sxs-lookup"><span data-stu-id="f17ea-104">After a LINQ query is created by a user, it is converted to a command tree.</span></span> <span data-ttu-id="f17ea-105">Un árbol de comandos es una representación de una consulta que es compatible con Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="f17ea-105">A command tree is a representation of a query that is compatible with the Entity Framework.</span></span> <span data-ttu-id="f17ea-106">Posteriormente, el árbol de comandos se ejecuta en el origen de datos.</span><span class="sxs-lookup"><span data-stu-id="f17ea-106">The command tree is then executed against the data source.</span></span> <span data-ttu-id="f17ea-107">En el momento de la ejecución de la consulta, se evalúan todas las expresiones de consulta (es decir, todos los componentes de la consulta), incluidas las expresiones que se utilizan en la materialización del resultado.</span><span class="sxs-lookup"><span data-stu-id="f17ea-107">At query execution time, all query expressions (that is, all components of the query) are evaluated, including those expressions that are used in result materialization.</span></span>  
  
 <span data-ttu-id="f17ea-108">El momento en que se ejecutan las expresiones de consulta puede variar.</span><span class="sxs-lookup"><span data-stu-id="f17ea-108">At what point query expressions are executed can vary.</span></span> <span data-ttu-id="f17ea-109">Las consultas LINQ siempre se ejecutan cuando se recorre en iteración la variable de consulta, no cuando se crea la citada variable de consulta.</span><span class="sxs-lookup"><span data-stu-id="f17ea-109">LINQ queries are always executed when the query variable is iterated over, not when the query variable is created.</span></span> <span data-ttu-id="f17ea-110">Esto se denomina *ejecución aplazada*.</span><span class="sxs-lookup"><span data-stu-id="f17ea-110">This is called *deferred execution*.</span></span> <span data-ttu-id="f17ea-111">También se puede obligar a que la consulta se ejecute inmediatamente, lo que es útil para almacenar en caché los resultados de la consulta.</span><span class="sxs-lookup"><span data-stu-id="f17ea-111">You can also force a query to execute immediately, which is useful for caching query results.</span></span> <span data-ttu-id="f17ea-112">Esto se describe más adelante en este tema.</span><span class="sxs-lookup"><span data-stu-id="f17ea-112">This is described later in this topic.</span></span>  
  
 <span data-ttu-id="f17ea-113">Cuando se ejecuta una consulta de LINQ to Entities, algunas de sus expresiones podrían ejecutarse en el servidor y ciertas partes podrían ejecutarse de forma local en el cliente.</span><span class="sxs-lookup"><span data-stu-id="f17ea-113">When a LINQ to Entities query is executed, some expressions in the query might be executed on the server and some parts might be executed locally on the client.</span></span> <span data-ttu-id="f17ea-114">La evaluación en el cliente de una expresión se lleva a cabo antes de ejecutar la consulta en el servidor.</span><span class="sxs-lookup"><span data-stu-id="f17ea-114">Client-side evaluation of an expression takes place before the query is executed on the server.</span></span> <span data-ttu-id="f17ea-115">Si una expresión se evalúa en el cliente, el resultado de esa evaluación se sustituye por la expresión en la consulta, y ésta se ejecuta entonces en el servidor.</span><span class="sxs-lookup"><span data-stu-id="f17ea-115">If an expression is evaluated on the client, the result of that evaluation is substituted for the expression in the query, and the query is then executed on the server.</span></span> <span data-ttu-id="f17ea-116">Dado que las consultas se ejecutan en el origen de datos, la configuración de este reemplaza el comportamiento especificado en el cliente.</span><span class="sxs-lookup"><span data-stu-id="f17ea-116">Because queries are executed on the data source, the data source configuration overrides the behavior specified in the client.</span></span> <span data-ttu-id="f17ea-117">Por ejemplo, la precisión numérica y el tratamiento de los valores NULL dependen de la configuración de servidor.</span><span class="sxs-lookup"><span data-stu-id="f17ea-117">For example, null value handling and numerical precision depend on the server settings.</span></span> <span data-ttu-id="f17ea-118">Cualquier excepción que se produzca durante la ejecución de la consulta en el servidor se pasa directamente al cliente.</span><span class="sxs-lookup"><span data-stu-id="f17ea-118">Any exceptions thrown during query execution on the server are passed directly up to the client.</span></span>  

> [!TIP]
> <span data-ttu-id="f17ea-119">Para obtener un breve resumen de los operadores de consulta en formato de tabla, lo que permite identificar rápidamente el comportamiento de ejecución de un operador, vea [clasificación de operadores de consulta estándar por modo de ejecución (C#)](../../../../../csharp/programming-guide/concepts/linq/classification-of-standard-query-operators-by-manner-of-execution.md).</span><span class="sxs-lookup"><span data-stu-id="f17ea-119">For a convenient summary of query operators in table format, which lets you quickly identify an operator's execution behavior, see [Classification of Standard Query Operators by Manner of Execution (C#)](../../../../../csharp/programming-guide/concepts/linq/classification-of-standard-query-operators-by-manner-of-execution.md).</span></span>

## <a name="deferred-query-execution"></a><span data-ttu-id="f17ea-120">Ejecución de consultas en diferido</span><span class="sxs-lookup"><span data-stu-id="f17ea-120">Deferred query execution</span></span>  
 <span data-ttu-id="f17ea-121">En una consulta que devuelve una secuencia de valores, la variable de consulta por sí misma nunca conserva los resultados de la consulta y solo almacena los comandos de la misma.</span><span class="sxs-lookup"><span data-stu-id="f17ea-121">In a query that returns a sequence of values, the query variable itself never holds the query results and only stores the query commands.</span></span> <span data-ttu-id="f17ea-122">La ejecución de la consulta se aplaza hasta que la variable de consulta se recorre en iteración en un bucle `foreach` o `For Each`.</span><span class="sxs-lookup"><span data-stu-id="f17ea-122">Execution of the query is deferred until the query variable is iterated over in a `foreach` or `For Each` loop.</span></span> <span data-ttu-id="f17ea-123">Esto se conoce como *ejecución aplazada*; es decir, la ejecución de la consulta se produce una vez después de la construcción de la consulta.</span><span class="sxs-lookup"><span data-stu-id="f17ea-123">This is known as *deferred execution*; that is, query execution occurs some time after the query is constructed.</span></span> <span data-ttu-id="f17ea-124">Esto significa que se puede ejecutar una consulta con la frecuencia que se desee.</span><span class="sxs-lookup"><span data-stu-id="f17ea-124">This means that you can execute a query as frequently as you want to.</span></span> <span data-ttu-id="f17ea-125">Esto es útil cuando, por ejemplo, se tiene una base de datos que otras aplicaciones están actualizando.</span><span class="sxs-lookup"><span data-stu-id="f17ea-125">This is useful when, for example, you have a database that is being updated by other applications.</span></span> <span data-ttu-id="f17ea-126">En su aplicación puede crear una consulta para recuperar la información más reciente y ejecutar de forma repetida la consulta, devolviendo cada vez la información actualizada.</span><span class="sxs-lookup"><span data-stu-id="f17ea-126">In your application, you can create a query to retrieve the latest information and repeatedly execute the query, returning the updated information every time.</span></span>  
  
 <span data-ttu-id="f17ea-127">La ejecución aplazada permite combinar varias consultas o ampliar una consulta.</span><span class="sxs-lookup"><span data-stu-id="f17ea-127">Deferred execution enables multiple queries to be combined or a query to be extended.</span></span> <span data-ttu-id="f17ea-128">Cuando se amplía una consulta, se modifica para incluir las nuevas operaciones. La ejecución eventual reflejará los cambios.</span><span class="sxs-lookup"><span data-stu-id="f17ea-128">When a query is extended, it is modified to include the new operations, and the eventual execution will reflect the changes.</span></span> <span data-ttu-id="f17ea-129">En el siguiente ejemplo, la primera consulta devuelve todos los productos.</span><span class="sxs-lookup"><span data-stu-id="f17ea-129">In the following example, the first query returns all the products.</span></span> <span data-ttu-id="f17ea-130">La segunda consulta amplía la primera usando `Where` para devolver todos los productos del tamaño "L":</span><span class="sxs-lookup"><span data-stu-id="f17ea-130">The second query extends the first by using `Where` to return all the products of size "L":</span></span>  
  
 [!code-csharp[DP L2E Conceptual Examples#Composing1](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Conceptual Examples/CS/Program.cs#composing1)]
 [!code-vb[DP L2E Conceptual Examples#Composing1](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Conceptual Examples/VB/Module1.vb#composing1)]  
  
 <span data-ttu-id="f17ea-131">Una vez ejecutada una consulta, todas las consultas sucesivas utilizarán los operadores de LINQ en memoria.</span><span class="sxs-lookup"><span data-stu-id="f17ea-131">After a query has been executed all successive queries will use the in-memory LINQ operators.</span></span> <span data-ttu-id="f17ea-132">Si se recorre en iteración la variable de la consulta utilizando una instrucción `foreach` o `For Each` o llamando a uno de los operadores de conversión de LINQ, se producirá la ejecución inmediata.</span><span class="sxs-lookup"><span data-stu-id="f17ea-132">Iterating over the query variable by using a `foreach` or `For Each` statement or by calling one of the LINQ conversion operators will cause immediate execution.</span></span> <span data-ttu-id="f17ea-133">Entre estos operadores de conversión se incluyen los siguientes: <xref:System.Linq.Enumerable.ToList%2A>, <xref:System.Linq.Enumerable.ToArray%2A>, <xref:System.Linq.Enumerable.ToLookup%2A> y <xref:System.Linq.Enumerable.ToDictionary%2A>.</span><span class="sxs-lookup"><span data-stu-id="f17ea-133">These conversion operators include the following: <xref:System.Linq.Enumerable.ToList%2A>, <xref:System.Linq.Enumerable.ToArray%2A>, <xref:System.Linq.Enumerable.ToLookup%2A>, and <xref:System.Linq.Enumerable.ToDictionary%2A>.</span></span>  
  
## <a name="immediate-query-execution"></a><span data-ttu-id="f17ea-134">Ejecución de consultas inmediata</span><span class="sxs-lookup"><span data-stu-id="f17ea-134">Immediate Query Execution</span></span>  
 <span data-ttu-id="f17ea-135">A diferencia de la ejecución aplazada de consultas que producen una secuencia de valores, las consultas que devuelven un valor singleton se ejecutan inmediatamente.</span><span class="sxs-lookup"><span data-stu-id="f17ea-135">In contrast to the deferred execution of queries that produce a sequence of values, queries that return a singleton value are executed immediately.</span></span> <span data-ttu-id="f17ea-136">Algunos ejemplos de consultas singleton son <xref:System.Linq.Enumerable.Average%2A>, <xref:System.Linq.Enumerable.Count%2A>, <xref:System.Linq.Enumerable.First%2A> y <xref:System.Linq.Enumerable.Max%2A>.</span><span class="sxs-lookup"><span data-stu-id="f17ea-136">Some examples of singleton queries are <xref:System.Linq.Enumerable.Average%2A>, <xref:System.Linq.Enumerable.Count%2A>, <xref:System.Linq.Enumerable.First%2A>, and <xref:System.Linq.Enumerable.Max%2A>.</span></span> <span data-ttu-id="f17ea-137">Se ejecutan inmediatamente porque la consulta debe producir una secuencia para calcular el resultado singleton.</span><span class="sxs-lookup"><span data-stu-id="f17ea-137">These execute immediately because the query must produce a sequence to calculate the singleton result.</span></span> <span data-ttu-id="f17ea-138">También se puede forzar la ejecución inmediata.</span><span class="sxs-lookup"><span data-stu-id="f17ea-138">You can also force immediate execution.</span></span> <span data-ttu-id="f17ea-139">Esto es útil cuando se desea almacenar en memoria caché los resultados de una consulta.</span><span class="sxs-lookup"><span data-stu-id="f17ea-139">This is useful when you want to cache the results of a query.</span></span> <span data-ttu-id="f17ea-140">Para forzar la ejecución inmediata de una consulta que no produce un valor singleton, se puede llamar a los métodos <xref:System.Linq.Enumerable.ToList%2A>, <xref:System.Linq.Enumerable.ToDictionary%2A> o <xref:System.Linq.Enumerable.ToArray%2A> en una consulta o una variable de consulta.</span><span class="sxs-lookup"><span data-stu-id="f17ea-140">To force immediate execution of a query that does not produce a singleton value, you can call the <xref:System.Linq.Enumerable.ToList%2A> method, the <xref:System.Linq.Enumerable.ToDictionary%2A> method, or the <xref:System.Linq.Enumerable.ToArray%2A> method on a query or query variable.</span></span> <span data-ttu-id="f17ea-141">En el ejemplo siguiente se utiliza el método <xref:System.Linq.Enumerable.ToArray%2A> para evaluar de forma inmediata una secuencia en una matriz.</span><span class="sxs-lookup"><span data-stu-id="f17ea-141">The following example uses the <xref:System.Linq.Enumerable.ToArray%2A> method to immediately evaluate a sequence into an array.</span></span>  
  
 [!code-csharp[DP L2E Examples#ToArray](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Examples/CS/Program.cs#toarray)]
 [!code-vb[DP L2E Examples#ToArray](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Examples/VB/Module1.vb#toarray)]  
  
 <span data-ttu-id="f17ea-142">También se puede forzar la ejecución colocando el bucle `foreach` o `For Each` inmediatamente después de la expresión de consulta, pero si se llama a los métodos <xref:System.Linq.Enumerable.ToList%2A> o <xref:System.Linq.Enumerable.ToArray%2A>, se almacenarán en caché todos los datos de un solo objeto de la colección.</span><span class="sxs-lookup"><span data-stu-id="f17ea-142">You could also force execution by putting the `foreach` or `For Each` loop immediately after the query expression, but by calling <xref:System.Linq.Enumerable.ToList%2A> or <xref:System.Linq.Enumerable.ToArray%2A> you cache all the data in a single collection object.</span></span>  
  
## <a name="store-execution"></a><span data-ttu-id="f17ea-143">Ejecución en el almacén</span><span class="sxs-lookup"><span data-stu-id="f17ea-143">Store Execution</span></span>  
 <span data-ttu-id="f17ea-144">En general, las expresiones de LINQ to Entities se evalúan en el servidor, y no es de esperar que el comportamiento de la expresión siga la semántica de Common Language Runtime (CLR), sino la del origen.</span><span class="sxs-lookup"><span data-stu-id="f17ea-144">In general, expressions in LINQ to Entities are evaluated on the server, and the behavior of the expression should not be expected to follow common language runtime (CLR) semantics, but those of the data source.</span></span> <span data-ttu-id="f17ea-145">Sin embargo, hay excepciones, como cuando la expresión se ejecuta en el cliente.</span><span class="sxs-lookup"><span data-stu-id="f17ea-145">There are exceptions to this, however, such as when the expression is executed on the client.</span></span> <span data-ttu-id="f17ea-146">Esto puede producir resultados inesperados, por ejemplo cuando el servidor y el cliente están en zonas horarias diferentes.</span><span class="sxs-lookup"><span data-stu-id="f17ea-146">This could cause unexpected results, for example when the server and client are in different time zones.</span></span>  
  
 <span data-ttu-id="f17ea-147">Algunas expresiones de la consulta se pueden ejecutar en el cliente.</span><span class="sxs-lookup"><span data-stu-id="f17ea-147">Some expressions in the query might be executed on the client.</span></span> <span data-ttu-id="f17ea-148">En general, se espera que la mayor parte de la ejecución de la consulta se produzca en el servidor.</span><span class="sxs-lookup"><span data-stu-id="f17ea-148">In general, most query execution is expected to occur on the server.</span></span> <span data-ttu-id="f17ea-149">Además de los métodos ejecutados en elementos de consulta asignados al origen de datos, suele haber expresiones de la consulta que se pueden ejecutar localmente.</span><span class="sxs-lookup"><span data-stu-id="f17ea-149">Aside from methods executed against query elements mapped to the data source, there are often expressions in the query that can be executed locally.</span></span> <span data-ttu-id="f17ea-150">La ejecución local de una expresión de consulta produce un valor que se puede utilizar en la ejecución de la consulta o en la generación del resultado.</span><span class="sxs-lookup"><span data-stu-id="f17ea-150">Local execution of a query expression yields a value that can be used in the query execution or result construction.</span></span>  
  
 <span data-ttu-id="f17ea-151">Ciertas operaciones se ejecutan siempre en el cliente, como el enlace de valores, subexpresiones, subconsultas de cierres, y la materialización de objetos en los resultados de la consulta.</span><span class="sxs-lookup"><span data-stu-id="f17ea-151">Certain operations are always executed on the client, such as binding of values, sub expressions, sub queries from closures, and materialization of objects into query results.</span></span> <span data-ttu-id="f17ea-152">La consecuencia final es que estos elementos (por ejemplo, los valores de parámetro) no se pueden actualizar durante la ejecución.</span><span class="sxs-lookup"><span data-stu-id="f17ea-152">The net effect of this is that these elements (for example, parameter values) cannot be updated during the execution.</span></span> <span data-ttu-id="f17ea-153">Los tipos anónimos se pueden crear alineados en el origen de datos, pero no se debe suponer que esto se vaya a producir.</span><span class="sxs-lookup"><span data-stu-id="f17ea-153">Anonymous types can be constructed inline on the data source, but should not be assumed to do so.</span></span> <span data-ttu-id="f17ea-154">Las agrupaciones alineadas también se pueden crear en el almacén, pero no se debe suponer que esto tenga lugar en cada instancia.</span><span class="sxs-lookup"><span data-stu-id="f17ea-154">Inline groupings can be constructed in the data source, as well, but this should not be assumed in every instance.</span></span> <span data-ttu-id="f17ea-155">En general, es preferible no hacer suposiciones sobre lo que se crea en el servidor.</span><span class="sxs-lookup"><span data-stu-id="f17ea-155">In general, it is best not to make any assumptions about what is constructed on the server.</span></span>  
  
 <span data-ttu-id="f17ea-156">En esta sección se describen los escenarios en que el código se ejecuta localmente en el cliente.</span><span class="sxs-lookup"><span data-stu-id="f17ea-156">This section describes the scenarios in which code is executed locally on the client.</span></span> <span data-ttu-id="f17ea-157">Para obtener más información sobre los tipos de expresiones que se ejecutan localmente, vea [expresiones en consultas de LINQ to Entities](expressions-in-linq-to-entities-queries.md).</span><span class="sxs-lookup"><span data-stu-id="f17ea-157">For more information about which types of expressions are executed locally, see [Expressions in LINQ to Entities Queries](expressions-in-linq-to-entities-queries.md).</span></span>  
  
### <a name="literals-and-parameters"></a><span data-ttu-id="f17ea-158">Literales y parámetros</span><span class="sxs-lookup"><span data-stu-id="f17ea-158">Literals and Parameters</span></span>  
 <span data-ttu-id="f17ea-159">Las variables locales, como la variable `orderID` del ejemplo siguiente, se evalúan en el cliente.</span><span class="sxs-lookup"><span data-stu-id="f17ea-159">Local variables, such as the `orderID` variable in the following example, are evaluated on the client.</span></span>  
  
 [!code-csharp[DP L2E Conceptual Examples#LiteralParameter1](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Conceptual Examples/CS/Program.cs#literalparameter1)]
 [!code-vb[DP L2E Conceptual Examples#LiteralParameter1](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Conceptual Examples/VB/Module1.vb#literalparameter1)]  
  
 <span data-ttu-id="f17ea-160">Los parámetros de métodos también se evalúan en el cliente.</span><span class="sxs-lookup"><span data-stu-id="f17ea-160">Method parameters are also evaluated on the client.</span></span> <span data-ttu-id="f17ea-161">El parámetro `orderID` que se pasa al método `MethodParameterExample`, como se puede apreciar más abajo, es un ejemplo.</span><span class="sxs-lookup"><span data-stu-id="f17ea-161">The `orderID` parameter passed into the `MethodParameterExample` method, below, is an example.</span></span>  
  
 [!code-csharp[DP L2E Conceptual Examples#MethodParameterExample](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Conceptual Examples/CS/Program.cs#methodparameterexample)]
 [!code-vb[DP L2E Conceptual Examples#MethodParameterExample](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Conceptual Examples/VB/Module1.vb#methodparameterexample)]  
  
### <a name="casting-literals-on-the-client"></a><span data-ttu-id="f17ea-162">Convertir literales en el cliente</span><span class="sxs-lookup"><span data-stu-id="f17ea-162">Casting Literals on the Client</span></span>  
 <span data-ttu-id="f17ea-163">La conversión de `null` a un tipo CLR se ejecuta en el cliente:</span><span class="sxs-lookup"><span data-stu-id="f17ea-163">Casting from `null` to a CLR type is executed on the client:</span></span>  
  
 [!code-csharp[DP L2E Conceptual Examples#NullCastToString](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Conceptual Examples/CS/Program.cs#nullcasttostring)]
 [!code-vb[DP L2E Conceptual Examples#NullCastToString](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Conceptual Examples/VB/Module1.vb#nullcasttostring)]  
  
 <span data-ttu-id="f17ea-164">La conversión a un tipo, como un <xref:System.Decimal> que acepta valores NULL, se ejecuta en el cliente:</span><span class="sxs-lookup"><span data-stu-id="f17ea-164">Casting to a type, such as a nullable <xref:System.Decimal>, is executed on the client:</span></span>  
  
 [!code-csharp[DP L2E Conceptual Examples#CastToNullable](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Conceptual Examples/CS/Program.cs#casttonullable)]
 [!code-vb[DP L2E Conceptual Examples#CastToNullable](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Conceptual Examples/VB/Module1.vb#casttonullable)]  
  
### <a name="constructors-for-literals"></a><span data-ttu-id="f17ea-165">Constructores para literales</span><span class="sxs-lookup"><span data-stu-id="f17ea-165">Constructors for Literals</span></span>  
 <span data-ttu-id="f17ea-166">Los nuevos tipos CLR que se pueden asignar a tipos del modelo conceptual se ejecutan en el cliente:</span><span class="sxs-lookup"><span data-stu-id="f17ea-166">New CLR types that can be mapped to conceptual model types are executed on the client:</span></span>  
  
 [!code-csharp[DP L2E Conceptual Examples#ConstructorForLiteral](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Conceptual Examples/CS/Program.cs#constructorforliteral)]
 [!code-vb[DP L2E Conceptual Examples#ConstructorForLiteral](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Conceptual Examples/VB/Module1.vb#constructorforliteral)]  
  
 <span data-ttu-id="f17ea-167">Las nuevas matrices también se ejecutan en el cliente.</span><span class="sxs-lookup"><span data-stu-id="f17ea-167">New arrays are also executed on the client.</span></span>  
  
## <a name="store-exceptions"></a><span data-ttu-id="f17ea-168">Excepciones en el almacén</span><span class="sxs-lookup"><span data-stu-id="f17ea-168">Store Exceptions</span></span>  
 <span data-ttu-id="f17ea-169">Los errores en el almacén que tienen lugar durante la ejecución de la consulta se pasan al cliente y no se asignan ni controlan.</span><span class="sxs-lookup"><span data-stu-id="f17ea-169">Any store errors that are encountered during query execution are passed up to the client, and are not mapped or handled.</span></span>  
  
## <a name="store-configuration"></a><span data-ttu-id="f17ea-170">Configuración del almacén</span><span class="sxs-lookup"><span data-stu-id="f17ea-170">Store Configuration</span></span>  
 <span data-ttu-id="f17ea-171">Cuando la consulta se ejecuta en el almacén, la configuración del almacén invalida todos los comportamientos del cliente, y la semántica del almacén se expresa para todas las operaciones y expresiones.</span><span class="sxs-lookup"><span data-stu-id="f17ea-171">When the query executes on the store, the store configuration overrides all client behaviors, and store semantics are expressed for all operations and expressions.</span></span> <span data-ttu-id="f17ea-172">El resultado puede ser una diferencia de comportamiento entre la ejecución en el CLR y la ejecución en el almacén en áreas como las comparaciones de NULL, la ordenación de GUID, la precisión y la exactitud de las operaciones que afectan a tipos de datos no precisos (como los tipos de punto flotante o <xref:System.DateTime>) y las operaciones de cadena.</span><span class="sxs-lookup"><span data-stu-id="f17ea-172">This can result in a difference in behavior between CLR and store execution in areas such as null comparisons, GUID ordering, precision and accuracy of operations involving non-precise data types (such as floating point types or <xref:System.DateTime>), and string operations.</span></span> <span data-ttu-id="f17ea-173">Es importante tener esto en cuenta al examinar los resultados de la consulta.</span><span class="sxs-lookup"><span data-stu-id="f17ea-173">It is important to keep this in mind when examining query results.</span></span>  
  
 <span data-ttu-id="f17ea-174">Por ejemplo, a continuación se indican algunas diferencias de comportamiento entre CLR y SQL Server:</span><span class="sxs-lookup"><span data-stu-id="f17ea-174">For example, the following are some differences in behavior between the CLR and SQL Server:</span></span>  
  
- <span data-ttu-id="f17ea-175">SQL Server ordena los GUID de manera diferente que CLR.</span><span class="sxs-lookup"><span data-stu-id="f17ea-175">SQL Server orders GUIDs differently than the CLR.</span></span>  
  
- <span data-ttu-id="f17ea-176">También puede haber diferencias en la precisión del resultado cuando se trabaja con el tipo Decimal en SQL Server.</span><span class="sxs-lookup"><span data-stu-id="f17ea-176">There can also be differences in result precision when dealing with the Decimal type on SQL Server.</span></span> <span data-ttu-id="f17ea-177">Esto se debe a los requisitos de precisión fijados para el tipo decimal de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="f17ea-177">This is due to the fixed precision requirements of the SQL Server decimal type.</span></span> <span data-ttu-id="f17ea-178">Por ejemplo, el valor medio de los valores <xref:System.Decimal> 0.0, 0.0, y 1.0 es 0.3333333333333333333333333333 en memoria en el cliente, pero 0.333333 en el almacén (si se toma como base la precisión predeterminada para el tipo decimal de SQL Server).</span><span class="sxs-lookup"><span data-stu-id="f17ea-178">For example, the average of <xref:System.Decimal> values 0.0, 0.0, and 1.0 is 0.3333333333333333333333333333 in memory on the client, but 0.333333 in the store (based on the default precision for SQL Server’s decimal type).</span></span>  
  
- <span data-ttu-id="f17ea-179">Algunas operaciones de comparación de cadenas también se tratan en SQL Server de forma diferente que en CLR.</span><span class="sxs-lookup"><span data-stu-id="f17ea-179">Some string comparison operations are also handled differently in SQL Server than in the CLR.</span></span> <span data-ttu-id="f17ea-180">El comportamiento de la comparación de cadenas depende de los valores de intercalación en el servidor.</span><span class="sxs-lookup"><span data-stu-id="f17ea-180">String comparison behavior depends on the collation settings on the server.</span></span>  
  
- <span data-ttu-id="f17ea-181">Las llamadas a funciones o métodos, cuando se incluyen en una consulta de LINQ to Entities, se asignan a funciones canónicas en Entity Framework, que, posteriormente, se convierten a Transact-SQL y se ejecutan en la base de datos de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="f17ea-181">Function or method calls, when included in a LINQ to Entities query, are mapped to canonical functions in the Entity Framework, which are then translated to Transact-SQL and executed on the SQL Server database.</span></span> <span data-ttu-id="f17ea-182">Hay casos en que el comportamiento que muestran estas funciones asignadas puede diferir de la implementación en las bibliotecas de clases base.</span><span class="sxs-lookup"><span data-stu-id="f17ea-182">There are cases when the behavior these mapped functions exhibit might differ from the implementation in the base class libraries.</span></span> <span data-ttu-id="f17ea-183">Por ejemplo, una llamada a los métodos <xref:System.String.Contains%2A>, <xref:System.String.StartsWith%2A> y <xref:System.String.EndsWith%2A> con una cadena vacía como parámetro, devolverá `true` si se ejecuta en CLR pero devolverá `false` si se ejecuta en SQL Server.</span><span class="sxs-lookup"><span data-stu-id="f17ea-183">For example, calling the <xref:System.String.Contains%2A>, <xref:System.String.StartsWith%2A>, and <xref:System.String.EndsWith%2A> methods with an empty string as a parameter will return `true` when executed in the CLR, but will return `false` when executed in SQL Server.</span></span> <span data-ttu-id="f17ea-184">El método <xref:System.String.EndsWith%2A> también puede devolver resultados diferentes porque SQL Server considera que dos cadenas son iguales si solo se diferencian en el espacio en blanco final, mientras que CLR considera que no son iguales.</span><span class="sxs-lookup"><span data-stu-id="f17ea-184">The <xref:System.String.EndsWith%2A> method can also return different results because SQL Server considers two strings to be equal if they only differ in trailing white space, whereas the CLR considers them to be not equal.</span></span> <span data-ttu-id="f17ea-185">Esto se muestra en el ejemplo siguiente:</span><span class="sxs-lookup"><span data-stu-id="f17ea-185">This is illustrated by the following example:</span></span>  
  
 [!code-csharp[DP L2E Conceptual Examples#CanonicalFuncVsCLRBaseType](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Conceptual Examples/CS/Program.cs#canonicalfuncvsclrbasetype)]
 [!code-vb[DP L2E Conceptual Examples#CanonicalFuncVsCLRBaseType](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Conceptual Examples/VB/Module1.vb#canonicalfuncvsclrbasetype)]
