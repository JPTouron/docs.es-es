---
title: Información general sobre eventos enrutados
description: Obtenga información sobre los eventos enrutados en Windows Presentation Foundation, incluido cómo se enrutan a través de un árbol de elementos y cómo crear eventos enrutados personalizados.
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- attached events [WPF]
- grouped button set [WPF]
- routed events [WPF]
- events [WPF], routed
- tunneling [WPF]
- events [WPF], attached
- routing strategies for events [WPF]
- button set [WPF], grouped
- bubbling [WPF]
ms.assetid: 1a2189ae-13b4-45b0-b12c-8de2e49c29d2
ms.openlocfilehash: d18b511a4886c68922cccac14942eb54e5735a71
ms.sourcegitcommit: 87cfeb69226fef01acb17c56c86f978f4f4a13db
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 07/24/2020
ms.locfileid: "87164810"
---
# <a name="routed-events-overview"></a><span data-ttu-id="72bca-103">Información general sobre eventos enrutados</span><span class="sxs-lookup"><span data-stu-id="72bca-103">Routed Events Overview</span></span>

<span data-ttu-id="72bca-104">En este tema se describe el concepto de eventos enrutados en [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="72bca-104">This topic describes the concept of routed events in [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)].</span></span> <span data-ttu-id="72bca-105">En el tema se define la terminología de los eventos enrutados, se describe cómo se enrutan a través de un árbol de elementos, se resume cómo controlar los eventos enrutados y se explica cómo crear sus propios eventos enrutados personalizados.</span><span class="sxs-lookup"><span data-stu-id="72bca-105">The topic defines routed events terminology, describes how routed events are routed through a tree of elements, summarizes how you handle routed events, and introduces how to create your own custom routed events.</span></span>

<a name="prerequisites"></a>

## <a name="prerequisites"></a><span data-ttu-id="72bca-106">Requisitos previos</span><span class="sxs-lookup"><span data-stu-id="72bca-106">Prerequisites</span></span>

<span data-ttu-id="72bca-107">En este tema se da por supuesto que tiene conocimientos básicos del Common Language Runtime (CLR) y la programación orientada a objetos, así como el concepto de cómo se pueden distinguir las relaciones entre los [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] elementos como un árbol.</span><span class="sxs-lookup"><span data-stu-id="72bca-107">This topic assumes that you have basic knowledge of the common language runtime (CLR) and object-oriented programming, as well as the concept of how the relationships between [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] elements can be conceptualized as a tree.</span></span> <span data-ttu-id="72bca-108">Para seguir los ejemplos de este tema, también debe comprender [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] y saber cómo escribir páginas o aplicaciones de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] muy básicas.</span><span class="sxs-lookup"><span data-stu-id="72bca-108">In order to follow the examples in this topic, you should also understand [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] and know how to write very basic [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] applications or pages.</span></span> <span data-ttu-id="72bca-109">Para obtener más información, vea [Tutorial: mi primera aplicación de escritorio WPF](../getting-started/walkthrough-my-first-wpf-desktop-application.md) e [información general sobre XAML (WPF)](../../../desktop-wpf/fundamentals/xaml.md).</span><span class="sxs-lookup"><span data-stu-id="72bca-109">For more information, see [Walkthrough: My first WPF desktop application](../getting-started/walkthrough-my-first-wpf-desktop-application.md) and [XAML Overview (WPF)](../../../desktop-wpf/fundamentals/xaml.md).</span></span>

<a name="routing"></a>

## <a name="what-is-a-routed-event"></a><span data-ttu-id="72bca-110">¿Qué es un evento enrutado?</span><span class="sxs-lookup"><span data-stu-id="72bca-110">What Is a Routed Event?</span></span>

<span data-ttu-id="72bca-111">Los eventos enrutados se pueden considerar desde dos perspectivas: funcional y de implementación.</span><span class="sxs-lookup"><span data-stu-id="72bca-111">You can think about routed events either from a functional or implementation perspective.</span></span> <span data-ttu-id="72bca-112">Aquí se presentan ambas definiciones, dado que algunas personas encuentran que una es más útil que la otra.</span><span class="sxs-lookup"><span data-stu-id="72bca-112">Both definitions are presented here, because some people find one or the other definition more useful.</span></span>

<span data-ttu-id="72bca-113">Definición funcional: un evento enrutado es un tipo de evento que puede invocar controladores en varios agentes de escucha en un árbol de elementos, en lugar de simplemente en el objeto que ha generado el evento.</span><span class="sxs-lookup"><span data-stu-id="72bca-113">Functional definition: A routed event is a type of event that can invoke handlers on multiple listeners in an element tree, rather than just on the object that raised the event.</span></span>

<span data-ttu-id="72bca-114">Definición de implementación: un evento enrutado es un evento CLR respaldado por una instancia de la <xref:System.Windows.RoutedEvent> clase y se procesa mediante el [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] sistema de eventos.</span><span class="sxs-lookup"><span data-stu-id="72bca-114">Implementation definition: A routed event is a CLR event that is backed by an instance of the <xref:System.Windows.RoutedEvent> class and is processed by the [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] event system.</span></span>

<span data-ttu-id="72bca-115">Una aplicación típica de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contiene muchos elementos.</span><span class="sxs-lookup"><span data-stu-id="72bca-115">A typical [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application contains many elements.</span></span> <span data-ttu-id="72bca-116">Tanto si se crean en código como si se declaran en [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], estos elementos se relacionan entre sí a través de un árbol de elementos.</span><span class="sxs-lookup"><span data-stu-id="72bca-116">Whether created in code or declared in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], these elements exist in an element tree relationship to each other.</span></span> <span data-ttu-id="72bca-117">En función de la definición del evento, la ruta de eventos puede viajar en cualquiera de las dos direcciones, pero generalmente viaja desde el elemento de origen y, después, "se propaga" en sentido ascendente por el árbol de elementos hasta que llega a la raíz (normalmente una página o una ventana).</span><span class="sxs-lookup"><span data-stu-id="72bca-117">The event route can travel in one of two directions depending on the event definition, but generally the route travels from the source element and then "bubbles" upward through the element tree until it reaches the element tree root (typically a page or a window).</span></span> <span data-ttu-id="72bca-118">Es posible que este concepto de propagación le resulte familiar si ha trabajado previamente con el modelo de objetos DHTML.</span><span class="sxs-lookup"><span data-stu-id="72bca-118">This bubbling concept might be familiar to you if you have worked with the DHTML object model previously.</span></span>

<span data-ttu-id="72bca-119">Considere el siguiente árbol de elementos simple:</span><span class="sxs-lookup"><span data-stu-id="72bca-119">Consider the following simple element tree:</span></span>

[!code-xaml[EventOvwSupport#GroupButton](~/samples/snippets/csharp/VS_Snippets_Wpf/EventOvwSupport/CSharp/default.xaml#groupbutton)]

<span data-ttu-id="72bca-120">Este árbol de elementos genera algo parecido a lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="72bca-120">This element tree produces something like the following:</span></span>

<span data-ttu-id="72bca-121">![Botones sí, no y cancelar](./media/routedevent-ovw-1.gif "RoutedEvent_ovw_1")</span><span class="sxs-lookup"><span data-stu-id="72bca-121">![Yes, No, and Cancel buttons](./media/routedevent-ovw-1.gif "RoutedEvent_ovw_1")</span></span>

<span data-ttu-id="72bca-122">En este árbol de elementos simplificado, el origen de un <xref:System.Windows.Controls.Primitives.ButtonBase.Click> evento es uno de los <xref:System.Windows.Controls.Button> elementos, y lo <xref:System.Windows.Controls.Button> que se hizo clic es el primer elemento que tiene la oportunidad de controlar el evento.</span><span class="sxs-lookup"><span data-stu-id="72bca-122">In this simplified element tree, the source of a <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event is one of the <xref:System.Windows.Controls.Button> elements, and whichever <xref:System.Windows.Controls.Button> was clicked is the first element that has the opportunity to handle the event.</span></span> <span data-ttu-id="72bca-123">Pero si ningún controlador asociado a <xref:System.Windows.Controls.Button> actúa en el evento, el evento se propagará hacia arriba hasta el <xref:System.Windows.Controls.Button> elemento primario en el árbol de elementos, que es <xref:System.Windows.Controls.StackPanel> .</span><span class="sxs-lookup"><span data-stu-id="72bca-123">But if no handler attached to the <xref:System.Windows.Controls.Button> acts on the event, then the event will bubble upwards to the <xref:System.Windows.Controls.Button> parent in the element tree, which is the <xref:System.Windows.Controls.StackPanel>.</span></span> <span data-ttu-id="72bca-124">Potencialmente, el evento se propaga a <xref:System.Windows.Controls.Border> y después más allá de la raíz de la página del árbol de elementos (no se muestra).</span><span class="sxs-lookup"><span data-stu-id="72bca-124">Potentially, the event bubbles to <xref:System.Windows.Controls.Border>, and then beyond to the page root of the element tree (not shown).</span></span>

<span data-ttu-id="72bca-125">En otras palabras, la ruta de eventos para este <xref:System.Windows.Controls.Primitives.ButtonBase.Click> evento es:</span><span class="sxs-lookup"><span data-stu-id="72bca-125">In other words, the event route for this <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event is:</span></span>

<span data-ttu-id="72bca-126">Botón-->StackPanel-->Borde-->...</span><span class="sxs-lookup"><span data-stu-id="72bca-126">Button-->StackPanel-->Border-->...</span></span>

### <a name="top-level-scenarios-for-routed-events"></a><span data-ttu-id="72bca-127">Escenarios de nivel superior para los eventos enrutados</span><span class="sxs-lookup"><span data-stu-id="72bca-127">Top-level Scenarios for Routed Events</span></span>

<span data-ttu-id="72bca-128">A continuación se encuentra un breve resumen de los escenarios que motivaron el concepto de evento enrutado y por qué un evento CLR típico no era adecuado para estos escenarios:</span><span class="sxs-lookup"><span data-stu-id="72bca-128">The following is a brief summary of the scenarios that motivated the routed event concept, and why a typical CLR event was not adequate for these scenarios:</span></span>

<span data-ttu-id="72bca-129">**Encapsulación y composición de controles:** varios controles de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] tienen un modelo de contenido enriquecido.</span><span class="sxs-lookup"><span data-stu-id="72bca-129">**Control composition and encapsulation:** Various controls in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] have a rich content model.</span></span> <span data-ttu-id="72bca-130">Por ejemplo, puede colocar una imagen dentro de un <xref:System.Windows.Controls.Button> , lo que extiende eficazmente el árbol visual del botón.</span><span class="sxs-lookup"><span data-stu-id="72bca-130">For example, you can place an image inside of a <xref:System.Windows.Controls.Button>, which effectively extends the visual tree of the button.</span></span> <span data-ttu-id="72bca-131">Sin embargo, la imagen agregada no debe interrumpir el comportamiento de la prueba de posicionamiento que hace que un botón responda a un <xref:System.Windows.Controls.Primitives.ButtonBase.Click> de su contenido, incluso si el usuario hace clic en píxeles que técnicamente forman parte de la imagen.</span><span class="sxs-lookup"><span data-stu-id="72bca-131">However, the added image must not break the hit-testing behavior that causes a button to respond to a <xref:System.Windows.Controls.Primitives.ButtonBase.Click> of its content, even if the user clicks on pixels that are technically part of the image.</span></span>

<span data-ttu-id="72bca-132">**Puntos de datos adjuntos de controlador singular:** En Windows Forms, tendría que adjuntar varias veces el mismo controlador para procesar los eventos que podrían generarse desde varios elementos.</span><span class="sxs-lookup"><span data-stu-id="72bca-132">**Singular handler attachment points:** In Windows Forms, you would have to attach the same handler multiple times to process events that could be raised from multiple elements.</span></span> <span data-ttu-id="72bca-133">Los eventos enrutados le permiten asociar ese controlador una sola vez, tal como se ha mostrado en el ejemplo anterior, y usar la lógica del controlador para determinar el origen del evento si fuera necesario.</span><span class="sxs-lookup"><span data-stu-id="72bca-133">Routed events enable you to attach that handler only once, as was shown in the previous example, and use handler logic to determine where the event came from if necessary.</span></span> <span data-ttu-id="72bca-134">Por ejemplo, este podría ser el controlador para el [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] mostrado anteriormente:</span><span class="sxs-lookup"><span data-stu-id="72bca-134">For instance, this might be the handler for the previously shown [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]:</span></span>

[!code-csharp[EventOvwSupport#GroupButtonCodeBehind](~/samples/snippets/csharp/VS_Snippets_Wpf/EventOvwSupport/CSharp/default.xaml.cs#groupbuttoncodebehind)]
[!code-vb[EventOvwSupport#GroupButtonCodeBehind](~/samples/snippets/visualbasic/VS_Snippets_Wpf/EventOvwSupport/visualbasic/default.xaml.vb#groupbuttoncodebehind)]

<span data-ttu-id="72bca-135">**Control de clases:** los eventos enrutados permiten un controlador estático definido por la clase.</span><span class="sxs-lookup"><span data-stu-id="72bca-135">**Class handling:** Routed events permit a static handler that is defined by the class.</span></span> <span data-ttu-id="72bca-136">Este controlador de clase tiene la oportunidad de controlar un evento antes de que pueda hacerlo cualquiera de los controladores de instancia asociados.</span><span class="sxs-lookup"><span data-stu-id="72bca-136">This class handler has the opportunity to handle an event before any attached instance handlers can.</span></span>

<span data-ttu-id="72bca-137">**Hacer referencia a un evento sin reflexión:** determinadas técnicas de código y de marcado requieren una manera de identificar un evento concreto.</span><span class="sxs-lookup"><span data-stu-id="72bca-137">**Referencing an event without reflection:** Certain code and markup techniques require a way to identify a specific event.</span></span> <span data-ttu-id="72bca-138">Un evento enrutado crea un <xref:System.Windows.RoutedEvent> campo como identificador, lo que proporciona una técnica de identificación de eventos sólida que no requiere reflexión estática o en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="72bca-138">A routed event creates a <xref:System.Windows.RoutedEvent> field as an identifier, which provides a robust event identification technique that does not require static or run-time reflection.</span></span>

### <a name="how-routed-events-are-implemented"></a><span data-ttu-id="72bca-139">Cómo se implementan los eventos enrutados</span><span class="sxs-lookup"><span data-stu-id="72bca-139">How Routed Events Are Implemented</span></span>

<span data-ttu-id="72bca-140">Un evento enrutado es un evento CLR respaldado por una instancia de la <xref:System.Windows.RoutedEvent> clase y registrado con el [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] sistema de eventos.</span><span class="sxs-lookup"><span data-stu-id="72bca-140">A routed event is a CLR event that is backed by an instance of the <xref:System.Windows.RoutedEvent> class and registered with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] event system.</span></span> <span data-ttu-id="72bca-141"><xref:System.Windows.RoutedEvent>Normalmente, la instancia obtenida del registro se conserva como un `public` `static` `readonly` miembro de campo de la clase que registra y, por lo tanto, "posee" el evento enrutado.</span><span class="sxs-lookup"><span data-stu-id="72bca-141">The <xref:System.Windows.RoutedEvent> instance obtained from registration is typically retained as a `public` `static` `readonly` field member of the class that registers and thus "owns" the routed event.</span></span> <span data-ttu-id="72bca-142">La conexión al evento CLR con el mismo nombre (que a veces se denomina el evento "contenedor") se logra invalidando las `add` `remove` implementaciones y para el evento CLR.</span><span class="sxs-lookup"><span data-stu-id="72bca-142">The connection to the identically named CLR event (which is sometimes termed the "wrapper" event) is accomplished by overriding the `add` and `remove` implementations for the CLR event.</span></span> <span data-ttu-id="72bca-143">Normalmente, `add` y `remove` se dejan como un valor predeterminado implícito que usa la sintaxis de eventos específica del lenguaje adecuada para agregar y quitar controladores de ese evento.</span><span class="sxs-lookup"><span data-stu-id="72bca-143">Ordinarily, the `add` and `remove` are left as an implicit default that uses the appropriate language-specific event syntax for adding and removing handlers of that event.</span></span> <span data-ttu-id="72bca-144">El mecanismo de respaldo y conexión de eventos enrutados es conceptualmente similar a la forma en que una propiedad de dependencia es una propiedad de CLR respaldada por la <xref:System.Windows.DependencyProperty> clase y registrada con el [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] sistema de propiedades.</span><span class="sxs-lookup"><span data-stu-id="72bca-144">The routed event backing and connection mechanism is conceptually similar to how a dependency property is a CLR property that is backed by the <xref:System.Windows.DependencyProperty> class and registered with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] property system.</span></span>

<span data-ttu-id="72bca-145">En el ejemplo siguiente se muestra la declaración de un `Tap` evento enrutado personalizado, incluido el registro y la exposición del <xref:System.Windows.RoutedEvent> campo identificador y las `add` `remove` implementaciones y para el `Tap` evento CLR.</span><span class="sxs-lookup"><span data-stu-id="72bca-145">The following example shows the declaration for a custom `Tap` routed event, including the registration and exposure of the <xref:System.Windows.RoutedEvent> identifier field and the `add` and `remove` implementations for the `Tap` CLR event.</span></span>

[!code-csharp[RoutedEventCustom#AddRemoveHandler](~/samples/snippets/csharp/VS_Snippets_Wpf/RoutedEventCustom/CSharp/SDKSampleLibrary/class1.cs#addremovehandler)]
[!code-vb[RoutedEventCustom#AddRemoveHandler](~/samples/snippets/visualbasic/VS_Snippets_Wpf/RoutedEventCustom/VB/SDKSampleLibrary/Class1.vb#addremovehandler)]

### <a name="routed-event-handlers-and-xaml"></a><span data-ttu-id="72bca-146">Controladores de eventos enrutados y XAML</span><span class="sxs-lookup"><span data-stu-id="72bca-146">Routed Event Handlers and XAML</span></span>

<span data-ttu-id="72bca-147">Para agregar un controlador para un evento mediante [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], declare el nombre del evento como un atributo en el elemento que actúa como agente de escucha de eventos.</span><span class="sxs-lookup"><span data-stu-id="72bca-147">To add a handler for an event using [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], you declare the event name as an attribute on the element that is an event listener.</span></span> <span data-ttu-id="72bca-148">El valor del atributo es el nombre de su método de controlador implementado, que debe existir en la clase parcial del archivo de código subyacente.</span><span class="sxs-lookup"><span data-stu-id="72bca-148">The value of the attribute is the name of your implemented handler method, which must exist in the partial class of the code-behind file.</span></span>

[!code-xaml[EventOvwSupport#SimplestSyntax](~/samples/snippets/csharp/VS_Snippets_Wpf/EventOvwSupport/CSharp/default.xaml#simplestsyntax)]

<span data-ttu-id="72bca-149">La [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] sintaxis para agregar controladores de eventos CLR estándar es la misma para agregar controladores de eventos enrutados, ya que en realidad se agregan controladores al contenedor de eventos de CLR, que tiene una implementación de eventos enrutados debajo.</span><span class="sxs-lookup"><span data-stu-id="72bca-149">The [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] syntax for adding standard CLR event handlers is the same for adding routed event handlers, because you are really adding handlers to the CLR event wrapper, which has a routed event implementation underneath.</span></span> <span data-ttu-id="72bca-150">Para más información sobre cómo agregar controladores de eventos en [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], vea [Información general sobre XAML (WPF)](../../../desktop-wpf/fundamentals/xaml.md).</span><span class="sxs-lookup"><span data-stu-id="72bca-150">For more information about adding event handlers in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], see [XAML Overview (WPF)](../../../desktop-wpf/fundamentals/xaml.md).</span></span>

<a name="routing_strategies"></a>

## <a name="routing-strategies"></a><span data-ttu-id="72bca-151">Estrategias de enrutamiento</span><span class="sxs-lookup"><span data-stu-id="72bca-151">Routing Strategies</span></span>

<span data-ttu-id="72bca-152">Los eventos enrutados usan una de estas tres estrategias de enrutamiento:</span><span class="sxs-lookup"><span data-stu-id="72bca-152">Routed events use one of three routing strategies:</span></span>

- <span data-ttu-id="72bca-153">**Propagación:** se invocan los controladores de eventos en el origen del evento.</span><span class="sxs-lookup"><span data-stu-id="72bca-153">**Bubbling:** Event handlers on the event source are invoked.</span></span> <span data-ttu-id="72bca-154">Después, el evento enrutado va pasando por los elementos primarios sucesivos hasta alcanzar la raíz del árbol de elementos.</span><span class="sxs-lookup"><span data-stu-id="72bca-154">The routed event then routes to successive parent elements until reaching the element tree root.</span></span> <span data-ttu-id="72bca-155">La mayoría de los eventos enrutados usan la estrategia del enrutamiento de propagación.</span><span class="sxs-lookup"><span data-stu-id="72bca-155">Most routed events use the bubbling routing strategy.</span></span> <span data-ttu-id="72bca-156">Los eventos con enrutamiento de propagación generalmente se usan para informar sobre cambios de entrada o de estado procedentes de controles distintos u otros elementos de la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="72bca-156">Bubbling routed events are generally used to report input or state changes from distinct controls or other UI elements.</span></span>

- <span data-ttu-id="72bca-157">**Directo:** solo el propio elemento de origen tiene la oportunidad de invocar controladores como respuesta.</span><span class="sxs-lookup"><span data-stu-id="72bca-157">**Direct:** Only the source element itself is given the opportunity to invoke handlers in response.</span></span> <span data-ttu-id="72bca-158">Es análogo al "enrutamiento" que Windows Forms usa para los eventos.</span><span class="sxs-lookup"><span data-stu-id="72bca-158">This is analogous to the "routing" that Windows Forms uses for events.</span></span> <span data-ttu-id="72bca-159">Sin embargo, a diferencia de un evento CLR estándar, los eventos enrutados directos admiten el control de clases (el control de clases se explica en una próxima sección) y se pueden usar con <xref:System.Windows.EventSetter> y <xref:System.Windows.EventTrigger> .</span><span class="sxs-lookup"><span data-stu-id="72bca-159">However, unlike a standard CLR event, direct routed events support class handling (class handling is explained in an upcoming section) and can be used by <xref:System.Windows.EventSetter> and <xref:System.Windows.EventTrigger>.</span></span>

- <span data-ttu-id="72bca-160">**Tunelización:** inicialmente, se invocan los controladores de eventos en la raíz del árbol de elementos.</span><span class="sxs-lookup"><span data-stu-id="72bca-160">**Tunneling:** Initially, event handlers at the element tree root are invoked.</span></span> <span data-ttu-id="72bca-161">Después, el evento enrutado viaja a través de los elementos secundarios sucesivos a lo largo de la ruta, hacia el elemento de nodo que es el origen del evento enrutado (el elemento que ha desencadenado el evento enrutado).</span><span class="sxs-lookup"><span data-stu-id="72bca-161">The routed event then travels a route through successive child elements along the route, towards the node element that is the routed event source (the element that raised the routed event).</span></span> <span data-ttu-id="72bca-162">Los eventos con enrutamiento de tunelización se suelen usar o controlar como parte de la composición de un control, de forma que los eventos de las partes compuestas se puedan suprimir o reemplazar deliberadamente por eventos que son específicos del control completo.</span><span class="sxs-lookup"><span data-stu-id="72bca-162">Tunneling routed events are often used or handled as part of the compositing for a control, such that events from composite parts can be deliberately suppressed or replaced by events that are specific to the complete control.</span></span> <span data-ttu-id="72bca-163">Los eventos de entrada proporcionados en [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] se suelen implementar como un par de tunelización-propagación.</span><span class="sxs-lookup"><span data-stu-id="72bca-163">Input events provided in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] often come implemented as a tunneling/bubbling pair.</span></span> <span data-ttu-id="72bca-164">Los eventos de tunelización también se conocen a veces como eventos de vista previa, debido a una convención de nomenclatura que se usa para los pares.</span><span class="sxs-lookup"><span data-stu-id="72bca-164">Tunneling events are also sometimes referred to as Preview events, because of a naming convention that is used for the pairs.</span></span>

<a name="why_use"></a>

## <a name="why-use-routed-events"></a><span data-ttu-id="72bca-165">¿Por qué usar eventos enrutados?</span><span class="sxs-lookup"><span data-stu-id="72bca-165">Why Use Routed Events?</span></span>

<span data-ttu-id="72bca-166">Como desarrollador de aplicaciones, no siempre necesita saber ni preocuparse de si el evento que está controlando se implementa como un evento enrutado.</span><span class="sxs-lookup"><span data-stu-id="72bca-166">As an application developer, you do not always need to know or care that the event you are handling is implemented as a routed event.</span></span> <span data-ttu-id="72bca-167">Los eventos enrutados tienen un comportamiento especial, pero ese comportamiento es prácticamente invisible si está controlando un evento en el elemento donde se desencadena.</span><span class="sxs-lookup"><span data-stu-id="72bca-167">Routed events have special behavior, but that behavior is largely invisible if you are handling an event on the element where it is raised.</span></span>

<span data-ttu-id="72bca-168">Los eventos enrutados demuestran su eficacia cuando se usa cualquiera de los escenarios sugeridos: definir los controladores comunes en una raíz común, componer un control personalizado o definir una clase de controles personalizada.</span><span class="sxs-lookup"><span data-stu-id="72bca-168">Where routed events become powerful is if you use any of the suggested scenarios: defining common handlers at a common root, compositing your own control, or defining your own custom control class.</span></span>

<span data-ttu-id="72bca-169">Los agentes de escucha y los orígenes de los eventos enrutados no necesitan compartir un evento común en su jerarquía.</span><span class="sxs-lookup"><span data-stu-id="72bca-169">Routed event listeners and routed event sources do not need to share a common event in their hierarchy.</span></span> <span data-ttu-id="72bca-170">Any <xref:System.Windows.UIElement> o <xref:System.Windows.ContentElement> puede ser un agente de escucha de eventos para cualquier evento enrutado.</span><span class="sxs-lookup"><span data-stu-id="72bca-170">Any <xref:System.Windows.UIElement> or <xref:System.Windows.ContentElement> can be an event listener for any routed event.</span></span> <span data-ttu-id="72bca-171">Por lo tanto, puede usar el conjunto completo de eventos enrutados disponibles en el conjunto de API de trabajo como una "interfaz" conceptual en la que los elementos dispares de la aplicación pueden intercambiar información de eventos.</span><span class="sxs-lookup"><span data-stu-id="72bca-171">Therefore, you can use the full set of routed events available throughout the working API set as a conceptual "interface" whereby disparate elements in the application can exchange event information.</span></span> <span data-ttu-id="72bca-172">Este concepto de "interfaz" para los eventos enrutados es especialmente aplicable a los eventos de entrada.</span><span class="sxs-lookup"><span data-stu-id="72bca-172">This "interface" concept for routed events is particularly applicable for input events.</span></span>

<span data-ttu-id="72bca-173">Los eventos enrutados también se pueden usar para comunicar datos a través del árbol de elementos, porque los datos de evento para cada evento se perpetúan en cada elemento de la ruta.</span><span class="sxs-lookup"><span data-stu-id="72bca-173">Routed events can also be used to communicate through the element tree, because the event data for the event is perpetuated to each element in the route.</span></span> <span data-ttu-id="72bca-174">Un elemento podría cambiar algo en los datos del evento, y ese cambio estaría disponible para el elemento siguiente de la ruta.</span><span class="sxs-lookup"><span data-stu-id="72bca-174">One element could change something in the event data, and that change would be available to the next element in the route.</span></span>

<span data-ttu-id="72bca-175">Aparte del aspecto de enrutamiento, hay otras dos razones por las que cualquier [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] evento determinado podría implementarse como un evento enrutado en lugar de un evento CLR estándar.</span><span class="sxs-lookup"><span data-stu-id="72bca-175">Other than the routing aspect, there are two other reasons that any given [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] event might be implemented as a routed event instead of a standard CLR event.</span></span> <span data-ttu-id="72bca-176">Si está implementando sus propios eventos, también podría considerar estos principios:</span><span class="sxs-lookup"><span data-stu-id="72bca-176">If you are implementing your own events, you might also consider these principles:</span></span>

- <span data-ttu-id="72bca-177">Ciertas [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] características de estilo y plantillas como <xref:System.Windows.EventSetter> y <xref:System.Windows.EventTrigger> requieren que el evento al que se hace referencia sea un evento enrutado.</span><span class="sxs-lookup"><span data-stu-id="72bca-177">Certain [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] styling and templating features such as <xref:System.Windows.EventSetter> and <xref:System.Windows.EventTrigger> require the referenced event to be a routed event.</span></span> <span data-ttu-id="72bca-178">Este es el escenario del identificador de eventos mencionado anteriormente.</span><span class="sxs-lookup"><span data-stu-id="72bca-178">This is the event identifier scenario mentioned earlier.</span></span>

- <span data-ttu-id="72bca-179">Los eventos enrutados admiten un mecanismo de control de clases en el que la clase puede especificar métodos estáticos que tienen la oportunidad de controlar eventos enrutados antes de que cualquier controlador de instancias registrado tenga acceso a ellos.</span><span class="sxs-lookup"><span data-stu-id="72bca-179">Routed events support a class handling mechanism whereby the class can specify static methods that have the opportunity to handle routed events before any registered instance handlers can access them.</span></span> <span data-ttu-id="72bca-180">Esto es muy útil en el diseño de controles, porque una clase puede exigir comportamientos de clase orientados a eventos que no se puedan suprimir accidentalmente controlando un evento en una instancia.</span><span class="sxs-lookup"><span data-stu-id="72bca-180">This is very useful in control design, because your class can enforce event-driven class behaviors that cannot be accidentally suppressed by handling an event on an instance.</span></span>

<span data-ttu-id="72bca-181">Cada una de las consideraciones anteriores se explica en una sección independiente de este tema.</span><span class="sxs-lookup"><span data-stu-id="72bca-181">Each of the above considerations is discussed in a separate section of this topic.</span></span>

<a name="event_handing"></a>

## <a name="adding-and-implementing-an-event-handler-for-a-routed-event"></a><span data-ttu-id="72bca-182">Agregar e implementar un controlador de eventos para un evento enrutado</span><span class="sxs-lookup"><span data-stu-id="72bca-182">Adding and Implementing an Event Handler for a Routed Event</span></span>

<span data-ttu-id="72bca-183">Para agregar un controlador de eventos en [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], simplemente agregue el nombre del evento a un elemento como un atributo y establezca el valor del atributo como el nombre del controlador de eventos que implementa un delegado adecuado, como en el ejemplo siguiente.</span><span class="sxs-lookup"><span data-stu-id="72bca-183">To add an event handler in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], you simply add the event name to an element as an attribute and set the attribute value as the name of the event handler that implements an appropriate delegate, as in the following example.</span></span>

[!code-xaml[EventOvwSupport#SimplestSyntax](~/samples/snippets/csharp/VS_Snippets_Wpf/EventOvwSupport/CSharp/default.xaml#simplestsyntax)]

<span data-ttu-id="72bca-184">`b1SetColor`es el nombre del controlador implementado que contiene el código que controla el <xref:System.Windows.Controls.Primitives.ButtonBase.Click> evento.</span><span class="sxs-lookup"><span data-stu-id="72bca-184">`b1SetColor` is the name of the implemented handler that contains the code that handles the <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event.</span></span> <span data-ttu-id="72bca-185">`b1SetColor`debe tener la misma firma que el <xref:System.Windows.RoutedEventHandler> delegado, que es el delegado de controlador de eventos para el <xref:System.Windows.Controls.Primitives.ButtonBase.Click> evento.</span><span class="sxs-lookup"><span data-stu-id="72bca-185">`b1SetColor` must have the same signature as the <xref:System.Windows.RoutedEventHandler> delegate, which is the event handler delegate for the <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event.</span></span> <span data-ttu-id="72bca-186">El primer parámetro de todos los delegados de controlador de eventos enrutados especifica el elemento al que se agrega el controlador de eventos y el segundo parámetro especifica los datos para el evento.</span><span class="sxs-lookup"><span data-stu-id="72bca-186">The first parameter of all routed event handler delegates specifies the element to which the event handler is added, and the second parameter specifies the data for the event.</span></span>

[!code-csharp[EventOvwSupport#SimpleHandlerA](~/samples/snippets/csharp/VS_Snippets_Wpf/EventOvwSupport/CSharp/default.xaml.cs#simplehandlera)]
[!code-vb[EventOvwSupport#SimpleHandlerA](~/samples/snippets/visualbasic/VS_Snippets_Wpf/EventOvwSupport/visualbasic/default.xaml.vb#simplehandlera)]

<span data-ttu-id="72bca-187"><xref:System.Windows.RoutedEventHandler>es el delegado de controlador de eventos enrutados básico.</span><span class="sxs-lookup"><span data-stu-id="72bca-187"><xref:System.Windows.RoutedEventHandler> is the basic routed event handler delegate.</span></span> <span data-ttu-id="72bca-188">Para los eventos enrutados especializados para ciertos controles o escenarios, los delegados que deben usarse para los controladores de eventos enrutados también podrían volverse más especializados, de forma que puedan transmitir datos de evento especializados.</span><span class="sxs-lookup"><span data-stu-id="72bca-188">For routed events that are specialized for certain controls or scenarios, the delegates to use for the routed event handlers also might become more specialized, so that they can transmit specialized event data.</span></span> <span data-ttu-id="72bca-189">Por ejemplo, en un escenario de entrada común, podría controlar un <xref:System.Windows.UIElement.DragEnter> evento enrutado.</span><span class="sxs-lookup"><span data-stu-id="72bca-189">For instance, in a common input scenario, you might handle a <xref:System.Windows.UIElement.DragEnter> routed event.</span></span> <span data-ttu-id="72bca-190">El controlador debe implementar el <xref:System.Windows.DragEventHandler> delegado.</span><span class="sxs-lookup"><span data-stu-id="72bca-190">Your handler should implement the <xref:System.Windows.DragEventHandler> delegate.</span></span> <span data-ttu-id="72bca-191">Mediante el uso del delegado más específico, puede procesar el <xref:System.Windows.DragEventArgs> en el controlador y leer la <xref:System.Windows.DragEventArgs.Data%2A> propiedad, que contiene la carga del portapapeles de la operación de arrastre.</span><span class="sxs-lookup"><span data-stu-id="72bca-191">By using the most specific delegate, you can process the <xref:System.Windows.DragEventArgs> in the handler and read the <xref:System.Windows.DragEventArgs.Data%2A> property, which contains the clipboard payload of the drag operation.</span></span>

<span data-ttu-id="72bca-192">Para obtener un ejemplo completo de cómo agregar un controlador de eventos a un elemento mediante [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], vea [Cómo: Controlar un evento enrutado](how-to-handle-a-routed-event.md).</span><span class="sxs-lookup"><span data-stu-id="72bca-192">For a complete example of how to add an event handler to an element using [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], see [Handle a Routed Event](how-to-handle-a-routed-event.md).</span></span>

<span data-ttu-id="72bca-193">Resulta sencillo agregar un controlador para un evento enrutado en una aplicación que se crea en el código.</span><span class="sxs-lookup"><span data-stu-id="72bca-193">Adding a handler for a routed event in an application that is created in code is straightforward.</span></span> <span data-ttu-id="72bca-194">Los controladores de eventos enrutados siempre se pueden agregar a través de un método auxiliar <xref:System.Windows.UIElement.AddHandler%2A> (que es el mismo método para el que las llamadas de respaldo existentes `add` ). Sin embargo, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] los eventos enrutados existentes generalmente tienen implementaciones de respaldo de `add` `remove` la lógica y que permiten agregar los controladores para los eventos enrutados mediante una sintaxis de eventos específica del lenguaje, que es una sintaxis más intuitiva que el método auxiliar.</span><span class="sxs-lookup"><span data-stu-id="72bca-194">Routed event handlers can always be added through a helper method <xref:System.Windows.UIElement.AddHandler%2A> (which is the same method that the existing backing calls for `add`.) However, existing [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] routed events generally have backing implementations of `add` and `remove` logic that allow the handlers for routed events to be added by a language-specific event syntax, which is more intuitive syntax than the helper method.</span></span> <span data-ttu-id="72bca-195">A continuación se muestra un ejemplo de uso del método del asistente:</span><span class="sxs-lookup"><span data-stu-id="72bca-195">The following is an example usage of the helper method:</span></span>

[!code-csharp[EventOvwSupport#AddHandlerCode](~/samples/snippets/csharp/VS_Snippets_Wpf/EventOvwSupport/CSharp/default.xaml.cs#addhandlercode)]
[!code-vb[EventOvwSupport#AddHandlerCode](~/samples/snippets/visualbasic/VS_Snippets_Wpf/EventOvwSupport/visualbasic/default.xaml.vb#addhandlercode)]

<span data-ttu-id="72bca-196">En el ejemplo siguiente se muestra la sintaxis del operador de C# (Visual Basic tiene una sintaxis de operador ligeramente diferente debido a su control de desreferenciación):</span><span class="sxs-lookup"><span data-stu-id="72bca-196">The next example shows the C# operator syntax (Visual Basic has slightly different operator syntax because of its handling of dereferencing):</span></span>

[!code-csharp[EventOvwSupport#AddHandlerPlusEquals](~/samples/snippets/csharp/VS_Snippets_Wpf/EventOvwSupport/CSharp/default.xaml.cs#addhandlerplusequals)]
[!code-vb[EventOvwSupport#AddHandlerPlusEquals](~/samples/snippets/visualbasic/VS_Snippets_Wpf/EventOvwSupport/visualbasic/default.xaml.vb#addhandlerplusequals)]

<span data-ttu-id="72bca-197">Para obtener un ejemplo de cómo agregar un controlador de eventos en el código, vea [Agregar un controlador de eventos mediante código](how-to-add-an-event-handler-using-code.md).</span><span class="sxs-lookup"><span data-stu-id="72bca-197">For an example of how to add an event handler in code, see [Add an Event Handler Using Code](how-to-add-an-event-handler-using-code.md).</span></span>

<span data-ttu-id="72bca-198">Si usa Visual Basic, también puede usar la `Handles` palabra clave para agregar controladores como parte de las declaraciones del controlador.</span><span class="sxs-lookup"><span data-stu-id="72bca-198">If you are using Visual Basic, you can also use the `Handles` keyword to add handlers as part of the handler declarations.</span></span> <span data-ttu-id="72bca-199">Para más información, vea [Control de eventos en Visual Basic y WPF](visual-basic-and-wpf-event-handling.md).</span><span class="sxs-lookup"><span data-stu-id="72bca-199">For more information, see [Visual Basic and WPF Event Handling](visual-basic-and-wpf-event-handling.md).</span></span>

<a name="concept_handled"></a>

### <a name="the-concept-of-handled"></a><span data-ttu-id="72bca-200">El concepto de controlado</span><span class="sxs-lookup"><span data-stu-id="72bca-200">The Concept of Handled</span></span>

<span data-ttu-id="72bca-201">Todos los eventos enrutados comparten una clase base de datos de eventos comunes, <xref:System.Windows.RoutedEventArgs> .</span><span class="sxs-lookup"><span data-stu-id="72bca-201">All routed events share a common event data base class, <xref:System.Windows.RoutedEventArgs>.</span></span> <span data-ttu-id="72bca-202"><xref:System.Windows.RoutedEventArgs>define la <xref:System.Windows.RoutedEventArgs.Handled%2A> propiedad, que toma un valor booleano.</span><span class="sxs-lookup"><span data-stu-id="72bca-202"><xref:System.Windows.RoutedEventArgs> defines the <xref:System.Windows.RoutedEventArgs.Handled%2A> property, which takes a Boolean value.</span></span> <span data-ttu-id="72bca-203">El propósito de la <xref:System.Windows.RoutedEventArgs.Handled%2A> propiedad es permitir que cualquier controlador de eventos a lo largo de la ruta Marque el evento enrutado como *controlado*, estableciendo el valor de <xref:System.Windows.RoutedEventArgs.Handled%2A> en `true` .</span><span class="sxs-lookup"><span data-stu-id="72bca-203">The purpose of the <xref:System.Windows.RoutedEventArgs.Handled%2A> property is to enable any event handler along the route to mark the routed event as *handled*, by setting the value of <xref:System.Windows.RoutedEventArgs.Handled%2A> to `true`.</span></span> <span data-ttu-id="72bca-204">Una vez procesados por el controlador de un elemento a lo largo de la ruta, se informa de nuevo sobre los datos de evento compartidos a cada agente de escucha a lo largo de la ruta.</span><span class="sxs-lookup"><span data-stu-id="72bca-204">After being processed by the handler at one element along the route, the shared event data is again reported to each listener along the route.</span></span>

<span data-ttu-id="72bca-205">El valor de <xref:System.Windows.RoutedEventArgs.Handled%2A> afecta al modo en que se envía o se procesa un evento enrutado a medida que se recorre la ruta.</span><span class="sxs-lookup"><span data-stu-id="72bca-205">The value of <xref:System.Windows.RoutedEventArgs.Handled%2A> affects how a routed event is reported or processed as it travels further along the route.</span></span> <span data-ttu-id="72bca-206">Si <xref:System.Windows.RoutedEventArgs.Handled%2A> está `true` en los datos de evento de un evento enrutado, los controladores que escuchan el evento enrutado en otros elementos normalmente ya no se invocan para esa instancia de evento concreta.</span><span class="sxs-lookup"><span data-stu-id="72bca-206">If <xref:System.Windows.RoutedEventArgs.Handled%2A> is `true` in the event data for a routed event, then handlers that listen for that routed event on other elements are generally no longer invoked for that particular event instance.</span></span> <span data-ttu-id="72bca-207">Esto se cumple tanto para los controladores adjuntos en [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] como para los controladores agregados mediante sintaxis de adjuntar controladores de eventos específicas del lenguaje como `+=` o `Handles`.</span><span class="sxs-lookup"><span data-stu-id="72bca-207">This is true both for handlers attached in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] and for handlers added by language-specific event handler attachment syntaxes such as `+=` or `Handles`.</span></span> <span data-ttu-id="72bca-208">En el caso de los escenarios de controlador más comunes, si se marca un evento como controlado, <xref:System.Windows.RoutedEventArgs.Handled%2A> se establece en `true` "detener" el enrutamiento para una ruta de tunelización o una ruta de propagación, y también para cualquier evento que se controle en un punto de la ruta mediante un controlador de clase.</span><span class="sxs-lookup"><span data-stu-id="72bca-208">For most common handler scenarios, marking an event as handled by setting <xref:System.Windows.RoutedEventArgs.Handled%2A> to `true` will "stop" routing for either a tunneling route or a bubbling route, and also for any event that is handled at a point in the route by a class handler.</span></span>

<span data-ttu-id="72bca-209">Sin embargo, hay un mecanismo de "handledEventsToo" por el que los agentes de escucha pueden seguir ejecutando controladores en respuesta a los eventos enrutados <xref:System.Windows.RoutedEventArgs.Handled%2A> `true` en los datos de evento.</span><span class="sxs-lookup"><span data-stu-id="72bca-209">However, there is a "handledEventsToo" mechanism whereby listeners can still run handlers in response to routed events where <xref:System.Windows.RoutedEventArgs.Handled%2A> is `true` in the event data.</span></span> <span data-ttu-id="72bca-210">Es decir, la ruta de eventos no se detiene realmente al marcar los datos de evento como controlados.</span><span class="sxs-lookup"><span data-stu-id="72bca-210">In other words, the event route is not truly stopped by marking the event data as handled.</span></span> <span data-ttu-id="72bca-211">Solo se puede usar el mecanismo handledEventsToo en el código o en <xref:System.Windows.EventSetter> :</span><span class="sxs-lookup"><span data-stu-id="72bca-211">You can only use the handledEventsToo mechanism in code, or in an <xref:System.Windows.EventSetter>:</span></span>

- <span data-ttu-id="72bca-212">En el código, en lugar de usar una sintaxis de eventos específica del lenguaje que funcione para eventos CLR generales, llame al [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] método <xref:System.Windows.UIElement.AddHandler%28System.Windows.RoutedEvent%2CSystem.Delegate%2CSystem.Boolean%29> para agregar el controlador.</span><span class="sxs-lookup"><span data-stu-id="72bca-212">In code, instead of using a language-specific event syntax that works for general CLR events, call the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] method <xref:System.Windows.UIElement.AddHandler%28System.Windows.RoutedEvent%2CSystem.Delegate%2CSystem.Boolean%29> to add your handler.</span></span> <span data-ttu-id="72bca-213">Especifique el valor de `handledEventsToo` como `true`.</span><span class="sxs-lookup"><span data-stu-id="72bca-213">Specify the value of `handledEventsToo` as `true`.</span></span>

- <span data-ttu-id="72bca-214">En <xref:System.Windows.EventSetter> , establezca el <xref:System.Windows.EventSetter.HandledEventsToo%2A> atributo en `true` .</span><span class="sxs-lookup"><span data-stu-id="72bca-214">In an <xref:System.Windows.EventSetter>, set the <xref:System.Windows.EventSetter.HandledEventsToo%2A> attribute to be `true`.</span></span>

<span data-ttu-id="72bca-215">Además del comportamiento que el <xref:System.Windows.RoutedEventArgs.Handled%2A> Estado produce en los eventos enrutados, el concepto de <xref:System.Windows.RoutedEventArgs.Handled%2A> tiene implicaciones sobre cómo diseñar la aplicación y escribir el código del controlador de eventos.</span><span class="sxs-lookup"><span data-stu-id="72bca-215">In addition to the behavior that <xref:System.Windows.RoutedEventArgs.Handled%2A> state produces in routed events, the concept of <xref:System.Windows.RoutedEventArgs.Handled%2A> has implications for how you should design your application and write the event handler code.</span></span> <span data-ttu-id="72bca-216">Puede conceptualizar <xref:System.Windows.RoutedEventArgs.Handled%2A> como un protocolo simple que exponen los eventos enrutados.</span><span class="sxs-lookup"><span data-stu-id="72bca-216">You can conceptualize <xref:System.Windows.RoutedEventArgs.Handled%2A> as being a simple protocol that is exposed by routed events.</span></span> <span data-ttu-id="72bca-217">El uso exacto de este protocolo depende de usted, pero el diseño conceptual de cómo se debe usar el valor de es el <xref:System.Windows.RoutedEventArgs.Handled%2A> siguiente:</span><span class="sxs-lookup"><span data-stu-id="72bca-217">Exactly how you use this protocol is up to you, but the conceptual design for how the value of <xref:System.Windows.RoutedEventArgs.Handled%2A> is intended to be used is as follows:</span></span>

- <span data-ttu-id="72bca-218">Si un evento enrutado está marcado como controlado, no es necesario que los demás elementos a lo largo de esa ruta lo controlen de nuevo.</span><span class="sxs-lookup"><span data-stu-id="72bca-218">If a routed event is marked as handled, then it does not need to be handled again by other elements along that route.</span></span>

- <span data-ttu-id="72bca-219">Si un evento enrutado no está marcado como controlado, otros agentes de escucha que se encontraban antes de la ruta han elegido no registrar un controlador o los controladores que se han registrado deciden no manipular los datos del evento y establecen <xref:System.Windows.RoutedEventArgs.Handled%2A> en `true` .</span><span class="sxs-lookup"><span data-stu-id="72bca-219">If a routed event is not marked as handled, then other listeners that were earlier along the route have chosen either not to register a handler, or the handlers that were registered chose not to manipulate the event data and set <xref:System.Windows.RoutedEventArgs.Handled%2A> to `true`.</span></span> <span data-ttu-id="72bca-220">(O bien, es posible que el agente de escucha actual sea el primer punto de la ruta). Los controladores del agente de escucha actual ahora tienen tres posibles cursos de acción:</span><span class="sxs-lookup"><span data-stu-id="72bca-220">(Or, it is of course possible that the current listener is the first point in the route.) Handlers on the current listener now have three possible courses of action:</span></span>

  - <span data-ttu-id="72bca-221">No realizar ninguna acción; el evento sigue estando sin controlar y se enruta al agente de escucha siguiente.</span><span class="sxs-lookup"><span data-stu-id="72bca-221">Take no action at all; the event remains unhandled, and the event routes to the next listener.</span></span>

  - <span data-ttu-id="72bca-222">Ejecutar código en respuesta al evento, pero tomar la determinación de que la acción realizada no ha sido lo suficientemente sustancial como para marcar el evento como controlado.</span><span class="sxs-lookup"><span data-stu-id="72bca-222">Execute code in response to the event, but make the determination that the action taken was not substantial enough to warrant marking the event as handled.</span></span> <span data-ttu-id="72bca-223">El evento se enruta al agente de escucha siguiente.</span><span class="sxs-lookup"><span data-stu-id="72bca-223">The event routes to the next listener.</span></span>

  - <span data-ttu-id="72bca-224">Ejecutar código en respuesta al evento.</span><span class="sxs-lookup"><span data-stu-id="72bca-224">Execute code in response to the event.</span></span> <span data-ttu-id="72bca-225">Marcar el evento como controlado en los datos de evento pasados al controlador, porque la acción realizada se ha considerado lo suficientemente sustancial como para marcarlo como controlado.</span><span class="sxs-lookup"><span data-stu-id="72bca-225">Mark the event as handled in the event data passed to the handler, because the action taken was deemed substantial enough to warrant marking as handled.</span></span> <span data-ttu-id="72bca-226">El evento sigue enrutando al siguiente agente de escucha, pero con <xref:System.Windows.RoutedEventArgs.Handled%2A> = `true` en sus datos de evento, solo `handledEventsToo` los agentes de escucha tienen la oportunidad de invocar más controladores.</span><span class="sxs-lookup"><span data-stu-id="72bca-226">The event still routes to the next listener, but with <xref:System.Windows.RoutedEventArgs.Handled%2A>=`true` in its event data, so only `handledEventsToo` listeners have the opportunity to invoke further handlers.</span></span>

<span data-ttu-id="72bca-227">Este diseño conceptual se refuerza mediante el comportamiento de enrutamiento mencionado anteriormente: es más difícil (aunque aún posible en código o estilos) adjuntar controladores para eventos enrutados que se invocan incluso si un controlador anterior a lo largo de la ruta ya está establecido <xref:System.Windows.RoutedEventArgs.Handled%2A> en `true` .</span><span class="sxs-lookup"><span data-stu-id="72bca-227">This conceptual design is reinforced by the routing behavior mentioned earlier: it is more difficult (although still possible in code or styles) to attach handlers for routed events that are invoked even if a previous handler along the route has already set <xref:System.Windows.RoutedEventArgs.Handled%2A> to `true`.</span></span>

<span data-ttu-id="72bca-228">Para obtener más información sobre <xref:System.Windows.RoutedEventArgs.Handled%2A> , el control de clases de eventos enrutados y recomendaciones sobre Cuándo es adecuado marcar un evento enrutado como <xref:System.Windows.RoutedEventArgs.Handled%2A> , vea [marcar eventos enrutados como controlados y control de clases](marking-routed-events-as-handled-and-class-handling.md).</span><span class="sxs-lookup"><span data-stu-id="72bca-228">For more information about <xref:System.Windows.RoutedEventArgs.Handled%2A>, class handling of routed events, and recommendations about when it is appropriate to mark a routed event as <xref:System.Windows.RoutedEventArgs.Handled%2A>, see [Marking Routed Events as Handled, and Class Handling](marking-routed-events-as-handled-and-class-handling.md).</span></span>

<span data-ttu-id="72bca-229">En las aplicaciones, es bastante habitual controlar un evento enrutado de propagación solamente en el objeto que lo ha desencadenado, y no preocuparse en absoluto por las características de enrutado del evento.</span><span class="sxs-lookup"><span data-stu-id="72bca-229">In applications, it is quite common to just handle a bubbling routed event on the object that raised it, and not be concerned with the event's routing characteristics at all.</span></span> <span data-ttu-id="72bca-230">Pero es una buena práctica marcar el evento enrutado como controlado en los datos de evento para evitar efectos secundarios imprevistos en caso de que un elemento situado más arriba en el árbol de elementos también tenga un controlador asociado para ese mismo evento enrutado.</span><span class="sxs-lookup"><span data-stu-id="72bca-230">However, it is still a good practice to mark the routed event as handled in the event data, to prevent unanticipated side effects just in case an element that is further up the element tree also has a handler attached for that same routed event.</span></span>

<a name="class_handlers"></a>

## <a name="class-handlers"></a><span data-ttu-id="72bca-231">Controladores de clase</span><span class="sxs-lookup"><span data-stu-id="72bca-231">Class Handlers</span></span>

<span data-ttu-id="72bca-232">Si está definiendo una clase que deriva de alguna manera de <xref:System.Windows.DependencyObject> , también puede definir y adjuntar un controlador de clase para un evento enrutado que sea un miembro de evento declarado o heredado de la clase.</span><span class="sxs-lookup"><span data-stu-id="72bca-232">If you are defining a class that derives in some way from <xref:System.Windows.DependencyObject>, you can also define and attach a class handler for a routed event that is a declared or inherited event member of your class.</span></span> <span data-ttu-id="72bca-233">Los controladores de clase se invocan antes que cualquier controlador de agente de escucha de instancia que esté asociado a una instancia de esa clase, cada vez que un evento enrutado alcanza una instancia de elemento en su ruta.</span><span class="sxs-lookup"><span data-stu-id="72bca-233">Class handlers are invoked before any instance listener handlers that are attached to an instance of that class, whenever a routed event reaches an element instance in its route.</span></span>

<span data-ttu-id="72bca-234">Algunos controles de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] tienen el control de clase inherente para ciertos eventos enrutados.</span><span class="sxs-lookup"><span data-stu-id="72bca-234">Some [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] controls have inherent class handling for certain routed events.</span></span> <span data-ttu-id="72bca-235">Esto podría dar la impresión de que el evento enrutado nunca se genera, pero en realidad está sujeto al control de clase y sus controladores de instancia todavía pueden controlar el evento enrutado si emplea ciertas técnicas.</span><span class="sxs-lookup"><span data-stu-id="72bca-235">This might give the outward appearance that the routed event is not ever raised, but in reality it is being class handled, and the routed event can potentially still be handled by your instance handlers if you use certain techniques.</span></span> <span data-ttu-id="72bca-236">Además, muchas clases y controles base exponen métodos virtuales que se pueden usar para invalidar el comportamiento del control de clase.</span><span class="sxs-lookup"><span data-stu-id="72bca-236">Also, many base classes and controls expose virtual methods that can be used to override class handling behavior.</span></span> <span data-ttu-id="72bca-237">Para más información sobre cómo evitar el control de clase no deseado y cómo definir su propio control de clase en una clase personalizada, vea [Marcar eventos enrutados como controlados y control de clases](marking-routed-events-as-handled-and-class-handling.md).</span><span class="sxs-lookup"><span data-stu-id="72bca-237">For more information both on how to work around undesired class handling and on defining your own class handling in a custom class, see [Marking Routed Events as Handled, and Class Handling](marking-routed-events-as-handled-and-class-handling.md).</span></span>

<a name="attached_events"></a>

## <a name="attached-events-in-wpf"></a><span data-ttu-id="72bca-238">Evento adjuntos en WPF</span><span class="sxs-lookup"><span data-stu-id="72bca-238">Attached Events in WPF</span></span>

<span data-ttu-id="72bca-239">El lenguaje [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] también define un tipo especial de evento denominado *evento adjunto*.</span><span class="sxs-lookup"><span data-stu-id="72bca-239">The [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] language also defines a special type of event called an *attached event*.</span></span> <span data-ttu-id="72bca-240">Un evento adjunto permite agregar un controlador para un evento determinado a un elemento arbitrario.</span><span class="sxs-lookup"><span data-stu-id="72bca-240">An attached event enables you to add a handler for a particular event to an arbitrary element.</span></span> <span data-ttu-id="72bca-241">No es necesario que el elemento que controla el evento defina o herede el evento adjunto, y ni el objeto que genera potencialmente el evento ni la instancia que controla el destino deben definir o ser "propietarios" de ese evento como miembro de clase.</span><span class="sxs-lookup"><span data-stu-id="72bca-241">The element handling the event need not define or inherit the attached event, and neither the object potentially raising the event nor the destination handling instance must define or otherwise "own" that event as a class member.</span></span>

<span data-ttu-id="72bca-242">El sistema de entrada de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] emplea mucho los eventos adjuntos.</span><span class="sxs-lookup"><span data-stu-id="72bca-242">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] input system uses attached events extensively.</span></span> <span data-ttu-id="72bca-243">Pero casi todos estos eventos adjuntos se reenvían a través de elementos base.</span><span class="sxs-lookup"><span data-stu-id="72bca-243">However, nearly all of these attached events are forwarded through base elements.</span></span> <span data-ttu-id="72bca-244">Los eventos de entrada aparecen como eventos enrutados no adjuntos equivalentes que son miembros de la clase de elemento base.</span><span class="sxs-lookup"><span data-stu-id="72bca-244">The input events then appear as equivalent non-attached routed events that are members of the base element class.</span></span> <span data-ttu-id="72bca-245">Por ejemplo, el evento adjunto subyacente <xref:System.Windows.Input.Mouse.MouseDown?displayProperty=nameWithType> se puede controlar más fácilmente en cualquier determinado mediante <xref:System.Windows.UIElement> <xref:System.Windows.UIElement.MouseDown> en, en <xref:System.Windows.UIElement> lugar de tratar con la sintaxis de eventos adjuntos en o en el [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] código.</span><span class="sxs-lookup"><span data-stu-id="72bca-245">For instance, the underlying attached event <xref:System.Windows.Input.Mouse.MouseDown?displayProperty=nameWithType> can more easily be handled on any given <xref:System.Windows.UIElement> by using <xref:System.Windows.UIElement.MouseDown> on that <xref:System.Windows.UIElement> rather than dealing with attached event syntax either in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] or code.</span></span>

<span data-ttu-id="72bca-246">Para más información sobre los eventos adjuntos en [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], vea [Información general sobre eventos adjuntos](attached-events-overview.md).</span><span class="sxs-lookup"><span data-stu-id="72bca-246">For more information about attached events in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], see [Attached Events Overview](attached-events-overview.md).</span></span>

<a name="Qualifying_Event_Names_in_XAML_for_Anticipated_Routing"></a>

## <a name="qualified-event-names-in-xaml"></a><span data-ttu-id="72bca-247">Nombres de evento completos en XAML</span><span class="sxs-lookup"><span data-stu-id="72bca-247">Qualified Event Names in XAML</span></span>

<span data-ttu-id="72bca-248">Otro uso de una sintaxis similar a la sintaxis de eventos adjuntos *nombreDeTipo*.*nombreDeEvento* pero que no es en sentido estricto un uso de eventos adjuntos se produce al adjuntar controladores para eventos enrutados que son desencadenados por elementos secundarios.</span><span class="sxs-lookup"><span data-stu-id="72bca-248">Another syntax usage that resembles *typename*.*eventname* attached event syntax but is not strictly speaking an attached event usage is when you attach handlers for routed events that are raised by child elements.</span></span> <span data-ttu-id="72bca-249">Los controladores se adjuntan a un elemento primario común, para aprovecharse del enrutamiento de eventos, aunque el evento enrutado pertinente no sea miembro del elemento primario común.</span><span class="sxs-lookup"><span data-stu-id="72bca-249">You attach the handlers to a common parent, to take advantage of event routing, even though the common parent might not have the relevant routed event as a member.</span></span> <span data-ttu-id="72bca-250">Considere este ejemplo de nuevo:</span><span class="sxs-lookup"><span data-stu-id="72bca-250">Consider this example again:</span></span>

[!code-xaml[EventOvwSupport#GroupButton](~/samples/snippets/csharp/VS_Snippets_Wpf/EventOvwSupport/CSharp/default.xaml#groupbutton)]

<span data-ttu-id="72bca-251">Aquí, el agente de escucha del elemento primario donde se agrega el controlador es <xref:System.Windows.Controls.StackPanel> .</span><span class="sxs-lookup"><span data-stu-id="72bca-251">Here, the parent element listener where the handler is added is a <xref:System.Windows.Controls.StackPanel>.</span></span> <span data-ttu-id="72bca-252">Sin embargo, está agregando un controlador para un evento enrutado que se declaró y lo generará la <xref:System.Windows.Controls.Button> clase ( <xref:System.Windows.Controls.Primitives.ButtonBase> en realidad, pero disponible para a través de la <xref:System.Windows.Controls.Button> herencia).</span><span class="sxs-lookup"><span data-stu-id="72bca-252">However, it is adding a handler for a routed event that was declared and will be raised by the <xref:System.Windows.Controls.Button> class (<xref:System.Windows.Controls.Primitives.ButtonBase> actually, but available to <xref:System.Windows.Controls.Button> through inheritance).</span></span> <span data-ttu-id="72bca-253"><xref:System.Windows.Controls.Button>"posee" el evento, pero el sistema de eventos enrutados permite que los controladores de cualquier evento enrutado se adjunten a cualquier <xref:System.Windows.UIElement> <xref:System.Windows.ContentElement> agente de escucha de instancia o que, de lo contrario, podría adjuntar agentes de escucha para un evento de Common Language Runtime (CLR).</span><span class="sxs-lookup"><span data-stu-id="72bca-253"><xref:System.Windows.Controls.Button> "owns" the event, but the routed event system permits handlers for any routed event to be attached to any <xref:System.Windows.UIElement> or <xref:System.Windows.ContentElement> instance listener that could otherwise attach listeners for a common language runtime (CLR) event.</span></span> <span data-ttu-id="72bca-254">El espacio de nombres xmlns predeterminado para estos nombres de atributo de evento calificados suele ser el espacio de nombres xmlns de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] predeterminado, pero también se pueden especificar espacios de nombres con prefijos para los eventos enrutados personalizados.</span><span class="sxs-lookup"><span data-stu-id="72bca-254">The default xmlns namespace for these qualified event attribute names is typically the default [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] xmlns namespace, but you can also specify prefixed namespaces for custom routed events.</span></span> <span data-ttu-id="72bca-255">Para más información sobre xmlns, vea [Espacios de nombres y asignación de espacios de nombres XAML para WPF](xaml-namespaces-and-namespace-mapping-for-wpf-xaml.md).</span><span class="sxs-lookup"><span data-stu-id="72bca-255">For more information about xmlns, see [XAML Namespaces and Namespace Mapping for WPF XAML](xaml-namespaces-and-namespace-mapping-for-wpf-xaml.md).</span></span>

<a name="how_event_processing_works"></a>

## <a name="wpf-input-events"></a><span data-ttu-id="72bca-256">Eventos de entrada de WPF</span><span class="sxs-lookup"><span data-stu-id="72bca-256">WPF Input Events</span></span>

<span data-ttu-id="72bca-257">En la plataforma [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], con frecuencia se emplean los eventos enrutados como eventos de entrada.</span><span class="sxs-lookup"><span data-stu-id="72bca-257">One frequent application of routed events within the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] platform is for input events.</span></span> <span data-ttu-id="72bca-258">En [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], a los nombres de los eventos enrutados con tunelización se les antepone la palabra "Preview" por convención.</span><span class="sxs-lookup"><span data-stu-id="72bca-258">In [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], tunneling routed events names are prefixed with the word "Preview" by convention.</span></span> <span data-ttu-id="72bca-259">Los eventos de entrada suelen presentarse en parejas, donde uno es el evento de propagación y el otro es el evento de tunelización.</span><span class="sxs-lookup"><span data-stu-id="72bca-259">Input events often come in pairs, with one being the bubbling event and the other being the tunneling event.</span></span> <span data-ttu-id="72bca-260">Por ejemplo, el evento <xref:System.Windows.ContentElement.KeyDown> y el <xref:System.Windows.ContentElement.PreviewKeyDown> evento tienen la misma firma, donde el primero es el evento de entrada de propagación y el último es el evento de entrada de tunelización.</span><span class="sxs-lookup"><span data-stu-id="72bca-260">For example, the <xref:System.Windows.ContentElement.KeyDown> event and the <xref:System.Windows.ContentElement.PreviewKeyDown> event have the same signature, with the former being the bubbling input event and the latter being the tunneling input event.</span></span> <span data-ttu-id="72bca-261">En ocasiones, los eventos de entrada solo tienen una versión de propagación o quizás solo una versión enrutada directa.</span><span class="sxs-lookup"><span data-stu-id="72bca-261">Occasionally, input events only have a bubbling version, or perhaps only a direct routed version.</span></span> <span data-ttu-id="72bca-262">En la documentación, los temas sobre eventos enrutados contienen referencias cruzadas a los temas relativos a los eventos enrutados similares con estrategias de enrutamiento alternativas, si existen dichos eventos enrutados, y las secciones de las páginas de referencia administradas clarifican la estrategia de enrutamiento de cada evento enrutado.</span><span class="sxs-lookup"><span data-stu-id="72bca-262">In the documentation, routed event topics cross-reference similar routed events with alternative routing strategies if such routed events exist, and sections in the managed reference pages clarify the routing strategy of each routed event.</span></span>

<span data-ttu-id="72bca-263">Los eventos de entrada de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] que se presentan en parejas se implementan de forma que una única acción del usuario desde la entrada, como presionar un botón del mouse, desencadenará los dos eventos enrutados de la pareja secuencialmente.</span><span class="sxs-lookup"><span data-stu-id="72bca-263">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] input events that come in pairs are implemented so that a single user action from input, such as a mouse button press, will raise both routed events of the pair in sequence.</span></span> <span data-ttu-id="72bca-264">En primer lugar, se desencadena el evento de tunelización, que viaja por su ruta.</span><span class="sxs-lookup"><span data-stu-id="72bca-264">First, the tunneling event is raised and travels its route.</span></span> <span data-ttu-id="72bca-265">Después se desencadena el evento de propagación y este viaja por su ruta.</span><span class="sxs-lookup"><span data-stu-id="72bca-265">Then the bubbling event is raised and travels its route.</span></span> <span data-ttu-id="72bca-266">Los dos eventos comparten literalmente la misma instancia de datos de evento, porque la <xref:System.Windows.UIElement.RaiseEvent%2A> llamada al método en la clase de implementación que genera el evento de propagación realiza escuchas para los datos de evento desde el evento de tunelización y lo vuelve a utilizar en el nuevo evento generado.</span><span class="sxs-lookup"><span data-stu-id="72bca-266">The two events literally share the same event data instance, because the <xref:System.Windows.UIElement.RaiseEvent%2A> method call in the implementing class that raises the bubbling event listens for the event data from the tunneling event and reuses it in the new raised event.</span></span> <span data-ttu-id="72bca-267">Los agentes de escucha con controladores para el evento de tunelización tienen la primera oportunidad de marcar el evento enrutado como controlado (en primer lugar los controladores de clase y después los controladores de instancia).</span><span class="sxs-lookup"><span data-stu-id="72bca-267">Listeners with handlers for the tunneling event have the first opportunity to mark the routed event handled (class handlers first, then instance handlers).</span></span> <span data-ttu-id="72bca-268">Si un elemento a lo largo de la ruta de tunelización ha marcado el evento enrutado como controlado, los datos del evento ya controlado se envían para el evento de propagación y no se invocarán los controladores adjuntos típicos para los eventos de entrada de propagación equivalentes.</span><span class="sxs-lookup"><span data-stu-id="72bca-268">If an element along the tunneling route marked the routed event as handled, the already-handled event data is sent on for the bubbling event, and typical handlers attached for the equivalent bubbling input events will not be invoked.</span></span> <span data-ttu-id="72bca-269">Externamente dará la impresión de que el evento de propagación controlado ni siquiera se ha desencadenado.</span><span class="sxs-lookup"><span data-stu-id="72bca-269">To outward appearances it will be as if the handled bubbling event has not even been raised.</span></span> <span data-ttu-id="72bca-270">Este comportamiento de control es útil para la composición de controles, donde podría ser conveniente que fuera el control final y no sus partes compuestas el que informara de todos los eventos de entrada basados en pruebas de posicionamiento o de los eventos de entrada basados en el foco.</span><span class="sxs-lookup"><span data-stu-id="72bca-270">This handling behavior is useful for control compositing, where you might want all hit-test based input events or focus-based input events to be reported by your final control, rather than its composite parts.</span></span> <span data-ttu-id="72bca-271">El elemento del control final está más próximo a la raíz en la composición y, por tanto, tiene la oportunidad de controlar desde la clase el evento de tunelización en primer lugar y posiblemente "reemplazar" dicho evento enrutado por un evento más específico del control, como parte del código que respalda la clase del control.</span><span class="sxs-lookup"><span data-stu-id="72bca-271">The final control element is closer to the root in the compositing, and therefore has the opportunity to class handle the tunneling event first and perhaps to "replace" that routed event with a more control-specific event, as part of the code that backs the control class.</span></span>

<span data-ttu-id="72bca-272">Para ilustrar cómo funciona el procesamiento de eventos de entrada, observe el ejemplo de evento de entrada siguiente.</span><span class="sxs-lookup"><span data-stu-id="72bca-272">As an illustration of how input event processing works, consider the following input event example.</span></span> <span data-ttu-id="72bca-273">En la ilustración de árbol siguiente, `leaf element #2` es el origen de `PreviewMouseDown` y, a continuación, un `MouseDown` evento:</span><span class="sxs-lookup"><span data-stu-id="72bca-273">In the following tree illustration, `leaf element #2` is the source of both a `PreviewMouseDown` and then a `MouseDown` event:</span></span>

![Diagrama de enrutamiento de eventos](./media/routed-events-overview/input-event-routing.png)

<span data-ttu-id="72bca-275">El orden de procesamiento de los eventos es el siguiente:</span><span class="sxs-lookup"><span data-stu-id="72bca-275">The order of event processing is as follows:</span></span>

1. <span data-ttu-id="72bca-276">`PreviewMouseDown` (túnel) en el elemento raíz.</span><span class="sxs-lookup"><span data-stu-id="72bca-276">`PreviewMouseDown` (tunnel) on root element.</span></span>

2. <span data-ttu-id="72bca-277">`PreviewMouseDown` (túnel) en el elemento intermedio n.º 1.</span><span class="sxs-lookup"><span data-stu-id="72bca-277">`PreviewMouseDown` (tunnel) on intermediate element #1.</span></span>

3. <span data-ttu-id="72bca-278">`PreviewMouseDown` (túnel) en el elemento de origen n.º 2.</span><span class="sxs-lookup"><span data-stu-id="72bca-278">`PreviewMouseDown` (tunnel) on source element #2.</span></span>

4. <span data-ttu-id="72bca-279">`MouseDown` (propagación) en el elemento de origen n.º 2.</span><span class="sxs-lookup"><span data-stu-id="72bca-279">`MouseDown` (bubble) on source element #2.</span></span>

5. <span data-ttu-id="72bca-280">`MouseDown` (propagación) en el elemento intermedio n.º 1.</span><span class="sxs-lookup"><span data-stu-id="72bca-280">`MouseDown` (bubble) on intermediate element #1.</span></span>

6. <span data-ttu-id="72bca-281">`MouseDown` (propagación) en el elemento raíz.</span><span class="sxs-lookup"><span data-stu-id="72bca-281">`MouseDown` (bubble) on root element.</span></span>

<span data-ttu-id="72bca-282">Un delegado de controlador de eventos enrutados proporciona referencias a dos objetos: el objeto que ha desencadenado el evento y el objeto en el que se ha invocado el controlador.</span><span class="sxs-lookup"><span data-stu-id="72bca-282">A routed event handler delegate provides references to two objects: the object that raised the event and the object where the handler was invoked.</span></span> <span data-ttu-id="72bca-283">El objeto en el que se ha invocado el controlador es el objeto sobre el que informa el parámetro `sender`.</span><span class="sxs-lookup"><span data-stu-id="72bca-283">The object where the handler was invoked is the object reported by the `sender` parameter.</span></span> <span data-ttu-id="72bca-284">La <xref:System.Windows.RoutedEventArgs.Source%2A> propiedad de los datos de evento detecta el objeto en el que se generó el evento por primera vez.</span><span class="sxs-lookup"><span data-stu-id="72bca-284">The object where the event was first raised is reported by the <xref:System.Windows.RoutedEventArgs.Source%2A> property in the event data.</span></span> <span data-ttu-id="72bca-285">Un evento enrutado todavía puede ser generado y controlado por el mismo objeto, en cuyo caso `sender` y <xref:System.Windows.RoutedEventArgs.Source%2A> son idénticos (este es el caso de los pasos 3 y 4 en la lista de ejemplo de procesamiento de eventos).</span><span class="sxs-lookup"><span data-stu-id="72bca-285">A routed event can still be raised and handled by the same object, in which case `sender` and <xref:System.Windows.RoutedEventArgs.Source%2A> are identical (this is the case with Steps 3 and 4 in the event processing example list).</span></span>

<span data-ttu-id="72bca-286">Debido a la tunelización y a la propagación, los elementos primarios reciben eventos de entrada donde <xref:System.Windows.RoutedEventArgs.Source%2A> es uno de sus elementos secundarios.</span><span class="sxs-lookup"><span data-stu-id="72bca-286">Because of tunneling and bubbling, parent elements receive input events where the <xref:System.Windows.RoutedEventArgs.Source%2A> is one of their child elements.</span></span> <span data-ttu-id="72bca-287">Cuando es importante saber cuál es el elemento de origen, puede identificar el elemento de origen mediante el acceso a la <xref:System.Windows.RoutedEventArgs.Source%2A> propiedad.</span><span class="sxs-lookup"><span data-stu-id="72bca-287">When it is important to know what the source element is, you can identify the source element by accessing the <xref:System.Windows.RoutedEventArgs.Source%2A> property.</span></span>

<span data-ttu-id="72bca-288">Normalmente, una vez que se marca el evento de entrada <xref:System.Windows.RoutedEventArgs.Handled%2A> , no se invocan controladores adicionales.</span><span class="sxs-lookup"><span data-stu-id="72bca-288">Usually, once the input event is marked <xref:System.Windows.RoutedEventArgs.Handled%2A>, further handlers are not invoked.</span></span> <span data-ttu-id="72bca-289">Lo habitual es marcar los eventos de entrada como controlados en cuanto se invoca un controlador que se ocupa del control lógico específico de la aplicación relacionado con el significado del evento de entrada.</span><span class="sxs-lookup"><span data-stu-id="72bca-289">Typically, you should mark input events as handled as soon as a handler is invoked that addresses your application-specific logical handling of the meaning of the input event.</span></span>

<span data-ttu-id="72bca-290">La excepción a esta instrucción general sobre <xref:System.Windows.RoutedEventArgs.Handled%2A> el estado es que los controladores de eventos de entrada que se registran para omitir deliberadamente <xref:System.Windows.RoutedEventArgs.Handled%2A> el estado de los datos de evento se pueden invocar a lo largo de una ruta.</span><span class="sxs-lookup"><span data-stu-id="72bca-290">The exception to this general statement about <xref:System.Windows.RoutedEventArgs.Handled%2A> state is that input event handlers that are registered to deliberately ignore <xref:System.Windows.RoutedEventArgs.Handled%2A> state of the event data would still be invoked along either route.</span></span> <span data-ttu-id="72bca-291">Para más información, vea [Eventos de vista previa](preview-events.md) o [Marcar eventos enrutados como controlados y control de clases](marking-routed-events-as-handled-and-class-handling.md).</span><span class="sxs-lookup"><span data-stu-id="72bca-291">For more information, see [Preview Events](preview-events.md) or [Marking Routed Events as Handled, and Class Handling](marking-routed-events-as-handled-and-class-handling.md).</span></span>

<span data-ttu-id="72bca-292">El modelo de datos de evento compartido entre los eventos de tunelización y de propagación, y el desencadenamiento secuencial primero de los eventos de tunelización y después de los de propagación, no es un concepto que se cumpla de forma general para todos los eventos enrutados.</span><span class="sxs-lookup"><span data-stu-id="72bca-292">The shared event data model between tunneling and bubbling events, and the sequential raising of first tunneling then bubbling events, is not a concept that is generally true for all routed events.</span></span> <span data-ttu-id="72bca-293">Ese comportamiento se implementa específicamente según el modo en que los dispositivos de entrada de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] deciden generar y conectar los pares de eventos de entrada.</span><span class="sxs-lookup"><span data-stu-id="72bca-293">That behavior is specifically implemented by how [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] input devices choose to raise and connect the input event pairs.</span></span> <span data-ttu-id="72bca-294">Implementar sus propios eventos de entrada es un escenario avanzado, pero también podría decidir seguir ese modelo para sus propios eventos de entrada.</span><span class="sxs-lookup"><span data-stu-id="72bca-294">Implementing your own input events is an advanced scenario, but you might choose to follow that model for your own input events also.</span></span>

<span data-ttu-id="72bca-295">Algunas clases eligen controlar ciertos eventos de entrada mediante clases, normalmente con la intención de volver a definir lo que significa un determinado evento de entrada controlado por el usuario dentro de ese control y de desencadenar un nuevo evento.</span><span class="sxs-lookup"><span data-stu-id="72bca-295">Certain classes choose to class-handle certain input events, usually with the intent of redefining what a particular user-driven input event means within that control and raising a new event.</span></span> <span data-ttu-id="72bca-296">Para más información, vea [Marcar eventos enrutados como controlados y control de clases](marking-routed-events-as-handled-and-class-handling.md).</span><span class="sxs-lookup"><span data-stu-id="72bca-296">For more information, see [Marking Routed Events as Handled, and Class Handling](marking-routed-events-as-handled-and-class-handling.md).</span></span>

<span data-ttu-id="72bca-297">Para más información sobre la entrada y cómo interactúa con los eventos en escenarios de aplicación típicos, vea [Información general sobre acciones del usuario](input-overview.md).</span><span class="sxs-lookup"><span data-stu-id="72bca-297">For more information on input and how input and events interact in typical application scenarios, see [Input Overview](input-overview.md).</span></span>

<a name="events_styles"></a>

## <a name="eventsetters-and-eventtriggers"></a><span data-ttu-id="72bca-298">EventSetters y EventTriggers</span><span class="sxs-lookup"><span data-stu-id="72bca-298">EventSetters and EventTriggers</span></span>

<span data-ttu-id="72bca-299">En los estilos, puede incluir alguna sintaxis de control de eventos declarada previamente [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] en el marcado mediante <xref:System.Windows.EventSetter> .</span><span class="sxs-lookup"><span data-stu-id="72bca-299">In styles, you can include some pre-declared [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] event handling syntax in the markup by using an <xref:System.Windows.EventSetter>.</span></span> <span data-ttu-id="72bca-300">Cuando se aplica el estilo, el controlador al que se hace referencia se agrega a la instancia que recibe el estilo.</span><span class="sxs-lookup"><span data-stu-id="72bca-300">When the style is applied, the referenced handler is added to the styled instance.</span></span> <span data-ttu-id="72bca-301">Puede declarar un <xref:System.Windows.EventSetter> solo para un evento enrutado.</span><span class="sxs-lookup"><span data-stu-id="72bca-301">You can declare an <xref:System.Windows.EventSetter> only for a routed event.</span></span> <span data-ttu-id="72bca-302">A continuación se muestra un ejemplo.</span><span class="sxs-lookup"><span data-stu-id="72bca-302">The following is an example.</span></span> <span data-ttu-id="72bca-303">Tenga en cuenta que el método `b1SetColor` al que se hace referencia aquí está en un archivo de código subyacente.</span><span class="sxs-lookup"><span data-stu-id="72bca-303">Note that the `b1SetColor` method referenced here is in a code-behind file.</span></span>

[!code-xaml[EventOvwSupport#XAML2](~/samples/snippets/csharp/VS_Snippets_Wpf/EventOvwSupport/CSharp/page2.xaml#xaml2)]

<span data-ttu-id="72bca-304">La ventaja que se obtiene aquí es que es probable que el estilo contenga una gran cantidad de información que se pueda aplicar a cualquier botón de la aplicación, y que la <xref:System.Windows.EventSetter> forma de formar parte de ese estilo promocione la reutilización de código, incluso en el nivel de marcado.</span><span class="sxs-lookup"><span data-stu-id="72bca-304">The advantage gained here is that the style is likely to contain a great deal of other information that could apply to any button in your application, and having the <xref:System.Windows.EventSetter> be part of that style promotes code reuse even at the markup level.</span></span> <span data-ttu-id="72bca-305">Además, <xref:System.Windows.EventSetter> abstrae los nombres de método para los controladores un paso más allá de la aplicación general y el marcado de página.</span><span class="sxs-lookup"><span data-stu-id="72bca-305">Also, an <xref:System.Windows.EventSetter> abstracts method names for handlers one step further away from the general application and page markup.</span></span>

<span data-ttu-id="72bca-306">Otra sintaxis especializada que combina las características de animación y eventos enrutados de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] es un <xref:System.Windows.EventTrigger> .</span><span class="sxs-lookup"><span data-stu-id="72bca-306">Another specialized syntax that combines the routed event and animation features of [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] is an <xref:System.Windows.EventTrigger>.</span></span> <span data-ttu-id="72bca-307">Al igual que con <xref:System.Windows.EventSetter> , solo se pueden usar eventos enrutados para <xref:System.Windows.EventTrigger> .</span><span class="sxs-lookup"><span data-stu-id="72bca-307">As with <xref:System.Windows.EventSetter>, only routed events may be used for an <xref:System.Windows.EventTrigger>.</span></span> <span data-ttu-id="72bca-308">Normalmente, <xref:System.Windows.EventTrigger> se declara como parte de un estilo, pero <xref:System.Windows.EventTrigger> también se puede declarar en elementos de nivel de página como parte de la <xref:System.Windows.FrameworkElement.Triggers%2A> colección o en <xref:System.Windows.Controls.ControlTemplate> .</span><span class="sxs-lookup"><span data-stu-id="72bca-308">Typically, an <xref:System.Windows.EventTrigger> is declared as part of a style, but an <xref:System.Windows.EventTrigger> can also be declared on page-level elements as part of the <xref:System.Windows.FrameworkElement.Triggers%2A> collection, or in a <xref:System.Windows.Controls.ControlTemplate>.</span></span> <span data-ttu-id="72bca-309"><xref:System.Windows.EventTrigger>Permite especificar un <xref:System.Windows.Media.Animation.Storyboard> que se ejecuta cada vez que un evento enrutado alcanza un elemento en su ruta que declara un <xref:System.Windows.EventTrigger> para ese evento.</span><span class="sxs-lookup"><span data-stu-id="72bca-309">An <xref:System.Windows.EventTrigger> enables you to specify a <xref:System.Windows.Media.Animation.Storyboard> that runs whenever a routed event reaches an element in its route that declares an <xref:System.Windows.EventTrigger> for that event.</span></span> <span data-ttu-id="72bca-310">La ventaja de un control <xref:System.Windows.EventTrigger> sobre simplemente controlar el evento y hacer que se inicie un guion gráfico existente es que <xref:System.Windows.EventTrigger> proporciona un mejor control sobre el guión gráfico y su comportamiento en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="72bca-310">The advantage of an <xref:System.Windows.EventTrigger> over just handling the event and causing it to start an existing storyboard is that an <xref:System.Windows.EventTrigger> provides better control over the storyboard and its run-time behavior.</span></span> <span data-ttu-id="72bca-311">Para más información, vea [Cómo: Utilizar desencadenadores de eventos para controlar un guión gráfico después de su inicio](../graphics-multimedia/how-to-use-event-triggers-to-control-a-storyboard-after-it-starts.md).</span><span class="sxs-lookup"><span data-stu-id="72bca-311">For more information, see [Use Event Triggers to Control a Storyboard After It Starts](../graphics-multimedia/how-to-use-event-triggers-to-control-a-storyboard-after-it-starts.md).</span></span>

<a name="more_about"></a>

## <a name="more-about-routed-events"></a><span data-ttu-id="72bca-312">Más información sobre los eventos enrutados</span><span class="sxs-lookup"><span data-stu-id="72bca-312">More About Routed Events</span></span>

<span data-ttu-id="72bca-313">En este tema se explican principalmente los eventos enrutados desde la perspectiva de describir los conceptos básicos y proporcionar orientación sobre cómo y cuándo responder a los eventos enrutados que ya existen en los distintos elementos y controles base.</span><span class="sxs-lookup"><span data-stu-id="72bca-313">This topic mainly discusses routed events from the perspective of describing the basic concepts and offering guidance on how and when to respond to the routed events that are already present in the various base elements and controls.</span></span> <span data-ttu-id="72bca-314">Pero puede crear sus propios eventos enrutados en su clase personalizada junto con toda la compatibilidad necesaria, como clases y delegados de datos de evento especializados.</span><span class="sxs-lookup"><span data-stu-id="72bca-314">However, you can create your own routed event on your custom class along with all the necessary support, such as specialized event data classes and delegates.</span></span> <span data-ttu-id="72bca-315">El propietario del evento enrutado puede ser cualquier clase, pero los eventos enrutados se deben generar y controlar mediante <xref:System.Windows.UIElement> o <xref:System.Windows.ContentElement> clases derivadas para ser útiles.</span><span class="sxs-lookup"><span data-stu-id="72bca-315">The routed event owner can be any class, but routed events must be raised by and handled by <xref:System.Windows.UIElement> or <xref:System.Windows.ContentElement> derived classes in order to be useful.</span></span> <span data-ttu-id="72bca-316">Para más información sobre los eventos personalizados, vea [Crear un evento enrutado personalizado](how-to-create-a-custom-routed-event.md).</span><span class="sxs-lookup"><span data-stu-id="72bca-316">For more information about custom events, see [Create a Custom Routed Event](how-to-create-a-custom-routed-event.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="72bca-317">Vea también</span><span class="sxs-lookup"><span data-stu-id="72bca-317">See also</span></span>

- <xref:System.Windows.EventManager>
- <xref:System.Windows.RoutedEvent>
- <xref:System.Windows.RoutedEventArgs>
- [<span data-ttu-id="72bca-318">Marcar eventos enrutados como controlados y control de clases</span><span class="sxs-lookup"><span data-stu-id="72bca-318">Marking Routed Events as Handled, and Class Handling</span></span>](marking-routed-events-as-handled-and-class-handling.md)
- [<span data-ttu-id="72bca-319">Información general sobre acciones del usuario</span><span class="sxs-lookup"><span data-stu-id="72bca-319">Input Overview</span></span>](input-overview.md)
- [<span data-ttu-id="72bca-320">Información general sobre comandos</span><span class="sxs-lookup"><span data-stu-id="72bca-320">Commanding Overview</span></span>](commanding-overview.md)
- [<span data-ttu-id="72bca-321">Propiedades de dependencia personalizadas</span><span class="sxs-lookup"><span data-stu-id="72bca-321">Custom Dependency Properties</span></span>](custom-dependency-properties.md)
- [<span data-ttu-id="72bca-322">Árboles en WPF</span><span class="sxs-lookup"><span data-stu-id="72bca-322">Trees in WPF</span></span>](trees-in-wpf.md)
- [<span data-ttu-id="72bca-323">Modelos de evento débil</span><span class="sxs-lookup"><span data-stu-id="72bca-323">Weak Event Patterns</span></span>](weak-event-patterns.md)
