---
title: Propiedades de dependencia personalizadas
description: Obtenga información sobre los pasos para implementar una propiedad en Windows Presentation Foundation y las opciones para mejorar el rendimiento, la facilidad de uso o la versatilidad de la propiedad.
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- implementing [WPF], wrappers
- registering properties [WPF]
- properties [WPF], metadata
- metadata [WPF], for properties
- custom dependency properties [WPF]
- properties [WPF], registering
- wrappers [WPF], implementing
- dependency properties [WPF], custom
ms.assetid: e6bfcfac-b10d-4f58-9f77-a864c2a2938f
ms.openlocfilehash: b082340afb8b1a814fc5923126aa58183d43bc01
ms.sourcegitcommit: 87cfeb69226fef01acb17c56c86f978f4f4a13db
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 07/24/2020
ms.locfileid: "87168145"
---
# <a name="custom-dependency-properties"></a><span data-ttu-id="bb2a8-103">Propiedades de dependencia personalizadas</span><span class="sxs-lookup"><span data-stu-id="bb2a8-103">Custom Dependency Properties</span></span>

<span data-ttu-id="bb2a8-104">En este tema se describen las razones por las que los autores de componentes y los desarrolladores de aplicaciones de [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] quieren crear la propiedad de dependencia personalizada, y se describen los pasos de implementación y algunas opciones de implementación que pueden mejorar el rendimiento, la facilidad de uso o la versatilidad de la propiedad.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-104">This topic describes the reasons that [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] application developers and component authors might want to create custom dependency property, and describes the implementation steps as well as some implementation options that can improve performance, usability, or versatility of the property.</span></span>

<a name="prerequisites"></a>

## <a name="prerequisites"></a><span data-ttu-id="bb2a8-105">Requisitos previos</span><span class="sxs-lookup"><span data-stu-id="bb2a8-105">Prerequisites</span></span>

<span data-ttu-id="bb2a8-106">En este tema, se supone que entiende las propiedades de dependencia desde la perspectiva de un consumidor de propiedades de dependencia existentes en las clases [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] y que ha leído el tema [Información general sobre las propiedades de dependencia](dependency-properties-overview.md).</span><span class="sxs-lookup"><span data-stu-id="bb2a8-106">This topic assumes that you understand dependency properties from the perspective of a consumer of existing dependency properties on [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] classes, and have read the [Dependency Properties Overview](dependency-properties-overview.md) topic.</span></span> <span data-ttu-id="bb2a8-107">Para seguir los ejemplos de este tema, también debe comprender [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] y saber cómo escribir aplicaciones de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="bb2a8-107">In order to follow the examples in this topic, you should also understand [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] and know how to write [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] applications.</span></span>

<a name="whatis"></a>

## <a name="what-is-a-dependency-property"></a><span data-ttu-id="bb2a8-108">¿Qué es una propiedad de dependencia?</span><span class="sxs-lookup"><span data-stu-id="bb2a8-108">What Is a Dependency Property?</span></span>

<span data-ttu-id="bb2a8-109">Puede habilitar lo que de otro modo sería una propiedad Common Language Runtime (CLR) para admitir el estilo, el enlace de datos, la herencia, las animaciones y los valores predeterminados mediante su implementación como una propiedad de dependencia.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-109">You can enable what would otherwise be a common language runtime (CLR) property to support styling, data binding, inheritance, animations, and default values by implementing it as a dependency property.</span></span> <span data-ttu-id="bb2a8-110">Las propiedades de dependencia son propiedades que se registran con el [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] sistema de propiedades llamando al <xref:System.Windows.DependencyProperty.Register%2A> método (o <xref:System.Windows.DependencyProperty.RegisterReadOnly%2A> ) y que están respaldadas por un <xref:System.Windows.DependencyProperty> campo de identificador.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-110">Dependency properties are properties that are registered with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] property system by calling the <xref:System.Windows.DependencyProperty.Register%2A> method (or <xref:System.Windows.DependencyProperty.RegisterReadOnly%2A>), and that are backed by a <xref:System.Windows.DependencyProperty> identifier field.</span></span> <span data-ttu-id="bb2a8-111">Las propiedades de dependencia solo se pueden usar en <xref:System.Windows.DependencyObject> los tipos, pero <xref:System.Windows.DependencyObject> es bastante alta en la [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] jerarquía de clases, por lo que la mayoría de las clases disponibles en [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] pueden admitir propiedades de dependencia.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-111">Dependency properties can be used only by <xref:System.Windows.DependencyObject> types, but <xref:System.Windows.DependencyObject> is quite high in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] class hierarchy, so the majority of classes available in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] can support dependency properties.</span></span> <span data-ttu-id="bb2a8-112">Para obtener más información sobre las propiedades de dependencia y parte de la terminología y las convenciones que se usan para describirlas en este SDK, consulte [información general sobre las propiedades de dependencia](dependency-properties-overview.md).</span><span class="sxs-lookup"><span data-stu-id="bb2a8-112">For more information about dependency properties and some of the terminology and conventions used for describing them in this SDK, see [Dependency Properties Overview](dependency-properties-overview.md).</span></span>

<a name="example_dp"></a>

## <a name="examples-of-dependency-properties"></a><span data-ttu-id="bb2a8-113">Ejemplos de propiedades de dependencia</span><span class="sxs-lookup"><span data-stu-id="bb2a8-113">Examples of Dependency Properties</span></span>

<span data-ttu-id="bb2a8-114">Algunos ejemplos de propiedades de dependencia que se implementan en [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] clases son la <xref:System.Windows.Controls.Control.Background%2A> propiedad, la <xref:System.Windows.FrameworkElement.Width%2A> propiedad y la <xref:System.Windows.Controls.TextBox.Text%2A> propiedad, entre muchos otros.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-114">Examples of dependency properties that are implemented on [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] classes include the <xref:System.Windows.Controls.Control.Background%2A> property, the <xref:System.Windows.FrameworkElement.Width%2A> property, and the <xref:System.Windows.Controls.TextBox.Text%2A> property, among many others.</span></span> <span data-ttu-id="bb2a8-115">Cada propiedad de dependencia expuesta por una clase tiene un campo estático público correspondiente de tipo <xref:System.Windows.DependencyProperty> expuesto en esa misma clase.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-115">Each dependency property exposed by a class has a corresponding public static field of type <xref:System.Windows.DependencyProperty> exposed on that same class.</span></span> <span data-ttu-id="bb2a8-116">Es el identificador de la propiedad de dependencia.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-116">This is the identifier for the dependency property.</span></span> <span data-ttu-id="bb2a8-117">El identificador se denomina mediante una convención: el nombre de la propiedad de dependencia con la cadena `Property` anexada.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-117">The identifier is named using a convention: the name of the dependency property with the string `Property` appended to it.</span></span> <span data-ttu-id="bb2a8-118">Por ejemplo, el <xref:System.Windows.DependencyProperty> campo de identificador correspondiente de la <xref:System.Windows.Controls.Control.Background%2A> propiedad es <xref:System.Windows.Controls.Control.BackgroundProperty> .</span><span class="sxs-lookup"><span data-stu-id="bb2a8-118">For example, the corresponding <xref:System.Windows.DependencyProperty> identifier field for the <xref:System.Windows.Controls.Control.Background%2A> property is <xref:System.Windows.Controls.Control.BackgroundProperty>.</span></span> <span data-ttu-id="bb2a8-119">El identificador almacena la información sobre la propiedad de dependencia tal y como se registró, y el identificador se usa posteriormente para otras operaciones relacionadas con la propiedad de dependencia, como llamar a <xref:System.Windows.DependencyObject.SetValue%2A> .</span><span class="sxs-lookup"><span data-stu-id="bb2a8-119">The identifier stores the information about the dependency property as it was registered, and the identifier is then used later for other operations involving the dependency property, such as calling <xref:System.Windows.DependencyObject.SetValue%2A>.</span></span>

<span data-ttu-id="bb2a8-120">Como se mencionó en la [información general sobre las propiedades de dependencia](dependency-properties-overview.md), todas las propiedades de dependencia de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] (excepto la mayoría de las propiedades adjuntas) son también propiedades de CLR debido a la implementación del "contenedor".</span><span class="sxs-lookup"><span data-stu-id="bb2a8-120">As mentioned in the [Dependency Properties Overview](dependency-properties-overview.md), all dependency properties in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] (except most attached properties) are also CLR properties because of the "wrapper" implementation.</span></span> <span data-ttu-id="bb2a8-121">Por lo tanto, desde el código, puede obtener o establecer las propiedades de dependencia mediante una llamada a los descriptores de acceso CLR que definen los contenedores de la misma manera que usaría otras propiedades CLR.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-121">Therefore, from code, you can get or set dependency properties by calling CLR accessors that define the wrappers in the same manner that you would use other CLR properties.</span></span> <span data-ttu-id="bb2a8-122">Como consumidor de las propiedades de dependencia establecidas, normalmente no se usan los <xref:System.Windows.DependencyObject> métodos <xref:System.Windows.DependencyObject.GetValue%2A> y <xref:System.Windows.DependencyObject.SetValue%2A> , que son el punto de conexión con el sistema de propiedades subyacente.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-122">As a consumer of established dependency properties, you do not typically use the <xref:System.Windows.DependencyObject> methods <xref:System.Windows.DependencyObject.GetValue%2A> and <xref:System.Windows.DependencyObject.SetValue%2A>, which are the connection point to the underlying property system.</span></span> <span data-ttu-id="bb2a8-123">En su lugar, la implementación existente de las propiedades de CLR ya habrá llamado <xref:System.Windows.DependencyObject.GetValue%2A> y <xref:System.Windows.DependencyObject.SetValue%2A> dentro de las `get` `set` implementaciones de contenedor y de la propiedad, mediante el campo de identificador de forma adecuada.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-123">Rather, the existing implementation of the CLR properties will have already called <xref:System.Windows.DependencyObject.GetValue%2A> and <xref:System.Windows.DependencyObject.SetValue%2A> within the `get` and `set` wrapper implementations of the property, using the identifier field appropriately.</span></span> <span data-ttu-id="bb2a8-124">Si se está implementando una propiedad de dependencia personalizada, a continuación, estará definiendo el contenedor de forma similar.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-124">If you are implementing a custom dependency property yourself, then you will be defining the wrapper in a similar way.</span></span>

<a name="backing_with_dp"></a>

## <a name="when-should-you-implement-a-dependency-property"></a><span data-ttu-id="bb2a8-125">¿Cuándo se debe implementar una propiedad de dependencia?</span><span class="sxs-lookup"><span data-stu-id="bb2a8-125">When Should You Implement a Dependency Property?</span></span>

<span data-ttu-id="bb2a8-126">Cuando se implementa una propiedad en una clase, siempre y cuando la clase derive de <xref:System.Windows.DependencyObject> , tiene la opción de hacer una copia de seguridad de la propiedad con un <xref:System.Windows.DependencyProperty> identificador y, por lo tanto, convertirla en una propiedad de dependencia.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-126">When you implement a property on a class, so long as your class derives from <xref:System.Windows.DependencyObject>, you have the option to back your property with a <xref:System.Windows.DependencyProperty> identifier and thus to make it a dependency property.</span></span> <span data-ttu-id="bb2a8-127">Convertir su propiedad en una propiedad de dependencia no es siempre necesario ni adecuado y dependerá de las necesidades del escenario.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-127">Having your property be a dependency property is not always necessary or appropriate, and will depend on your scenario needs.</span></span> <span data-ttu-id="bb2a8-128">A veces, la técnica típica de respaldar la propiedad con un campo privado es adecuada.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-128">Sometimes, the typical technique of backing your property with a private field is adequate.</span></span> <span data-ttu-id="bb2a8-129">Sin embargo, deberá implementar la propiedad como una propiedad de dependencia cada vez que quiera que esta admita una o varias de las siguientes funcionalidades de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]:</span><span class="sxs-lookup"><span data-stu-id="bb2a8-129">However, you should implement your property as a dependency property whenever you want your property to support one or more of the following [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] capabilities:</span></span>

- <span data-ttu-id="bb2a8-130">Quiere que su propiedad se pueda establecer en un estilo.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-130">You want your property to be settable in a style.</span></span> <span data-ttu-id="bb2a8-131">Para obtener más información, consulte [Aplicar estilos y plantillas](../../../desktop-wpf/fundamentals/styles-templates-overview.md).</span><span class="sxs-lookup"><span data-stu-id="bb2a8-131">For more information, see [Styling and Templating](../../../desktop-wpf/fundamentals/styles-templates-overview.md).</span></span>

- <span data-ttu-id="bb2a8-132">Quiere que su propiedad admita el enlace de datos.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-132">You want your property to support data binding.</span></span> <span data-ttu-id="bb2a8-133">Para obtener más información sobre las propiedades de dependencia de enlace de datos, consulte [Enlazar las propiedades de dos controles](../data/how-to-bind-the-properties-of-two-controls.md).</span><span class="sxs-lookup"><span data-stu-id="bb2a8-133">For more information about data binding dependency properties, see [Bind the Properties of Two Controls](../data/how-to-bind-the-properties-of-two-controls.md).</span></span>

- <span data-ttu-id="bb2a8-134">Quiere que su propiedad se pueda establecer con una referencia de recurso dinámico.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-134">You want your property to be settable with a dynamic resource reference.</span></span> <span data-ttu-id="bb2a8-135">Para obtener más información, consulte [Recursos XAML](../../../desktop-wpf/fundamentals/xaml-resources-define.md).</span><span class="sxs-lookup"><span data-stu-id="bb2a8-135">For more information, see [XAML Resources](../../../desktop-wpf/fundamentals/xaml-resources-define.md).</span></span>

- <span data-ttu-id="bb2a8-136">Quiere heredar un valor de propiedad automáticamente de un elemento primario del árbol de elementos.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-136">You want to inherit a property value automatically from a parent element in the element tree.</span></span> <span data-ttu-id="bb2a8-137">En este caso, regístrese con el <xref:System.Windows.DependencyProperty.RegisterAttached%2A> método, incluso si también crea un contenedor de propiedades para el acceso a CLR.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-137">In this case, register with the <xref:System.Windows.DependencyProperty.RegisterAttached%2A> method, even if you also create a property wrapper for CLR access.</span></span> <span data-ttu-id="bb2a8-138">Para más información, vea [Herencia de valores de propiedad](property-value-inheritance.md).</span><span class="sxs-lookup"><span data-stu-id="bb2a8-138">For more information, see [Property Value Inheritance](property-value-inheritance.md).</span></span>

- <span data-ttu-id="bb2a8-139">Quiere que su propiedad se pueda animar.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-139">You want your property to be animatable.</span></span> <span data-ttu-id="bb2a8-140">Para obtener más información, vea [información general sobre animaciones](../graphics-multimedia/animation-overview.md).</span><span class="sxs-lookup"><span data-stu-id="bb2a8-140">For more information, see [Animation Overview](../graphics-multimedia/animation-overview.md).</span></span>

- <span data-ttu-id="bb2a8-141">Quiere que el sistema de propiedades notifique cualquier cambio en el valor anterior de la propiedad debido a acciones del sistema de propiedades, el entorno o el usuario, o a la lectura y el uso de estilos.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-141">You want the property system to report when the previous value of the property has been changed by actions taken by the property system, the environment, or the user, or by reading and using styles.</span></span> <span data-ttu-id="bb2a8-142">Al usar los metadatos de la propiedad, la propiedad puede especificar un método de devolución de llamada que se invocará cada vez que el sistema de propiedades determine un cambio definitivo en el valor de la propiedad.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-142">By using property metadata, your property can specify a callback method that will be invoked each time the property system determines that your property value was definitively changed.</span></span> <span data-ttu-id="bb2a8-143">Un concepto relacionado es la coerción del valor de propiedad.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-143">A related concept is property value coercion.</span></span> <span data-ttu-id="bb2a8-144">Para obtener más información, consulte [Devoluciones de llamada y validación de las propiedades de dependencia](dependency-property-callbacks-and-validation.md).</span><span class="sxs-lookup"><span data-stu-id="bb2a8-144">For more information, see [Dependency Property Callbacks and Validation](dependency-property-callbacks-and-validation.md).</span></span>

- <span data-ttu-id="bb2a8-145">Quiere usar convenciones de metadatos establecidas que también se usan en los procesos de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], como notificar si un cambio en un valor de propiedad debe exigir que el sistema de diseño recomponga los elementos visuales de un elemento.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-145">You want to use established metadata conventions that are also used by [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] processes, such as reporting whether changing a property value should require the layout system to recompose the visuals for an element.</span></span> <span data-ttu-id="bb2a8-146">O bien quiere poder usar invalidaciones de metadatos para que las clases derivadas puedan cambiar las características basadas en metadatos, como el valor predeterminado.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-146">Or you want to be able to use metadata overrides so that derived classes can change metadata-based characteristics such as the default value.</span></span>

- <span data-ttu-id="bb2a8-147">Quiere que las propiedades de un control personalizado reciban compatibilidad con el diseñador WPF de Visual Studio, como la edición de la ventana **propiedades** .</span><span class="sxs-lookup"><span data-stu-id="bb2a8-147">You want properties of a custom control to receive Visual Studio WPF Designer support, such as **Properties** window editing.</span></span> <span data-ttu-id="bb2a8-148">Para obtener más información, consulte [Información general sobre la creación de controles](../controls/control-authoring-overview.md).</span><span class="sxs-lookup"><span data-stu-id="bb2a8-148">For more information, see [Control Authoring Overview](../controls/control-authoring-overview.md).</span></span>

<span data-ttu-id="bb2a8-149">Al examinar estos escenarios, también debe considerar si puede obtener su escenario mediante la invalidación de los metadatos de una propiedad de dependencia existente, en lugar de hacerlo a través de la implementación de una propiedad completamente nueva.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-149">When you examine these scenarios, you should also consider whether you can achieve your scenario by overriding the metadata of an existing dependency property, rather than implementing a completely new property.</span></span> <span data-ttu-id="bb2a8-150">Que una invalidación de metadatos resulte práctica depende de su escenario y del parecido de ese escenario con la implementación en las clases y las propiedades de dependencia existentes de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="bb2a8-150">Whether a metadata override is practical depends on your scenario and how closely that scenario resembles the implementation in existing [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] dependency properties and classes.</span></span> <span data-ttu-id="bb2a8-151">Para obtener más información sobre cómo invalidar los metadatos de las propiedades existentes, consulte [Metadatos de las propiedades de dependencia](dependency-property-metadata.md).</span><span class="sxs-lookup"><span data-stu-id="bb2a8-151">For more information about overriding metadata on existing properties, see [Dependency Property Metadata](dependency-property-metadata.md).</span></span>

<a name="checklist"></a>

## <a name="checklist-for-defining-a-dependency-property"></a><span data-ttu-id="bb2a8-152">Lista de comprobación para definir una propiedad de dependencia</span><span class="sxs-lookup"><span data-stu-id="bb2a8-152">Checklist for Defining a Dependency Property</span></span>

<span data-ttu-id="bb2a8-153">La definición de una propiedad de dependencia consta de cuatro conceptos distintos.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-153">Defining a dependency property consists of four distinct concepts.</span></span> <span data-ttu-id="bb2a8-154">Estos conceptos no son necesariamente procedimientos estrictos, ya que algunos de ellos acaban combinándose en una sola línea de código en la implementación:</span><span class="sxs-lookup"><span data-stu-id="bb2a8-154">These concepts are not necessarily strict procedural steps, because some of these end up being combined as single lines of code in the implementation:</span></span>

- <span data-ttu-id="bb2a8-155">(Opcional) Cree los metadatos de propiedad de la propiedad de dependencia.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-155">(Optional) Create property metadata for the dependency property.</span></span>

- <span data-ttu-id="bb2a8-156">Registre el nombre de propiedad con el sistema de propiedades, y especifique el tipo de propietario y el tipo de valor de propiedad.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-156">Register the property name with the property system, specifying an owner type and the type of the property value.</span></span> <span data-ttu-id="bb2a8-157">Especifique también los metadatos de la propiedad, si se usan.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-157">Also specify the property metadata, if used.</span></span>

- <span data-ttu-id="bb2a8-158">Defina un <xref:System.Windows.DependencyProperty> identificador como un `public` `static` `readonly` campo en el tipo de propietario.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-158">Define a <xref:System.Windows.DependencyProperty> identifier as a `public` `static` `readonly` field on the owner type.</span></span>

- <span data-ttu-id="bb2a8-159">Defina una propiedad de "contenedor" de CLR cuyo nombre coincida con el nombre de la propiedad de dependencia.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-159">Define a CLR "wrapper" property whose name matches the name of the dependency property.</span></span> <span data-ttu-id="bb2a8-160">Implemente los descriptores de acceso y de la propiedad "contenedor" de CLR `get` `set` para conectarse con la propiedad de dependencia que lo respalda.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-160">Implement the CLR "wrapper" property's `get` and `set` accessors to connect with the dependency property that backs it.</span></span>

<a name="registering"></a>

### <a name="registering-the-property-with-the-property-system"></a><span data-ttu-id="bb2a8-161">Registro de la propiedad con el sistema de propiedades</span><span class="sxs-lookup"><span data-stu-id="bb2a8-161">Registering the Property with the Property System</span></span>

<span data-ttu-id="bb2a8-162">Para que la propiedad sea una propiedad de dependencia, debe registrarla en una tabla (de cuyo mantenimiento se encargue el sistema de propiedades) y asignarle un identificador único, que se usará como calificador en operaciones posteriores del sistema de propiedades.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-162">In order for your property to be a dependency property, you must register that property into a table maintained by the property system, and give it a unique identifier that is used as the qualifier for later property system operations.</span></span> <span data-ttu-id="bb2a8-163">Estas operaciones pueden ser operaciones internas o su propio código que llama a las API del sistema de propiedades.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-163">These operations might be internal operations, or your own code calling property system APIs.</span></span> <span data-ttu-id="bb2a8-164">Para registrar la propiedad, se llama al <xref:System.Windows.DependencyProperty.Register%2A> método dentro del cuerpo de la clase (dentro de la clase, pero fuera de las definiciones de miembro).</span><span class="sxs-lookup"><span data-stu-id="bb2a8-164">To register the property, you call the <xref:System.Windows.DependencyProperty.Register%2A> method within the body of your class (inside the class, but outside of any member definitions).</span></span> <span data-ttu-id="bb2a8-165">El campo identificador también lo proporciona la <xref:System.Windows.DependencyProperty.Register%2A> llamada al método, como el valor devuelto.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-165">The identifier field is also provided by the <xref:System.Windows.DependencyProperty.Register%2A> method call, as the return value.</span></span> <span data-ttu-id="bb2a8-166">La razón por la que la <xref:System.Windows.DependencyProperty.Register%2A> llamada se realiza fuera de otras definiciones de miembro es porque se usa este valor devuelto para asignar y crear un `public` `static` `readonly` campo de tipo <xref:System.Windows.DependencyProperty> como parte de la clase.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-166">The reason that the <xref:System.Windows.DependencyProperty.Register%2A> call is done outside of other member definitions is because you use this return value to assign and create a `public` `static` `readonly` field of type <xref:System.Windows.DependencyProperty> as part of your class.</span></span> <span data-ttu-id="bb2a8-167">Este campo se convierte en el identificador de la propiedad de dependencia.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-167">This field becomes the identifier for your dependency property.</span></span>

[!code-csharp[WPFAquariumSln#RegisterAG](~/samples/snippets/csharp/VS_Snippets_Wpf/WPFAquariumSln/CSharp/WPFAquariumObjects/Class1.cs#registerag)]
[!code-vb[WPFAquariumSln#RegisterAG](~/samples/snippets/visualbasic/VS_Snippets_Wpf/WPFAquariumSln/visualbasic/wpfaquariumobjects/class1.vb#registerag)]

<a name="nameconventions"></a>

### <a name="dependency-property-name-conventions"></a><span data-ttu-id="bb2a8-168">Convenciones de nombres de las propiedades de dependencia</span><span class="sxs-lookup"><span data-stu-id="bb2a8-168">Dependency Property Name Conventions</span></span>

<span data-ttu-id="bb2a8-169">Existen convenciones de nomenclatura establecidas con respecto a las propiedades de dependencia que se deben seguir en todas las circunstancias, menos en las excepcionales.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-169">There are established naming conventions regarding dependency properties that you must follow in all but exceptional circumstances.</span></span>

<span data-ttu-id="bb2a8-170">La propia propiedad de dependencia tendrá un nombre básico, "AquariumGraphic", como en este ejemplo, que se proporciona como el primer parámetro de <xref:System.Windows.DependencyProperty.Register%2A> .</span><span class="sxs-lookup"><span data-stu-id="bb2a8-170">The dependency property itself will have a basic name, "AquariumGraphic" as in this example, which is given as the first parameter of <xref:System.Windows.DependencyProperty.Register%2A>.</span></span> <span data-ttu-id="bb2a8-171">Este nombre debe ser único en cada tipo de registro.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-171">That name must be unique within each registering type.</span></span> <span data-ttu-id="bb2a8-172">Las propiedades de dependencia heredadas a través de tipos base ya se consideran parte del tipo de registro; los nombres de las propiedades heredadas no se pueden volver a registrar.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-172">Dependency properties inherited through base types are considered to be already part of the registering type; names of inherited properties cannot be registered again.</span></span> <span data-ttu-id="bb2a8-173">Sin embargo, existe una técnica para agregar una clase como propietaria de una propiedad de dependencia, aunque esa propiedad de dependencia no sea heredada. Para obtener más información, consulte [Metadatos de las propiedades de dependencia](dependency-property-metadata.md).</span><span class="sxs-lookup"><span data-stu-id="bb2a8-173">However, there is a technique for adding a class as owner of a dependency property even when that dependency property is not inherited; for details, see [Dependency Property Metadata](dependency-property-metadata.md).</span></span>

<span data-ttu-id="bb2a8-174">Al crear el campo de identificador, asígnele el nombre de la propiedad tal como lo registró, seguido del sufijo `Property`.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-174">When you create the identifier field, name this field by the name of the property as you registered it, plus the suffix `Property`.</span></span> <span data-ttu-id="bb2a8-175">Este campo es el identificador de la propiedad de dependencia y se usará más adelante como una entrada para las llamadas a <xref:System.Windows.DependencyObject.SetValue%2A> y realizará <xref:System.Windows.DependencyObject.GetValue%2A> en los contenedores cualquier otro acceso de código a la propiedad por su propio código, por cualquier acceso de código externo que permita, por parte del sistema de propiedades, y posiblemente por [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] procesadores.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-175">This field is your identifier for the dependency property, and it will be used later as an input for the <xref:System.Windows.DependencyObject.SetValue%2A> and <xref:System.Windows.DependencyObject.GetValue%2A> calls you will make in the wrappers, by any other code access to the property by your own code, by any external code access you allow, by the property system, and potentially by [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] processors.</span></span>

> [!NOTE]
> <span data-ttu-id="bb2a8-176">La definición de la propiedad de dependencia en el cuerpo de la clase es la implementación típica, pero también es posible definir una propiedad de dependencia en el constructor estático de la clase.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-176">Defining the dependency property in the class body is the typical implementation, but it is also possible to define a dependency property in the class static constructor.</span></span> <span data-ttu-id="bb2a8-177">Este enfoque podría tener sentido si necesita más de una línea de código para inicializar la propiedad de dependencia.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-177">This approach might make sense if you need more than one line of code to initialize the dependency property.</span></span>

<a name="wrapper1"></a>

### <a name="implementing-the-wrapper"></a><span data-ttu-id="bb2a8-178">Implementación del "contenedor"</span><span class="sxs-lookup"><span data-stu-id="bb2a8-178">Implementing the "Wrapper"</span></span>

<span data-ttu-id="bb2a8-179">La implementación del contenedor debería llamar a <xref:System.Windows.DependencyObject.GetValue%2A> en la `get` implementación de y, <xref:System.Windows.DependencyObject.SetValue%2A> en la `set` implementación de (el campo y la llamada de registro originales se muestran aquí para mayor claridad).</span><span class="sxs-lookup"><span data-stu-id="bb2a8-179">Your wrapper implementation should call <xref:System.Windows.DependencyObject.GetValue%2A> in the `get` implementation, and <xref:System.Windows.DependencyObject.SetValue%2A> in the `set` implementation (the original registration call and field are shown here too for clarity).</span></span>

<span data-ttu-id="bb2a8-180">En todas las circunstancias, pero excepcionales, las implementaciones de contenedor deben realizar solo las <xref:System.Windows.DependencyObject.GetValue%2A> <xref:System.Windows.DependencyObject.SetValue%2A> acciones y, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-180">In all but exceptional circumstances, your wrapper implementations should perform only the <xref:System.Windows.DependencyObject.GetValue%2A> and <xref:System.Windows.DependencyObject.SetValue%2A> actions, respectively.</span></span> <span data-ttu-id="bb2a8-181">La razón se explica en el tema [Carga de XAML y propiedades de dependencia](xaml-loading-and-dependency-properties.md).</span><span class="sxs-lookup"><span data-stu-id="bb2a8-181">The reason for this is discussed in the topic [XAML Loading and Dependency Properties](xaml-loading-and-dependency-properties.md).</span></span>

<span data-ttu-id="bb2a8-182">Todas las propiedades de dependencia públicas existentes que se proporcionan en las clases de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] usan este modelo de implementación de contenedor simple; gran parte de la complejidad del funcionamiento de las propiedades de dependencia es de manera inherente un comportamiento del sistema de propiedades, o bien se implementa a través de otros conceptos, como la coerción o las devoluciones de llamada de cambio de propiedad a través de los metadatos de la propiedad.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-182">All existing public dependency properties that are provided on the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] classes use this simple wrapper implementation model; most of the complexity of how dependency properties work is either inherently a behavior of the property system, or is implemented through other concepts such as coercion or property change callbacks through property metadata.</span></span>

[!code-csharp[WPFAquariumSln#AGWithWrapper](~/samples/snippets/csharp/VS_Snippets_Wpf/WPFAquariumSln/CSharp/WPFAquariumObjects/Class1.cs#agwithwrapper)]
[!code-vb[WPFAquariumSln#AGWithWrapper](~/samples/snippets/visualbasic/VS_Snippets_Wpf/WPFAquariumSln/visualbasic/wpfaquariumobjects/class1.vb#agwithwrapper)]

<span data-ttu-id="bb2a8-183">De nuevo, por Convención, el nombre de la propiedad de contenedor debe ser el mismo que el nombre elegido y dado como primer parámetro de la <xref:System.Windows.DependencyProperty.Register%2A> llamada que registró la propiedad.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-183">Again, by convention, the name of the wrapper property must be the same as the name chosen and given as first parameter of the <xref:System.Windows.DependencyProperty.Register%2A> call that registered the property.</span></span> <span data-ttu-id="bb2a8-184">Si la propiedad no cumple esta convención, no deshabilitará necesariamente todos los usos posibles, pero encontrará varios problemas importantes:</span><span class="sxs-lookup"><span data-stu-id="bb2a8-184">If your property does not follow the convention, this does not necessarily disable all possible uses, but you will encounter several notable issues:</span></span>

- <span data-ttu-id="bb2a8-185">Determinados aspectos de los estilos y las plantillas no funcionarán.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-185">Certain aspects of styles and templates will not work.</span></span>

- <span data-ttu-id="bb2a8-186">La mayoría de las herramientas y los diseñadores deben basarse en las convenciones de nomenclatura para serializar correctamente [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], o para proporcionar al entorno del diseñador asistencia para cada propiedad.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-186">Most tools and designers must rely on the naming conventions to properly serialize [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], or to provide designer environment assistance at a per-property level.</span></span>

- <span data-ttu-id="bb2a8-187">La implementación actual del [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] cargador omite completamente los contenedores y se basa en la Convención de nomenclatura al procesar los valores de atributo.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-187">The current implementation of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] loader bypasses the wrappers entirely, and relies on the naming convention when processing attribute values.</span></span> <span data-ttu-id="bb2a8-188">Para obtener más información, consulte [Carga de XAML y propiedades de dependencia](xaml-loading-and-dependency-properties.md).</span><span class="sxs-lookup"><span data-stu-id="bb2a8-188">For more information, see [XAML Loading and Dependency Properties](xaml-loading-and-dependency-properties.md).</span></span>

<a name="metadata"></a>

### <a name="property-metadata-for-a-new-dependency-property"></a><span data-ttu-id="bb2a8-189">Metadatos de propiedad de una nueva propiedad de dependencia</span><span class="sxs-lookup"><span data-stu-id="bb2a8-189">Property Metadata for a New Dependency Property</span></span>

<span data-ttu-id="bb2a8-190">Al registrar una propiedad de dependencia, el registro a través del sistema de propiedades crea un objeto de metadatos que almacena las características de la propiedad.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-190">When you register a dependency property, the registration through the property system creates a metadata object that stores property characteristics.</span></span> <span data-ttu-id="bb2a8-191">Muchas de estas características tienen valores predeterminados que se establecen si la propiedad se registra con las firmas simples de <xref:System.Windows.DependencyProperty.Register%2A> .</span><span class="sxs-lookup"><span data-stu-id="bb2a8-191">Many of these characteristics have defaults that are set if the property is registered with the simple signatures of <xref:System.Windows.DependencyProperty.Register%2A>.</span></span> <span data-ttu-id="bb2a8-192">Otras firmas de <xref:System.Windows.DependencyProperty.Register%2A> le permiten especificar los metadatos que desea al registrar la propiedad.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-192">Other signatures of <xref:System.Windows.DependencyProperty.Register%2A> allow you to specify the metadata that you want as you register the property.</span></span> <span data-ttu-id="bb2a8-193">La asignación de metadatos más común para las propiedades de dependencia consiste en asignarles un valor predeterminado, que se aplicará a las nuevas instancias que usen la propiedad.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-193">The most common metadata given for dependency properties is to give them a default value that is applied on new instances that use the property.</span></span>

<span data-ttu-id="bb2a8-194">Si va a crear una propiedad de dependencia que existe en una clase derivada de <xref:System.Windows.FrameworkElement> , puede usar la clase de metadatos más especializada <xref:System.Windows.FrameworkPropertyMetadata> en lugar de la <xref:System.Windows.PropertyMetadata> clase base.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-194">If you are creating a dependency property that exists on a derived class of <xref:System.Windows.FrameworkElement>, you can use the more specialized metadata class <xref:System.Windows.FrameworkPropertyMetadata> rather than the base <xref:System.Windows.PropertyMetadata> class.</span></span> <span data-ttu-id="bb2a8-195">El constructor de la <xref:System.Windows.FrameworkPropertyMetadata> clase tiene varias firmas en las que puede especificar varias características de metadatos en combinación.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-195">The constructor for the <xref:System.Windows.FrameworkPropertyMetadata> class has several signatures where you can specify various metadata characteristics in combination.</span></span> <span data-ttu-id="bb2a8-196">Si desea especificar solo el valor predeterminado, utilice la firma que toma un único parámetro de tipo <xref:System.Object> .</span><span class="sxs-lookup"><span data-stu-id="bb2a8-196">If you want to specify the default value only, use the signature that takes a single parameter of type <xref:System.Object>.</span></span> <span data-ttu-id="bb2a8-197">Pase ese parámetro de objeto como valor predeterminado específico del tipo para la propiedad (el valor predeterminado proporcionado debe ser el tipo proporcionado como `propertyType` parámetro en la <xref:System.Windows.DependencyProperty.Register%2A> llamada).</span><span class="sxs-lookup"><span data-stu-id="bb2a8-197">Pass that object parameter as a type-specific default value for your property (the default value provided must be the type you provided as the `propertyType` parameter in the <xref:System.Windows.DependencyProperty.Register%2A> call).</span></span>

<span data-ttu-id="bb2a8-198">Para <xref:System.Windows.FrameworkPropertyMetadata> , también puede especificar las marcas de opciones de metadatos para la propiedad.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-198">For <xref:System.Windows.FrameworkPropertyMetadata>, you can also specify metadata option flags for your property.</span></span> <span data-ttu-id="bb2a8-199">Estas marcas se convierten en propiedades discretas en los metadatos de propiedad después del registro y se usan para comunicar ciertos determinantes a otros procesos, como el motor de diseño.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-199">These flags are converted into discrete properties on the property metadata after registration and are used to communicate certain conditionals to other processes such as the layout engine.</span></span>

#### <a name="setting-appropriate-metadata-flags"></a><span data-ttu-id="bb2a8-200">Establecimiento de marcas de metadatos adecuadas</span><span class="sxs-lookup"><span data-stu-id="bb2a8-200">Setting Appropriate Metadata Flags</span></span>

- <span data-ttu-id="bb2a8-201">Si la propiedad (o los cambios en su valor) afecta a [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] y, en particular, afecta al modo en que el sistema de diseño debe ajustar el tamaño o representar el elemento en una página, establezca una o varias de las marcas siguientes: <xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsMeasure> , <xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsArrange> , <xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsRender> .</span><span class="sxs-lookup"><span data-stu-id="bb2a8-201">If your property (or changes in its value) affects the [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)], and in particular affects how the layout system should size or render your element in a page, set one or more of the following flags: <xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsMeasure>, <xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsArrange>, <xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsRender>.</span></span>

  - <span data-ttu-id="bb2a8-202"><xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsMeasure>indica que un cambio en esta propiedad requiere un cambio en [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] la representación donde el objeto contenedor podría requerir más o menos espacio en el elemento primario.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-202"><xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsMeasure> indicates that a change to this property requires a change to [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] rendering where the containing object might require more or less space within the parent.</span></span> <span data-ttu-id="bb2a8-203">Por ejemplo, una propiedad "Width" debe tener establecida esta marca.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-203">For example, a "Width" property should have this flag set.</span></span>

  - <span data-ttu-id="bb2a8-204"><xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsArrange>indica que un cambio en esta propiedad requiere un cambio en [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] la representación que normalmente no requiere un cambio en el espacio dedicado, pero indica que ha cambiado la posición dentro del espacio.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-204"><xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsArrange> indicates that a change to this property requires a change to [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] rendering that typically does not require a change in the dedicated space, but does indicate that the positioning within the space has changed.</span></span> <span data-ttu-id="bb2a8-205">Por ejemplo, una propiedad "Alignment" debe tener establecida esta marca.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-205">For example, an "Alignment" property should have this flag set.</span></span>

  - <span data-ttu-id="bb2a8-206"><xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsRender>indica que se ha producido algún otro cambio que no afectará al diseño y a la medida, pero requiere otro procesamiento.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-206"><xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsRender> indicates that some other change has occurred that will not affect layout and measure, but does require another render.</span></span> <span data-ttu-id="bb2a8-207">Un ejemplo sería una propiedad que cambia un color de un elemento existente, como "Background".</span><span class="sxs-lookup"><span data-stu-id="bb2a8-207">An example would be a property that changes a color of an existing element, such as "Background".</span></span>

  - <span data-ttu-id="bb2a8-208">Estas marcas se usan a menudo como un protocolo en los metadatos para sus propias implementaciones de invalidación de las devoluciones de llamada de diseño o del sistema propiedades.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-208">These flags are often used as a protocol in metadata for your own override implementations of property system or layout callbacks.</span></span> <span data-ttu-id="bb2a8-209">Por ejemplo, podría tener una devolución de llamada <xref:System.Windows.DependencyObject.OnPropertyChanged%2A> que llamará a <xref:System.Windows.UIElement.InvalidateArrange%2A> si alguna propiedad de la instancia informa de un cambio de valor y tiene <xref:System.Windows.FrameworkPropertyMetadata.AffectsArrange%2A> como `true` en sus metadatos.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-209">For instance, you might have an <xref:System.Windows.DependencyObject.OnPropertyChanged%2A> callback that will call <xref:System.Windows.UIElement.InvalidateArrange%2A> if any property of the instance reports a value change and has <xref:System.Windows.FrameworkPropertyMetadata.AffectsArrange%2A> as `true` in its metadata.</span></span>

- <span data-ttu-id="bb2a8-210">Algunas propiedades pueden afectar a la representación de características del elemento primario contenedor, más allá de los cambios en el tamaño necesario mencionados anteriormente.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-210">Some properties may affect the rendering characteristics of the containing parent element, in ways above and beyond the changes in required size mentioned above.</span></span> <span data-ttu-id="bb2a8-211">Un ejemplo es la <xref:System.Windows.Documents.Paragraph.MinOrphanLines%2A> propiedad que se usa en el modelo de documento de flujo, donde los cambios en esa propiedad pueden cambiar la representación general del documento dinámico que contiene el párrafo.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-211">An example is the <xref:System.Windows.Documents.Paragraph.MinOrphanLines%2A> property used in the flow document model, where changes to that property can change the overall rendering of the flow document that contains the paragraph.</span></span> <span data-ttu-id="bb2a8-212">Use <xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsParentArrange> o <xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsParentMeasure> para identificar casos similares en sus propias propiedades.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-212">Use <xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsParentArrange> or <xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsParentMeasure> to identify similar cases in your own properties.</span></span>

- <span data-ttu-id="bb2a8-213">De forma predeterminada, las propiedades de dependencia admiten el enlace de datos.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-213">By default, dependency properties support data binding.</span></span> <span data-ttu-id="bb2a8-214">Puede deshabilitar deliberadamente el enlace de datos en aquellos casos en que no exista ningún escenario realista para el enlace de datos, o en que el rendimiento del enlace de datos de un objeto de gran tamaño se reconozca como un problema.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-214">You can deliberately disable data binding, for cases where there is no realistic scenario for data binding, or where performance in data binding for a large object is recognized as a problem.</span></span>

- <span data-ttu-id="bb2a8-215">De forma predeterminada, el enlace <xref:System.Windows.Data.Binding.Mode%2A> de datos para las propiedades de dependencia tiene como valor predeterminado <xref:System.Windows.Data.BindingMode.OneWay> .</span><span class="sxs-lookup"><span data-stu-id="bb2a8-215">By default, data binding <xref:System.Windows.Data.Binding.Mode%2A> for dependency properties defaults to <xref:System.Windows.Data.BindingMode.OneWay>.</span></span> <span data-ttu-id="bb2a8-216">Siempre puede cambiar el enlace para que sea <xref:System.Windows.Data.BindingMode.TwoWay> por instancia de enlace; para obtener más información, vea [especificar la dirección del enlace](../data/how-to-specify-the-direction-of-the-binding.md).</span><span class="sxs-lookup"><span data-stu-id="bb2a8-216">You can always change the binding to be <xref:System.Windows.Data.BindingMode.TwoWay> per binding instance; for details, see [Specify the Direction of the Binding](../data/how-to-specify-the-direction-of-the-binding.md).</span></span> <span data-ttu-id="bb2a8-217">Pero como autor de la propiedad de dependencia, puede elegir que la propiedad use el <xref:System.Windows.Data.BindingMode.TwoWay> modo de enlace de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-217">But as the dependency property author, you can choose to make the property use <xref:System.Windows.Data.BindingMode.TwoWay> binding mode by default.</span></span> <span data-ttu-id="bb2a8-218">Un ejemplo de una propiedad de dependencia existente es <xref:System.Windows.Controls.MenuItem.IsSubmenuOpen%2A?displayProperty=nameWithType> ; el escenario de esta propiedad es que la <xref:System.Windows.Controls.MenuItem.IsSubmenuOpen%2A> lógica de configuración y la composición de <xref:System.Windows.Controls.MenuItem> interactúan con el estilo de tema predeterminado.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-218">An example of an existing dependency property is <xref:System.Windows.Controls.MenuItem.IsSubmenuOpen%2A?displayProperty=nameWithType>; the scenario for this property is that the <xref:System.Windows.Controls.MenuItem.IsSubmenuOpen%2A> setting logic and the compositing of <xref:System.Windows.Controls.MenuItem> interact with the default theme style.</span></span> <span data-ttu-id="bb2a8-219">La <xref:System.Windows.Controls.MenuItem.IsSubmenuOpen%2A> lógica de propiedad usa el enlace de datos de forma nativa para mantener el estado de la propiedad de acuerdo con otras propiedades de estado y llamadas a métodos.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-219">The <xref:System.Windows.Controls.MenuItem.IsSubmenuOpen%2A> property logic uses data binding natively to maintain the state of the property in accordance to other state properties and method calls.</span></span> <span data-ttu-id="bb2a8-220">Otra propiedad de ejemplo que <xref:System.Windows.Data.BindingMode.TwoWay> se enlaza de forma predeterminada es <xref:System.Windows.Controls.TextBox.Text%2A?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="bb2a8-220">Another example property that binds <xref:System.Windows.Data.BindingMode.TwoWay> by default is <xref:System.Windows.Controls.TextBox.Text%2A?displayProperty=nameWithType>.</span></span>

- <span data-ttu-id="bb2a8-221">También puede habilitar la herencia de propiedades en una propiedad de dependencia personalizada estableciendo la <xref:System.Windows.FrameworkPropertyMetadataOptions.Inherits> marca.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-221">You can also enable property inheritance in a custom dependency property by setting the <xref:System.Windows.FrameworkPropertyMetadataOptions.Inherits> flag.</span></span> <span data-ttu-id="bb2a8-222">La herencia de propiedades resulta útil para un escenario en que los elementos primarios y secundarios tienen una propiedad en común, y tiene sentido para los elementos secundarios que tienen ese valor de propiedad concreto establecido en el mismo valor que el elemento primario.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-222">Property inheritance is useful for a scenario where parent elements and child elements have a property in common, and it makes sense for the child elements to have that particular property value set to the same value as the parent set it.</span></span> <span data-ttu-id="bb2a8-223">Una propiedad heredable de ejemplo es <xref:System.Windows.FrameworkElement.DataContext%2A> , que se usa para las operaciones de enlace para habilitar el escenario importante de detalles maestros para la presentación de datos.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-223">An example inheritable property is <xref:System.Windows.FrameworkElement.DataContext%2A>, which is used for binding operations to enable the important master-detail scenario for data presentation.</span></span> <span data-ttu-id="bb2a8-224">Al hacer <xref:System.Windows.FrameworkElement.DataContext%2A> que se puedan heredar, todos los elementos secundarios heredan también ese contexto de datos.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-224">By making <xref:System.Windows.FrameworkElement.DataContext%2A> inheritable, any child elements inherit that data context also.</span></span> <span data-ttu-id="bb2a8-225">Debido a la herencia de valores de propiedad, puede especificar un contexto de datos en la raíz de la aplicación o la página y no es necesario volver a especificarlo para los enlaces de todos los elementos secundarios posibles.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-225">Because of property value inheritance, you can specify a data context at the page or application root, and do not need to respecify it for bindings in all possible child elements.</span></span> <span data-ttu-id="bb2a8-226"><xref:System.Windows.FrameworkElement.DataContext%2A>también es un buen ejemplo para ilustrar que la herencia invalida el valor predeterminado, pero siempre se puede establecer localmente en cualquier elemento secundario concreto; para obtener más información, consulte [usar el patrón principal-detalle con datos jerárquicos](../data/how-to-use-the-master-detail-pattern-with-hierarchical-data.md).</span><span class="sxs-lookup"><span data-stu-id="bb2a8-226"><xref:System.Windows.FrameworkElement.DataContext%2A> is also a good example to illustrate that inheritance overrides the default value, but it can always be set locally on any particular child element; for details, see [Use the Master-Detail Pattern with Hierarchical Data](../data/how-to-use-the-master-detail-pattern-with-hierarchical-data.md).</span></span> <span data-ttu-id="bb2a8-227">La herencia de valores de propiedad puede presentar un costo de rendimiento y, por tanto, debe usarse con moderación. Para obtener más información, consulte [Herencia de valores de propiedad](property-value-inheritance.md).</span><span class="sxs-lookup"><span data-stu-id="bb2a8-227">Property value inheritance does have a possible performance cost, and thus should be used sparingly; for details, see [Property Value Inheritance](property-value-inheritance.md).</span></span>

- <span data-ttu-id="bb2a8-228">Establezca la <xref:System.Windows.FrameworkPropertyMetadataOptions.Journal> marca para indicar si la propiedad de dependencia debe ser detectada o utilizada por los servicios de registro en diario de navegación.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-228">Set the <xref:System.Windows.FrameworkPropertyMetadataOptions.Journal> flag to indicate if your dependency property should be detected or used by navigation journaling services.</span></span> <span data-ttu-id="bb2a8-229">Un ejemplo es la <xref:System.Windows.Controls.Primitives.Selector.SelectedIndex%2A> propiedad; cualquier elemento seleccionado en un control de selección debe conservarse cuando se navega por el historial de registro en diario.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-229">An example is the <xref:System.Windows.Controls.Primitives.Selector.SelectedIndex%2A> property; any item selected in a selection control should be persisted when the journaling history is navigated.</span></span>

<a name="RODP"></a>

## <a name="read-only-dependency-properties"></a><span data-ttu-id="bb2a8-230">Propiedades de dependencia de sólo lectura</span><span class="sxs-lookup"><span data-stu-id="bb2a8-230">Read-Only Dependency Properties</span></span>

<span data-ttu-id="bb2a8-231">Es posible definir una propiedad de dependencia que sea de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-231">You can define a dependency property that is read-only.</span></span> <span data-ttu-id="bb2a8-232">Sin embargo, los escenarios para los que podría definir la propiedad como de solo lectura son algo diferentes, del mismo modo que lo es el procedimiento para registrarlos con el sistema de propiedades y exponer el identificador.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-232">However, the scenarios for why you might define your property as read-only are somewhat different, as is the procedure for registering them with the property system and exposing the identifier.</span></span> <span data-ttu-id="bb2a8-233">Para obtener más información, consulte [Propiedades de dependencia de solo lectura](read-only-dependency-properties.md).</span><span class="sxs-lookup"><span data-stu-id="bb2a8-233">For more information, see [Read-Only Dependency Properties](read-only-dependency-properties.md).</span></span>

<a name="CTDP"></a>

## <a name="collection-type-dependency-properties"></a><span data-ttu-id="bb2a8-234">Propiedades de dependencia de tipo de colección</span><span class="sxs-lookup"><span data-stu-id="bb2a8-234">Collection-Type Dependency Properties</span></span>

<span data-ttu-id="bb2a8-235">Las propiedades de dependencia de tipo de colección presentan algunos problemas de implementación adicionales que se deben tener en cuenta.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-235">Collection-type dependency properties have some additional implementation issues to consider.</span></span> <span data-ttu-id="bb2a8-236">Para obtener más información, consulte [Propiedades de dependencia de tipo de colección](collection-type-dependency-properties.md).</span><span class="sxs-lookup"><span data-stu-id="bb2a8-236">For details, see [Collection-Type Dependency Properties](collection-type-dependency-properties.md).</span></span>

<a name="SecurityC"></a>

## <a name="dependency-property-security-considerations"></a><span data-ttu-id="bb2a8-237">Consideraciones de seguridad de las propiedades de dependencia</span><span class="sxs-lookup"><span data-stu-id="bb2a8-237">Dependency Property Security Considerations</span></span>

<span data-ttu-id="bb2a8-238">Las propiedades de dependencia deben declararse como propiedades públicas.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-238">Dependency properties should be declared as public properties.</span></span> <span data-ttu-id="bb2a8-239">Los campos de identificador de las propiedades de dependencia deben declararse como campos estáticos públicos.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-239">Dependency property identifier fields should be declared as public static fields.</span></span> <span data-ttu-id="bb2a8-240">Aunque intente declarar otros niveles de acceso (como Protected), siempre se puede tener acceso a una propiedad de dependencia a través del identificador en combinación con las API del sistema de propiedades.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-240">Even if you attempt to declare other access levels (such as protected), a dependency property can always be accessed through the identifier in combination with the property system APIs.</span></span> <span data-ttu-id="bb2a8-241">Incluso se puede obtener acceso a un campo de identificador protegido debido a las API de informes de metadatos o de determinación de valores que forman parte del sistema de propiedades, como <xref:System.Windows.LocalValueEnumerator> .</span><span class="sxs-lookup"><span data-stu-id="bb2a8-241">Even a protected identifier field is potentially accessible because of metadata reporting or value determination APIs that are part of the property system, such as <xref:System.Windows.LocalValueEnumerator>.</span></span> <span data-ttu-id="bb2a8-242">Para obtener más información, consulte [Seguridad de las propiedades de dependencia](dependency-property-security.md).</span><span class="sxs-lookup"><span data-stu-id="bb2a8-242">For more information, see [Dependency Property Security](dependency-property-security.md).</span></span>

<a name="DPCtor"></a>

## <a name="dependency-properties-and-class-constructors"></a><span data-ttu-id="bb2a8-243">Propiedades de dependencia y constructores de clase</span><span class="sxs-lookup"><span data-stu-id="bb2a8-243">Dependency Properties and Class Constructors</span></span>

<span data-ttu-id="bb2a8-244">Existe un principio general en la programación de código administrado (que suelen aplicar las herramientas de análisis de código, como FxCop), según el cual los constructores de clase no deben llamar a métodos virtuales.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-244">There is a general principle in managed code programming (often enforced by code analysis tools such as FxCop) that class constructors should not call virtual methods.</span></span> <span data-ttu-id="bb2a8-245">Esto es debe a que los constructores se pueden llamar como inicialización base de un constructor de clase derivada y la especificación del método virtual a través del constructor puede producirse en un estado de inicialización incompleto de la instancia del objeto que se está construyendo.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-245">This is because constructors can be called as base initialization of a derived class constructor, and entering the virtual method through the constructor might occur at an incomplete initialization state of the object instance being constructed.</span></span> <span data-ttu-id="bb2a8-246">Cuando derive de cualquier clase que ya derive de <xref:System.Windows.DependencyObject> , debe tener en cuenta que el propio sistema de propiedades llama y expone internamente los métodos virtuales.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-246">When you derive from any class that already derives from <xref:System.Windows.DependencyObject>, you should be aware that the property system itself calls and exposes virtual methods internally.</span></span> <span data-ttu-id="bb2a8-247">Estos métodos virtuales forman parte de los servicios del sistema de propiedades [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="bb2a8-247">These virtual methods are part of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] property system services.</span></span> <span data-ttu-id="bb2a8-248">La invalidación de los métodos permite que las clases derivadas participen en la determinación del valor.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-248">Overriding the methods enables derived classes to participate in value determination.</span></span> <span data-ttu-id="bb2a8-249">Para evitar posibles problemas con la inicialización en tiempo de ejecución, no debe establecer valores de propiedades de dependencia dentro de los constructores de clase, a menos que siga un patrón de constructor muy específico.</span><span class="sxs-lookup"><span data-stu-id="bb2a8-249">To avoid potential issues with runtime initialization, you should not set dependency property values within constructors of classes, unless you follow a very specific constructor pattern.</span></span> <span data-ttu-id="bb2a8-250">Para obtener más información, consulte [Modelos de constructores seguros para objetos DependencyObject](safe-constructor-patterns-for-dependencyobjects.md).</span><span class="sxs-lookup"><span data-stu-id="bb2a8-250">For details, see [Safe Constructor Patterns for DependencyObjects](safe-constructor-patterns-for-dependencyobjects.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="bb2a8-251">Vea también</span><span class="sxs-lookup"><span data-stu-id="bb2a8-251">See also</span></span>

- [<span data-ttu-id="bb2a8-252">Información general sobre las propiedades de dependencia</span><span class="sxs-lookup"><span data-stu-id="bb2a8-252">Dependency Properties Overview</span></span>](dependency-properties-overview.md)
- [<span data-ttu-id="bb2a8-253">Metadatos de las propiedades de dependencia</span><span class="sxs-lookup"><span data-stu-id="bb2a8-253">Dependency Property Metadata</span></span>](dependency-property-metadata.md)
- [<span data-ttu-id="bb2a8-254">Información general sobre la creación de controles</span><span class="sxs-lookup"><span data-stu-id="bb2a8-254">Control Authoring Overview</span></span>](../controls/control-authoring-overview.md)
- [<span data-ttu-id="bb2a8-255">Propiedades de dependencia de tipo de colección</span><span class="sxs-lookup"><span data-stu-id="bb2a8-255">Collection-Type Dependency Properties</span></span>](collection-type-dependency-properties.md)
- [<span data-ttu-id="bb2a8-256">Seguridad de las propiedades de dependencia</span><span class="sxs-lookup"><span data-stu-id="bb2a8-256">Dependency Property Security</span></span>](dependency-property-security.md)
- [<span data-ttu-id="bb2a8-257">Carga de XAML y propiedades de dependencia</span><span class="sxs-lookup"><span data-stu-id="bb2a8-257">XAML Loading and Dependency Properties</span></span>](xaml-loading-and-dependency-properties.md)
- [<span data-ttu-id="bb2a8-258">Modelos de constructores seguros para objetos DependencyObject</span><span class="sxs-lookup"><span data-stu-id="bb2a8-258">Safe Constructor Patterns for DependencyObjects</span></span>](safe-constructor-patterns-for-dependencyobjects.md)
