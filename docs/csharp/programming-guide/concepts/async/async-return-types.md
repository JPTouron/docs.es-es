---
title: Tipos de valor devueltos asincrónicos (C#)
description: Obtenga información sobre los tipos de valor devueltos que los métodos asincrónicos pueden tener en C# con ejemplos de código para cada tipo y recursos adicionales.
ms.date: 08/19/2020
ms.assetid: ddb2539c-c898-48c1-ad92-245e4a996df8
ms.openlocfilehash: 71e560ed8ee0cae14da396e5ea2f3ab29611ebab
ms.sourcegitcommit: 9c45035b781caebc63ec8ecf912dc83fb6723b1f
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 08/25/2020
ms.locfileid: "88811501"
---
# <a name="async-return-types-c"></a><span data-ttu-id="2d6bf-103">Tipos de valor devueltos asincrónicos (C#)</span><span class="sxs-lookup"><span data-stu-id="2d6bf-103">Async return types (C#)</span></span>

<span data-ttu-id="2d6bf-104">Los métodos asincrónicos pueden tener los siguientes tipos de valor devuelto:</span><span class="sxs-lookup"><span data-stu-id="2d6bf-104">Async methods can have the following return types:</span></span>

- <span data-ttu-id="2d6bf-105"><xref:System.Threading.Tasks.Task>, para un método asincrónico que realiza una operación pero no devuelve ningún valor.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-105"><xref:System.Threading.Tasks.Task>, for an async method that performs an operation but returns no value.</span></span>
- <span data-ttu-id="2d6bf-106"><xref:System.Threading.Tasks.Task%601>, para un método asincrónico que devuelve un valor.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-106"><xref:System.Threading.Tasks.Task%601>, for an async method that returns a value.</span></span>
- <span data-ttu-id="2d6bf-107">`void`, para un controlador de eventos.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-107">`void`, for an event handler.</span></span>
- <span data-ttu-id="2d6bf-108">A partir de C# 7.0, cualquier tipo que tenga un método `GetAwaiter` accesible.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-108">Starting with C# 7.0, any type that has an accessible `GetAwaiter` method.</span></span> <span data-ttu-id="2d6bf-109">El objeto devuelto por el método `GetAwaiter` debe implementar la interfaz <xref:System.Runtime.CompilerServices.ICriticalNotifyCompletion?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-109">The object returned by the `GetAwaiter` method must implement the <xref:System.Runtime.CompilerServices.ICriticalNotifyCompletion?displayProperty=nameWithType> interface.</span></span>
- <span data-ttu-id="2d6bf-110">A partir C# 8.0, <xref:System.Collections.Generic.IAsyncEnumerable%601>, para un método asincrónico que devuelve una *secuencia asincrónica*.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-110">Starting with C# 8.0, <xref:System.Collections.Generic.IAsyncEnumerable%601>, for an async method that returns an *async stream*.</span></span>

<span data-ttu-id="2d6bf-111">Para obtener más información sobre los métodos asincrónicos, vea [Programación asincrónica con async y await (C#)](./index.md).</span><span class="sxs-lookup"><span data-stu-id="2d6bf-111">For more information about async methods, see [Asynchronous programming with async and await (C#)](./index.md).</span></span>

<span data-ttu-id="2d6bf-112">También existen varios tipos que son específicos de las cargas de trabajo de Windows:</span><span class="sxs-lookup"><span data-stu-id="2d6bf-112">Several other types also exist that are specific to Windows workloads:</span></span>

- <span data-ttu-id="2d6bf-113"><xref:System.Windows.Threading.DispatcherOperation>: para las operaciones asincrónicas limitadas a Windows.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-113"><xref:System.Windows.Threading.DispatcherOperation>, for async operations limited to Windows.</span></span>
- <span data-ttu-id="2d6bf-114"><xref:Windows.Foundation.IAsyncAction>: para las acciones asincrónicas en UWP que no devuelven un valor.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-114"><xref:Windows.Foundation.IAsyncAction>, for async actions in UWP that do not return a value.</span></span>
- <span data-ttu-id="2d6bf-115"><xref:Windows.Foundation.IAsyncActionWithProgress%601>: para las acciones asincrónicas en UWP que informan del progreso, pero no devuelven un valor.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-115"><xref:Windows.Foundation.IAsyncActionWithProgress%601>, for async actions in UWP that report progress but do not return a value.</span></span>
- <span data-ttu-id="2d6bf-116"><xref:Windows.Foundation.IAsyncOperation%601>: para las operaciones asincrónicas en UWP que devuelven un valor.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-116"><xref:Windows.Foundation.IAsyncOperation%601>, for async operations in UWP that return a value.</span></span>
- <span data-ttu-id="2d6bf-117"><xref:Windows.Foundation.IAsyncOperationWithProgress%602>: para las operaciones asincrónicas en UWP que informan del progreso y devuelven un valor.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-117"><xref:Windows.Foundation.IAsyncOperationWithProgress%602>, for async operations in UWP that report progress and return a value.</span></span>

## <a name="task-return-type"></a><span data-ttu-id="2d6bf-118">Tipo de valor devuelto Task</span><span class="sxs-lookup"><span data-stu-id="2d6bf-118">Task return type</span></span>

<span data-ttu-id="2d6bf-119">Los métodos asincrónicos que no contienen una instrucción `return` o que contienen una instrucción `return` que no devuelve un operando tienen normalmente un tipo de valor devuelto de <xref:System.Threading.Tasks.Task>.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-119">Async methods that don't contain a `return` statement or that contain a `return` statement that doesn't return an operand usually have a return type of <xref:System.Threading.Tasks.Task>.</span></span> <span data-ttu-id="2d6bf-120">Dichos métodos devuelven `void` si se ejecutan de manera sincrónica.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-120">Such methods return `void` if they run synchronously.</span></span> <span data-ttu-id="2d6bf-121">Si se usa un tipo de valor devuelto <xref:System.Threading.Tasks.Task> para un método asincrónico, un método de llamada puede usar un operador `await` para suspender la finalización del llamador hasta que finalice el método asincrónico llamado.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-121">If you use a <xref:System.Threading.Tasks.Task> return type for an async method, a calling method can use an `await` operator to suspend the caller's completion until the called async method has finished.</span></span>

<span data-ttu-id="2d6bf-122">En el ejemplo siguiente, el método `WaitAndApologizeAsync` no contiene una instrucción `return`, de manera que el método devuelve un objeto <xref:System.Threading.Tasks.Task>.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-122">In the following example, the `WaitAndApologizeAsync` method doesn't contain a `return` statement, so the method returns a <xref:System.Threading.Tasks.Task> object.</span></span> <span data-ttu-id="2d6bf-123">La devolución de `Task` permite que se espere a `WaitAndApologizeAsync`.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-123">Returning a `Task` enables `WaitAndApologizeAsync` to be awaited.</span></span> <span data-ttu-id="2d6bf-124">El tipo <xref:System.Threading.Tasks.Task> no incluye una propiedad `Result` porque no tiene ningún valor devuelto.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-124">The <xref:System.Threading.Tasks.Task> type doesn't include a `Result` property because it has no return value.</span></span>

:::code language="csharp" source="snippets/async-return-types/async-returns2.cs" id="TaskReturn":::

<span data-ttu-id="2d6bf-125">Se espera a `WaitAndApologizeAsync` mediante una instrucción await en lugar de una expresión await, similar a la instrucción de llamada para un método sincrónico que devuelve void.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-125">`WaitAndApologizeAsync` is awaited by using an await statement instead of an await expression, similar to the calling statement for a synchronous void-returning method.</span></span> <span data-ttu-id="2d6bf-126">En este caso, la aplicación de un operador await no genera un valor.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-126">The application of an await operator in this case doesn't produce a value.</span></span> <span data-ttu-id="2d6bf-127">Para aclarar la instrucción y la expresión de los términos, consulte la tabla siguiente:</span><span class="sxs-lookup"><span data-stu-id="2d6bf-127">To clarify the terms statement and expression, refer to the table below:</span></span>

| <span data-ttu-id="2d6bf-128">Tipo de operador await</span><span class="sxs-lookup"><span data-stu-id="2d6bf-128">Await kind</span></span> | <span data-ttu-id="2d6bf-129">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="2d6bf-129">Example</span></span>                                      | <span data-ttu-id="2d6bf-130">Tipo</span><span class="sxs-lookup"><span data-stu-id="2d6bf-130">Type</span></span>                                   |
|------------|----------------------------------------------|----------------------------------------|
| <span data-ttu-id="2d6bf-131">.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-131">Statement</span></span>  | `await SomeTaskMethodAsync()`                | <xref:System.Threading.Tasks.Task>     |
| <span data-ttu-id="2d6bf-132">Expression</span><span class="sxs-lookup"><span data-stu-id="2d6bf-132">Expression</span></span> | `T result = await SomeTaskMethodAsync<T>();` | <xref:System.Threading.Tasks.Task%601> |

<span data-ttu-id="2d6bf-133">Puede separar la llamada a `WaitAndApologizeAsync` desde la aplicación de un operador await, como muestra el código siguiente.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-133">You can separate the call to `WaitAndApologizeAsync` from the application of an await operator, as the following code shows.</span></span> <span data-ttu-id="2d6bf-134">Pero recuerde que una `Task` no tiene una propiedad `Result` y que no se genera ningún valor cuando se aplica un operador await a una `Task`.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-134">However, remember that a `Task` doesn't have a `Result` property, and that no value is produced when an await operator is applied to a `Task`.</span></span>

<span data-ttu-id="2d6bf-135">El código siguiente separa la llamada del método `WaitAndApologizeAsync` de la espera de la tarea que el método devuelve.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-135">The following code separates calling the `WaitAndApologizeAsync` method from awaiting the task that the method returns.</span></span>

:::code language="csharp" source="snippets/async-return-types/async-returns2a.cs" id="AwaitTask":::

## <a name="tasktresult-return-type"></a><span data-ttu-id="2d6bf-136">Tipo de valor devuelto Task\<TResult\></span><span class="sxs-lookup"><span data-stu-id="2d6bf-136">Task\<TResult\> return type</span></span>

<span data-ttu-id="2d6bf-137">El tipo de valor devuelto <xref:System.Threading.Tasks.Task%601> se usa para un método asincrónico que contiene una instrucción [return](../../../language-reference/keywords/return.md) en la que el operando es `TResult`.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-137">The <xref:System.Threading.Tasks.Task%601> return type is used for an async method that contains a [return](../../../language-reference/keywords/return.md) statement in which the operand is `TResult`.</span></span>

<span data-ttu-id="2d6bf-138">En el ejemplo siguiente, el método `GetLeisureHoursAsync` contiene una instrucción `return` que devuelve un entero.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-138">In the following example, the `GetLeisureHoursAsync` method contains a `return` statement that returns an integer.</span></span> <span data-ttu-id="2d6bf-139">Por tanto, la declaración del método debe tener un tipo de valor devuelto de `Task<int>`.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-139">Therefore, the method declaration must specify a return type of `Task<int>`.</span></span> <span data-ttu-id="2d6bf-140">El método asincrónico <xref:System.Threading.Tasks.Task.FromResult%2A> es un marcador de posición para una operación que devuelve una propiedad <xref:System.DateTime.DayOfWeek>.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-140">The <xref:System.Threading.Tasks.Task.FromResult%2A> async method is a placeholder for an operation that returns a <xref:System.DateTime.DayOfWeek>.</span></span>

:::code language="csharp" source="snippets/async-return-types/async-returns1.cs" id="LeisureHours":::

<span data-ttu-id="2d6bf-141">Cuando se llama a `GetLeisureHoursAsync` desde una expresión await en el método `ShowTodaysInfo`, esta recupera el valor entero (el valor de `leisureHours`) que está almacenado en la tarea que devuelve el método `GetLeisureHours`.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-141">When `GetLeisureHoursAsync` is called from within an await expression in the `ShowTodaysInfo` method, the await expression retrieves the integer value (the value of `leisureHours`) that's stored in the task returned by the `GetLeisureHours` method.</span></span> <span data-ttu-id="2d6bf-142">Para más información sobre las expresiones await, vea [await](../../../language-reference/operators/await.md).</span><span class="sxs-lookup"><span data-stu-id="2d6bf-142">For more information about await expressions, see [await](../../../language-reference/operators/await.md).</span></span>

<span data-ttu-id="2d6bf-143">Puede comprender mejor cómo `await` recupera el resultado de `Task<T>` si separa la llamada a `GetLeisureHoursAsync` de la aplicación de `await`, como se muestra en el código siguiente.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-143">You can better understand how `await` retrieves the result from a `Task<T>` by separating the call to `GetLeisureHoursAsync` from the application of `await`, as the following code shows.</span></span> <span data-ttu-id="2d6bf-144">Una llamada al método `GetLeisureHoursAsync` que no se espera inmediatamente devuelve `Task<int>`, como se podría esperar de la declaración del método.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-144">A call to method `GetLeisureHoursAsync` that isn't immediately awaited returns a `Task<int>`, as you would expect from the declaration of the method.</span></span> <span data-ttu-id="2d6bf-145">La tarea se asigna a la variable `getLeisureHoursTask` en el ejemplo.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-145">The task is assigned to the `getLeisureHoursTask` variable in the example.</span></span> <span data-ttu-id="2d6bf-146">Dado que `getLeisureHoursTask` es <xref:System.Threading.Tasks.Task%601>, contiene una propiedad <xref:System.Threading.Tasks.Task%601.Result> de tipo `TResult`.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-146">Because `getLeisureHoursTask` is a <xref:System.Threading.Tasks.Task%601>, it contains a <xref:System.Threading.Tasks.Task%601.Result> property of type `TResult`.</span></span> <span data-ttu-id="2d6bf-147">En este caso, `TResult` representa un tipo entero.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-147">In this case, `TResult` represents an integer type.</span></span> <span data-ttu-id="2d6bf-148">Cuando `await` se aplica a `getLeisureHoursTask`, la expresión await se evalúa en el contenido de la propiedad <xref:System.Threading.Tasks.Task%601.Result%2A> de `getLeisureHoursTask`.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-148">When `await` is applied to `getLeisureHoursTask`, the await expression evaluates to the contents of the <xref:System.Threading.Tasks.Task%601.Result%2A> property of `getLeisureHoursTask`.</span></span> <span data-ttu-id="2d6bf-149">El valor se asigna a la variable `ret`.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-149">The value is assigned to the `ret` variable.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="2d6bf-150">La propiedad <xref:System.Threading.Tasks.Task%601.Result%2A> es una propiedad de bloqueo.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-150">The <xref:System.Threading.Tasks.Task%601.Result%2A> property is a blocking property.</span></span> <span data-ttu-id="2d6bf-151">Si se intenta acceder a ella antes de que termine su tarea, se bloquea el subproceso que está activo actualmente hasta que finaliza la tarea y el valor está disponible.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-151">If you try to access it before its task is finished, the thread that's currently active is blocked until the task completes and the value is available.</span></span> <span data-ttu-id="2d6bf-152">En la mayoría de los casos, se debe tener acceso al valor usando `await` en lugar de tener acceso directamente a la propiedad.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-152">In most cases, you should access the value by using `await` instead of accessing the property directly.</span></span>
>
> <span data-ttu-id="2d6bf-153">En el ejemplo anterior se ha recuperado el valor de la propiedad <xref:System.Threading.Tasks.Task%601.Result%2A> para bloquear el subproceso principal de manera que el método `Main` pueda imprimir el mensaje (`message`) en la consola antes de que finalice la aplicación.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-153">The previous example retrieved the value of the <xref:System.Threading.Tasks.Task%601.Result%2A> property to block the main thread so that the `Main` method could print the `message` to the console before the application ended.</span></span>

:::code language="csharp" source="snippets/async-return-types/async-returns1a.cs" id="StoreTask":::

## <a name="void-return-type"></a><span data-ttu-id="2d6bf-154">Tipo de valor devuelto Void</span><span class="sxs-lookup"><span data-stu-id="2d6bf-154">Void return type</span></span>

<span data-ttu-id="2d6bf-155">Usa el tipo de valor devuelto `void` en controladores de eventos asincrónicos, que necesitan un tipo de valor devuelto `void`.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-155">You use the `void` return type in asynchronous event handlers, which require a `void` return type.</span></span> <span data-ttu-id="2d6bf-156">Para métodos que no sean controladores de eventos que no devuelven un valor, debe devolver <xref:System.Threading.Tasks.Task> en su lugar, porque no se espera a un método asincrónico que devuelva `void`.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-156">For methods other than event handlers that don't return a value, you should return a <xref:System.Threading.Tasks.Task> instead, because an async method that returns `void` can't be awaited.</span></span> <span data-ttu-id="2d6bf-157">Cualquiera que realice la llamada a este método debe continuar hasta completarse sin esperar a que finalice el método asincrónico que se haya llamado.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-157">Any caller of such a method must continue to completion without waiting for the called async method to finish.</span></span> <span data-ttu-id="2d6bf-158">El autor de la llamada debe ser independiente de los valores o las excepciones que genere el método asincrónico.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-158">The caller must be independent of any values or exceptions that the async method generates.</span></span>

<span data-ttu-id="2d6bf-159">El autor de la llamada de un método asincrónico que devuelve void no puede capturar las excepciones iniciadas desde el método y es probable que esas excepciones sin controlar provoquen un error de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-159">The caller of a void-returning async method can't catch exceptions thrown from the method, and such unhandled exceptions are likely to cause your application to fail.</span></span> <span data-ttu-id="2d6bf-160">Si un método que devuelve un valor <xref:System.Threading.Tasks.Task> o <xref:System.Threading.Tasks.Task%601> inicia una excepción, la excepción se almacena en la tarea devuelta.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-160">If a method that returns a <xref:System.Threading.Tasks.Task> or <xref:System.Threading.Tasks.Task%601> throws an exception, the exception is stored in the returned task.</span></span> <span data-ttu-id="2d6bf-161">La excepción se vuelve a iniciar cuando se espera a la tarea.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-161">The exception is rethrown when the task is awaited.</span></span> <span data-ttu-id="2d6bf-162">Por tanto, asegúrese de que cualquier método asincrónico que puede producir una excepción tiene un tipo de valor devuelto de <xref:System.Threading.Tasks.Task> o <xref:System.Threading.Tasks.Task%601> y que se esperan llamadas al método.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-162">Therefore, make sure that any async method that can produce an exception has a return type of <xref:System.Threading.Tasks.Task> or <xref:System.Threading.Tasks.Task%601> and that calls to the method are awaited.</span></span>

<span data-ttu-id="2d6bf-163">Para obtener más información sobre cómo capturar excepciones en métodos asincrónicos, vea la sección [Excepciones en métodos asincrónicos](../../../language-reference/keywords/try-catch.md#exceptions-in-async-methods) del artículo [try-catch](../../../language-reference/keywords/try-catch.md).</span><span class="sxs-lookup"><span data-stu-id="2d6bf-163">For more information about how to catch exceptions in async methods, see the [Exceptions in async methods](../../../language-reference/keywords/try-catch.md#exceptions-in-async-methods) section of the [try-catch](../../../language-reference/keywords/try-catch.md) article.</span></span>

<span data-ttu-id="2d6bf-164">En el ejemplo siguiente se muestra el comportamiento de un controlador de eventos asincrónicos.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-164">The following example shows the behavior of an async event handler.</span></span> <span data-ttu-id="2d6bf-165">En el código de ejemplo, un controlador de eventos asincrónicos debe informar al subproceso principal de que ha terminado.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-165">In the example code, an async event handler must let the main thread know when it finishes.</span></span> <span data-ttu-id="2d6bf-166">Después, el subproceso principal puede esperar a que un controlador de eventos asincrónicos finalice antes de salir del programa.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-166">Then the main thread can wait for an async event handler to complete before exiting the program.</span></span>

:::code language="csharp" source="snippets/async-return-types/async-returns3.cs":::

## <a name="generalized-async-return-types-and-valuetasktresult"></a><span data-ttu-id="2d6bf-167">Tipos de valor devueltos asincrónicos generalizados y ValueTask\<TResult\></span><span class="sxs-lookup"><span data-stu-id="2d6bf-167">Generalized async return types and ValueTask\<TResult\></span></span>

<span data-ttu-id="2d6bf-168">A partir de C# 7.0, un método asincrónico puede devolver cualquier tipo que tenga un método `GetAwaiter` accesible.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-168">Starting with C# 7.0, an async method can return any type that has an accessible `GetAwaiter` method.</span></span>

<span data-ttu-id="2d6bf-169">Como <xref:System.Threading.Tasks.Task> y <xref:System.Threading.Tasks.Task%601> son tipos de referencia, la asignación de memoria en las rutas críticas para el rendimiento, especialmente cuando las asignaciones se producen en ajustados bucles, puede afectar negativamente al rendimiento.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-169">Because <xref:System.Threading.Tasks.Task> and <xref:System.Threading.Tasks.Task%601> are reference types, memory allocation in performance-critical paths, particularly when allocations occur in tight loops, can adversely affect performance.</span></span> <span data-ttu-id="2d6bf-170">La compatibilidad para los tipos de valor devuelto generalizados significa que puede devolver un tipo de valor ligero en lugar de un tipo de referencia para evitar asignaciones de memoria adicionales.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-170">Support for generalized return types means that you can return a lightweight value type instead of a reference type to avoid additional memory allocations.</span></span>

<span data-ttu-id="2d6bf-171">.NET proporciona la estructura <xref:System.Threading.Tasks.ValueTask%601?displayProperty=nameWithType> como una implementación ligera de un valor de devolución de tareas generalizado.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-171">.NET provides the <xref:System.Threading.Tasks.ValueTask%601?displayProperty=nameWithType> structure as a lightweight implementation of a generalized task-returning value.</span></span> <span data-ttu-id="2d6bf-172">Para usar el tipo <xref:System.Threading.Tasks.ValueTask%601?displayProperty=nameWithType>, debe agregar el paquete NuGet de `System.Threading.Tasks.Extensions` a su proyecto.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-172">To use the <xref:System.Threading.Tasks.ValueTask%601?displayProperty=nameWithType> type, you must add the `System.Threading.Tasks.Extensions` NuGet package to your project.</span></span> <span data-ttu-id="2d6bf-173">En el ejemplo siguiente se usa la estructura <xref:System.Threading.Tasks.ValueTask%601> para recuperar el valor de dos tiradas de dado.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-173">The following example uses the <xref:System.Threading.Tasks.ValueTask%601> structure to retrieve the value of two dice rolls.</span></span>

:::code language="csharp" source="snippets/async-return-types/async-valuetask.cs":::

## <a name="async-streams-with-iasyncenumerablet"></a><span data-ttu-id="2d6bf-174">Secuencias asincrónicas con IAsyncEnumerable\<T\></span><span class="sxs-lookup"><span data-stu-id="2d6bf-174">Async streams with IAsyncEnumerable\<T\></span></span>

<span data-ttu-id="2d6bf-175">A partir de C# 8.0, un método asincrónico puede devolver una *secuencia asincrónica*, representada por <xref:System.Collections.Generic.IAsyncEnumerable%601>.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-175">Starting with C# 8.0, an async method may return an *async stream*, represented by <xref:System.Collections.Generic.IAsyncEnumerable%601>.</span></span> <span data-ttu-id="2d6bf-176">Una secuencia asincrónica proporciona una manera de enumerar los elementos leídos de una secuencia cuando se generan elementos en fragmentos con llamadas asincrónicas repetidas.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-176">An async stream provides a way to enumerate items read from a stream when elements are generated in chunks with repeated asynchronous calls.</span></span> <span data-ttu-id="2d6bf-177">En el ejemplo siguiente se muestra un método asincrónico que genera una secuencia asincrónica:</span><span class="sxs-lookup"><span data-stu-id="2d6bf-177">The following example shows an async method that generates an async stream:</span></span>

:::code language="csharp" source="snippets/async-return-types/AsyncStreams.cs" id="GenerateAsyncStream":::

<span data-ttu-id="2d6bf-178">En el ejemplo anterior, las líneas de una cadena se leen de forma asincrónica.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-178">The preceding example reads lines from a string asynchronously.</span></span> <span data-ttu-id="2d6bf-179">Una vez que se ha leído cada línea, el código enumera cada palabra de la cadena.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-179">Once each line is read, the code enumerates each word in the string.</span></span> <span data-ttu-id="2d6bf-180">Los autores de la llamada enumerarían cada palabra mediante la instrucción `await foreach`.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-180">Callers would enumerate each word using the `await foreach` statement.</span></span> <span data-ttu-id="2d6bf-181">El método espera cuando necesita leer de forma asincrónica la línea siguiente de la cadena de origen.</span><span class="sxs-lookup"><span data-stu-id="2d6bf-181">The method awaits when it needs to asynchronously read the next line from the source string.</span></span>

## <a name="see-also"></a><span data-ttu-id="2d6bf-182">Vea también</span><span class="sxs-lookup"><span data-stu-id="2d6bf-182">See also</span></span>

- <xref:System.Threading.Tasks.Task.FromResult%2A>
- [<span data-ttu-id="2d6bf-183">Procesamiento de tareas asincrónicas a medida que se completan</span><span class="sxs-lookup"><span data-stu-id="2d6bf-183">Process asynchronous tasks as they complete</span></span>](start-multiple-async-tasks-and-process-them-as-they-complete.md)
- [<span data-ttu-id="2d6bf-184">Programación asincrónica con async y await (C#)</span><span class="sxs-lookup"><span data-stu-id="2d6bf-184">Asynchronous programming with async and await (C#)</span></span>](index.md)
- [<span data-ttu-id="2d6bf-185">async</span><span class="sxs-lookup"><span data-stu-id="2d6bf-185">async</span></span>](../../../language-reference/keywords/async.md)
- [<span data-ttu-id="2d6bf-186">await</span><span class="sxs-lookup"><span data-stu-id="2d6bf-186">await</span></span>](../../../language-reference/operators/await.md)
