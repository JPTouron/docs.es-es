---
title: 'Uso de tipo dinámico: Guía de programación de C#'
ms.date: 07/20/2015
helpviewer_keywords:
- dynamic [C#], about dynamic type
- dynamic type [C#]
ms.assetid: 3828989d-c967-4a51-b948-857ebc8fdf26
ms.openlocfilehash: 24d48605e560038d70f1818611f339a94ecc2bba
ms.sourcegitcommit: a241301495a84cc8c64fe972330d16edd619868b
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 06/01/2020
ms.locfileid: "84241973"
---
# <a name="using-type-dynamic-c-programming-guide"></a><span data-ttu-id="788f2-102">Uso de tipo dinámico (Guía de programación de C#)</span><span class="sxs-lookup"><span data-stu-id="788f2-102">Using type dynamic (C# Programming Guide)</span></span>

<span data-ttu-id="788f2-103">C# 4 introduce un nuevo tipo, `dynamic`.</span><span class="sxs-lookup"><span data-stu-id="788f2-103">C# 4 introduces a new type, `dynamic`.</span></span> <span data-ttu-id="788f2-104">Se trata de un tipo estático, pero un objeto de tipo `dynamic` omite la comprobación de tipos estáticos.</span><span class="sxs-lookup"><span data-stu-id="788f2-104">The type is a static type, but an object of type `dynamic` bypasses static type checking.</span></span> <span data-ttu-id="788f2-105">En la mayoría de los casos, funciona como si tuviera el tipo `object`.</span><span class="sxs-lookup"><span data-stu-id="788f2-105">In most cases, it functions like it has type `object`.</span></span> <span data-ttu-id="788f2-106">En tiempo de compilación, se supone que un elemento con tipo `dynamic` admite cualquier operación.</span><span class="sxs-lookup"><span data-stu-id="788f2-106">At compile time, an element that is typed as `dynamic` is assumed to support any operation.</span></span> <span data-ttu-id="788f2-107">Por consiguiente, no tendrá que preocuparse de si el objeto obtiene su valor de una API de COM, de un lenguaje dinámico como IronPython, del Document Object Model (DOM) HTML, de la reflexión o de otro lugar en el programa.</span><span class="sxs-lookup"><span data-stu-id="788f2-107">Therefore, you do not have to be concerned about whether the object gets its value from a COM API, from a dynamic language such as IronPython, from the HTML Document Object Model (DOM), from reflection, or from somewhere else in the program.</span></span> <span data-ttu-id="788f2-108">Pero si el código no es válido, los errores se detectan en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="788f2-108">However, if the code is not valid, errors are caught at run time.</span></span>

<span data-ttu-id="788f2-109">Por ejemplo, si la instancia de método `exampleMethod1` del código siguiente solo tiene un parámetro, el compilador reconoce que la primera llamada al método, `ec.exampleMethod1(10, 4)`, no es válida porque contiene dos argumentos.</span><span class="sxs-lookup"><span data-stu-id="788f2-109">For example, if instance method `exampleMethod1` in the following code has only one parameter, the compiler recognizes that the first call to the method, `ec.exampleMethod1(10, 4)`, is not valid because it contains two arguments.</span></span> <span data-ttu-id="788f2-110">La llamada genera un error del compilador.</span><span class="sxs-lookup"><span data-stu-id="788f2-110">The call causes a compiler error.</span></span> <span data-ttu-id="788f2-111">El compilador no comprueba la segunda llamada al método, `dynamic_ec.exampleMethod1(10, 4)`, porque el tipo de `dynamic_ec` es `dynamic`.</span><span class="sxs-lookup"><span data-stu-id="788f2-111">The second call to the method, `dynamic_ec.exampleMethod1(10, 4)`, is not checked by the compiler because the type of `dynamic_ec` is `dynamic`.</span></span> <span data-ttu-id="788f2-112">Por consiguiente, no se notifica ningún error del compilador.</span><span class="sxs-lookup"><span data-stu-id="788f2-112">Therefore, no compiler error is reported.</span></span> <span data-ttu-id="788f2-113">Pero el error no pasa inadvertido indefinidamente.</span><span class="sxs-lookup"><span data-stu-id="788f2-113">However, the error does not escape notice indefinitely.</span></span> <span data-ttu-id="788f2-114">Se detecta en tiempo de ejecución y genera una excepción en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="788f2-114">It is caught at run time and causes a run-time exception.</span></span>

[!code-csharp[CsProgGuideTypes#50](~/samples/snippets/csharp/VS_Snippets_VBCSharp/CsProgGuideTypes/CS/usingdynamic.cs#50)]

[!code-csharp[CsProgGuideTypes#56](~/samples/snippets/csharp/VS_Snippets_VBCSharp/CsProgGuideTypes/CS/usingdynamic.cs#56)]

<span data-ttu-id="788f2-115">El rol del compilador en estos ejemplos consiste en empaquetar información sobre lo que cada instrucción se propone para el objeto o la expresión con el tipo `dynamic`.</span><span class="sxs-lookup"><span data-stu-id="788f2-115">The role of the compiler in these examples is to package together information about what each statement is proposing to do to the object or expression that is typed as `dynamic`.</span></span> <span data-ttu-id="788f2-116">En tiempo de ejecución, la información almacenada se examina y cualquier instrucción que no sea válida genera una excepción en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="788f2-116">At run time, the stored information is examined, and any statement that is not valid causes a run-time exception.</span></span>

<span data-ttu-id="788f2-117">El resultado de la mayoría de las operaciones dinámicas es `dynamic`.</span><span class="sxs-lookup"><span data-stu-id="788f2-117">The result of most dynamic operations is itself `dynamic`.</span></span> <span data-ttu-id="788f2-118">Por ejemplo, si se sitúa el puntero del mouse sobre el uso de `testSum` en el ejemplo siguiente, IntelliSense muestra el tipo **(local variable) dynamic testSum**.</span><span class="sxs-lookup"><span data-stu-id="788f2-118">For example, if you rest the mouse pointer over the use of `testSum` in the following example, IntelliSense displays the type **(local variable) dynamic testSum**.</span></span>

[!code-csharp[CsProgGuideTypes#51](~/samples/snippets/csharp/VS_Snippets_VBCSharp/CsProgGuideTypes/CS/usingdynamic.cs#51)]

<span data-ttu-id="788f2-119">Las operaciones en las que el resultado no es `dynamic` incluyen:</span><span class="sxs-lookup"><span data-stu-id="788f2-119">Operations in which the result is not `dynamic` include:</span></span>

* <span data-ttu-id="788f2-120">Conversiones de `dynamic` a otro tipo.</span><span class="sxs-lookup"><span data-stu-id="788f2-120">Conversions from `dynamic` to another type.</span></span>
* <span data-ttu-id="788f2-121">Llamadas de constructor que incluyen argumentos de tipo `dynamic`.</span><span class="sxs-lookup"><span data-stu-id="788f2-121">Constructor calls that include arguments of type `dynamic`.</span></span>

<span data-ttu-id="788f2-122">Por ejemplo, el tipo de `testInstance` en la declaración siguiente es `ExampleClass`, no `dynamic`:</span><span class="sxs-lookup"><span data-stu-id="788f2-122">For example, the type of `testInstance` in the following declaration is `ExampleClass`, not `dynamic`:</span></span>

[!code-csharp[CsProgGuideTypes#52](~/samples/snippets/csharp/VS_Snippets_VBCSharp/CsProgGuideTypes/CS/usingdynamic.cs#52)]

<span data-ttu-id="788f2-123">En la siguiente sección, "Conversiones", se muestran ejemplos de conversión.</span><span class="sxs-lookup"><span data-stu-id="788f2-123">Conversion examples are shown in the following section, "Conversions."</span></span>

## <a name="conversions"></a><span data-ttu-id="788f2-124">Conversiones</span><span class="sxs-lookup"><span data-stu-id="788f2-124">Conversions</span></span>

<span data-ttu-id="788f2-125">Las conversiones entre objetos dinámicos y de otro tipo son fáciles.</span><span class="sxs-lookup"><span data-stu-id="788f2-125">Conversions between dynamic objects and other types are easy.</span></span> <span data-ttu-id="788f2-126">Esto permite al desarrollador cambiar entre el comportamiento dinámico y no dinámico.</span><span class="sxs-lookup"><span data-stu-id="788f2-126">This enables the developer to switch between dynamic and non-dynamic behavior.</span></span>

<span data-ttu-id="788f2-127">Cualquier objeto se puede convertir implícitamente al tipo dinámico, tal y como se muestra en los ejemplos siguientes.</span><span class="sxs-lookup"><span data-stu-id="788f2-127">Any object can be converted to dynamic type implicitly, as shown in the following examples.</span></span>

[!code-csharp[CsProgGuideTypes#53](~/samples/snippets/csharp/VS_Snippets_VBCSharp/CsProgGuideTypes/CS/usingdynamic.cs#53)]

<span data-ttu-id="788f2-128">En cambio, una conversión implícita se puede aplicar dinámicamente a cualquier expresión de tipo `dynamic`.</span><span class="sxs-lookup"><span data-stu-id="788f2-128">Conversely, an implicit conversion can be dynamically applied to any expression of type `dynamic`.</span></span>

[!code-csharp[CsProgGuideTypes#54](~/samples/snippets/csharp/VS_Snippets_VBCSharp/CsProgGuideTypes/CS/usingdynamic.cs#54)]

## <a name="overload-resolution-with-arguments-of-type-dynamic"></a><span data-ttu-id="788f2-129">Resolución de sobrecarga con argumentos de tipo dinámico</span><span class="sxs-lookup"><span data-stu-id="788f2-129">Overload resolution with arguments of type dynamic</span></span>

<span data-ttu-id="788f2-130">La resolución de sobrecarga se produce en tiempo de ejecución y no en tiempo de compilación si uno o varios argumentos de una llamada de método tienen el tipo `dynamic` o si el receptor de la llamada de método es de tipo `dynamic`.</span><span class="sxs-lookup"><span data-stu-id="788f2-130">Overload resolution occurs at run time instead of at compile time if one or more of the arguments in a method call have the type `dynamic`, or if the receiver of the method call is of type `dynamic`.</span></span> <span data-ttu-id="788f2-131">En el ejemplo siguiente, si el único método `exampleMethod2` accesible se define para que tome un argumento de cadena, al enviar `d1` como argumento no se produce un error del compilador, pero sí se genera una excepción en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="788f2-131">In the following example, if the only accessible `exampleMethod2` method is defined to take a string argument, sending `d1` as the argument does not cause a compiler error, but it does cause a run-time exception.</span></span> <span data-ttu-id="788f2-132">La resolución de sobrecarga no se produce en tiempo de ejecución porque el tipo en tiempo de ejecución de `d1` es `int`, y `exampleMethod2` requiere una cadena.</span><span class="sxs-lookup"><span data-stu-id="788f2-132">Overload resolution fails at run time because the run-time type of `d1` is `int`, and `exampleMethod2` requires a string.</span></span>

[!code-csharp[CsProgGuideTypes#55](~/samples/snippets/csharp/VS_Snippets_VBCSharp/CsProgGuideTypes/CS/usingdynamic.cs#55)]

## <a name="dynamic-language-runtime"></a><span data-ttu-id="788f2-133">Dynamic Language Runtime</span><span class="sxs-lookup"><span data-stu-id="788f2-133">Dynamic language runtime</span></span>

<span data-ttu-id="788f2-134">Dynamic Language Runtime (DLR) es una API introducida en .NET Framework 4.</span><span class="sxs-lookup"><span data-stu-id="788f2-134">The dynamic language runtime (DLR) is an API that was introduced in .NET Framework 4.</span></span> <span data-ttu-id="788f2-135">Proporciona la infraestructura que admite el tipo `dynamic` en C# y también la implementación de lenguajes de programación dinámicos como IronPython e IronRuby.</span><span class="sxs-lookup"><span data-stu-id="788f2-135">It provides the infrastructure that supports the `dynamic` type in C#, and also the implementation of dynamic programming languages such as IronPython and IronRuby.</span></span> <span data-ttu-id="788f2-136">Para obtener más información sobre el entorno DLR, vea [Información general acerca de Dynamic Language Runtime](../../../framework/reflection-and-codedom/dynamic-language-runtime-overview.md).</span><span class="sxs-lookup"><span data-stu-id="788f2-136">For more information about the DLR, see [Dynamic Language Runtime Overview](../../../framework/reflection-and-codedom/dynamic-language-runtime-overview.md).</span></span>

## <a name="com-interop"></a><span data-ttu-id="788f2-137">Interoperabilidad COM</span><span class="sxs-lookup"><span data-stu-id="788f2-137">COM interop</span></span>

<span data-ttu-id="788f2-138">C# 4 incluye varias características que mejoran la experiencia de interoperar con API de COM tales como las API de automatización de Office.</span><span class="sxs-lookup"><span data-stu-id="788f2-138">C# 4 includes several features that improve the experience of interoperating with COM APIs such as the Office Automation APIs.</span></span> <span data-ttu-id="788f2-139">Entre las mejoras se incluye el uso del tipo `dynamic` y de [argumentos opcionales y con nombre](../classes-and-structs/named-and-optional-arguments.md).</span><span class="sxs-lookup"><span data-stu-id="788f2-139">Among the improvements are the use of the `dynamic` type, and of [named and optional arguments](../classes-and-structs/named-and-optional-arguments.md).</span></span>

<span data-ttu-id="788f2-140">Muchos métodos COM permiten variaciones en los tipos de argumento y el tipo de valor devuelto mediante la designación de los tipos como `object`.</span><span class="sxs-lookup"><span data-stu-id="788f2-140">Many COM methods allow for variation in argument types and return type by designating the types as `object`.</span></span> <span data-ttu-id="788f2-141">Esto requería una conversión explícita de los valores para coordinarlos con variables fuertemente tipadas en C#.</span><span class="sxs-lookup"><span data-stu-id="788f2-141">This has necessitated explicit casting of the values to coordinate with strongly typed variables in C#.</span></span> <span data-ttu-id="788f2-142">Si se compila con la opción [-link (opciones del compilador de C#)](../../language-reference/compiler-options/link-compiler-option.md), la introducción del tipo `dynamic` le permite tratar las repeticiones de `object` en las firmas COM como si fueran de tipo `dynamic` y así evitar gran parte de la conversión.</span><span class="sxs-lookup"><span data-stu-id="788f2-142">If you compile by using the [-link (C# Compiler Options)](../../language-reference/compiler-options/link-compiler-option.md) option, the introduction of the `dynamic` type enables you to treat the occurrences of `object` in COM signatures as if they were of type `dynamic`, and thereby to avoid much of the casting.</span></span> <span data-ttu-id="788f2-143">Por ejemplo, las instrucciones siguientes comparan cómo se accede a una celda de una hoja de cálculo de Microsoft Office Excel con el tipo `dynamic` y sin el tipo `dynamic`.</span><span class="sxs-lookup"><span data-stu-id="788f2-143">For example, the following statements contrast how you access a cell in a Microsoft Office Excel spreadsheet with the `dynamic` type and without the `dynamic` type.</span></span>

[!code-csharp[csOfficeWalkthrough#12](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csofficewalkthrough/cs/thisaddin.cs#12)]

[!code-csharp[csOfficeWalkthrough#13](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csofficewalkthrough/cs/thisaddin.cs#13)]

## <a name="related-topics"></a><span data-ttu-id="788f2-144">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="788f2-144">Related topics</span></span>

|<span data-ttu-id="788f2-145">Title</span><span class="sxs-lookup"><span data-stu-id="788f2-145">Title</span></span>|<span data-ttu-id="788f2-146">Descripción</span><span class="sxs-lookup"><span data-stu-id="788f2-146">Description</span></span>|
|-----------|-----------------|
|[<span data-ttu-id="788f2-147">dynamic</span><span class="sxs-lookup"><span data-stu-id="788f2-147">dynamic</span></span>](../../language-reference/builtin-types/reference-types.md)|<span data-ttu-id="788f2-148">Describe el uso de la palabra clave `dynamic`.</span><span class="sxs-lookup"><span data-stu-id="788f2-148">Describes the usage of the `dynamic` keyword.</span></span>|
|[<span data-ttu-id="788f2-149">Información general sobre Dynamic Language Runtime</span><span class="sxs-lookup"><span data-stu-id="788f2-149">Dynamic Language Runtime Overview</span></span>](../../../framework/reflection-and-codedom/dynamic-language-runtime-overview.md)|<span data-ttu-id="788f2-150">Ofrece información general sobre DLR, que es un entorno en tiempo de ejecución que agrega un conjunto de servicios para lenguajes dinámicos en Common Language Runtime (CLR).</span><span class="sxs-lookup"><span data-stu-id="788f2-150">Provides an overview of the DLR, which is a runtime environment that adds a set of services for dynamic languages to the common language runtime (CLR).</span></span>|
|[<span data-ttu-id="788f2-151">Tutorial: Crear y usar objetos dinámicos</span><span class="sxs-lookup"><span data-stu-id="788f2-151">Walkthrough: Creating and Using Dynamic Objects</span></span>](walkthrough-creating-and-using-dynamic-objects.md)|<span data-ttu-id="788f2-152">Ofrece instrucciones paso a paso para crear un objeto dinámico personalizado y para crear un proyecto que acceda a una biblioteca de `IronPython`.</span><span class="sxs-lookup"><span data-stu-id="788f2-152">Provides step-by-step instructions for creating a custom dynamic object and for creating a project that accesses an `IronPython` library.</span></span>|
|[<span data-ttu-id="788f2-153">Procedimiento para acceder a objetos de interoperabilidad de Office mediante características de C#</span><span class="sxs-lookup"><span data-stu-id="788f2-153">How to access Office interop objects by using C# features</span></span>](../interop/how-to-access-office-onterop-objects.md)|<span data-ttu-id="788f2-154">Muestra cómo crear un proyecto que use argumentos opcionales y con nombre, el tipo `dynamic` y otras mejoras que simplifican el acceso a objetos de la API de Office.</span><span class="sxs-lookup"><span data-stu-id="788f2-154">Demonstrates how to create a project that uses named and optional arguments, the `dynamic` type, and other enhancements that simplify access to Office API objects.</span></span>|
