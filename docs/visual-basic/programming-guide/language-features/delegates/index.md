---
title: Delegados
ms.date: 07/20/2015
helpviewer_keywords:
- delegates [Visual Basic]
- Visual Basic code, delegates
ms.assetid: 410b60dc-5e60-4ec0-bfae-426755a2ee28
ms.openlocfilehash: 1f161248fa04f8fab0e5335413e69ca565732f71
ms.sourcegitcommit: f8c270376ed905f6a8896ce0fe25b4f4b38ff498
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/04/2020
ms.locfileid: "84410687"
---
# <a name="delegates-visual-basic"></a><span data-ttu-id="ab5d7-102">Delegados (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="ab5d7-102">Delegates (Visual Basic)</span></span>

<span data-ttu-id="ab5d7-103">Los delegados son objetos que hacen referencia a métodos.</span><span class="sxs-lookup"><span data-stu-id="ab5d7-103">Delegates are objects that refer to methods.</span></span> <span data-ttu-id="ab5d7-104">A veces se describen como *punteros de función con seguridad de tipos* porque son similares a los punteros de función utilizados en otros lenguajes de programación.</span><span class="sxs-lookup"><span data-stu-id="ab5d7-104">They are sometimes described as *type-safe function pointers* because they are similar to function pointers used in other programming languages.</span></span> <span data-ttu-id="ab5d7-105">Pero a diferencia de los punteros de función, los delegados Visual Basic son un tipo de referencia basado en la clase <xref:System.Delegate?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="ab5d7-105">But unlike function pointers, Visual Basic delegates are a reference type based on the class <xref:System.Delegate?displayProperty=nameWithType>.</span></span> <span data-ttu-id="ab5d7-106">Los delegados pueden hacer referencia a los métodos compartidos, métodos a los que se puede llamar sin una instancia específica de una clase, y a los métodos de instancia.</span><span class="sxs-lookup"><span data-stu-id="ab5d7-106">Delegates can reference both shared methods — methods that can be called without a specific instance of a class — and instance methods.</span></span>

## <a name="delegates-and-events"></a><span data-ttu-id="ab5d7-107">Delegados y eventos</span><span class="sxs-lookup"><span data-stu-id="ab5d7-107">Delegates and Events</span></span>

<span data-ttu-id="ab5d7-108">Los delegados son útiles en situaciones donde es necesario un intermediario entre un procedimiento que realiza la llamada y el procedimiento que la recibe.</span><span class="sxs-lookup"><span data-stu-id="ab5d7-108">Delegates are useful in situations where you need an intermediary between a calling procedure and the procedure being called.</span></span> <span data-ttu-id="ab5d7-109">Por ejemplo, puede que necesite un objeto que provoca que los eventos puedan llamar a controladores de eventos diferentes en distintas circunstancias.</span><span class="sxs-lookup"><span data-stu-id="ab5d7-109">For example, you might want an object that raises events to be able to call different event handlers under different circumstances.</span></span> <span data-ttu-id="ab5d7-110">Lamentablemente, el objeto que provoca los eventos no puede conocer de antemano qué controlador de eventos controla un evento específico.</span><span class="sxs-lookup"><span data-stu-id="ab5d7-110">Unfortunately, the object raising the events cannot know ahead of time which event handler is handling a specific event.</span></span> <span data-ttu-id="ab5d7-111">Visual Basic permite asociar dinámicamente controladores de eventos con eventos mediante la creación de un delegado cuando se utiliza la `AddHandler` instrucción.</span><span class="sxs-lookup"><span data-stu-id="ab5d7-111">Visual Basic lets you dynamically associate event handlers with events by creating a delegate for you when you use the `AddHandler` statement.</span></span> <span data-ttu-id="ab5d7-112">En tiempo de ejecución, el delegado reenvía las llamadas al controlador de eventos adecuado.</span><span class="sxs-lookup"><span data-stu-id="ab5d7-112">At run time, the delegate forwards calls to the appropriate event handler.</span></span>

<span data-ttu-id="ab5d7-113">Aunque puede crear sus propios delegados, en la mayoría de los casos Visual Basic crea el delegado y se encarga de los detalles.</span><span class="sxs-lookup"><span data-stu-id="ab5d7-113">Although you can create your own delegates, in most cases Visual Basic creates the delegate and takes care of the details for you.</span></span> <span data-ttu-id="ab5d7-114">Por ejemplo, una instrucción `Event` define implícitamente una clase delegada denominada `<EventName>EventHandler` como una clase anidada de la clase que contiene la instrucción `Event`, y con la misma firma que el evento.</span><span class="sxs-lookup"><span data-stu-id="ab5d7-114">For example, an `Event` statement implicitly defines a delegate class named `<EventName>EventHandler` as a nested class of the class containing the `Event` statement, and with the same signature as the event.</span></span> <span data-ttu-id="ab5d7-115">La instrucción `AddressOf` crea implícitamente una instancia de un delegado que hace referencia a un procedimiento específico.</span><span class="sxs-lookup"><span data-stu-id="ab5d7-115">The `AddressOf` statement implicitly creates an instance of a delegate that refers to a specific procedure.</span></span> <span data-ttu-id="ab5d7-116">Las dos líneas de código siguientes son equivalentes.</span><span class="sxs-lookup"><span data-stu-id="ab5d7-116">The following two lines of code are equivalent.</span></span> <span data-ttu-id="ab5d7-117">En la primera línea, verá que la creación explícita de una instancia de `EventHandler`, con una referencia al método `Button1_Click` enviada como argumento.</span><span class="sxs-lookup"><span data-stu-id="ab5d7-117">In the first line, you see the explicit creation of an instance of `EventHandler`, with a reference to method `Button1_Click` sent as the argument.</span></span> <span data-ttu-id="ab5d7-118">La segunda línea es una manera más práctica de conseguir el mismo resultado.</span><span class="sxs-lookup"><span data-stu-id="ab5d7-118">The second line is a more convenient way to do the same thing.</span></span>

[!code-vb[VbVbalrDelegates#6](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrDelegates/VB/Class1.vb#6)]

<span data-ttu-id="ab5d7-119">Puede utilizar la forma abreviada para crear delegados en cualquier lugar en que el compilador puede determinar el tipo de delegado en función del contexto.</span><span class="sxs-lookup"><span data-stu-id="ab5d7-119">You can use the shorthand way of creating delegates anywhere the compiler can determine the delegate's type by the context.</span></span>

## <a name="declaring-events-that-use-an-existing-delegate-type"></a><span data-ttu-id="ab5d7-120">Declaración de eventos que usan un tipo de delegado existente</span><span class="sxs-lookup"><span data-stu-id="ab5d7-120">Declaring Events that Use an Existing Delegate Type</span></span>

<span data-ttu-id="ab5d7-121">En algunas situaciones, puede declarar un evento para utilizar un tipo de delegado existente como su delegado subyacente.</span><span class="sxs-lookup"><span data-stu-id="ab5d7-121">In some situations, you may want to declare an event to use an existing delegate type as its underlying delegate.</span></span> <span data-ttu-id="ab5d7-122">La sintaxis siguiente muestra cómo:</span><span class="sxs-lookup"><span data-stu-id="ab5d7-122">The following syntax demonstrates how:</span></span>

[!code-vb[VbVbalrDelegates#7](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrDelegates/VB/Class1.vb#7)]

<span data-ttu-id="ab5d7-123">Esto es útil cuando desea enrutar diversos eventos hacia el mismo controlador.</span><span class="sxs-lookup"><span data-stu-id="ab5d7-123">This is useful when you want to route multiple events to the same handler.</span></span>

## <a name="delegate-variables-and-parameters"></a><span data-ttu-id="ab5d7-124">Variables y parámetros delegados</span><span class="sxs-lookup"><span data-stu-id="ab5d7-124">Delegate Variables and Parameters</span></span>

<span data-ttu-id="ab5d7-125">Puede utilizar delegados para otras tareas relacionadas sin eventos, como un subproceso libre, o con procedimientos que necesiten llamar a diferentes versiones de funciones en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="ab5d7-125">You can use delegates for other, non-event related tasks, such as free threading or with procedures that need to call different versions of functions at run time.</span></span>

<span data-ttu-id="ab5d7-126">Por ejemplo, suponga que tiene una aplicación de anuncios clasificados que incluye un cuadro de lista con los nombres de los automóviles.</span><span class="sxs-lookup"><span data-stu-id="ab5d7-126">For example, suppose you have a classified-ad application that includes a list box with the names of cars.</span></span> <span data-ttu-id="ab5d7-127">Los anuncios se ordenan por título, que suele ser la marca del automóvil.</span><span class="sxs-lookup"><span data-stu-id="ab5d7-127">The ads are sorted by title, which is normally the make of the car.</span></span> <span data-ttu-id="ab5d7-128">Se puede plantear un problema si algunos coches incluyen el año del automóvil antes de la marca.</span><span class="sxs-lookup"><span data-stu-id="ab5d7-128">A problem you may face occurs when some cars include the year of the car before the make.</span></span> <span data-ttu-id="ab5d7-129">El problema es que la funcionalidad de ordenación integrada del cuadro de lista ordena únicamente por códigos de caracteres; coloca todos los anuncios que empiezan con las fechas primero, seguidos de los anuncios que empiezan con la marca.</span><span class="sxs-lookup"><span data-stu-id="ab5d7-129">The problem is that the built-in sort functionality of the list box sorts only by character codes; it places all the ads starting with dates first, followed by the ads starting with the make.</span></span>

<span data-ttu-id="ab5d7-130">Para solucionar este problema, puede crear un procedimiento de ordenación en una clase que usa la ordenación alfabética estándar en la mayoría de los cuadros de lista, pero puede cambiar en tiempo de ejecución al procedimiento de ordenación personalizado para los anuncios de los automóviles.</span><span class="sxs-lookup"><span data-stu-id="ab5d7-130">To fix this, you can create a sort procedure in a class that uses the standard alphabetic sort on most list boxes, but is able to switch at run time to the custom sort procedure for car ads.</span></span> <span data-ttu-id="ab5d7-131">Para ello, pasa el procedimiento de ordenación personalizado a la clase de ordenación en tiempo de ejecución, mediante el uso de delegados.</span><span class="sxs-lookup"><span data-stu-id="ab5d7-131">To do this, you pass the custom sort procedure to the sort class at run time, using delegates.</span></span>

## <a name="addressof-and-lambda-expressions"></a><span data-ttu-id="ab5d7-132">Expresiones lambda y AddressOf</span><span class="sxs-lookup"><span data-stu-id="ab5d7-132">AddressOf and Lambda Expressions</span></span>

<span data-ttu-id="ab5d7-133">Cada clase delegada define un constructor que se pasa la especificación de un método de objeto.</span><span class="sxs-lookup"><span data-stu-id="ab5d7-133">Each delegate class defines a constructor that is passed the specification of an object method.</span></span> <span data-ttu-id="ab5d7-134">Un argumento para un constructor delegado debe ser una referencia a un método o una expresión lambda.</span><span class="sxs-lookup"><span data-stu-id="ab5d7-134">An argument to a delegate constructor must be a reference to a method, or a lambda expression.</span></span>

<span data-ttu-id="ab5d7-135">Para especificar una referencia a un método, utilice la siguiente sintaxis:</span><span class="sxs-lookup"><span data-stu-id="ab5d7-135">To specify a reference to a method, use the following syntax:</span></span>

<span data-ttu-id="ab5d7-136">`AddressOf` [`expression`.]`methodName`</span><span class="sxs-lookup"><span data-stu-id="ab5d7-136">`AddressOf` [`expression`.]`methodName`</span></span>

<span data-ttu-id="ab5d7-137">El tipo de tiempo de compilación de `expression` debe ser el nombre de una clase o una interfaz que contiene un método del nombre especificado cuya firma coincida con la firma de la clase delegada.</span><span class="sxs-lookup"><span data-stu-id="ab5d7-137">The compile-time type of the `expression` must be the name of a class or an interface that contains a method of the specified name whose signature matches the signature of the delegate class.</span></span> <span data-ttu-id="ab5d7-138">`methodName` puede ser un método compartido o un método de instancia.</span><span class="sxs-lookup"><span data-stu-id="ab5d7-138">The `methodName` can be either a shared method or an instance method.</span></span> <span data-ttu-id="ab5d7-139">`methodName` no es opcional, incluso si se crea un delegado para el método predeterminado de la clase.</span><span class="sxs-lookup"><span data-stu-id="ab5d7-139">The `methodName` is not optional, even if you create a delegate for the default method of the class.</span></span>

<span data-ttu-id="ab5d7-140">Para especificar una expresión lambda, utilice la siguiente sintaxis:</span><span class="sxs-lookup"><span data-stu-id="ab5d7-140">To specify a lambda expression, use the following syntax:</span></span>

<span data-ttu-id="ab5d7-141">`Function` ([`parm` As `type`, `parm2` As `type2`, ...]) `expression`</span><span class="sxs-lookup"><span data-stu-id="ab5d7-141">`Function` ([`parm` As `type`, `parm2` As `type2`, ...]) `expression`</span></span>

<span data-ttu-id="ab5d7-142">En el ejemplo siguiente se muestran las expresiones lambda y `AddressOf` usadas para especificar la referencia de un delegado.</span><span class="sxs-lookup"><span data-stu-id="ab5d7-142">The following example shows both `AddressOf` and lambda expressions used to specify the reference for a delegate.</span></span>

[!code-vb[VbVbalrDelegates#15](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrDelegates/VB/Class2.vb#15)]

<span data-ttu-id="ab5d7-143">La firma de la función debe coincidir con la del tipo de delegado.</span><span class="sxs-lookup"><span data-stu-id="ab5d7-143">The signature of the function must match that of the delegate type.</span></span> <span data-ttu-id="ab5d7-144">Para obtener más información sobre las expresiones lambda, vea [expresiones lambda](../procedures/lambda-expressions.md).</span><span class="sxs-lookup"><span data-stu-id="ab5d7-144">For more information about lambda expressions, see [Lambda Expressions](../procedures/lambda-expressions.md).</span></span> <span data-ttu-id="ab5d7-145">Para obtener más ejemplos de expresión lambda y asignaciones de `AddressOf` a delegados, vea [Conversión de delegado flexible](relaxed-delegate-conversion.md).</span><span class="sxs-lookup"><span data-stu-id="ab5d7-145">For more examples of lambda expression and `AddressOf` assignments to delegates, see [Relaxed Delegate Conversion](relaxed-delegate-conversion.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="ab5d7-146">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="ab5d7-146">Related Topics</span></span>

|<span data-ttu-id="ab5d7-147">Title</span><span class="sxs-lookup"><span data-stu-id="ab5d7-147">Title</span></span>|<span data-ttu-id="ab5d7-148">Descripción</span><span class="sxs-lookup"><span data-stu-id="ab5d7-148">Description</span></span>|
|-----------|-----------------|
|[<span data-ttu-id="ab5d7-149">Procedimiento para invocar un método delegado</span><span class="sxs-lookup"><span data-stu-id="ab5d7-149">How to: Invoke a Delegate Method</span></span>](how-to-invoke-a-delegate-method.md)|<span data-ttu-id="ab5d7-150">Proporciona un ejemplo que muestra cómo asociar un método a un delegado y después invocar ese método a través del delegado.</span><span class="sxs-lookup"><span data-stu-id="ab5d7-150">Provides an example that shows how to associate a method with a delegate and then invoke that method through the delegate.</span></span>|
|[<span data-ttu-id="ab5d7-151">Cómo: Pasar procedimientos a otro procedimiento en Visual Basic</span><span class="sxs-lookup"><span data-stu-id="ab5d7-151">How to: Pass Procedures to Another Procedure in Visual Basic</span></span>](how-to-pass-procedures-to-another-procedure.md)|<span data-ttu-id="ab5d7-152">Muestra cómo utilizar los delegados para pasar un procedimiento a otro procedimiento.</span><span class="sxs-lookup"><span data-stu-id="ab5d7-152">Demonstrates how to use delegates to pass one procedure to another procedure.</span></span>|
|[<span data-ttu-id="ab5d7-153">Conversión de delegado flexible</span><span class="sxs-lookup"><span data-stu-id="ab5d7-153">Relaxed Delegate Conversion</span></span>](relaxed-delegate-conversion.md)|<span data-ttu-id="ab5d7-154">Describe cómo asignar subfunciones y funciones a delegados o controladores incluso cuando sus firmas no son idénticas.</span><span class="sxs-lookup"><span data-stu-id="ab5d7-154">Describes how you can assign subs and functions to delegates or handlers even when their signatures are not identical</span></span>|
|[<span data-ttu-id="ab5d7-155">Eventos</span><span class="sxs-lookup"><span data-stu-id="ab5d7-155">Events</span></span>](../events/index.md)|<span data-ttu-id="ab5d7-156">Proporciona información general sobre eventos en Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="ab5d7-156">Provides an overview of events in Visual Basic.</span></span>|
