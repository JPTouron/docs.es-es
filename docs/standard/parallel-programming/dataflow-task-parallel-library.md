---
title: Flujo de datos (biblioteca TPL)
ms.date: 03/30/2017
ms.technology: dotnet-standard
dev_langs:
- csharp
- vb
helpviewer_keywords:
- Task Parallel Library, dataflows
- TPL dataflow library
ms.assetid: 643575d0-d26d-4c35-8de7-a9c403e97dd6
ms.openlocfilehash: e1d4dc596f57a4c75c11806f95099ee5593c6c03
ms.sourcegitcommit: 33deec3e814238fb18a49b2a7e89278e27888291
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 06/02/2020
ms.locfileid: "84285539"
---
# <a name="dataflow-task-parallel-library"></a><span data-ttu-id="c1c59-102">Flujo de datos (biblioteca TPL)</span><span class="sxs-lookup"><span data-stu-id="c1c59-102">Dataflow (Task Parallel Library)</span></span>
<span data-ttu-id="c1c59-103">La biblioteca TPL (Task Parallel Library, biblioteca de procesamiento paralelo basado en tareas) proporciona componentes de flujo de datos que ayudan a aumentar la solidez de aplicaciones habilitadas para simultaneidad.</span><span class="sxs-lookup"><span data-stu-id="c1c59-103">The Task Parallel Library (TPL) provides dataflow components to help increase the robustness of concurrency-enabled applications.</span></span> <span data-ttu-id="c1c59-104">Se conoce colectivamente a estos componentes de flujo de datos como *biblioteca TDF (biblioteca de TPL Dataflow)* pero nos referiremos descriptivamente a ella como "biblioteca de flujos de datos TPL".</span><span class="sxs-lookup"><span data-stu-id="c1c59-104">These dataflow components are collectively referred to as the *TPL Dataflow Library*.</span></span> <span data-ttu-id="c1c59-105">Este modelo de flujo de datos promueve una programación basada en actores mediante el paso de mensajes en proceso para tareas de canalización y de flujo de datos de grano grueso.</span><span class="sxs-lookup"><span data-stu-id="c1c59-105">This dataflow model promotes actor-based programming by providing in-process message passing for coarse-grained dataflow and pipelining tasks.</span></span> <span data-ttu-id="c1c59-106">Los componentes de flujo de datos se basan en los tipos y la infraestructura de programación de la biblioteca TPL y se integran con la compatibilidad de los lenguajes C#, Visual Basic y F# para proporcionar programación asincrónica.</span><span class="sxs-lookup"><span data-stu-id="c1c59-106">The dataflow components build on the types and scheduling infrastructure of the TPL and integrate with the C#, Visual Basic, and F# language support for asynchronous programming.</span></span> <span data-ttu-id="c1c59-107">Estos componentes de flujo de datos son útiles cuando se tienen varias operaciones que deben comunicarse entre sí de forma asincrónica, o cuando se desea procesar datos a medida que estén disponibles.</span><span class="sxs-lookup"><span data-stu-id="c1c59-107">These dataflow components are useful when you have multiple operations that must communicate with one another asynchronously or when you want to process data as it becomes available.</span></span> <span data-ttu-id="c1c59-108">Por ejemplo, piense en una aplicación que procesa datos de imagen de una cámara web.</span><span class="sxs-lookup"><span data-stu-id="c1c59-108">For example, consider an application that processes image data from a web camera.</span></span> <span data-ttu-id="c1c59-109">Con el modelo de flujo de datos, la aplicación puede procesar fotogramas de imagen a medida que estén disponibles.</span><span class="sxs-lookup"><span data-stu-id="c1c59-109">By using the dataflow model, the application can process image frames as they become available.</span></span> <span data-ttu-id="c1c59-110">Si la aplicación mejora fotogramas de imagen, por ejemplo, corrigiendo la luz o reduciendo ojos rojos, puede crear una *canalización* de los componentes de flujo de datos.</span><span class="sxs-lookup"><span data-stu-id="c1c59-110">If the application enhances image frames, for example, by performing light correction or red-eye reduction, you can create a *pipeline* of dataflow components.</span></span> <span data-ttu-id="c1c59-111">Cada fase de la canalización puede utilizar más funcionalidad de paralelismo de grano grueso, como la funcionalidad proporcionada por la biblioteca TPL, para transformar la imagen.</span><span class="sxs-lookup"><span data-stu-id="c1c59-111">Each stage of the pipeline might use more coarse-grained parallelism functionality, such as the functionality that is provided by the TPL, to transform the image.</span></span>  
  
 <span data-ttu-id="c1c59-112">En este documento se proporciona información general sobre la biblioteca de flujos de datos TPL.</span><span class="sxs-lookup"><span data-stu-id="c1c59-112">This document provides an overview of the TPL Dataflow Library.</span></span> <span data-ttu-id="c1c59-113">Se describe el modelo de programación, los tipos de bloques de flujo de datos predefinidos y cómo configurar bloques de flujo de datos para satisfacer las necesidades específicas de las aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="c1c59-113">It describes the programming model, the predefined dataflow block types, and how to configure dataflow blocks to meet the specific requirements of your applications.</span></span>  

[!INCLUDE [tpl-install-instructions](../../../includes/tpl-install-instructions.md)]

## <a name="programming-model"></a><span data-ttu-id="c1c59-114">Modelo de programación</span><span class="sxs-lookup"><span data-stu-id="c1c59-114">Programming Model</span></span>
 <span data-ttu-id="c1c59-115">La biblioteca de flujos de datos TPL proporciona una base para el paso de mensajes y para paralelizar aplicaciones que consumen mucha CPU, así como aplicaciones intensivas de entrada y salida con alto rendimiento y latencia baja.</span><span class="sxs-lookup"><span data-stu-id="c1c59-115">The TPL Dataflow Library provides a foundation for message passing and parallelizing CPU-intensive and I/O-intensive applications that have high throughput and low latency.</span></span> <span data-ttu-id="c1c59-116">También ofrece el control explícito sobre cómo almacenar los datos en búfer y desplazarlos alrededor del sistema.</span><span class="sxs-lookup"><span data-stu-id="c1c59-116">It also gives you explicit control over how data is buffered and moves around the system.</span></span> <span data-ttu-id="c1c59-117">Para entender mejor el modelo de programación de flujo de datos, piense en una aplicación que de forma asincrónica carga imágenes desde el disco y crea un compuesto de esas imágenes.</span><span class="sxs-lookup"><span data-stu-id="c1c59-117">To better understand the dataflow programming model, consider an application that asynchronously loads images from disk and creates a composite of those images.</span></span> <span data-ttu-id="c1c59-118">Los modelos de programación tradicionales suelen usar devoluciones de llamada y objetos de sincronización, como bloqueos, para coordinar tareas y tener acceso a datos compartidos.</span><span class="sxs-lookup"><span data-stu-id="c1c59-118">Traditional programming models typically require that you use callbacks and synchronization objects, such as locks, to coordinate tasks and access to shared data.</span></span> <span data-ttu-id="c1c59-119">Con el modelo de programación de flujo de datos, puede crear objetos de flujo de datos que procesan las imágenes como se leen desde el disco.</span><span class="sxs-lookup"><span data-stu-id="c1c59-119">By using the dataflow programming model, you can create dataflow objects that process images as they are read from disk.</span></span> <span data-ttu-id="c1c59-120">Bajo el modelo de flujo de datos, se declara cómo se controlan los datos cuando están disponibles, así como las dependencias entre datos.</span><span class="sxs-lookup"><span data-stu-id="c1c59-120">Under the dataflow model, you declare how data is handled when it becomes available, and also any dependencies between data.</span></span> <span data-ttu-id="c1c59-121">Dado que el runtime administra las dependencias entre datos, se puede evitar a menudo la necesidad de sincronizar el acceso a los datos compartidos.</span><span class="sxs-lookup"><span data-stu-id="c1c59-121">Because the runtime manages dependencies between data, you can often avoid the requirement to synchronize access to shared data.</span></span> <span data-ttu-id="c1c59-122">Además, dado que el runtime programa el trabajo según la llegada asincrónica de datos, el flujo de datos puede mejorar la capacidad de respuesta y el nivel de rendimiento administrando de forma eficaz los subprocesos subyacentes.</span><span class="sxs-lookup"><span data-stu-id="c1c59-122">In addition, because the runtime schedules work based on the asynchronous arrival of data, dataflow can improve responsiveness and throughput by efficiently managing the underlying threads.</span></span> <span data-ttu-id="c1c59-123">Para ver un ejemplo en el que se usa el modelo de programación de flujo de datos para implementar el procesamiento de imágenes en una aplicación de Windows Forms, consulte [Walkthrough: Using Dataflow in a Windows Forms Application](walkthrough-using-dataflow-in-a-windows-forms-application.md) (Tutorial: Uso de flujo de datos en una aplicación de Windows Forms).</span><span class="sxs-lookup"><span data-stu-id="c1c59-123">For an example that uses the dataflow programming model to implement image processing in a Windows Forms application, see [Walkthrough: Using Dataflow in a Windows Forms Application](walkthrough-using-dataflow-in-a-windows-forms-application.md).</span></span>  
  
### <a name="sources-and-targets"></a><span data-ttu-id="c1c59-124">Orígenes y destinos</span><span class="sxs-lookup"><span data-stu-id="c1c59-124">Sources and Targets</span></span>  
 <span data-ttu-id="c1c59-125">La biblioteca de flujos de datos TPL consta de *bloques de flujo de datos*, que son estructuras de datos que almacenan datos en búfer y procesan datos.</span><span class="sxs-lookup"><span data-stu-id="c1c59-125">The TPL Dataflow Library consists of *dataflow blocks*, which are data structures that buffer and process data.</span></span> <span data-ttu-id="c1c59-126">La biblioteca TPL define tres tipos de bloques de flujos de datos: *bloques de origen*, *bloques de destino* y *bloques propagadores*.</span><span class="sxs-lookup"><span data-stu-id="c1c59-126">The TPL defines three kinds of dataflow blocks: *source blocks*, *target blocks*, and *propagator blocks*.</span></span> <span data-ttu-id="c1c59-127">Un bloque de origen actúa como un origen de datos y se puede leer desde él.</span><span class="sxs-lookup"><span data-stu-id="c1c59-127">A source block acts as a source of data and can be read from.</span></span> <span data-ttu-id="c1c59-128">Un bloque de destino actúa como un receptor de datos y se puede escribir en él.</span><span class="sxs-lookup"><span data-stu-id="c1c59-128">A target block acts as a receiver of data and can be written to.</span></span> <span data-ttu-id="c1c59-129">Un bloque propagador actúa como un bloque de origen y un bloque de destino, y se puede leer desde él y escribir en él.</span><span class="sxs-lookup"><span data-stu-id="c1c59-129">A propagator block acts as both a source block and a target block, and can be read from and written to.</span></span> <span data-ttu-id="c1c59-130">La biblioteca TPL define la interfaz <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601?displayProperty=nameWithType> para representar orígenes, <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601?displayProperty=nameWithType> para representar destinos y <xref:System.Threading.Tasks.Dataflow.IPropagatorBlock%602?displayProperty=nameWithType> para representar propagadores.</span><span class="sxs-lookup"><span data-stu-id="c1c59-130">The TPL defines the <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601?displayProperty=nameWithType> interface to represent sources, <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601?displayProperty=nameWithType> to represent targets, and <xref:System.Threading.Tasks.Dataflow.IPropagatorBlock%602?displayProperty=nameWithType> to represent propagators.</span></span> <span data-ttu-id="c1c59-131"><xref:System.Threading.Tasks.Dataflow.IPropagatorBlock%602> hereda de <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601> y de <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601>.</span><span class="sxs-lookup"><span data-stu-id="c1c59-131"><xref:System.Threading.Tasks.Dataflow.IPropagatorBlock%602> inherits from both <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601>, and <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601>.</span></span>  
  
 <span data-ttu-id="c1c59-132">La biblioteca de flujos de datos TPL proporciona varios tipos de bloques de flujo de datos predefinidos que implementan las interfaces <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601>, <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601> y <xref:System.Threading.Tasks.Dataflow.IPropagatorBlock%602>.</span><span class="sxs-lookup"><span data-stu-id="c1c59-132">The TPL Dataflow Library provides several predefined dataflow block types that implement the <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601>, <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601>, and <xref:System.Threading.Tasks.Dataflow.IPropagatorBlock%602> interfaces.</span></span> <span data-ttu-id="c1c59-133">Estos tipos de bloques de flujo de datos se describen en este documento en la sección [Tipos de bloques de flujo de datos predefinidos](#predefined-dataflow-block-types).</span><span class="sxs-lookup"><span data-stu-id="c1c59-133">These dataflow block types are described in this document in the section [Predefined Dataflow Block Types](#predefined-dataflow-block-types).</span></span>  
  
### <a name="connecting-blocks"></a><span data-ttu-id="c1c59-134">Conectar bloques</span><span class="sxs-lookup"><span data-stu-id="c1c59-134">Connecting Blocks</span></span>  
 <span data-ttu-id="c1c59-135">Puede conectar los bloques de flujo de datos para establecer *canalizaciones*, que son secuencias lineales de bloques de flujo de datos, o *redes*, que son gráficos de bloques de flujo de datos.</span><span class="sxs-lookup"><span data-stu-id="c1c59-135">You can connect dataflow blocks to form *pipelines*, which are linear sequences of dataflow blocks, or *networks*, which are graphs of dataflow blocks.</span></span> <span data-ttu-id="c1c59-136">Una canalización es una forma de red.</span><span class="sxs-lookup"><span data-stu-id="c1c59-136">A pipeline is one form of network.</span></span> <span data-ttu-id="c1c59-137">En una canalización o red, los orígenes propagan datos de forma asincrónica en destinos a medida que esos datos están disponibles.</span><span class="sxs-lookup"><span data-stu-id="c1c59-137">In a pipeline or network, sources asynchronously propagate data to targets as that data becomes available.</span></span> <span data-ttu-id="c1c59-138">El método <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.LinkTo%2A?displayProperty=nameWithType> vincula un bloque de flujo de datos de origen a un bloque de destino.</span><span class="sxs-lookup"><span data-stu-id="c1c59-138">The <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.LinkTo%2A?displayProperty=nameWithType> method links a source dataflow block to a target block.</span></span> <span data-ttu-id="c1c59-139">Un origen puede vincularse a cero o más destinos; los destinos se pueden vincular a partir de cero o más orígenes.</span><span class="sxs-lookup"><span data-stu-id="c1c59-139">A source can be linked to zero or more targets; targets can be linked from zero or more sources.</span></span> <span data-ttu-id="c1c59-140">Puede agregar o quitar bloques de flujo de datos hacia o desde una canalización o red simultáneamente.</span><span class="sxs-lookup"><span data-stu-id="c1c59-140">You can add or remove dataflow blocks to or from a pipeline or network concurrently.</span></span> <span data-ttu-id="c1c59-141">Los tipos de bloques de flujo de datos predefinidos controlan todos los aspectos de la seguridad para subprocesos de vinculación y desvinculación.</span><span class="sxs-lookup"><span data-stu-id="c1c59-141">The predefined dataflow block types handle all thread-safety aspects of linking and unlinking.</span></span>  
  
 <span data-ttu-id="c1c59-142">Para ver un ejemplo en el que se conectan los bloques de flujo de datos para formar una canalización básica, consulte [Walkthrough: Creating a Dataflow Pipeline](walkthrough-creating-a-dataflow-pipeline.md) (Tutorial: Creación de una canalización de flujo de datos).</span><span class="sxs-lookup"><span data-stu-id="c1c59-142">For an example that connects dataflow blocks to form a basic pipeline, see [Walkthrough: Creating a Dataflow Pipeline](walkthrough-creating-a-dataflow-pipeline.md).</span></span> <span data-ttu-id="c1c59-143">Para ver un ejemplo en el que se conectan los bloques de flujo de datos para formar una red más compleja, consulte [Walkthrough: Using Dataflow in a Windows Forms Application](walkthrough-using-dataflow-in-a-windows-forms-application.md) (Tutorial: Uso de flujo de datos en una aplicación de Windows Forms).</span><span class="sxs-lookup"><span data-stu-id="c1c59-143">For an example that connects dataflow blocks to form a more complex network, see [Walkthrough: Using Dataflow in a Windows Forms Application](walkthrough-using-dataflow-in-a-windows-forms-application.md).</span></span> <span data-ttu-id="c1c59-144">Para ver un ejemplo en el que se desvincula un destino de un origen después de que el origen proporcione un mensaje al destino, consulte [How to: Unlink Dataflow Blocks](how-to-unlink-dataflow-blocks.md) (Cómo: Desvincular bloques de flujo de datos).</span><span class="sxs-lookup"><span data-stu-id="c1c59-144">For an example that unlinks a target from a source after the source offers the target a message, see [How to: Unlink Dataflow Blocks](how-to-unlink-dataflow-blocks.md).</span></span>  
  
#### <a name="filtering"></a><span data-ttu-id="c1c59-145">Filtros</span><span class="sxs-lookup"><span data-stu-id="c1c59-145">Filtering</span></span>  
 <span data-ttu-id="c1c59-146">Cuando se llama al método <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.LinkTo%2A?displayProperty=nameWithType> para vincular un origen a un destino, puede proporcionar un delegado que determina si el bloque de destino acepta o rechaza un mensaje basado en el valor de ese mensaje.</span><span class="sxs-lookup"><span data-stu-id="c1c59-146">When you call the <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.LinkTo%2A?displayProperty=nameWithType> method to link a source to a target, you can supply a delegate that determines whether the target block accepts or rejects a message based on the value of that message.</span></span> <span data-ttu-id="c1c59-147">Este mecanismo de filtrado resulta útil para garantizar que un bloque de flujo de datos recibe solo ciertos valores.</span><span class="sxs-lookup"><span data-stu-id="c1c59-147">This filtering mechanism is a useful way to guarantee that a dataflow block receives only certain values.</span></span> <span data-ttu-id="c1c59-148">Para la mayoría de los tipos de bloques de flujo de datos predefinidos, si un bloque de origen está conectado a varios bloques de destino, cuando un bloque de destino rechaza un mensaje, el origen proporciona ese mensaje al destino siguiente.</span><span class="sxs-lookup"><span data-stu-id="c1c59-148">For most of the predefined dataflow block types, if a source block is connected to multiple target blocks, when a target block rejects a message, the source offers that message to the next target.</span></span> <span data-ttu-id="c1c59-149">El orden en el que un origen proporciona mensajes a los destinos se define mediante el origen y puede variar según el tipo de origen.</span><span class="sxs-lookup"><span data-stu-id="c1c59-149">The order in which a source offers messages to targets is defined by the source and can vary according to the type of the source.</span></span> <span data-ttu-id="c1c59-150">La mayoría de los tipos de bloques de origen dejan de proporcionar un mensaje después de que un destino acepta ese mensaje.</span><span class="sxs-lookup"><span data-stu-id="c1c59-150">Most source block types stop offering a message after one target accepts that message.</span></span> <span data-ttu-id="c1c59-151">Una excepción a esta regla es la clase <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601>, que proporciona cada mensaje a todos los destinos, aunque algunos destinos rechacen el mensaje.</span><span class="sxs-lookup"><span data-stu-id="c1c59-151">One exception to this rule is the <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601> class, which offers each message to all targets, even if some targets reject the message.</span></span> <span data-ttu-id="c1c59-152">Para ver un ejemplo en el que se usa el filtrado para procesar únicamente determinados mensajes, consulte [Walkthrough: Using Dataflow in a Windows Forms Application](walkthrough-using-dataflow-in-a-windows-forms-application.md) (Tutorial: Uso de flujo de datos en una aplicación de Windows Forms).</span><span class="sxs-lookup"><span data-stu-id="c1c59-152">For an example that uses filtering to process only certain messages, see [Walkthrough: Using Dataflow in a Windows Forms Application](walkthrough-using-dataflow-in-a-windows-forms-application.md).</span></span>  
  
> [!IMPORTANT]
> <span data-ttu-id="c1c59-153">Dado que cada tipo de bloque de flujo de datos de origen predefinido garantiza que los mensajes se propaguen en el orden en que se reciben, se debe leer cada mensaje desde el bloque de origen antes de que el bloque de origen pueda procesar el mensaje siguiente.</span><span class="sxs-lookup"><span data-stu-id="c1c59-153">Because each predefined source dataflow block type guarantees that messages are propagated out in the order in which they are received, every message must be read from the source block before the source block can process the next message.</span></span> <span data-ttu-id="c1c59-154">Por consiguiente, si usa el filtrado para conectarse varios destinos a un origen, asegúrese de que al menos un bloque de destino recibe cada mensaje.</span><span class="sxs-lookup"><span data-stu-id="c1c59-154">Therefore, when you use filtering to connect multiple targets to a source, make sure that at least one target block receives each message.</span></span> <span data-ttu-id="c1c59-155">De lo contrario, la aplicación podría generar un interbloqueo.</span><span class="sxs-lookup"><span data-stu-id="c1c59-155">Otherwise, your application might deadlock.</span></span>  
  
### <a name="message-passing"></a><span data-ttu-id="c1c59-156">Paso de mensajes</span><span class="sxs-lookup"><span data-stu-id="c1c59-156">Message Passing</span></span>  
 <span data-ttu-id="c1c59-157">El modelo de programación basado en el flujo de datos está relacionado con el concepto *paso de mensajes*, donde los componentes independientes de un programa comunican entre sí enviándose mensajes.</span><span class="sxs-lookup"><span data-stu-id="c1c59-157">The dataflow programming model is related to the concept of *message passing*, where independent components of a program communicate with one another by sending messages.</span></span> <span data-ttu-id="c1c59-158">Una manera de propagar mensajes entre los componentes de la aplicación es llamar a los métodos <xref:System.Threading.Tasks.Dataflow.DataflowBlock.Post%2A> y <xref:System.Threading.Tasks.Dataflow.DataflowBlock.SendAsync%2A?displayProperty=nameWithType> para enviar mensajes a los bloques de flujo de datos de destino (<xref:System.Threading.Tasks.Dataflow.DataflowBlock.Post%2A> actúa de forma sincrónica; <xref:System.Threading.Tasks.Dataflow.DataflowBlock.SendAsync%2A> actúa de forma asincrónica) y a los métodos <xref:System.Threading.Tasks.Dataflow.DataflowBlock.Receive%2A>, <xref:System.Threading.Tasks.Dataflow.DataflowBlock.ReceiveAsync%2A> y <xref:System.Threading.Tasks.Dataflow.DataflowBlock.TryReceive%2A> para recibir los mensajes desde los bloques de origen.</span><span class="sxs-lookup"><span data-stu-id="c1c59-158">One way to propagate messages among application components is to call the <xref:System.Threading.Tasks.Dataflow.DataflowBlock.Post%2A> and <xref:System.Threading.Tasks.Dataflow.DataflowBlock.SendAsync%2A?displayProperty=nameWithType> methods to send messages to target dataflow blocks post (<xref:System.Threading.Tasks.Dataflow.DataflowBlock.Post%2A> acts synchronously; <xref:System.Threading.Tasks.Dataflow.DataflowBlock.SendAsync%2A> acts asynchronously) and the <xref:System.Threading.Tasks.Dataflow.DataflowBlock.Receive%2A>, <xref:System.Threading.Tasks.Dataflow.DataflowBlock.ReceiveAsync%2A>, and <xref:System.Threading.Tasks.Dataflow.DataflowBlock.TryReceive%2A> methods to receive messages from source blocks.</span></span> <span data-ttu-id="c1c59-159">Puede combinar estos métodos con las canalizaciones o redes de flujo de datos enviando datos de entrada al nodo principal (un bloque de destino) y recibiendo datos de salida del nodo terminal de la canalización o de los nodos terminales de la red (uno o varios bloques de origen).</span><span class="sxs-lookup"><span data-stu-id="c1c59-159">You can combine these methods with dataflow pipelines or networks by sending input data to the head node (a target block), and receiving output data from the terminal node of the pipeline or the terminal nodes of the network (one or more source blocks).</span></span> <span data-ttu-id="c1c59-160">También puede utilizar el método <xref:System.Threading.Tasks.Dataflow.DataflowBlock.Choose%2A> para leer desde el primero de los orígenes proporcionados siempre que tenga datos disponibles y realice acciones sobre esos datos.</span><span class="sxs-lookup"><span data-stu-id="c1c59-160">You can also use the <xref:System.Threading.Tasks.Dataflow.DataflowBlock.Choose%2A> method to read from the first of the provided sources that has data available and perform action on that data.</span></span>  
  
 <span data-ttu-id="c1c59-161">Los bloques de origen proporcionan datos a los bloques de destino llamando al método <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601.OfferMessage%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="c1c59-161">Source blocks offer data to target blocks by calling the <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601.OfferMessage%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="c1c59-162">El bloque de destino responde a un mensaje proporcionado de una de estas tres maneras: puede aceptar el mensaje, rechazar el mensaje o posponer el mensaje.</span><span class="sxs-lookup"><span data-stu-id="c1c59-162">The target block responds to an offered message in one of three ways: it can accept the message, decline the message, or postpone the message.</span></span> <span data-ttu-id="c1c59-163">Cuando el destino acepta el mensaje, el método <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601.OfferMessage%2A> devuelve <xref:System.Threading.Tasks.Dataflow.DataflowMessageStatus.Accepted>.</span><span class="sxs-lookup"><span data-stu-id="c1c59-163">When the target accepts the message, the <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601.OfferMessage%2A> method returns <xref:System.Threading.Tasks.Dataflow.DataflowMessageStatus.Accepted>.</span></span> <span data-ttu-id="c1c59-164">Cuando el destino rechaza el mensaje, el método <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601.OfferMessage%2A> devuelve <xref:System.Threading.Tasks.Dataflow.DataflowMessageStatus.Declined>.</span><span class="sxs-lookup"><span data-stu-id="c1c59-164">When the target declines the message, the <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601.OfferMessage%2A> method returns <xref:System.Threading.Tasks.Dataflow.DataflowMessageStatus.Declined>.</span></span> <span data-ttu-id="c1c59-165">Cuando el destino requiere que ya no recibe ningún mensaje del origen, <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601.OfferMessage%2A> devuelve <xref:System.Threading.Tasks.Dataflow.DataflowMessageStatus.DecliningPermanently>.</span><span class="sxs-lookup"><span data-stu-id="c1c59-165">When the target requires that it no longer receives any messages from the source, <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601.OfferMessage%2A> returns <xref:System.Threading.Tasks.Dataflow.DataflowMessageStatus.DecliningPermanently>.</span></span> <span data-ttu-id="c1c59-166">Los tipos de bloques de origen predefinidos no proporcionan mensajes a los destinos vinculados después de recibir este valor devuelto, y automáticamente se desvinculan de estos destinos.</span><span class="sxs-lookup"><span data-stu-id="c1c59-166">The predefined source block types do not offer messages to linked targets after such a return value is received, and they automatically unlink from such targets.</span></span>  
  
 <span data-ttu-id="c1c59-167">Cuando un bloque de destino pospone el mensaje para su uso posterior, el método <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601.OfferMessage%2A> devuelve <xref:System.Threading.Tasks.Dataflow.DataflowMessageStatus.Postponed>.</span><span class="sxs-lookup"><span data-stu-id="c1c59-167">When a target block postpones the message for later use, the <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601.OfferMessage%2A> method returns <xref:System.Threading.Tasks.Dataflow.DataflowMessageStatus.Postponed>.</span></span> <span data-ttu-id="c1c59-168">Un bloque de destino que pospone un mensaje puede llamar posteriormente al método <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.ReserveMessage%2A?displayProperty=nameWithType> para tratar de reservar el mensaje proporcionado.</span><span class="sxs-lookup"><span data-stu-id="c1c59-168">A target block that postpones a message can later call the <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.ReserveMessage%2A?displayProperty=nameWithType> method to try to reserve the offered message.</span></span> <span data-ttu-id="c1c59-169">En este punto, el mensaje todavía permanece disponible y lo puede usar el bloque de destino, o puede que otro destino haya tomado el mensaje.</span><span class="sxs-lookup"><span data-stu-id="c1c59-169">At this point, the message is either still available and can be used by the target block, or the message has been taken by another target.</span></span> <span data-ttu-id="c1c59-170">Cuando el bloque de destino requiere el mensaje posteriormente o cuando ya no necesita el mensaje, llama al método <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.ConsumeMessage%2A?displayProperty=nameWithType> o <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.ReleaseReservation%2A>, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="c1c59-170">When the target block later requires the message or no longer needs the message, it calls the <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.ConsumeMessage%2A?displayProperty=nameWithType> or <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.ReleaseReservation%2A> method, respectively.</span></span> <span data-ttu-id="c1c59-171">La reserva de mensajes la utilizan normalmente los tipos de bloques de flujo de datos que trabajan en modo no expansivo.</span><span class="sxs-lookup"><span data-stu-id="c1c59-171">Message reservation is typically used by the dataflow block types that operate in non-greedy mode.</span></span> <span data-ttu-id="c1c59-172">El modo no expansivo se explica más adelante en este documento.</span><span class="sxs-lookup"><span data-stu-id="c1c59-172">Non-greedy mode is explained later in this document.</span></span> <span data-ttu-id="c1c59-173">En lugar de reservar un mensaje pospuesto, un bloque de destino puede utilizar el método <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.ConsumeMessage%2A?displayProperty=nameWithType> para intentar utilizar directamente el mensaje pospuesto.</span><span class="sxs-lookup"><span data-stu-id="c1c59-173">Instead of reserving a postponed message, a target block can also use the <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.ConsumeMessage%2A?displayProperty=nameWithType> method to attempt to directly consume the postponed message.</span></span>  
  
### <a name="dataflow-block-completion"></a><span data-ttu-id="c1c59-174">Finalización del bloque de flujo de datos</span><span class="sxs-lookup"><span data-stu-id="c1c59-174">Dataflow Block Completion</span></span>  
 <span data-ttu-id="c1c59-175">Los bloques de flujo de datos también admiten el concepto de *finalización*.</span><span class="sxs-lookup"><span data-stu-id="c1c59-175">Dataflow blocks also support the concept of *completion*.</span></span> <span data-ttu-id="c1c59-176">Un bloque de flujo de datos que está en estado completado no realiza ningún trabajo posterior.</span><span class="sxs-lookup"><span data-stu-id="c1c59-176">A dataflow block that is in the completed state does not perform any further work.</span></span> <span data-ttu-id="c1c59-177">Cada bloque de flujo de datos tiene un objeto <xref:System.Threading.Tasks.Task?displayProperty=nameWithType> asociado, conocido como *tarea de finalización*, que representa el estado de finalización del bloque.</span><span class="sxs-lookup"><span data-stu-id="c1c59-177">Each dataflow block has an associated <xref:System.Threading.Tasks.Task?displayProperty=nameWithType> object, known as a *completion task*, that represents the completion status of the block.</span></span> <span data-ttu-id="c1c59-178">Dado que para finalizar se puede esperar un objeto <xref:System.Threading.Tasks.Task>, mediante tareas de finalización, para finalizar se pueden esperar uno o más nodos terminales de una red de flujo de datos.</span><span class="sxs-lookup"><span data-stu-id="c1c59-178">Because you can wait for a <xref:System.Threading.Tasks.Task> object to finish, by using completion tasks, you can wait for one or more terminal nodes of a dataflow network to finish.</span></span> <span data-ttu-id="c1c59-179">La interfaz <xref:System.Threading.Tasks.Dataflow.IDataflowBlock> define el método <xref:System.Threading.Tasks.Dataflow.IDataflowBlock.Complete%2A>, que informa al bloque de flujo de datos de una solicitud para que se complete, y la propiedad <xref:System.Threading.Tasks.Dataflow.IDataflowBlock.Completion%2A>, que devuelve la tarea de finalización para el bloque de flujo de datos.</span><span class="sxs-lookup"><span data-stu-id="c1c59-179">The <xref:System.Threading.Tasks.Dataflow.IDataflowBlock> interface defines the <xref:System.Threading.Tasks.Dataflow.IDataflowBlock.Complete%2A> method, which informs the dataflow block of a request for it to complete, and the <xref:System.Threading.Tasks.Dataflow.IDataflowBlock.Completion%2A> property, which returns the completion task for the dataflow block.</span></span> <span data-ttu-id="c1c59-180">Tanto <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601> como <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601> heredan de la interfaz <xref:System.Threading.Tasks.Dataflow.IDataflowBlock>.</span><span class="sxs-lookup"><span data-stu-id="c1c59-180">Both <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601> and <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601> inherit the <xref:System.Threading.Tasks.Dataflow.IDataflowBlock> interface.</span></span>  
  
 <span data-ttu-id="c1c59-181">Hay dos maneras de determinar si un bloque de flujo de datos se completó sin error, encontró uno o más errores, o se canceló.</span><span class="sxs-lookup"><span data-stu-id="c1c59-181">There are two ways to determine whether a dataflow block completed without error, encountered one or more errors, or was canceled.</span></span> <span data-ttu-id="c1c59-182">La primera manera consiste en llamar al método <xref:System.Threading.Tasks.Task.Wait%2A?displayProperty=nameWithType> en la tarea de finalización en un bloque `try`-`catch` (`Try`-`Catch` en Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="c1c59-182">The first way is to call the <xref:System.Threading.Tasks.Task.Wait%2A?displayProperty=nameWithType> method on the completion task in a `try`-`catch` block (`Try`-`Catch` in Visual Basic).</span></span> <span data-ttu-id="c1c59-183">En el siguiente ejemplo se crea un objeto <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> que produce <xref:System.ArgumentOutOfRangeException> si su valor de entrada es menor que cero.</span><span class="sxs-lookup"><span data-stu-id="c1c59-183">The following example creates an <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> object that throws <xref:System.ArgumentOutOfRangeException> if its input value is less than zero.</span></span> <span data-ttu-id="c1c59-184"><xref:System.AggregateException> se produce cuando este ejemplo llama a <xref:System.Threading.Tasks.Task.Wait%2A> en la tarea de finalización.</span><span class="sxs-lookup"><span data-stu-id="c1c59-184"><xref:System.AggregateException> is thrown when this example calls <xref:System.Threading.Tasks.Task.Wait%2A> on the completion task.</span></span> <span data-ttu-id="c1c59-185">Se obtiene acceso a <xref:System.ArgumentOutOfRangeException> mediante la propiedad <xref:System.AggregateException.InnerExceptions%2A> del objeto <xref:System.AggregateException>.</span><span class="sxs-lookup"><span data-stu-id="c1c59-185">The <xref:System.ArgumentOutOfRangeException> is accessed through the <xref:System.AggregateException.InnerExceptions%2A> property of the <xref:System.AggregateException> object.</span></span>  
  
 [!code-csharp[TPLDataflow_Overview#10](../../../samples/snippets/csharp/VS_Snippets_Misc/tpldataflow_overview/cs/program.cs#10)]
 [!code-vb[TPLDataflow_Overview#10](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpldataflow_overview/vb/program.vb#10)]  
  
 <span data-ttu-id="c1c59-186">En este ejemplo se muestra el caso en el que una excepción no está controlada en el delegado de un bloque de flujo de datos de ejecución.</span><span class="sxs-lookup"><span data-stu-id="c1c59-186">This example demonstrates the case in which an exception goes unhandled in the delegate of an execution dataflow block.</span></span> <span data-ttu-id="c1c59-187">Se recomienda controlar las excepciones en los cuerpos de estos bloques.</span><span class="sxs-lookup"><span data-stu-id="c1c59-187">We recommend that you handle exceptions in the bodies of such blocks.</span></span> <span data-ttu-id="c1c59-188">Sin embargo, si no puede hacerlo, el bloque se comporta como si estuviera cancelado y no procesa los mensajes entrantes.</span><span class="sxs-lookup"><span data-stu-id="c1c59-188">However, if you are unable to do so, the block behaves as though it was canceled and does not process incoming messages.</span></span>  
  
 <span data-ttu-id="c1c59-189">Cuando un bloque de flujo de datos se cancela explícitamente, el objeto <xref:System.AggregateException> contiene <xref:System.OperationCanceledException> en la propiedad <xref:System.AggregateException.InnerExceptions%2A>.</span><span class="sxs-lookup"><span data-stu-id="c1c59-189">When a dataflow block is canceled explicitly, the <xref:System.AggregateException> object contains <xref:System.OperationCanceledException> in the <xref:System.AggregateException.InnerExceptions%2A> property.</span></span> <span data-ttu-id="c1c59-190">Para obtener más información sobre la cancelación del flujo de datos, vea la sección [Habilitar la cancelación](#enabling-cancellation).</span><span class="sxs-lookup"><span data-stu-id="c1c59-190">For more information about dataflow cancellation, see [Enabling Cancellation](#enabling-cancellation) section.</span></span>  
  
 <span data-ttu-id="c1c59-191">La segunda manera de determinar el estado de finalización de un bloque de flujo de datos es usar una continuación de la tarea de finalización o utilizar las características de lenguaje asincrónicas de C# y Visual Basic para esperar a la tarea de finalización de forma asincrónica.</span><span class="sxs-lookup"><span data-stu-id="c1c59-191">The second way to determine the completion status of a dataflow block is to use a continuation of the completion task, or to use the asynchronous language features of C# and Visual Basic to asynchronously wait for the completion task.</span></span> <span data-ttu-id="c1c59-192">El delegado que se proporciona al método <xref:System.Threading.Tasks.Task.ContinueWith%2A?displayProperty=nameWithType> toma un objeto <xref:System.Threading.Tasks.Task> que representa la tarea anterior.</span><span class="sxs-lookup"><span data-stu-id="c1c59-192">The delegate that you provide to the <xref:System.Threading.Tasks.Task.ContinueWith%2A?displayProperty=nameWithType> method takes a <xref:System.Threading.Tasks.Task> object that represents the antecedent task.</span></span> <span data-ttu-id="c1c59-193">En el caso de la propiedad <xref:System.Threading.Tasks.Dataflow.IDataflowBlock.Completion%2A>, el delegado de continuación toma la propia tarea de finalización.</span><span class="sxs-lookup"><span data-stu-id="c1c59-193">In the case of the <xref:System.Threading.Tasks.Dataflow.IDataflowBlock.Completion%2A> property, the delegate for the continuation takes the completion task itself.</span></span> <span data-ttu-id="c1c59-194">El siguiente ejemplo se parece el anterior, con la salvedad de que también utiliza el método <xref:System.Threading.Tasks.Task.ContinueWith%2A> para crear una tarea de continuación que imprime el estado de la operación total de flujo de datos.</span><span class="sxs-lookup"><span data-stu-id="c1c59-194">The following example resembles the previous one, except that it also uses the <xref:System.Threading.Tasks.Task.ContinueWith%2A> method to create a continuation task that prints the status of the overall dataflow operation.</span></span>  
  
 [!code-csharp[TPLDataflow_Overview#11](../../../samples/snippets/csharp/VS_Snippets_Misc/tpldataflow_overview/cs/program.cs#11)]
 [!code-vb[TPLDataflow_Overview#11](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpldataflow_overview/vb/program.vb#11)]  
  
 <span data-ttu-id="c1c59-195">También puede usar propiedades como <xref:System.Threading.Tasks.Task.IsCanceled%2A> en el cuerpo de la tarea de continuación para determinar información adicional sobre el estado de finalización de un bloque de flujo de datos.</span><span class="sxs-lookup"><span data-stu-id="c1c59-195">You can also use properties such as <xref:System.Threading.Tasks.Task.IsCanceled%2A> in the body of the continuation task to determine additional information about the completion status of a dataflow block.</span></span> <span data-ttu-id="c1c59-196">Para obtener más información sobre las tareas de continuación y cómo se relacionan con la cancelación y el control de errores, vea [Encadenar tareas mediante tareas de continuación](chaining-tasks-by-using-continuation-tasks.md), [Cancelación de tareas](task-cancellation.md) y [Control de excepciones](exception-handling-task-parallel-library.md).</span><span class="sxs-lookup"><span data-stu-id="c1c59-196">For more information about continuation tasks and how they relate to cancellation and error handling, see [Chaining Tasks by Using Continuation Tasks](chaining-tasks-by-using-continuation-tasks.md), [Task Cancellation](task-cancellation.md), and [Exception Handling](exception-handling-task-parallel-library.md).</span></span>  

## <a name="predefined-dataflow-block-types"></a><span data-ttu-id="c1c59-197">Tipos de bloques de flujo de datos predefinidos</span><span class="sxs-lookup"><span data-stu-id="c1c59-197">Predefined Dataflow Block Types</span></span>  
 <span data-ttu-id="c1c59-198">La biblioteca de flujos de datos TPL proporciona varios tipos de bloques de flujo de datos predefinidos.</span><span class="sxs-lookup"><span data-stu-id="c1c59-198">The TPL Dataflow Library provides several predefined dataflow block types.</span></span> <span data-ttu-id="c1c59-199">Estos tipos se dividen en tres categorías: *bloques de almacenamiento en búfer*, *bloques de ejecución* y *bloques de agrupación*.</span><span class="sxs-lookup"><span data-stu-id="c1c59-199">These types are divided into three categories: *buffering blocks*, *execution blocks*, and *grouping blocks*.</span></span> <span data-ttu-id="c1c59-200">En las secciones siguientes se describen los tipos de bloques que componen estas categorías.</span><span class="sxs-lookup"><span data-stu-id="c1c59-200">The following sections describe the block types that make up these categories.</span></span>  
  
### <a name="buffering-blocks"></a><span data-ttu-id="c1c59-201">Bloques de almacenamiento en búfer</span><span class="sxs-lookup"><span data-stu-id="c1c59-201">Buffering Blocks</span></span>  
 <span data-ttu-id="c1c59-202">Los bloques de almacenamiento en búfer contiene datos para su uso por los consumidores de datos.</span><span class="sxs-lookup"><span data-stu-id="c1c59-202">Buffering blocks hold data for use by data consumers.</span></span> <span data-ttu-id="c1c59-203">La biblioteca de flujos de datos TPL proporciona tres tipos de bloques de almacenamiento en búfer: <xref:System.Threading.Tasks.Dataflow.BufferBlock%601?displayProperty=nameWithType>, <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601?displayProperty=nameWithType> y <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="c1c59-203">The TPL Dataflow Library provides three buffering block types: <xref:System.Threading.Tasks.Dataflow.BufferBlock%601?displayProperty=nameWithType>, <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601?displayProperty=nameWithType>, and <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601?displayProperty=nameWithType>.</span></span>  
  
#### <a name="bufferblockt"></a><span data-ttu-id="c1c59-204">BufferBlock(T)</span><span class="sxs-lookup"><span data-stu-id="c1c59-204">BufferBlock(T)</span></span>  
 <span data-ttu-id="c1c59-205">La clase <xref:System.Threading.Tasks.Dataflow.BufferBlock%601> representa una estructura de mensajería asincrónica de uso general.</span><span class="sxs-lookup"><span data-stu-id="c1c59-205">The <xref:System.Threading.Tasks.Dataflow.BufferBlock%601> class represents a general-purpose asynchronous messaging structure.</span></span> <span data-ttu-id="c1c59-206">Esta clase almacena una cola FIFO (primero en entrar, primero en salir) de mensajes donde varios orígenes pueden escribir o de los que varios destinos pueden leer.</span><span class="sxs-lookup"><span data-stu-id="c1c59-206">This class stores a first in, first out (FIFO) queue of messages that can be written to by multiple sources or read from by multiple targets.</span></span> <span data-ttu-id="c1c59-207">Cuando un destino recibe un mensaje de un objeto <xref:System.Threading.Tasks.Dataflow.BufferBlock%601>, ese mensaje se quita de la cola de mensajes.</span><span class="sxs-lookup"><span data-stu-id="c1c59-207">When a target receives a message from a <xref:System.Threading.Tasks.Dataflow.BufferBlock%601> object, that message is removed from the message queue.</span></span> <span data-ttu-id="c1c59-208">Por tanto, aunque un objeto <xref:System.Threading.Tasks.Dataflow.BufferBlock%601> puede tener varios destinos, solo uno recibirá cada mensaje.</span><span class="sxs-lookup"><span data-stu-id="c1c59-208">Therefore, although a <xref:System.Threading.Tasks.Dataflow.BufferBlock%601> object can have multiple targets, only one target will receive each message.</span></span> <span data-ttu-id="c1c59-209">La clase <xref:System.Threading.Tasks.Dataflow.BufferBlock%601> resulta útil si desea pasar varios mensajes a otro componente, y ese componente debe recibir cada mensaje.</span><span class="sxs-lookup"><span data-stu-id="c1c59-209">The <xref:System.Threading.Tasks.Dataflow.BufferBlock%601> class is useful when you want to pass multiple messages to another component, and that component must receive each message.</span></span>  
  
 <span data-ttu-id="c1c59-210">En el siguiente ejemplo básico se exponen varios valores <xref:System.Int32> a un objeto <xref:System.Threading.Tasks.Dataflow.BufferBlock%601> y después se leen esos valores desde ese objeto.</span><span class="sxs-lookup"><span data-stu-id="c1c59-210">The following basic example posts several <xref:System.Int32> values to a <xref:System.Threading.Tasks.Dataflow.BufferBlock%601> object and then reads those values back from that object.</span></span>  
  
 [!code-csharp[TPLDataflow_Overview#1](../../../samples/snippets/csharp/VS_Snippets_Misc/tpldataflow_overview/cs/program.cs#1)]
 [!code-vb[TPLDataflow_Overview#1](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpldataflow_overview/vb/program.vb#1)]  
  
 <span data-ttu-id="c1c59-211">Para obtener un ejemplo completo que muestra cómo escribir mensajes y leer mensajes desde un objeto <xref:System.Threading.Tasks.Dataflow.BufferBlock%601>, vea el artículo sobre [escritura y lectura de mensajes en un bloque de flujo de datos](how-to-write-messages-to-and-read-messages-from-a-dataflow-block.md).</span><span class="sxs-lookup"><span data-stu-id="c1c59-211">For a complete example that demonstrates how to write messages to and read messages from a <xref:System.Threading.Tasks.Dataflow.BufferBlock%601> object, see [How to: Write Messages to and Read Messages from a Dataflow Block](how-to-write-messages-to-and-read-messages-from-a-dataflow-block.md).</span></span>  
  
#### <a name="broadcastblockt"></a><span data-ttu-id="c1c59-212">BroadcastBlock(T)</span><span class="sxs-lookup"><span data-stu-id="c1c59-212">BroadcastBlock(T)</span></span>  
 <span data-ttu-id="c1c59-213">La clase <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601> resulta útil si debe pasar varios mensajes a otro componente, pero este componente solo necesita el valor más reciente.</span><span class="sxs-lookup"><span data-stu-id="c1c59-213">The <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601> class is useful when you must pass multiple messages to another component, but that component needs only the most recent value.</span></span> <span data-ttu-id="c1c59-214">Esta clase también resulta útil si desea difundir un mensaje a varios componentes.</span><span class="sxs-lookup"><span data-stu-id="c1c59-214">This class is also useful when you want to broadcast a message to multiple components.</span></span>  
  
 <span data-ttu-id="c1c59-215">En el siguiente ejemplo básico se publica un valor <xref:System.Double> a un objeto <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601> y después se lee ese valor desde el objeto varias veces.</span><span class="sxs-lookup"><span data-stu-id="c1c59-215">The following basic example posts a <xref:System.Double> value to a <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601> object and then reads that value back from that object several times.</span></span> <span data-ttu-id="c1c59-216">Dado que los valores no se quitan de los objetos <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601> después de leerlos, el mismo valor está disponible cada vez.</span><span class="sxs-lookup"><span data-stu-id="c1c59-216">Because values are not removed from <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601> objects after they are read, the same value is available every time.</span></span>  
  
 [!code-csharp[TPLDataflow_Overview#2](../../../samples/snippets/csharp/VS_Snippets_Misc/tpldataflow_overview/cs/program.cs#2)]
 [!code-vb[TPLDataflow_Overview#2](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpldataflow_overview/vb/program.vb#2)]  
  
 <span data-ttu-id="c1c59-217">Para obtener un ejemplo completo de cómo usar <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601> para difundir un mensaje a varios bloques de destino, vea el artículo que explica cómo [especificar un programador de tareas en un bloque de flujo de datos](how-to-specify-a-task-scheduler-in-a-dataflow-block.md).</span><span class="sxs-lookup"><span data-stu-id="c1c59-217">For a complete example that demonstrates how to use <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601> to broadcast a message to multiple target blocks, see [How to: Specify a Task Scheduler in a Dataflow Block](how-to-specify-a-task-scheduler-in-a-dataflow-block.md).</span></span>  
  
#### <a name="writeonceblockt"></a><span data-ttu-id="c1c59-218">WriteOnceBlock(T)</span><span class="sxs-lookup"><span data-stu-id="c1c59-218">WriteOnceBlock(T)</span></span>  
 <span data-ttu-id="c1c59-219">La clase <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> se asemeja a la clase <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601>, salvo que un objeto <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> se puede escribir una sola una vez.</span><span class="sxs-lookup"><span data-stu-id="c1c59-219">The <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> class resembles the <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601> class, except that a <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> object can be written to one time only.</span></span> <span data-ttu-id="c1c59-220">Puede pensar que <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> es similar a la palabra clave de C# [readonly](../../csharp/language-reference/keywords/readonly.md) ([Readonly](../../visual-basic/language-reference/modifiers/readonly.md) en Visual Basic), salvo que un objeto <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> se vuelve inalterable después de recibir un valor en lugar de una construcción.</span><span class="sxs-lookup"><span data-stu-id="c1c59-220">You can think of <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> as being similar to the C# [readonly](../../csharp/language-reference/keywords/readonly.md) ([ReadOnly](../../visual-basic/language-reference/modifiers/readonly.md) in Visual Basic) keyword, except that a <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> object becomes immutable after it receives a value instead of at construction.</span></span> <span data-ttu-id="c1c59-221">Al igual que la clase <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601>, cuando un destino recibe un mensaje de un objeto <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601>, el mensaje no se quita de dicho objeto.</span><span class="sxs-lookup"><span data-stu-id="c1c59-221">Like the <xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601> class, when a target receives a message from a <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> object, that message is not removed from that object.</span></span> <span data-ttu-id="c1c59-222">Por tanto, varios destinos reciben una copia del mensaje.</span><span class="sxs-lookup"><span data-stu-id="c1c59-222">Therefore, multiple targets receive a copy of the message.</span></span> <span data-ttu-id="c1c59-223">La clase <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> es útil si desea difundir solamente el primero de varios de mensajes.</span><span class="sxs-lookup"><span data-stu-id="c1c59-223">The <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> class is useful when you want to propagate only the first of multiple messages.</span></span>  
  
 <span data-ttu-id="c1c59-224">En el siguiente ejemplo básico se exponen varios valores <xref:System.String> a un objeto <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> y después se lee ese valor desde el objeto.</span><span class="sxs-lookup"><span data-stu-id="c1c59-224">The following basic example posts multiple <xref:System.String> values to a <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> object and then reads the value back from that object.</span></span> <span data-ttu-id="c1c59-225">Dado que un objeto <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> solo se puede escribir una vez, a partir de que un objeto <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> recibe un mensaje, ese objeto descarta los mensajes subsiguientes.</span><span class="sxs-lookup"><span data-stu-id="c1c59-225">Because a <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> object can be written to one time only, after a <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> object receives a message, it discards subsequent messages.</span></span>  
  
 [!code-csharp[TPLDataflow_Overview#3](../../../samples/snippets/csharp/VS_Snippets_Misc/tpldataflow_overview/cs/program.cs#3)]
 [!code-vb[TPLDataflow_Overview#3](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpldataflow_overview/vb/program.vb#3)]  
  
 <span data-ttu-id="c1c59-226">Para obtener un ejemplo completo que muestra cómo usar <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> para recibir el valor de la primera operación que termina, vea el artículo sobre [desvinculación de bloques de flujos de datos](how-to-unlink-dataflow-blocks.md).</span><span class="sxs-lookup"><span data-stu-id="c1c59-226">For a complete example that demonstrates how to use <xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601> to receive the value of the first operation that finishes, see [How to: Unlink Dataflow Blocks](how-to-unlink-dataflow-blocks.md).</span></span>  
  
### <a name="execution-blocks"></a><span data-ttu-id="c1c59-227">Bloques de ejecución</span><span class="sxs-lookup"><span data-stu-id="c1c59-227">Execution Blocks</span></span>  
 <span data-ttu-id="c1c59-228">Los bloques de ejecución llaman a un delegado proporcionado por el usuario para cada fragmento de datos recibidos.</span><span class="sxs-lookup"><span data-stu-id="c1c59-228">Execution blocks call a user-provided delegate for each piece of received data.</span></span> <span data-ttu-id="c1c59-229">La biblioteca de flujos de datos TPL proporciona tres tipos de bloques de ejecución: <xref:System.Threading.Tasks.Dataflow.ActionBlock%601>, <xref:System.Threading.Tasks.Dataflow.TransformBlock%602?displayProperty=nameWithType> y <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="c1c59-229">The TPL Dataflow Library provides three execution block types: <xref:System.Threading.Tasks.Dataflow.ActionBlock%601>, <xref:System.Threading.Tasks.Dataflow.TransformBlock%602?displayProperty=nameWithType>, and <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602?displayProperty=nameWithType>.</span></span>  
  
#### <a name="actionblockt"></a><span data-ttu-id="c1c59-230">ActionBlock(T)</span><span class="sxs-lookup"><span data-stu-id="c1c59-230">ActionBlock(T)</span></span>  
 <span data-ttu-id="c1c59-231">La clase <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> es un bloque de destino que llama a un delegado cuando recibe datos.</span><span class="sxs-lookup"><span data-stu-id="c1c59-231">The <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> class is a target block that calls a delegate when it receives data.</span></span> <span data-ttu-id="c1c59-232">Piense en un objeto <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> como un delegado que se ejecuta de forma asincrónica cuando los datos están disponibles.</span><span class="sxs-lookup"><span data-stu-id="c1c59-232">Think of a <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> object as a delegate that runs asynchronously when data becomes available.</span></span> <span data-ttu-id="c1c59-233">El delegado que se proporciona a un objeto <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> puede ser de tipo <xref:System.Action%601> o tipo `System.Func<TInput, Task>`.</span><span class="sxs-lookup"><span data-stu-id="c1c59-233">The delegate that you provide to an <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> object can be of type <xref:System.Action%601> or type `System.Func<TInput, Task>`.</span></span> <span data-ttu-id="c1c59-234">Si se utiliza un objeto <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> con <xref:System.Action%601>, se considera que el procesamiento de cada elemento de entrada se ha completado cuando devuelve el delegado.</span><span class="sxs-lookup"><span data-stu-id="c1c59-234">When you use an <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> object with <xref:System.Action%601>, processing of each input element is considered completed when the delegate returns.</span></span> <span data-ttu-id="c1c59-235">Si se utiliza un objeto <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> con `System.Func<TInput, Task>`, se considera que el procesamiento de cada elemento de entrada se ha completado solamente cuando el objeto devuelto <xref:System.Threading.Tasks.Task> está completo.</span><span class="sxs-lookup"><span data-stu-id="c1c59-235">When you use an <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> object with `System.Func<TInput, Task>`, processing of each input element is considered completed only when the returned <xref:System.Threading.Tasks.Task> object is completed.</span></span> <span data-ttu-id="c1c59-236">Mediante estos dos mecanismos, se puede utilizar <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> para el procesamiento sincrónico y asincrónico de cada elemento de entrada.</span><span class="sxs-lookup"><span data-stu-id="c1c59-236">By using these two mechanisms, you can use <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> for both synchronous and asynchronous processing of each input element.</span></span>  
  
 <span data-ttu-id="c1c59-237">En el siguiente ejemplo básico se exponen varios valores <xref:System.Int32> a un objeto <xref:System.Threading.Tasks.Dataflow.ActionBlock%601>.</span><span class="sxs-lookup"><span data-stu-id="c1c59-237">The following basic example posts multiple <xref:System.Int32> values to an <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> object.</span></span> <span data-ttu-id="c1c59-238">El objeto <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> imprime esos valores en la consola.</span><span class="sxs-lookup"><span data-stu-id="c1c59-238">The <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> object prints those values to the console.</span></span> <span data-ttu-id="c1c59-239">Después, en este ejemplo se establece el bloque en estado completado y se espera hasta que finalicen todas las tareas de flujo de datos.</span><span class="sxs-lookup"><span data-stu-id="c1c59-239">This example then sets the block to the completed state and waits for all dataflow tasks to finish.</span></span>  
  
 [!code-csharp[TPLDataflow_Overview#4](../../../samples/snippets/csharp/VS_Snippets_Misc/tpldataflow_overview/cs/program.cs#4)]
 [!code-vb[TPLDataflow_Overview#4](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpldataflow_overview/vb/program.vb#4)]  
  
 <span data-ttu-id="c1c59-240">Para obtener ejemplos completos que muestran cómo usar delegados con la clase <xref:System.Threading.Tasks.Dataflow.ActionBlock%601>, vea el artículo que explica [cómo realizar una acción cuando un bloque de flujo de datos recibe datos](how-to-perform-action-when-a-dataflow-block-receives-data.md).</span><span class="sxs-lookup"><span data-stu-id="c1c59-240">For complete examples that demonstrate how to use delegates with the <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> class, see [How to: Perform Action When a Dataflow Block Receives Data](how-to-perform-action-when-a-dataflow-block-receives-data.md).</span></span>  
  
#### <a name="transformblocktinput-toutput"></a><span data-ttu-id="c1c59-241">TransformBlock(TInput, TOutput)</span><span class="sxs-lookup"><span data-stu-id="c1c59-241">TransformBlock(TInput, TOutput)</span></span>  
 <span data-ttu-id="c1c59-242">La clase <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> es similar a la clase <xref:System.Threading.Tasks.Dataflow.ActionBlock%601>, salvo que actúa como origen y como destino.</span><span class="sxs-lookup"><span data-stu-id="c1c59-242">The <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> class resembles the <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> class, except that it acts as both a source and as a target.</span></span> <span data-ttu-id="c1c59-243">El delegado que pasa a un objeto <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> devuelve un valor de tipo `TOutput`.</span><span class="sxs-lookup"><span data-stu-id="c1c59-243">The delegate that you pass to a <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> object returns a value of type `TOutput`.</span></span> <span data-ttu-id="c1c59-244">El delegado que se proporciona a un objeto <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> puede ser de tipo `System.Func<TInput, TOutput>` o tipo `System.Func<TInput, Task<TOutput>>`.</span><span class="sxs-lookup"><span data-stu-id="c1c59-244">The delegate that you provide to a <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> object can be of type `System.Func<TInput, TOutput>` or type `System.Func<TInput, Task<TOutput>>`.</span></span> <span data-ttu-id="c1c59-245">Si se utiliza un objeto <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> con `System.Func<TInput, TOutput>`, se considera que el procesamiento de cada elemento de entrada se ha completado cuando devuelve el delegado.</span><span class="sxs-lookup"><span data-stu-id="c1c59-245">When you use a <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> object with `System.Func<TInput, TOutput>`, processing of each input element is considered completed when the delegate returns.</span></span> <span data-ttu-id="c1c59-246">Si se utiliza un objeto <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> que se usa con `System.Func<TInput, Task<TOutput>>`, se considera que el procesamiento de cada elemento de entrada se ha completado solamente cuando el objeto devuelto <xref:System.Threading.Tasks.Task%601> está completo.</span><span class="sxs-lookup"><span data-stu-id="c1c59-246">When you use a <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> object used with `System.Func<TInput, Task<TOutput>>`, processing of each input element is considered completed only when the returned <xref:System.Threading.Tasks.Task%601> object is completed.</span></span> <span data-ttu-id="c1c59-247">Al igual que sucede con <xref:System.Threading.Tasks.Dataflow.ActionBlock%601>, mediante estos dos mecanismos, se puede utilizar <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> para el procesamiento sincrónico y asincrónico de cada elemento de entrada.</span><span class="sxs-lookup"><span data-stu-id="c1c59-247">As with <xref:System.Threading.Tasks.Dataflow.ActionBlock%601>, by using these two mechanisms, you can use <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> for both synchronous and asynchronous processing of each input element.</span></span>  
  
 <span data-ttu-id="c1c59-248">En el siguiente ejemplo básico se crea un objeto <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> que calcula la raíz cuadrada de la entrada.</span><span class="sxs-lookup"><span data-stu-id="c1c59-248">The following basic example creates a <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> object that computes the square root of its input.</span></span> <span data-ttu-id="c1c59-249">El objeto <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> toma valores <xref:System.Int32> como entrada y genera valores <xref:System.Double> como salida.</span><span class="sxs-lookup"><span data-stu-id="c1c59-249">The <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> object takes <xref:System.Int32> values as input and produces <xref:System.Double> values as output.</span></span>  
  
 [!code-csharp[TPLDataflow_Overview#5](../../../samples/snippets/csharp/VS_Snippets_Misc/tpldataflow_overview/cs/program.cs#5)]
 [!code-vb[TPLDataflow_Overview#5](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpldataflow_overview/vb/program.vb#5)]  
  
 <span data-ttu-id="c1c59-250">Para obtener ejemplos completos que usan <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> en una red de bloques de flujo de datos que realiza procesamiento de imágenes en una aplicación de Windows Forms, vea el artículo sobre [uso de flujo de datos en una aplicación de Windows Forms](walkthrough-using-dataflow-in-a-windows-forms-application.md).</span><span class="sxs-lookup"><span data-stu-id="c1c59-250">For complete examples that uses <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> in a network of dataflow blocks that performs image processing in a Windows Forms application, see [Walkthrough: Using Dataflow in a Windows Forms Application](walkthrough-using-dataflow-in-a-windows-forms-application.md).</span></span>  
  
#### <a name="transformmanyblocktinput-toutput"></a><span data-ttu-id="c1c59-251">TransformManyBlock(TInput, TOutput)</span><span class="sxs-lookup"><span data-stu-id="c1c59-251">TransformManyBlock(TInput, TOutput)</span></span>  
 <span data-ttu-id="c1c59-252">La clase <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> es similar a la clase <xref:System.Threading.Tasks.Dataflow.TransformBlock%602>, salvo que <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> genere cero o más valores de salida por cada valor de entrada, en lugar de generar un solo valor de salida por cada valor de entrada.</span><span class="sxs-lookup"><span data-stu-id="c1c59-252">The <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> class resembles the <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> class, except that <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> produces zero or more output values for each input value, instead of only one output value for each input value.</span></span> <span data-ttu-id="c1c59-253">El delegado que se proporciona a un objeto <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> puede ser de tipo `System.Func<TInput, IEnumerable<TOutput>>` o tipo `System.Func<TInput, Task<IEnumerable<TOutput>>>`.</span><span class="sxs-lookup"><span data-stu-id="c1c59-253">The delegate that you provide to a <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> object can be of type `System.Func<TInput, IEnumerable<TOutput>>` or type `System.Func<TInput, Task<IEnumerable<TOutput>>>`.</span></span> <span data-ttu-id="c1c59-254">Si se utiliza un objeto <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> con `System.Func<TInput, IEnumerable<TOutput>>`, se considera que el procesamiento de cada elemento de entrada se ha completado cuando devuelve el delegado.</span><span class="sxs-lookup"><span data-stu-id="c1c59-254">When you use a <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> object with `System.Func<TInput, IEnumerable<TOutput>>`, processing of each input element is considered completed when the delegate returns.</span></span> <span data-ttu-id="c1c59-255">Si se utiliza un objeto <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> con `System.Func<TInput, Task<IEnumerable<TOutput>>>`, se considera que el procesamiento de cada elemento de entrada se ha completado solo cuando el objeto devuelto `System.Threading.Tasks.Task<IEnumerable<TOutput>>` está completo.</span><span class="sxs-lookup"><span data-stu-id="c1c59-255">When you use a <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> object with `System.Func<TInput, Task<IEnumerable<TOutput>>>`, processing of each input element is considered complete only when the returned `System.Threading.Tasks.Task<IEnumerable<TOutput>>` object is completed.</span></span>  
  
 <span data-ttu-id="c1c59-256">En el siguiente ejemplo básico se crea un objeto <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> que divide las cadenas en sus secuencias de caracteres individuales.</span><span class="sxs-lookup"><span data-stu-id="c1c59-256">The following basic example creates a <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> object that splits strings into their individual character sequences.</span></span> <span data-ttu-id="c1c59-257">El objeto <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> toma valores <xref:System.String> como entrada y genera valores <xref:System.Char> como salida.</span><span class="sxs-lookup"><span data-stu-id="c1c59-257">The <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> object takes <xref:System.String> values as input and produces <xref:System.Char> values as output.</span></span>  
  
 [!code-csharp[TPLDataflow_Overview#6](../../../samples/snippets/csharp/VS_Snippets_Misc/tpldataflow_overview/cs/program.cs#6)]
 [!code-vb[TPLDataflow_Overview#6](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpldataflow_overview/vb/program.vb#6)]  
  
 <span data-ttu-id="c1c59-258">Para obtener ejemplos completos que usan <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> para generar varias salidas independientes para cada entrada en una canalización de flujo de datos, vea el [tutorial sobre creación de una canalización de flujo de datos](walkthrough-creating-a-dataflow-pipeline.md).</span><span class="sxs-lookup"><span data-stu-id="c1c59-258">For complete examples that use <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> to produce multiple independent outputs for each input in a dataflow pipeline, see [Walkthrough: Creating a Dataflow Pipeline](walkthrough-creating-a-dataflow-pipeline.md).</span></span>  
  
#### <a name="degree-of-parallelism"></a><span data-ttu-id="c1c59-259">Grado de paralelismo</span><span class="sxs-lookup"><span data-stu-id="c1c59-259">Degree of Parallelism</span></span>  
 <span data-ttu-id="c1c59-260">Cada uno de los objetos <xref:System.Threading.Tasks.Dataflow.ActionBlock%601>, <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> y <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> almacena en búfer los mensajes de entrada hasta que el bloque está listo para procesarlos.</span><span class="sxs-lookup"><span data-stu-id="c1c59-260">Every <xref:System.Threading.Tasks.Dataflow.ActionBlock%601>, <xref:System.Threading.Tasks.Dataflow.TransformBlock%602>, and <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> object buffers input messages until the block is ready to process them.</span></span> <span data-ttu-id="c1c59-261">De forma predeterminada, estas clases procesan los mensajes en el orden en el que se recibieron, un mensaje cada vez.</span><span class="sxs-lookup"><span data-stu-id="c1c59-261">By default, these classes process messages in the order in which they are received, one message at a time.</span></span> <span data-ttu-id="c1c59-262">También puede especificar el grado de paralelismo para permitir que los objetos <xref:System.Threading.Tasks.Dataflow.ActionBlock%601>, <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> y <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> puedan procesar varios mensajes simultáneamente.</span><span class="sxs-lookup"><span data-stu-id="c1c59-262">You can also specify the degree of parallelism to enable <xref:System.Threading.Tasks.Dataflow.ActionBlock%601>, <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> and <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> objects to process multiple messages concurrently.</span></span> <span data-ttu-id="c1c59-263">Para obtener más información sobre la ejecución simultánea, vea la sección Especificar el grado de paralelismo más adelante en este documento.</span><span class="sxs-lookup"><span data-stu-id="c1c59-263">For more information about concurrent execution, see the section Specifying the Degree of Parallelism later in this document.</span></span> <span data-ttu-id="c1c59-264">Para ver un ejemplo que establece el grado de paralelismo para permitir que un bloque de flujo de datos de ejecución pueda procesar varios mensajes al mismo tiempo, consulte [How to: Specify the Degree of Parallelism in a Dataflow Block](how-to-specify-the-degree-of-parallelism-in-a-dataflow-block.md) (Cómo: Especificar el grado de paralelismo en un bloque de flujo de datos).</span><span class="sxs-lookup"><span data-stu-id="c1c59-264">For an example that sets the degree of parallelism to enable an execution dataflow block to process more than one message at a time, see [How to: Specify the Degree of Parallelism in a Dataflow Block](how-to-specify-the-degree-of-parallelism-in-a-dataflow-block.md).</span></span>  
  
#### <a name="summary-of-delegate-types"></a><span data-ttu-id="c1c59-265">Resumen de tipos de delegado</span><span class="sxs-lookup"><span data-stu-id="c1c59-265">Summary of Delegate Types</span></span>  
 <span data-ttu-id="c1c59-266">En la tabla siguiente se resumen los tipos de delegado que puede proporcionar a los objetos <xref:System.Threading.Tasks.Dataflow.ActionBlock%601>, <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> y <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602>.</span><span class="sxs-lookup"><span data-stu-id="c1c59-266">The following table summarizes the delegate types that you can provide to <xref:System.Threading.Tasks.Dataflow.ActionBlock%601>, <xref:System.Threading.Tasks.Dataflow.TransformBlock%602>, and <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602> objects.</span></span> <span data-ttu-id="c1c59-267">En esta tabla también se especifica si el tipo de delegado funciona de forma sincrónica o asincrónica.</span><span class="sxs-lookup"><span data-stu-id="c1c59-267">This table also specifies whether the delegate type operates synchronously or asynchronously.</span></span>  
  
|<span data-ttu-id="c1c59-268">Tipo</span><span class="sxs-lookup"><span data-stu-id="c1c59-268">Type</span></span>|<span data-ttu-id="c1c59-269">Tipo de delegado sincrónico</span><span class="sxs-lookup"><span data-stu-id="c1c59-269">Synchronous Delegate Type</span></span>|<span data-ttu-id="c1c59-270">Tipo de delegado asincrónico</span><span class="sxs-lookup"><span data-stu-id="c1c59-270">Asynchronous Delegate Type</span></span>|  
|----------|-------------------------------|--------------------------------|  
|<xref:System.Threading.Tasks.Dataflow.ActionBlock%601>|`System.Action`|`System.Func<TInput, Task>`|  
|<xref:System.Threading.Tasks.Dataflow.TransformBlock%602>|`System.Func<TInput, TOutput>`|`System.Func<TInput, Task<TOutput>>`|  
|<xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602>|`System.Func<TInput, IEnumerable<TOutput>>`|`System.Func<TInput, Task<IEnumerable<TOutput>>>`|  
  
 <span data-ttu-id="c1c59-271">También puede utilizar expresiones lambda cuando trabaja con tipos de bloque de ejecución.</span><span class="sxs-lookup"><span data-stu-id="c1c59-271">You can also use lambda expressions when you work with execution block types.</span></span> <span data-ttu-id="c1c59-272">Para ver un ejemplo que muestra cómo usar una expresión lambda con un bloque de ejecución, consulte [How to: Perform Action When a Dataflow Block Receives Data](how-to-perform-action-when-a-dataflow-block-receives-data.md) (Cómo: realizar una acción cuando un bloque de flujo de datos recibe datos).</span><span class="sxs-lookup"><span data-stu-id="c1c59-272">For an example that shows how to use a lambda expression with an execution block, see [How to: Perform Action When a Dataflow Block Receives Data](how-to-perform-action-when-a-dataflow-block-receives-data.md).</span></span>  
  
### <a name="grouping-blocks"></a><span data-ttu-id="c1c59-273">Bloques de agrupación</span><span class="sxs-lookup"><span data-stu-id="c1c59-273">Grouping Blocks</span></span>  
 <span data-ttu-id="c1c59-274">Los bloques de agrupación combinan datos de uno o más orígenes y con distintas restricciones.</span><span class="sxs-lookup"><span data-stu-id="c1c59-274">Grouping blocks combine data from one or more sources and under various constraints.</span></span> <span data-ttu-id="c1c59-275">La biblioteca de flujos de datos TPL proporciona tres tipos de bloques de combinación: <xref:System.Threading.Tasks.Dataflow.BatchBlock%601>, <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> y <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602>.</span><span class="sxs-lookup"><span data-stu-id="c1c59-275">The TPL Dataflow Library provides three join block types: <xref:System.Threading.Tasks.Dataflow.BatchBlock%601>, <xref:System.Threading.Tasks.Dataflow.JoinBlock%602>, and <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602>.</span></span>  
  
#### <a name="batchblockt"></a><span data-ttu-id="c1c59-276">BatchBlock(T)</span><span class="sxs-lookup"><span data-stu-id="c1c59-276">BatchBlock(T)</span></span>  
 <span data-ttu-id="c1c59-277">La clase <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> combina conjuntos de datos de entrada, que se conocen como lotes, en las matrices de datos de salida.</span><span class="sxs-lookup"><span data-stu-id="c1c59-277">The <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> class combines sets of input data, which are known as batches, into arrays of output data.</span></span> <span data-ttu-id="c1c59-278">Especifique el tamaño de cada lote cuando crea un objeto <xref:System.Threading.Tasks.Dataflow.BatchBlock%601>.</span><span class="sxs-lookup"><span data-stu-id="c1c59-278">You specify the size of each batch when you create a <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> object.</span></span> <span data-ttu-id="c1c59-279">Cuando el objeto <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> recibe el número especificado de elementos de entrada, propaga de forma asincrónica una matriz que contiene esos elementos.</span><span class="sxs-lookup"><span data-stu-id="c1c59-279">When the <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> object receives the specified count of input elements, it asynchronously propagates out an array that contains those elements.</span></span> <span data-ttu-id="c1c59-280">Si un objeto <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> se establece en el estado completado pero no contiene elementos suficientes para formar un lote, propaga una matriz final que contiene los elementos de entrada restantes.</span><span class="sxs-lookup"><span data-stu-id="c1c59-280">If a <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> object is set to the completed state but does not contain enough elements to form a batch, it propagates out a final array that contains the remaining input elements.</span></span>  
  
 <span data-ttu-id="c1c59-281">La clase <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> funciona en modo *expansivo* o *no expansivo*.</span><span class="sxs-lookup"><span data-stu-id="c1c59-281">The <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> class operates in either *greedy* or *non-greedy* mode.</span></span> <span data-ttu-id="c1c59-282">En modo expansivo, que es el valor predeterminado, un objeto <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> acepta cada mensaje que se proporciona y propaga una matriz después de recibir el número especificado de elementos.</span><span class="sxs-lookup"><span data-stu-id="c1c59-282">In greedy mode, which is the default, a <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> object accepts every message that it is offered and propagates out an array after it receives the specified count of elements.</span></span> <span data-ttu-id="c1c59-283">En modo no expansivo, un objeto <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> pospone todos los mensajes entrantes hasta que haya suficientes orígenes que proporcionen mensajes al bloque para formar un lote.</span><span class="sxs-lookup"><span data-stu-id="c1c59-283">In non-greedy mode, a <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> object postpones all incoming messages until enough sources have offered messages to the block to form a batch.</span></span> <span data-ttu-id="c1c59-284">Normalmente, el modo expansivo se comporta mejor que el modo no expansivo porque requiere menos sobrecarga de procesamiento.</span><span class="sxs-lookup"><span data-stu-id="c1c59-284">Greedy mode typically performs better than non-greedy mode because it requires less processing overhead.</span></span> <span data-ttu-id="c1c59-285">Sin embargo, se puede usar el modo no expansivo cuando se debe coordinar el consumo de varios orígenes en modo atómico.</span><span class="sxs-lookup"><span data-stu-id="c1c59-285">However, you can use non-greedy mode when you must coordinate consumption from multiple sources in an atomic fashion.</span></span> <span data-ttu-id="c1c59-286">Especifique el modo no expansivo estableciendo <xref:System.Threading.Tasks.Dataflow.GroupingDataflowBlockOptions.Greedy%2A> en `False` en el parámetro `dataflowBlockOptions` del constructor <xref:System.Threading.Tasks.Dataflow.BatchBlock%601.%23ctor%2A>.</span><span class="sxs-lookup"><span data-stu-id="c1c59-286">Specify non-greedy mode by setting <xref:System.Threading.Tasks.Dataflow.GroupingDataflowBlockOptions.Greedy%2A> to `False` in the `dataflowBlockOptions` parameter in the <xref:System.Threading.Tasks.Dataflow.BatchBlock%601.%23ctor%2A> constructor.</span></span>  
  
 <span data-ttu-id="c1c59-287">En el siguiente ejemplo básico se exponen varios valores <xref:System.Int32> a un objeto <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> que contiene diez elementos en un lote.</span><span class="sxs-lookup"><span data-stu-id="c1c59-287">The following basic example posts several <xref:System.Int32> values to a <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> object that holds ten elements in a batch.</span></span> <span data-ttu-id="c1c59-288">Para garantizar que todos los valores se propagan fuera de <xref:System.Threading.Tasks.Dataflow.BatchBlock%601>, este ejemplo llama al método <xref:System.Threading.Tasks.Dataflow.IDataflowBlock.Complete%2A>.</span><span class="sxs-lookup"><span data-stu-id="c1c59-288">To guarantee that all values propagate out of the <xref:System.Threading.Tasks.Dataflow.BatchBlock%601>, this example calls the <xref:System.Threading.Tasks.Dataflow.IDataflowBlock.Complete%2A> method.</span></span> <span data-ttu-id="c1c59-289">El método <xref:System.Threading.Tasks.Dataflow.IDataflowBlock.Complete%2A> establece el objeto <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> en el estado completado y, por consiguiente, el objeto <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> propaga cualquier elemento restante como un lote final.</span><span class="sxs-lookup"><span data-stu-id="c1c59-289">The <xref:System.Threading.Tasks.Dataflow.IDataflowBlock.Complete%2A> method sets the <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> object to the completed state, and therefore, the <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> object propagates out any remaining elements as a final batch.</span></span>  
  
 [!code-csharp[TPLDataflow_Overview#7](../../../samples/snippets/csharp/VS_Snippets_Misc/tpldataflow_overview/cs/program.cs#7)]
 [!code-vb[TPLDataflow_Overview#7](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpldataflow_overview/vb/program.vb#7)]  
  
 <span data-ttu-id="c1c59-290">Para obtener un ejemplo completo en el que se usa <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> para mejorar la eficacia de las operaciones de inserción de base de datos, vea el [tutorial sobre uso de BatchBlock y BatchedJoinBlock para mejorar la eficacia](walkthrough-using-batchblock-and-batchedjoinblock-to-improve-efficiency.md).</span><span class="sxs-lookup"><span data-stu-id="c1c59-290">For a complete example that uses <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> to improve the efficiency of database insert operations, see [Walkthrough: Using BatchBlock and BatchedJoinBlock to Improve Efficiency](walkthrough-using-batchblock-and-batchedjoinblock-to-improve-efficiency.md).</span></span>  
  
#### <a name="joinblockt1-t2-"></a><span data-ttu-id="c1c59-291">JoinBlock(T1, T2, ...)</span><span class="sxs-lookup"><span data-stu-id="c1c59-291">JoinBlock(T1, T2, ...)</span></span>  
 <span data-ttu-id="c1c59-292">Las clases <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> y <xref:System.Threading.Tasks.Dataflow.JoinBlock%603> obtienen elementos de entrada y propagan objetos <xref:System.Tuple%602?displayProperty=nameWithType> o <xref:System.Tuple%603?displayProperty=nameWithType> que contienen esos elementos.</span><span class="sxs-lookup"><span data-stu-id="c1c59-292">The <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> and <xref:System.Threading.Tasks.Dataflow.JoinBlock%603> classes collect input elements and propagate out <xref:System.Tuple%602?displayProperty=nameWithType> or <xref:System.Tuple%603?displayProperty=nameWithType> objects that contain those elements.</span></span> <span data-ttu-id="c1c59-293">Las clases <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> y <xref:System.Threading.Tasks.Dataflow.JoinBlock%603> no heredan de <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601>.</span><span class="sxs-lookup"><span data-stu-id="c1c59-293">The <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> and <xref:System.Threading.Tasks.Dataflow.JoinBlock%603> classes do not inherit from <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601>.</span></span> <span data-ttu-id="c1c59-294">En su lugar, proporcionan propiedades, <xref:System.Threading.Tasks.Dataflow.JoinBlock%602.Target1%2A>, <xref:System.Threading.Tasks.Dataflow.JoinBlock%602.Target2%2A> y <xref:System.Threading.Tasks.Dataflow.JoinBlock%603.Target3%2A>, que implementan <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601>.</span><span class="sxs-lookup"><span data-stu-id="c1c59-294">Instead, they provide properties, <xref:System.Threading.Tasks.Dataflow.JoinBlock%602.Target1%2A>, <xref:System.Threading.Tasks.Dataflow.JoinBlock%602.Target2%2A>, and <xref:System.Threading.Tasks.Dataflow.JoinBlock%603.Target3%2A>, that implement <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601>.</span></span>  
  
 <span data-ttu-id="c1c59-295">Al igual que <xref:System.Threading.Tasks.Dataflow.BatchBlock%601>, <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> y <xref:System.Threading.Tasks.Dataflow.JoinBlock%603> funcionan en modo expansivo o no expansivo.</span><span class="sxs-lookup"><span data-stu-id="c1c59-295">Like <xref:System.Threading.Tasks.Dataflow.BatchBlock%601>, <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> and <xref:System.Threading.Tasks.Dataflow.JoinBlock%603> operate in either greedy or non-greedy mode.</span></span> <span data-ttu-id="c1c59-296">En modo expansivo, que es el valor predeterminado, un objeto <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> o <xref:System.Threading.Tasks.Dataflow.JoinBlock%603> acepta cada mensaje que se proporciona y propaga una tupla después de que cada uno de sus destinos reciba por lo menos un mensaje.</span><span class="sxs-lookup"><span data-stu-id="c1c59-296">In greedy mode, which is the default, a <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> or <xref:System.Threading.Tasks.Dataflow.JoinBlock%603> object accepts every message that it is offered and propagates out a tuple after each of its targets receives at least one message.</span></span> <span data-ttu-id="c1c59-297">En modo no expansivo, un objeto <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> o <xref:System.Threading.Tasks.Dataflow.JoinBlock%603> pospone todos los mensajes entrantes hasta que todos los destinos han proporcionado los datos necesarios para crear una tupla.</span><span class="sxs-lookup"><span data-stu-id="c1c59-297">In non-greedy mode, a <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> or <xref:System.Threading.Tasks.Dataflow.JoinBlock%603> object postpones all incoming messages until all targets have been offered the data that is required to create a tuple.</span></span> <span data-ttu-id="c1c59-298">En este punto, el bloque se involucra en un protocolo de confirmación en dos fases para recuperar atómicamente todos los elementos necesarios de los orígenes.</span><span class="sxs-lookup"><span data-stu-id="c1c59-298">At this point, the block engages in a two-phase commit protocol to atomically retrieve all required items from the sources.</span></span> <span data-ttu-id="c1c59-299">Este aplazamiento permite que, mientras tanto, otra entidad consuma datos, para permitir que el sistema global progrese.</span><span class="sxs-lookup"><span data-stu-id="c1c59-299">This postponement makes it possible for another entity to consume the data in the meantime, to allow the overall system to make forward progress.</span></span>  
  
 <span data-ttu-id="c1c59-300">En el siguiente ejemplo básico se muestra un caso en el que un objeto <xref:System.Threading.Tasks.Dataflow.JoinBlock%603> requiere varios datos para calcular un valor.</span><span class="sxs-lookup"><span data-stu-id="c1c59-300">The following basic example demonstrates a case in which a <xref:System.Threading.Tasks.Dataflow.JoinBlock%603> object requires multiple data to compute a value.</span></span> <span data-ttu-id="c1c59-301">En este ejemplo se crea un objeto <xref:System.Threading.Tasks.Dataflow.JoinBlock%603> que requiere dos valores <xref:System.Int32> y un valor <xref:System.Char> para realizar una operación aritmética.</span><span class="sxs-lookup"><span data-stu-id="c1c59-301">This example creates a <xref:System.Threading.Tasks.Dataflow.JoinBlock%603> object that requires two <xref:System.Int32> values and a <xref:System.Char> value to perform an arithmetic operation.</span></span>  
  
 [!code-csharp[TPLDataflow_Overview#8](../../../samples/snippets/csharp/VS_Snippets_Misc/tpldataflow_overview/cs/program.cs#8)]
 [!code-vb[TPLDataflow_Overview#8](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpldataflow_overview/vb/program.vb#8)]  
  
 <span data-ttu-id="c1c59-302">Para obtener un ejemplo completo en el que se usan objetos <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> en modo no expansivo para compartir de forma cooperativa un recurso, vea el artículo en el que se explica cómo [usar JoinBlock para leer datos en varios orígenes](how-to-use-joinblock-to-read-data-from-multiple-sources.md).</span><span class="sxs-lookup"><span data-stu-id="c1c59-302">For a complete example that uses <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> objects in non-greedy mode to cooperatively share a resource, see [How to: Use JoinBlock to Read Data From Multiple Sources](how-to-use-joinblock-to-read-data-from-multiple-sources.md).</span></span>  
  
#### <a name="batchedjoinblockt1-t2-"></a><span data-ttu-id="c1c59-303">BatchedJoinBlock(T1, T2, ...)</span><span class="sxs-lookup"><span data-stu-id="c1c59-303">BatchedJoinBlock(T1, T2, ...)</span></span>  
 <span data-ttu-id="c1c59-304">Las clases <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> y <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%603> obtienen lotes de elementos de entrada y propagan objetos `System.Tuple(IList(T1), IList(T2))` o `System.Tuple(IList(T1), IList(T2), IList(T3))` que contienen esos elementos.</span><span class="sxs-lookup"><span data-stu-id="c1c59-304">The <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> and <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%603> classes collect batches of input elements and propagate out `System.Tuple(IList(T1), IList(T2))` or `System.Tuple(IList(T1), IList(T2), IList(T3))` objects that contain those elements.</span></span> <span data-ttu-id="c1c59-305">Piense en <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> como una combinación de <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> y <xref:System.Threading.Tasks.Dataflow.JoinBlock%602>.</span><span class="sxs-lookup"><span data-stu-id="c1c59-305">Think of <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> as a combination of <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> and <xref:System.Threading.Tasks.Dataflow.JoinBlock%602>.</span></span> <span data-ttu-id="c1c59-306">Especifique el tamaño de cada lote cuando crea un objeto <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602>.</span><span class="sxs-lookup"><span data-stu-id="c1c59-306">Specify the size of each batch when you create a <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> object.</span></span> <span data-ttu-id="c1c59-307"><xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> también proporciona propiedades, <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602.Target1%2A> y <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602.Target2%2A>, que implementan <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601>.</span><span class="sxs-lookup"><span data-stu-id="c1c59-307"><xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> also provides properties, <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602.Target1%2A> and <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602.Target2%2A>, that implement <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601>.</span></span> <span data-ttu-id="c1c59-308">Cuando el número especificado de elementos de entrada se recibe a través de todos los destinos, el objeto <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> propaga de forma asincrónica un objeto `System.Tuple(IList(T1), IList(T2))` que contiene esos elementos.</span><span class="sxs-lookup"><span data-stu-id="c1c59-308">When the specified count of input elements are received from across all targets, the <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> object asynchronously propagates out a `System.Tuple(IList(T1), IList(T2))` object that contains those elements.</span></span>  
  
 <span data-ttu-id="c1c59-309">En el siguiente ejemplo básico se crea un objeto <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> que contiene resultados, valores <xref:System.Int32> y errores que son objetos <xref:System.Exception>.</span><span class="sxs-lookup"><span data-stu-id="c1c59-309">The following basic example creates a <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> object that holds results, <xref:System.Int32> values, and errors that are <xref:System.Exception> objects.</span></span> <span data-ttu-id="c1c59-310">En este ejemplo se realizan varias operaciones y se escriben los resultados en la propiedad <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602.Target1%2A>, y los errores en la propiedad <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602.Target2%2A>, del objeto <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602>.</span><span class="sxs-lookup"><span data-stu-id="c1c59-310">This example performs multiple operations and writes results to the <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602.Target1%2A> property, and errors to the <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602.Target2%2A> property, of the <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> object.</span></span> <span data-ttu-id="c1c59-311">Dado que el número de operaciones correctas y las que dieron error no se conoce de antemano, los objetos <xref:System.Collections.Generic.IList%601> permiten que cada destino reciba cero o más valores.</span><span class="sxs-lookup"><span data-stu-id="c1c59-311">Because the count of successful and failed operations is unknown in advance, the <xref:System.Collections.Generic.IList%601> objects enable each target to receive zero or more values.</span></span>  
  
 [!code-csharp[TPLDataflow_Overview#9](../../../samples/snippets/csharp/VS_Snippets_Misc/tpldataflow_overview/cs/program.cs#9)]
 [!code-vb[TPLDataflow_Overview#9](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpldataflow_overview/vb/program.vb#9)]  
  
 <span data-ttu-id="c1c59-312">Para obtener un ejemplo completo que usa <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> para capturar resultados y cualquier excepción que se produzca mientras el programa lee en una base de datos, vea el [tutorial sobre uso de BatchBlock y BatchedJoingBlock para mejorar la eficiencia](walkthrough-using-batchblock-and-batchedjoinblock-to-improve-efficiency.md).</span><span class="sxs-lookup"><span data-stu-id="c1c59-312">For a complete example that uses <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> to capture both the results and any exceptions that occur while the program reads from a database, see [Walkthrough: Using BatchBlock and BatchedJoinBlock to Improve Efficiency](walkthrough-using-batchblock-and-batchedjoinblock-to-improve-efficiency.md).</span></span>  

## <a name="configuring-dataflow--block-behavior"></a><span data-ttu-id="c1c59-313">Configurar el comportamiento del bloque de flujo de datos</span><span class="sxs-lookup"><span data-stu-id="c1c59-313">Configuring Dataflow  Block Behavior</span></span>  
 <span data-ttu-id="c1c59-314">Puede habilitar opciones adicionales si proporciona un objeto <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions?displayProperty=nameWithType> al constructor de los tipos de bloques de flujo de datos.</span><span class="sxs-lookup"><span data-stu-id="c1c59-314">You can enable additional options by providing a <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions?displayProperty=nameWithType> object to the constructor of dataflow block types.</span></span> <span data-ttu-id="c1c59-315">Estas opciones controlan el comportamiento, como el del programador que administra la tarea subyacente, y el grado de paralelismo.</span><span class="sxs-lookup"><span data-stu-id="c1c59-315">These options control behavior such the scheduler that manages the underlying task and the degree of parallelism.</span></span> <span data-ttu-id="c1c59-316">El objeto <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions> también tiene tipos derivados que especifican el comportamiento específico de ciertos tipos de bloques de flujo de datos.</span><span class="sxs-lookup"><span data-stu-id="c1c59-316">The <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions> also has derived types that specify behavior that is specific to certain dataflow block types.</span></span> <span data-ttu-id="c1c59-317">En la tabla siguiente se resumen los tipo de opciones que se asocian a cada tipo de bloques de flujo de datos.</span><span class="sxs-lookup"><span data-stu-id="c1c59-317">The following table summarizes which options type is associated with each dataflow block type.</span></span>  
  
|<span data-ttu-id="c1c59-318">Tipo de bloques de flujo de datos</span><span class="sxs-lookup"><span data-stu-id="c1c59-318">Dataflow Block Type</span></span>|<span data-ttu-id="c1c59-319">Tipo de <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions></span><span class="sxs-lookup"><span data-stu-id="c1c59-319"><xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions> type</span></span>|  
|-------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------|  
|<xref:System.Threading.Tasks.Dataflow.BufferBlock%601>|<xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions>|  
|<xref:System.Threading.Tasks.Dataflow.BroadcastBlock%601>|<xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions>|  
|<xref:System.Threading.Tasks.Dataflow.WriteOnceBlock%601>|<xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions>|  
|<xref:System.Threading.Tasks.Dataflow.ActionBlock%601>|<xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions>|  
|<xref:System.Threading.Tasks.Dataflow.TransformBlock%602>|<xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions>|  
|<xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602>|<xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions>|  
|<xref:System.Threading.Tasks.Dataflow.BatchBlock%601>|<xref:System.Threading.Tasks.Dataflow.GroupingDataflowBlockOptions>|  
|<xref:System.Threading.Tasks.Dataflow.JoinBlock%602>|<xref:System.Threading.Tasks.Dataflow.GroupingDataflowBlockOptions>|  
|<xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602>|<xref:System.Threading.Tasks.Dataflow.GroupingDataflowBlockOptions>|  
  
 <span data-ttu-id="c1c59-320">Las secciones siguientes proporcionan información adicional sobre las clases importantes de opciones de bloques de flujo de datos que están disponibles a través de las clases <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions?displayProperty=nameWithType>, <xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions?displayProperty=nameWithType> y <xref:System.Threading.Tasks.Dataflow.GroupingDataflowBlockOptions?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="c1c59-320">The following sections provide additional information about the important kinds of dataflow block options that are available through the <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions?displayProperty=nameWithType>, <xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions?displayProperty=nameWithType>, and <xref:System.Threading.Tasks.Dataflow.GroupingDataflowBlockOptions?displayProperty=nameWithType> classes.</span></span>  
  
### <a name="specifying-the-task-scheduler"></a><span data-ttu-id="c1c59-321">Especificar el programador de tareas</span><span class="sxs-lookup"><span data-stu-id="c1c59-321">Specifying the Task Scheduler</span></span>  
 <span data-ttu-id="c1c59-322">Cada bloque de flujo de datos predefinido utiliza el mecanismo de programación de tareas de la biblioteca TPL para realizar actividades como propagar datos a un destino, recibir datos de un origen y ejecutar delegados definido por el usuario si los datos están disponibles.</span><span class="sxs-lookup"><span data-stu-id="c1c59-322">Every predefined dataflow block uses the TPL task scheduling mechanism to perform activities such as propagating data to a target, receiving data from a source, and running user-defined delegates when data becomes available.</span></span> <span data-ttu-id="c1c59-323"><xref:System.Threading.Tasks.TaskScheduler> es una clase abstracta que representa un programador de tareas que pone en cola las tareas en los subprocesos.</span><span class="sxs-lookup"><span data-stu-id="c1c59-323"><xref:System.Threading.Tasks.TaskScheduler> is an abstract class that represents a task scheduler that queues tasks onto threads.</span></span> <span data-ttu-id="c1c59-324">El programador de tareas predeterminado, <xref:System.Threading.Tasks.TaskScheduler.Default%2A>, utiliza la clase <xref:System.Threading.ThreadPool> para poner en cola y ejecutar el trabajo.</span><span class="sxs-lookup"><span data-stu-id="c1c59-324">The default task scheduler, <xref:System.Threading.Tasks.TaskScheduler.Default%2A>, uses the <xref:System.Threading.ThreadPool> class to queue and execute work.</span></span> <span data-ttu-id="c1c59-325">Puede reemplazar el programador de tareas predeterminado estableciendo la propiedad <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.TaskScheduler%2A> al crear un objeto de bloque de flujo de datos.</span><span class="sxs-lookup"><span data-stu-id="c1c59-325">You can override the default task scheduler by setting the <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.TaskScheduler%2A> property when you construct a dataflow block object.</span></span>  
  
 <span data-ttu-id="c1c59-326">Cuando el mismo programador de tareas administra varios bloques de flujo de datos, puede aplicar directivas entre ellos.</span><span class="sxs-lookup"><span data-stu-id="c1c59-326">When the same task scheduler manages multiple dataflow blocks, it can enforce policies across them.</span></span> <span data-ttu-id="c1c59-327">Por ejemplo, si cada uno de los bloques de flujo de datos se configuran como destino del programador exclusivo del mismo objeto <xref:System.Threading.Tasks.ConcurrentExclusiveSchedulerPair>, todo el trabajo que se ejecuta a través de estos bloques se serializa.</span><span class="sxs-lookup"><span data-stu-id="c1c59-327">For example, if multiple dataflow blocks are each configured to target the exclusive scheduler of the same <xref:System.Threading.Tasks.ConcurrentExclusiveSchedulerPair> object, all work that runs across these blocks is serialized.</span></span> <span data-ttu-id="c1c59-328">De igual forma, si estos bloques se configuran como destino del programador simultáneo del mismo objeto <xref:System.Threading.Tasks.ConcurrentExclusiveSchedulerPair>, y el programador se configura para tener un nivel de simultaneidad máximo, todo el trabajo de estos bloques se limita a ese número de operaciones simultáneas.</span><span class="sxs-lookup"><span data-stu-id="c1c59-328">Similarly, if these blocks are configured to target the concurrent scheduler of the same <xref:System.Threading.Tasks.ConcurrentExclusiveSchedulerPair> object, and that scheduler is configured to have a maximum concurrency level, all work from these blocks is limited to that number of concurrent operations.</span></span> <span data-ttu-id="c1c59-329">Para obtener un ejemplo en el que se usa la clase <xref:System.Threading.Tasks.ConcurrentExclusiveSchedulerPair> para permitir operaciones de lectura en paralelo y que las operaciones de escritura sean exclusivas del resto de operaciones, vea el artículo sobre [cómo especificar un programador de tareas en un bloque de flujo de datos](how-to-specify-a-task-scheduler-in-a-dataflow-block.md).</span><span class="sxs-lookup"><span data-stu-id="c1c59-329">For an example that uses the <xref:System.Threading.Tasks.ConcurrentExclusiveSchedulerPair> class to enable read operations to occur in parallel, but write operations to occur exclusively of all other operations, see [How to: Specify a Task Scheduler in a Dataflow Block](how-to-specify-a-task-scheduler-in-a-dataflow-block.md).</span></span> <span data-ttu-id="c1c59-330">Para obtener más información sobre los programadores de tareas en la biblioteca TPL, consulte el tema sobre la clase <xref:System.Threading.Tasks.TaskScheduler>.</span><span class="sxs-lookup"><span data-stu-id="c1c59-330">For more information about task schedulers in the TPL, see the <xref:System.Threading.Tasks.TaskScheduler> class topic.</span></span>  
  
### <a name="specifying-the-degree-of-parallelism"></a><span data-ttu-id="c1c59-331">Especificar el grado de Paralelismo</span><span class="sxs-lookup"><span data-stu-id="c1c59-331">Specifying the Degree of Parallelism</span></span>  
 <span data-ttu-id="c1c59-332">De forma predeterminada, los tres tipos de bloques de ejecución que la biblioteca de flujos de datos TPL proporciona, <xref:System.Threading.Tasks.Dataflow.ActionBlock%601>, <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> y <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602>, procesan un mensaje al mismo tiempo.</span><span class="sxs-lookup"><span data-stu-id="c1c59-332">By default, the three execution block types that the TPL Dataflow Library provides, <xref:System.Threading.Tasks.Dataflow.ActionBlock%601>, <xref:System.Threading.Tasks.Dataflow.TransformBlock%602>, and <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602>, process one message at a time.</span></span> <span data-ttu-id="c1c59-333">Estos tipos de bloques de flujo de datos también procesan mensajes en el orden en que se reciben.</span><span class="sxs-lookup"><span data-stu-id="c1c59-333">These dataflow block types also process messages in the order in which they are received.</span></span> <span data-ttu-id="c1c59-334">Para permitir que estos bloques de flujo de datos procesen mensajes simultáneamente, establezca la propiedad <xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions.MaxDegreeOfParallelism%2A?displayProperty=nameWithType> cuando construya el objeto de bloques de flujo de datos.</span><span class="sxs-lookup"><span data-stu-id="c1c59-334">To enable these dataflow blocks to process messages concurrently, set the <xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions.MaxDegreeOfParallelism%2A?displayProperty=nameWithType> property when you construct the dataflow block object.</span></span>  
  
 <span data-ttu-id="c1c59-335">El valor predeterminado de <xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions.MaxDegreeOfParallelism%2A> es 1, que garantiza que el bloque de flujo de datos procesa un mensaje al mismo tiempo.</span><span class="sxs-lookup"><span data-stu-id="c1c59-335">The default value of <xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions.MaxDegreeOfParallelism%2A> is 1, which guarantees that the dataflow block processes one message at a time.</span></span> <span data-ttu-id="c1c59-336">Al establecer esta propiedad en un valor mayor de 1 se permite que el bloque de flujo de datos procese varios mensajes simultáneamente.</span><span class="sxs-lookup"><span data-stu-id="c1c59-336">Setting this property to a value that is larger than 1 enables the dataflow block to process multiple messages concurrently.</span></span> <span data-ttu-id="c1c59-337">Al establecer esta propiedad en <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.Unbounded?displayProperty=nameWithType> se permite que el programador de tareas subyacente administre el grado máximo de simultaneidad.</span><span class="sxs-lookup"><span data-stu-id="c1c59-337">Setting this property to <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.Unbounded?displayProperty=nameWithType> enables the underlying task scheduler to manage the maximum degree of concurrency.</span></span>  
  
> [!IMPORTANT]
> <span data-ttu-id="c1c59-338">Cuando se especifica un grado máximo de paralelismo mayor que 1, varios mensajes se procesan simultáneamente y, por tanto, los mensajes no se pueden procesar en el orden en que se reciben.</span><span class="sxs-lookup"><span data-stu-id="c1c59-338">When you specify a maximum degree of parallelism that is larger than 1, multiple messages are processed simultaneously, and therefore messages might not be processed in the order in which they are received.</span></span> <span data-ttu-id="c1c59-339">Pero los mensajes salen del bloque en el mismo orden en que se reciben.</span><span class="sxs-lookup"><span data-stu-id="c1c59-339">The order in which the messages are output from the block is, however, the same one in which they are received.</span></span>  
  
 <span data-ttu-id="c1c59-340">Dado que la propiedad <xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions.MaxDegreeOfParallelism%2A> representa el grado máximo de paralelismo, el bloque de flujo de datos puede ejecutarse con un menor grado de paralelismo que el especificado.</span><span class="sxs-lookup"><span data-stu-id="c1c59-340">Because the <xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions.MaxDegreeOfParallelism%2A> property represents the maximum degree of parallelism, the dataflow block might execute with a lesser degree of parallelism than you specify.</span></span> <span data-ttu-id="c1c59-341">El bloque de flujo de datos puede utilizar un menor grado de paralelismo para cumplir los requisitos funcionales o porque hay una falta de recursos del sistema disponibles.</span><span class="sxs-lookup"><span data-stu-id="c1c59-341">The dataflow block might use a lesser degree of parallelism to meet its functional requirements or because there is a lack of available system resources.</span></span> <span data-ttu-id="c1c59-342">Un flujo de datos bloqueado nunca elige más paralelismo que el especificado.</span><span class="sxs-lookup"><span data-stu-id="c1c59-342">A dataflow block never chooses more parallelism than you specify.</span></span>  
  
 <span data-ttu-id="c1c59-343">El valor de la propiedad <xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions.MaxDegreeOfParallelism%2A> es exclusivo para cada objeto de bloque de flujo de datos.</span><span class="sxs-lookup"><span data-stu-id="c1c59-343">The value of the <xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions.MaxDegreeOfParallelism%2A> property is exclusive to each dataflow block object.</span></span> <span data-ttu-id="c1c59-344">Por ejemplo, si cuatro objetos de bloques de flujo de datos especifican 1 como el grado máximo de paralelismo, los cuatro objetos de bloques de flujo de datos podrían ejecutarse en paralelo.</span><span class="sxs-lookup"><span data-stu-id="c1c59-344">For example, if four dataflow block objects each specify 1 for the maximum degree of parallelism, all four dataflow block objects can potentially run in parallel.</span></span>  
  
 <span data-ttu-id="c1c59-345">Para ver un ejemplo que establece el grado máximo de paralelismo para permitir que operaciones largas se produzcan en paralelo, consulte [How to: Specify the Degree of Parallelism in a Dataflow Block](how-to-specify-the-degree-of-parallelism-in-a-dataflow-block.md) (Cómo: Especificar el grado de paralelismo en un bloque de flujo de datos).</span><span class="sxs-lookup"><span data-stu-id="c1c59-345">For an example that sets the maximum degree of parallelism to enable lengthy operations to occur in parallel, see [How to: Specify the Degree of Parallelism in a Dataflow Block](how-to-specify-the-degree-of-parallelism-in-a-dataflow-block.md).</span></span>  
  
### <a name="specifying-the-number-of-messages-per-task"></a><span data-ttu-id="c1c59-346">Especificar el número de mensajes por tarea</span><span class="sxs-lookup"><span data-stu-id="c1c59-346">Specifying the Number of Messages per Task</span></span>  
 <span data-ttu-id="c1c59-347">Los tipos predefinidos de bloques de flujo de datos utilizan tareas para procesar varios elementos de entrada.</span><span class="sxs-lookup"><span data-stu-id="c1c59-347">The predefined dataflow block types use tasks to process multiple input elements.</span></span> <span data-ttu-id="c1c59-348">Esto ayuda a minimizar el número de objetos de tarea necesarios para procesar datos, lo que permite que las aplicaciones se ejecuten más eficazmente.</span><span class="sxs-lookup"><span data-stu-id="c1c59-348">This helps minimize the number of task objects that are required to process data, which enables applications to run more efficiently.</span></span> <span data-ttu-id="c1c59-349">Sin embargo, cuando las tareas de un conjunto de bloques de flujo de datos están procesando datos, es posible que las tareas de otros bloques de flujo de datos tengan que esperar el tiempo de procesamiento en la cola mensajes.</span><span class="sxs-lookup"><span data-stu-id="c1c59-349">However, when the tasks from one set of dataflow blocks are processing data, the tasks from other dataflow blocks might need to wait for processing time by queuing messages.</span></span> <span data-ttu-id="c1c59-350">Para permitir una mejor equidad entre tareas de flujo de datos, establezca la propiedad <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.MaxMessagesPerTask%2A>.</span><span class="sxs-lookup"><span data-stu-id="c1c59-350">To enable better fairness among dataflow tasks, set the <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.MaxMessagesPerTask%2A> property.</span></span> <span data-ttu-id="c1c59-351">Cuando <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.MaxMessagesPerTask%2A> se establece en <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.Unbounded?displayProperty=nameWithType>, que es el valor predeterminado, la tarea utilizada por un bloque de flujo de datos procesa tantos mensajes como están disponibles.</span><span class="sxs-lookup"><span data-stu-id="c1c59-351">When <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.MaxMessagesPerTask%2A> is set to <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.Unbounded?displayProperty=nameWithType>, which is the default, the task used by a dataflow block processes as many messages as are available.</span></span> <span data-ttu-id="c1c59-352">Cuando <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.MaxMessagesPerTask%2A> se establece en un valor distinto de <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.Unbounded>, el bloque de flujo de datos procesa como máximo este número de mensajes por objeto <xref:System.Threading.Tasks.Task>.</span><span class="sxs-lookup"><span data-stu-id="c1c59-352">When <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.MaxMessagesPerTask%2A> is set to a value other than <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.Unbounded>, the dataflow block processes at most this number of messages per <xref:System.Threading.Tasks.Task> object.</span></span> <span data-ttu-id="c1c59-353">Aunque al establecer la propiedad <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.MaxMessagesPerTask%2A> se puede aumentar la equidad entre tareas, puede provocar que el sistema cree más tareas que las necesarias, lo que puede reducir el rendimiento.</span><span class="sxs-lookup"><span data-stu-id="c1c59-353">Although setting the <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.MaxMessagesPerTask%2A> property can increase fairness among tasks, it can cause the system to create more tasks than are necessary, which can decrease performance.</span></span>  
  
### <a name="enabling-cancellation"></a><span data-ttu-id="c1c59-354">Habilitar la cancelación</span><span class="sxs-lookup"><span data-stu-id="c1c59-354">Enabling Cancellation</span></span>  
 <span data-ttu-id="c1c59-355">La biblioteca TPL proporciona un mecanismo que habilita las tareas para coordinar la cancelación de manera cooperativa.</span><span class="sxs-lookup"><span data-stu-id="c1c59-355">The TPL provides a mechanism that enables tasks to coordinate cancellation in a cooperative manner.</span></span> <span data-ttu-id="c1c59-356">Para permitir que los bloques de flujo de datos puedan participar en este mecanismo de cancelación, establezca la propiedad <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.CancellationToken%2A>.</span><span class="sxs-lookup"><span data-stu-id="c1c59-356">To enable dataflow blocks to participate in this cancellation mechanism, set the <xref:System.Threading.Tasks.Dataflow.DataflowBlockOptions.CancellationToken%2A> property.</span></span> <span data-ttu-id="c1c59-357">Cuando este objeto <xref:System.Threading.CancellationToken> se establece en el estado cancelado, todos los bloques de flujo de datos que controlan este token finalizan la ejecución de su elemento actual pero no comienzan a procesar los elementos siguientes.</span><span class="sxs-lookup"><span data-stu-id="c1c59-357">When this <xref:System.Threading.CancellationToken> object is set to the canceled state, all dataflow blocks that monitor this token finish execution of their current item but do not start processing subsequent items.</span></span> <span data-ttu-id="c1c59-358">Estos bloques de flujo de datos también borran los mensajes almacenados en búfer, conexiones de inicio para los bloques de origen y de destino, y la transición al estado cancelado.</span><span class="sxs-lookup"><span data-stu-id="c1c59-358">These dataflow blocks also clear any buffered messages, release connections to any source and target blocks, and transition to the canceled state.</span></span> <span data-ttu-id="c1c59-359">Al realizar la transición al estado cancelado, la propiedad <xref:System.Threading.Tasks.Dataflow.IDataflowBlock.Completion%2A> tiene la propiedad <xref:System.Threading.Tasks.Task.Status%2A> establecida en <xref:System.Threading.Tasks.TaskStatus.Canceled>, a menos que se produzca una excepción durante el procesamiento.</span><span class="sxs-lookup"><span data-stu-id="c1c59-359">By transitioning to the canceled state, the <xref:System.Threading.Tasks.Dataflow.IDataflowBlock.Completion%2A> property has the <xref:System.Threading.Tasks.Task.Status%2A> property set to <xref:System.Threading.Tasks.TaskStatus.Canceled>, unless an exception occurred during processing.</span></span> <span data-ttu-id="c1c59-360">En ese caso, <xref:System.Threading.Tasks.Task.Status%2A> se establece en <xref:System.Threading.Tasks.TaskStatus.Faulted>.</span><span class="sxs-lookup"><span data-stu-id="c1c59-360">In that case, <xref:System.Threading.Tasks.Task.Status%2A> is set to <xref:System.Threading.Tasks.TaskStatus.Faulted>.</span></span>  
  
 <span data-ttu-id="c1c59-361">Para ver un ejemplo en el que se muestra cómo usar la cancelación en una aplicación de Windows Forms, consulte [How to: Cancel a Dataflow Block](how-to-cancel-a-dataflow-block.md) (Cómo: Cancelar un bloque de flujo de datos).</span><span class="sxs-lookup"><span data-stu-id="c1c59-361">For an example that demonstrates how to use cancellation in a Windows Forms application, see [How to: Cancel a Dataflow Block](how-to-cancel-a-dataflow-block.md).</span></span> <span data-ttu-id="c1c59-362">Para más información sobre la cancelación en la biblioteca TPL, consulte [Task Cancellation](task-cancellation.md) (Cancelación de tareas).</span><span class="sxs-lookup"><span data-stu-id="c1c59-362">For more information about cancellation in the TPL, see [Task Cancellation](task-cancellation.md).</span></span>  
  
### <a name="specifying-greedy-versus-non-greedy-behavior"></a><span data-ttu-id="c1c59-363">Especificar el comportamiento expansivo frente al no expansivo</span><span class="sxs-lookup"><span data-stu-id="c1c59-363">Specifying Greedy Versus Non-Greedy Behavior</span></span>  
 <span data-ttu-id="c1c59-364">Varios tipos de bloques de flujo de datos de agrupación pueden trabajar en modo *expansivo* o *no expansivo*.</span><span class="sxs-lookup"><span data-stu-id="c1c59-364">Several grouping dataflow block types can operate in either *greedy* or *non-greedy* mode.</span></span> <span data-ttu-id="c1c59-365">De forma predeterminada, los tipos de bloques de flujo de datos predefinidos funcionan en modo expansivo.</span><span class="sxs-lookup"><span data-stu-id="c1c59-365">By default, the predefined dataflow block types operate in greedy mode.</span></span>  
  
 <span data-ttu-id="c1c59-366">Para los tipos de bloques de combinación como <xref:System.Threading.Tasks.Dataflow.JoinBlock%602>, el modo expansivo significa que el bloque acepta datos inmediatamente aunque los correspondientes datos con los que se combinará aún no estén disponibles.</span><span class="sxs-lookup"><span data-stu-id="c1c59-366">For join block types such as <xref:System.Threading.Tasks.Dataflow.JoinBlock%602>, greedy mode means that the block immediately accepts data even if the corresponding data with which to join is not yet available.</span></span> <span data-ttu-id="c1c59-367">El modo no expansivo significa que el bloque pospone todos los mensajes entrantes hasta que uno esté disponible para cada uno de sus destinos para completar la combinación.</span><span class="sxs-lookup"><span data-stu-id="c1c59-367">Non-greedy mode means that the block postpones all incoming messages until one is available on each of its targets to complete the join.</span></span> <span data-ttu-id="c1c59-368">Si los mensajes pospuestos ya no están disponibles, el bloque de combinación libera todos los mensajes pospuestos y reinicia el proceso.</span><span class="sxs-lookup"><span data-stu-id="c1c59-368">If any of the postponed messages are no longer available, the join block releases all postponed messages and restarts the process.</span></span> <span data-ttu-id="c1c59-369">Para la clase <xref:System.Threading.Tasks.Dataflow.BatchBlock%601>, el comportamiento expansivo y no expansivo es similar, salvo que en modo no expansivo, un objeto <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> pospone todos los mensajes entrantes hasta que haya suficientes mensajes disponibles de orígenes distintos para completar un lote.</span><span class="sxs-lookup"><span data-stu-id="c1c59-369">For the <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> class, greedy and non-greedy behavior is similar, except that under non-greedy mode, a <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> object postpones all incoming messages until enough are available from distinct sources to complete a batch.</span></span>  
  
 <span data-ttu-id="c1c59-370">Para especificar el modo no expansivo para un bloque de flujo de datos, establezca <xref:System.Threading.Tasks.Dataflow.GroupingDataflowBlockOptions.Greedy%2A> en `False`.</span><span class="sxs-lookup"><span data-stu-id="c1c59-370">To specify non-greedy mode for a dataflow block, set <xref:System.Threading.Tasks.Dataflow.GroupingDataflowBlockOptions.Greedy%2A> to `False`.</span></span> <span data-ttu-id="c1c59-371">Para ver un ejemplo en el que se muestra cómo usar el modo no expansivo para permitir que varios bloques de combinación compartan un origen de datos de forma más eficaz, consulte [How to: Use JoinBlock to Read Data From Multiple Sources](how-to-use-joinblock-to-read-data-from-multiple-sources.md) (Cómo: Utilizar JoinBlock para leer datos de varios orígenes).</span><span class="sxs-lookup"><span data-stu-id="c1c59-371">For an example that demonstrates how to use non-greedy mode to enable multiple join blocks to share a data source more efficiently, see [How to: Use JoinBlock to Read Data From Multiple Sources](how-to-use-joinblock-to-read-data-from-multiple-sources.md).</span></span>

## <a name="custom-dataflow-blocks"></a><span data-ttu-id="c1c59-372">Bloques de flujo de datos personalizados</span><span class="sxs-lookup"><span data-stu-id="c1c59-372">Custom Dataflow Blocks</span></span>  
 <span data-ttu-id="c1c59-373">Aunque la biblioteca de flujos de datos TPL proporciona muchos tipos de bloques predefinidos, puede crear tipos de bloques adicionales que tengan un comportamiento personalizado.</span><span class="sxs-lookup"><span data-stu-id="c1c59-373">Although the TPL Dataflow Library provides many predefined block types, you can create additional block types that perform custom behavior.</span></span> <span data-ttu-id="c1c59-374">Implemente las interfaces <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601> o <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601> directamente, o utilice el método <xref:System.Threading.Tasks.Dataflow.DataflowBlock.Encapsulate%2A> para compilar un bloque complejo que encapsule el comportamiento de los tipos de bloques existentes.</span><span class="sxs-lookup"><span data-stu-id="c1c59-374">Implement the <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601> or <xref:System.Threading.Tasks.Dataflow.ITargetBlock%601> interfaces directly or use the  <xref:System.Threading.Tasks.Dataflow.DataflowBlock.Encapsulate%2A> method to build a complex block that encapsulates the behavior of existing block types.</span></span> <span data-ttu-id="c1c59-375">Para ver ejemplos que muestran cómo implementar funcionalidad de bloques de flujo de datos personalizados, consulte [Walkthrough: Creating a Custom Dataflow Block Type](walkthrough-creating-a-custom-dataflow-block-type.md) (Tutorial: Creación de un tipo de bloque de flujo de datos personalizado).</span><span class="sxs-lookup"><span data-stu-id="c1c59-375">For examples that show how to implement custom dataflow block functionality, see [Walkthrough: Creating a Custom Dataflow Block Type](walkthrough-creating-a-custom-dataflow-block-type.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="c1c59-376">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="c1c59-376">Related Topics</span></span>  
  
|<span data-ttu-id="c1c59-377">Título</span><span class="sxs-lookup"><span data-stu-id="c1c59-377">Title</span></span>|<span data-ttu-id="c1c59-378">Description</span><span class="sxs-lookup"><span data-stu-id="c1c59-378">Description</span></span>|  
|-----------|-----------------|  
|[<span data-ttu-id="c1c59-379">Cómo: Leer y escribir mensajes en un bloque de flujo de datos</span><span class="sxs-lookup"><span data-stu-id="c1c59-379">How to: Write Messages to and Read Messages from a Dataflow Block</span></span>](how-to-write-messages-to-and-read-messages-from-a-dataflow-block.md)|<span data-ttu-id="c1c59-380">Muestra cómo escribir y leer los mensajes de un objeto <xref:System.Threading.Tasks.Dataflow.BufferBlock%601>.</span><span class="sxs-lookup"><span data-stu-id="c1c59-380">Demonstrates how to write messages to and read messages from a <xref:System.Threading.Tasks.Dataflow.BufferBlock%601> object.</span></span>|  
|[<span data-ttu-id="c1c59-381">Cómo: Implementar un modelo de flujo de datos productor-consumidor</span><span class="sxs-lookup"><span data-stu-id="c1c59-381">How to: Implement a Producer-Consumer Dataflow Pattern</span></span>](how-to-implement-a-producer-consumer-dataflow-pattern.md)|<span data-ttu-id="c1c59-382">Describe cómo utilizar el modelo de flujo de datos para implementar un patrón consumidor-productor, cuando el productor envía mensajes a un bloque de flujo de datos y el consumidor lee mensajes de ese bloque.</span><span class="sxs-lookup"><span data-stu-id="c1c59-382">Describes how to use the dataflow model to implement a producer-consumer pattern, where the producer sends messages to a dataflow block, and the consumer reads messages from that block.</span></span>|  
|[<span data-ttu-id="c1c59-383">Cómo: Realizar una acción cuando un bloque de flujo de datos recibe datos</span><span class="sxs-lookup"><span data-stu-id="c1c59-383">How to: Perform Action When a Dataflow Block Receives Data</span></span>](how-to-perform-action-when-a-dataflow-block-receives-data.md)|<span data-ttu-id="c1c59-384">Describe cómo proporcionar delegados a los tipos de bloques de flujo de datos de ejecución, <xref:System.Threading.Tasks.Dataflow.ActionBlock%601>, <xref:System.Threading.Tasks.Dataflow.TransformBlock%602> y <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602>.</span><span class="sxs-lookup"><span data-stu-id="c1c59-384">Describes how to provide delegates to the execution dataflow block types, <xref:System.Threading.Tasks.Dataflow.ActionBlock%601>, <xref:System.Threading.Tasks.Dataflow.TransformBlock%602>, and <xref:System.Threading.Tasks.Dataflow.TransformManyBlock%602>.</span></span>|  
|[<span data-ttu-id="c1c59-385">Tutorial: Creación de una canalización de flujo de datos</span><span class="sxs-lookup"><span data-stu-id="c1c59-385">Walkthrough: Creating a Dataflow Pipeline</span></span>](walkthrough-creating-a-dataflow-pipeline.md)|<span data-ttu-id="c1c59-386">Describe cómo crear una canalización de flujo de datos que descarga texto desde Internet y realiza operaciones en ese texto.</span><span class="sxs-lookup"><span data-stu-id="c1c59-386">Describes how to create a dataflow pipeline that downloads text from the web and performs operations on that text.</span></span>|  
|[<span data-ttu-id="c1c59-387">Cómo: Desvincular bloques de flujo de datos</span><span class="sxs-lookup"><span data-stu-id="c1c59-387">How to: Unlink Dataflow Blocks</span></span>](how-to-unlink-dataflow-blocks.md)|<span data-ttu-id="c1c59-388">Muestra cómo utilizar el método <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.LinkTo%2A> para desvincular un bloque de destino de su origen después de que el origen proporciona un mensaje al destino.</span><span class="sxs-lookup"><span data-stu-id="c1c59-388">Demonstrates how to use the <xref:System.Threading.Tasks.Dataflow.ISourceBlock%601.LinkTo%2A> method to unlink a target block from its source after the source offers a message to the target.</span></span>|  
|<span data-ttu-id="c1c59-389">[Walkthrough: Using Dataflow in a Windows Forms Application](walkthrough-using-dataflow-in-a-windows-forms-application.md) (Tutorial: Uso de flujos de datos en aplicaciones de Windows Forms)</span><span class="sxs-lookup"><span data-stu-id="c1c59-389">[Walkthrough: Using Dataflow in a Windows Forms Application](walkthrough-using-dataflow-in-a-windows-forms-application.md)</span></span>|<span data-ttu-id="c1c59-390">Muestra cómo crear una red de bloques de flujo de datos que realizan procesamiento de imágenes en una aplicación de Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="c1c59-390">Demonstrates how to create a network of dataflow blocks that perform image processing in a Windows Forms application.</span></span>|  
|[<span data-ttu-id="c1c59-391">Cómo: Cancelar un bloque de flujo de datos</span><span class="sxs-lookup"><span data-stu-id="c1c59-391">How to: Cancel a Dataflow Block</span></span>](how-to-cancel-a-dataflow-block.md)|<span data-ttu-id="c1c59-392">Muestra cómo se usa la cancelación en una aplicación de Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="c1c59-392">Demonstrates how to use cancellation in a Windows Forms application.</span></span>|  
|[<span data-ttu-id="c1c59-393">Cómo: Utilizar JoinBlock para leer datos de varios orígenes</span><span class="sxs-lookup"><span data-stu-id="c1c59-393">How to: Use JoinBlock to Read Data From Multiple Sources</span></span>](how-to-use-joinblock-to-read-data-from-multiple-sources.md)|<span data-ttu-id="c1c59-394">Explica cómo utilizar la clase <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> para realizar una operación cuando los datos están disponibles a partir de varios orígenes, y cómo utilizar el modo no expansivo para permitir que varios bloques de combinación puedan compartir un origen de datos más eficazmente.</span><span class="sxs-lookup"><span data-stu-id="c1c59-394">Explains how to use the <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> class to perform an operation when data is available from multiple sources, and how to use non-greedy mode to enable multiple join blocks to share a data source more efficiently.</span></span>|  
|[<span data-ttu-id="c1c59-395">Cómo: Especificar el grado de paralelismo en un bloque de flujo de datos</span><span class="sxs-lookup"><span data-stu-id="c1c59-395">How to: Specify the Degree of Parallelism in a Dataflow Block</span></span>](how-to-specify-the-degree-of-parallelism-in-a-dataflow-block.md)|<span data-ttu-id="c1c59-396">Describe cómo establecer la propiedad <xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions.MaxDegreeOfParallelism%2A> para permitir que un bloque de flujo de datos de ejecución pueda procesar varios mensajes al mismo tiempo.</span><span class="sxs-lookup"><span data-stu-id="c1c59-396">Describes how to set the <xref:System.Threading.Tasks.Dataflow.ExecutionDataflowBlockOptions.MaxDegreeOfParallelism%2A> property to enable an execution dataflow block to process more than one message at a time.</span></span>|  
|[<span data-ttu-id="c1c59-397">Cómo: Especificar un programador de tareas en un bloque de flujo de datos</span><span class="sxs-lookup"><span data-stu-id="c1c59-397">How to: Specify a Task Scheduler in a Dataflow Block</span></span>](how-to-specify-a-task-scheduler-in-a-dataflow-block.md)|<span data-ttu-id="c1c59-398">Muestra cómo asociar un programador de tareas específico cuando se usa flujo de datos en la aplicación.</span><span class="sxs-lookup"><span data-stu-id="c1c59-398">Demonstrates how to associate a specific task scheduler when you use dataflow in your application.</span></span>|  
|[<span data-ttu-id="c1c59-399">Tutorial: Uso de BatchBlock y BatchedJoinBlock para mejorar la eficacia</span><span class="sxs-lookup"><span data-stu-id="c1c59-399">Walkthrough: Using BatchBlock and BatchedJoinBlock to Improve Efficiency</span></span>](walkthrough-using-batchblock-and-batchedjoinblock-to-improve-efficiency.md)|<span data-ttu-id="c1c59-400">Describe cómo utilizar la clase <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> para mejorar la eficacia de las operaciones de inserción de la base de datos y cómo utilizar la clase <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> para capturar los resultados y cualquier excepción que se produzca mientras el programa lee de una base de datos.</span><span class="sxs-lookup"><span data-stu-id="c1c59-400">Describes how to use the <xref:System.Threading.Tasks.Dataflow.BatchBlock%601> class to improve the efficiency of database insert operations, and how to use the <xref:System.Threading.Tasks.Dataflow.BatchedJoinBlock%602> class to capture both the results and any exceptions that occur while the program reads from a database.</span></span>|  
|[<span data-ttu-id="c1c59-401">Tutorial: Creación de un tipo de bloque de flujo de datos personalizado</span><span class="sxs-lookup"><span data-stu-id="c1c59-401">Walkthrough: Creating a Custom Dataflow Block Type</span></span>](walkthrough-creating-a-custom-dataflow-block-type.md)|<span data-ttu-id="c1c59-402">Muestra dos maneras de crear un tipo de bloque de flujo de datos que implementa un comportamiento personalizado.</span><span class="sxs-lookup"><span data-stu-id="c1c59-402">Demonstrates two ways to create a dataflow block type that implements custom behavior.</span></span>|  
|[<span data-ttu-id="c1c59-403">Biblioteca TPL</span><span class="sxs-lookup"><span data-stu-id="c1c59-403">Task Parallel Library (TPL)</span></span>](task-parallel-library-tpl.md)|<span data-ttu-id="c1c59-404">Presenta la biblioteca TPL, una biblioteca que simplifica la programación paralela y simultánea en aplicaciones de .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="c1c59-404">Introduces the TPL, a library that simplifies parallel and concurrent programming in .NET Framework applications.</span></span>|
