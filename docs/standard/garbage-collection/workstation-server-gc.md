---
title: Diferencias entre la recolección de elementos no utilizados (GC) en estaciones de trabajo y servidores
description: Obtenga información sobre la recolección de elementos no utilizados de estación de trabajo y de servidor en .NET.
ms.date: 04/21/2020
helpviewer_keywords:
- garbage collection, workstation
- garbage collection, server
- workstation garbage collection
- server garbage collection
ms.openlocfilehash: 640b5f42c1f841c2537284e4721e827248e3d300
ms.sourcegitcommit: ef50c99928183a0bba75e07b9f22895cd4c480f8
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 08/07/2020
ms.locfileid: "87917007"
---
# <a name="workstation-and-server-garbage-collection"></a><span data-ttu-id="8d0e6-103">Recolección de elementos no utilizados de estación de trabajo y de servidor</span><span class="sxs-lookup"><span data-stu-id="8d0e6-103">Workstation and server garbage collection</span></span>

<span data-ttu-id="8d0e6-104">El recolector de elementos no utilizados se ajusta automáticamente y puede funcionar en gran variedad de escenarios.</span><span class="sxs-lookup"><span data-stu-id="8d0e6-104">The garbage collector is self-tuning and can work in a wide variety of scenarios.</span></span> <span data-ttu-id="8d0e6-105">Pero puede [establecer el tipo de recolección de elementos no utilizados](../../core/run-time-config/garbage-collector.md#flavors-of-garbage-collection) en función de las características de la carga de trabajo.</span><span class="sxs-lookup"><span data-stu-id="8d0e6-105">However, you can [set the type of garbage collection](../../core/run-time-config/garbage-collector.md#flavors-of-garbage-collection) based on the characteristics of the workload.</span></span> <span data-ttu-id="8d0e6-106">El CLR proporciona los tipos siguientes de recolección de elementos no utilizados:</span><span class="sxs-lookup"><span data-stu-id="8d0e6-106">The CLR provides the following types of garbage collection:</span></span>

- <span data-ttu-id="8d0e6-107">La recolección de elementos no utilizados (GC) de estación de trabajo, que está diseñada para las aplicaciones cliente.</span><span class="sxs-lookup"><span data-stu-id="8d0e6-107">Workstation garbage collection (GC), which is designed for client apps.</span></span> <span data-ttu-id="8d0e6-108">Es el tipo de GC predeterminado para las aplicaciones independientes.</span><span class="sxs-lookup"><span data-stu-id="8d0e6-108">It's the default GC flavor for standalone apps.</span></span> <span data-ttu-id="8d0e6-109">En el caso de las aplicaciones hospedadas, por ejemplo, las que se hospedan en ASP.NET, el host determina el tipo de GC predeterminado.</span><span class="sxs-lookup"><span data-stu-id="8d0e6-109">For hosted apps, for example, those hosted by ASP.NET, the host determines the default GC flavor.</span></span>

  <span data-ttu-id="8d0e6-110">La recolección de elementos no utilizados de estación de trabajo puede ser simultánea o no simultánea.</span><span class="sxs-lookup"><span data-stu-id="8d0e6-110">Workstation garbage collection can be concurrent or non-concurrent.</span></span> <span data-ttu-id="8d0e6-111">La recolección simultánea (o *en segundo plano*) de elementos no utilizados permite que los subprocesos administrados continúen con sus operaciones durante una recolección de elementos no utilizados.</span><span class="sxs-lookup"><span data-stu-id="8d0e6-111">Concurrent (or *background*) garbage collection enables managed threads to continue operations during a garbage collection.</span></span> <span data-ttu-id="8d0e6-112">La [recolección de elementos no utilizados en segundo plano](background-gc.md) reemplaza la [recolección simultánea de elementos no utilizados](background-gc.md#concurrent-garbage-collection) en .NET Framework 4 y versiones posteriores.</span><span class="sxs-lookup"><span data-stu-id="8d0e6-112">[Background garbage collection](background-gc.md) replaces [concurrent garbage collection](background-gc.md#concurrent-garbage-collection) in .NET Framework 4 and later versions.</span></span>

- <span data-ttu-id="8d0e6-113">Recolección de elementos no utilizados de servidor, diseñada para las aplicaciones de servidor que necesitan un alto nivel de rendimiento y escalabilidad.</span><span class="sxs-lookup"><span data-stu-id="8d0e6-113">Server garbage collection, which is intended for server applications that need high throughput and scalability.</span></span>

  - <span data-ttu-id="8d0e6-114">En .NET Core, la recolección de elementos no utilizados de servidor puede ser no simultánea o en segundo plano.</span><span class="sxs-lookup"><span data-stu-id="8d0e6-114">In .NET Core, server garbage collection can be non-concurrent or background.</span></span>

  - <span data-ttu-id="8d0e6-115">En .NET Framework 4.5 y versiones posteriores, la recolección de elementos no utilizados de servidor puede ser no simultánea o en segundo plano.</span><span class="sxs-lookup"><span data-stu-id="8d0e6-115">In .NET Framework 4.5 and later versions, server garbage collection can be non-concurrent or background.</span></span> <span data-ttu-id="8d0e6-116">En .NET Framework 4 y versiones anteriores, la recolección de elementos no utilizados de servidor no es simultánea.</span><span class="sxs-lookup"><span data-stu-id="8d0e6-116">In .NET Framework 4 and previous versions, server garbage collection is non-concurrent.</span></span>

<span data-ttu-id="8d0e6-117">En las siguientes ilustraciones se muestran los subprocesos dedicados que realizan la recolección de elementos no utilizados en un servidor:</span><span class="sxs-lookup"><span data-stu-id="8d0e6-117">The following illustration shows the dedicated threads that perform the garbage collection on a server:</span></span>

![Subprocesos de recolección de elementos no utilizados de servidor](media/gc-server.png)

## <a name="performance-considerations"></a><span data-ttu-id="8d0e6-119">Consideraciones sobre el rendimiento</span><span class="sxs-lookup"><span data-stu-id="8d0e6-119">Performance considerations</span></span>

### <a name="workstation-gc"></a><span data-ttu-id="8d0e6-120">Estación de trabajo de catálogo global</span><span class="sxs-lookup"><span data-stu-id="8d0e6-120">Workstation GC</span></span>

<span data-ttu-id="8d0e6-121">Estas son algunas consideraciones sobre subprocesos y rendimiento para la recolección de elementos no utilizados de estación de trabajo:</span><span class="sxs-lookup"><span data-stu-id="8d0e6-121">The following are threading and performance considerations for workstation garbage collection:</span></span>

- <span data-ttu-id="8d0e6-122">La recolección se produce en el subproceso del usuario que desencadenó la recolección de elementos no utilizados y permanece en la misma prioridad.</span><span class="sxs-lookup"><span data-stu-id="8d0e6-122">The collection occurs on the user thread that triggered the garbage collection and remains at the same priority.</span></span> <span data-ttu-id="8d0e6-123">Como los subprocesos de usuario suelen ejecutarse con prioridad normal, el recolector de elementos no utilizados (que se ejecuta en un subproceso de prioridad normal) debe competir con otros subprocesos por el tiempo de la CPU.</span><span class="sxs-lookup"><span data-stu-id="8d0e6-123">Because user threads typically run at normal priority, the garbage collector (which runs on a normal priority thread) must compete with other threads for CPU time.</span></span> <span data-ttu-id="8d0e6-124">(Los subprocesos que ejecutan código nativo no se suspenden en la recolección de elementos no utilizados de servidor o de estación de trabajo).</span><span class="sxs-lookup"><span data-stu-id="8d0e6-124">(Threads that run native code are not suspended on either server or workstation garbage collection.)</span></span>

- <span data-ttu-id="8d0e6-125">La recolección de elementos no utilizados de estación de trabajo siempre se utiliza en un equipo que tiene un solo procesador, sin tener en cuenta el [valor de configuración](../../core/run-time-config/garbage-collector.md#workstation-vs-server).</span><span class="sxs-lookup"><span data-stu-id="8d0e6-125">Workstation garbage collection is always used on a computer that has only one processor, regardless of the [configuration setting](../../core/run-time-config/garbage-collector.md#workstation-vs-server).</span></span>

### <a name="server-gc"></a><span data-ttu-id="8d0e6-126">Servidor de catálogo global</span><span class="sxs-lookup"><span data-stu-id="8d0e6-126">Server GC</span></span>

<span data-ttu-id="8d0e6-127">Estas son algunas consideraciones sobre subprocesos y rendimiento para la recolección de elementos no utilizados de servidor:</span><span class="sxs-lookup"><span data-stu-id="8d0e6-127">The following are threading and performance considerations for server garbage collection:</span></span>

- <span data-ttu-id="8d0e6-128">La recolección se produce en varios subprocesos dedicados que se ejecutan en el nivel de prioridad `THREAD_PRIORITY_HIGHEST` .</span><span class="sxs-lookup"><span data-stu-id="8d0e6-128">The collection occurs on multiple dedicated threads that are running at `THREAD_PRIORITY_HIGHEST` priority level.</span></span>

- <span data-ttu-id="8d0e6-129">Para cada CPU se proporciona un montón y un subproceso dedicado para realizar recolección de elementos no utilizados y, al mismo tiempo, se recolectan los montones.</span><span class="sxs-lookup"><span data-stu-id="8d0e6-129">A heap and a dedicated thread to perform garbage collection are provided for each CPU, and the heaps are collected at the same time.</span></span> <span data-ttu-id="8d0e6-130">Cada montón contiene un montón de objetos pequeños y un montón de objetos grandes; a todos ellos se puede tener acceso mediante código de usuario.</span><span class="sxs-lookup"><span data-stu-id="8d0e6-130">Each heap contains a small object heap and a large object heap, and all heaps can be accessed by user code.</span></span> <span data-ttu-id="8d0e6-131">Los objetos de montones diferentes pueden hacerse referencia a entre sí.</span><span class="sxs-lookup"><span data-stu-id="8d0e6-131">Objects on different heaps can refer to each other.</span></span>

- <span data-ttu-id="8d0e6-132">Dado que varios subprocesos de recolección de elementos no utilizados funcionan juntos, la recolección de elementos no utilizados de servidor es más rápida que la de estación de trabajo, con un montón del mismo tamaño.</span><span class="sxs-lookup"><span data-stu-id="8d0e6-132">Because multiple garbage collection threads work together, server garbage collection is faster than workstation garbage collection on the same size heap.</span></span>

- <span data-ttu-id="8d0e6-133">La recolección de elementos no utilizados de servidor suele tener segmentos de mayor tamaño.</span><span class="sxs-lookup"><span data-stu-id="8d0e6-133">Server garbage collection often has larger size segments.</span></span> <span data-ttu-id="8d0e6-134">Sin embargo, esto es solo una generalización: el tamaño de los segmentos es específico de la implementación y está sujeto a cambios.</span><span class="sxs-lookup"><span data-stu-id="8d0e6-134">However, this is only a generalization: segment size is implementation-specific and is subject to change.</span></span> <span data-ttu-id="8d0e6-135">No haga ninguna suposición sobre el tamaño de los segmentos asignados por el recolector de elementos no utilizados al optimizar la aplicación.</span><span class="sxs-lookup"><span data-stu-id="8d0e6-135">Don't make assumptions about the size of segments allocated by the garbage collector when tuning your app.</span></span>

- <span data-ttu-id="8d0e6-136">La recolección de elementos no utilizados de servidor puede consumir gran cantidad de recursos.</span><span class="sxs-lookup"><span data-stu-id="8d0e6-136">Server garbage collection can be resource-intensive.</span></span> <span data-ttu-id="8d0e6-137">Por ejemplo, imagine que hay 12 procesos que usan GC de servidor que se ejecutan en un equipo con cuatro procesadores.</span><span class="sxs-lookup"><span data-stu-id="8d0e6-137">For example, imagine that there are 12 processes that use server GC running on a computer that has four processors.</span></span> <span data-ttu-id="8d0e6-138">Si todos los procesos tienen que recopilar elementos no utilizados al mismo tiempo, interfieren entre sí, ya que serían 12 subprocesos programados en el mismo procesador.</span><span class="sxs-lookup"><span data-stu-id="8d0e6-138">If all the processes happen to collect garbage at the same time, they would interfere with each other, as there would be 12 threads scheduled on the same processor.</span></span> <span data-ttu-id="8d0e6-139">Si los procesos están activos, no es recomendable que todos usen GC de servidor.</span><span class="sxs-lookup"><span data-stu-id="8d0e6-139">If the processes are active, it's not a good idea to have them all use server GC.</span></span>

<span data-ttu-id="8d0e6-140">Si se ejecutan centenares de instancias de una aplicación, puede ser más conveniente utilizar la recolección de elementos no utilizados de estación de trabajo con la recolección simultánea de elementos no utilizados deshabilitada.</span><span class="sxs-lookup"><span data-stu-id="8d0e6-140">If you're running hundreds of instances of an application, consider using workstation garbage collection with concurrent garbage collection disabled.</span></span> <span data-ttu-id="8d0e6-141">De este modo se realizarán menos cambios de contexto, lo que puede mejorar el rendimiento.</span><span class="sxs-lookup"><span data-stu-id="8d0e6-141">This will result in less context switching, which can improve performance.</span></span>

## <a name="see-also"></a><span data-ttu-id="8d0e6-142">Vea también</span><span class="sxs-lookup"><span data-stu-id="8d0e6-142">See also</span></span>

- [<span data-ttu-id="8d0e6-143">Recolección de elementos no utilizados en segundo plano</span><span class="sxs-lookup"><span data-stu-id="8d0e6-143">Background garbage collection</span></span>](background-gc.md)
- [<span data-ttu-id="8d0e6-144">Opciones de configuración de tiempo de ejecución para la recolección de elementos no utilizados</span><span class="sxs-lookup"><span data-stu-id="8d0e6-144">Run-time configuration options for garbage collection</span></span>](../../core/run-time-config/garbage-collector.md)
