---
title: Recolección de elementos no utilizados en segundo plano
description: Obtenga información sobre la recolección de elementos no utilizados en .NET y cuáles son las diferencias en la recolección de elementos no utilizados de estación de trabajo y de servidor.
ms.date: 04/21/2020
helpviewer_keywords:
- garbage collection, background
- background garbage collection
ms.openlocfilehash: 780503288d3474cd99a595bdbd52c3a5abba5308
ms.sourcegitcommit: 45c8eed045779b70a47b23169897459d0323dc89
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 06/18/2020
ms.locfileid: "84990231"
---
# <a name="background-garbage-collection"></a><span data-ttu-id="63c0d-103">Recolección de elementos no utilizados en segundo plano</span><span class="sxs-lookup"><span data-stu-id="63c0d-103">Background garbage collection</span></span>

<span data-ttu-id="63c0d-104">En la recolección de elementos no utilizados (GC) en segundo plano, las generaciones efímeras (0 y 1) se recolectan según sea necesario mientras la recolección de la generación 2 está en curso.</span><span class="sxs-lookup"><span data-stu-id="63c0d-104">In background garbage collection (GC), ephemeral generations (0 and 1) are collected as needed while the collection of generation 2 is in progress.</span></span> <span data-ttu-id="63c0d-105">La recolección de elementos no utilizados en segundo plano se realiza en uno o más subprocesos dedicados, en función de si se trata de GC en segundo plano o de servidor, y solo se aplica a las recolecciones de la generación 2.</span><span class="sxs-lookup"><span data-stu-id="63c0d-105">Background garbage collection is performed on one or more dedicated threads, depending on whether it's background or server GC, and applies only to generation 2 collections.</span></span>

<span data-ttu-id="63c0d-106">La recolección de elementos no utilizados en segundo plano está habilitada de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="63c0d-106">Background garbage collection is enabled by default.</span></span> <span data-ttu-id="63c0d-107">Se puede habilitar o deshabilitar con la opción de configuración [gcConcurrent](../../framework/configure-apps/file-schema/runtime/gcconcurrent-element.md) o la opción [System.GC.Concurrent](../../core/run-time-config/garbage-collector.md#systemgcconcurrentcomplus_gcconcurrent) en aplicaciones de .NET Core.</span><span class="sxs-lookup"><span data-stu-id="63c0d-107">It can be enabled or disabled with the [gcConcurrent](../../framework/configure-apps/file-schema/runtime/gcconcurrent-element.md) configuration setting in .NET Framework apps or the [System.GC.Concurrent](../../core/run-time-config/garbage-collector.md#systemgcconcurrentcomplus_gcconcurrent) setting in .NET Core apps.</span></span>

> [!NOTE]
> <span data-ttu-id="63c0d-108">La recolección de elementos no utilizados en segundo plano reemplaza la [recolección simultánea de elementos no utilizados](#concurrent-garbage-collection) en .NET Framework 4 y versiones posteriores.</span><span class="sxs-lookup"><span data-stu-id="63c0d-108">Background garbage collection replaces [concurrent garbage collection](#concurrent-garbage-collection) and is available in .NET Framework 4 and later versions.</span></span> <span data-ttu-id="63c0d-109">En .NET Framework 4, solo se admite para la recolección de elementos no utilizados de *estación de trabajo*.</span><span class="sxs-lookup"><span data-stu-id="63c0d-109">In .NET Framework 4, it's supported only for *workstation* garbage collection.</span></span> <span data-ttu-id="63c0d-110">A partir de .NET Framework 4.5, la recolección de elementos no utilizados en segundo plano está disponible para *estaciones de trabajo* y *servidores*.</span><span class="sxs-lookup"><span data-stu-id="63c0d-110">Starting with .NET Framework 4.5, background garbage collection is available for both *workstation* and *server* garbage collection.</span></span>

<span data-ttu-id="63c0d-111">Una recolección de las generaciones efímeras durante una recolección de elementos no utilizados en segundo plano se denomina recolección de elementos no utilizados en *primer plano*.</span><span class="sxs-lookup"><span data-stu-id="63c0d-111">A collection on ephemeral generations during background garbage collection is known as *foreground* garbage collection.</span></span> <span data-ttu-id="63c0d-112">Cuando se producen recolecciones de elementos no utilizados en primer plano, se suspenden todos los subprocesos administrados.</span><span class="sxs-lookup"><span data-stu-id="63c0d-112">When foreground garbage collections occur, all managed threads are suspended.</span></span>

<span data-ttu-id="63c0d-113">Cuando hay en curso una recolección de elementos no utilizados en segundo plano y se han asignado suficientes objetos en la generación 0, el CLR realiza una recolección de elementos no utilizados en primer plano de las generaciones 0 o 1.</span><span class="sxs-lookup"><span data-stu-id="63c0d-113">When background garbage collection is in progress and you've allocated enough objects in generation 0, the CLR performs a generation 0 or generation 1 foreground garbage collection.</span></span> <span data-ttu-id="63c0d-114">El subproceso de recolección de elementos no utilizados en segundo plano dedicado realiza comprobaciones en puntos seguros frecuentes para determinar si existe alguna solicitud de recolección de elementos no utilizados en primer plano.</span><span class="sxs-lookup"><span data-stu-id="63c0d-114">The dedicated background garbage collection thread checks at frequent safe points to determine whether there is a request for foreground garbage collection.</span></span> <span data-ttu-id="63c0d-115">Si la hay, la recolección en segundo plano se suspende para que la recolección de elementos no utilizados en primer plano se pueda llevar a cabo.</span><span class="sxs-lookup"><span data-stu-id="63c0d-115">If there is, the background collection suspends itself so that foreground garbage collection can occur.</span></span> <span data-ttu-id="63c0d-116">Una vez completada la recolección de elementos no utilizados en primer plano, se reanudan los subprocesos de recolección de elementos no utilizados en segundo plano dedicados y los subprocesos del usuario.</span><span class="sxs-lookup"><span data-stu-id="63c0d-116">After the foreground garbage collection is completed, the dedicated background garbage collection threads and user threads resume.</span></span>

<span data-ttu-id="63c0d-117">La recolección de elementos no utilizados en segundo plano quita las restricciones de asignación impuestas por la recolección simultánea de elementos no utilizados, porque se pueden producir recolecciones de elementos no utilizados efímeras durante una recolección en segundo plano.</span><span class="sxs-lookup"><span data-stu-id="63c0d-117">Background garbage collection removes allocation restrictions imposed by concurrent garbage collection, because ephemeral garbage collections can occur during background garbage collection.</span></span> <span data-ttu-id="63c0d-118">La recolección de elementos no utilizados en segundo plano puede eliminar objetos inactivos procedentes de generaciones efímeras.</span><span class="sxs-lookup"><span data-stu-id="63c0d-118">Background garbage collection can remove dead objects in ephemeral generations.</span></span> <span data-ttu-id="63c0d-119">También puede expandir el montón si es necesario durante una recolección de elementos no utilizados de generación 1.</span><span class="sxs-lookup"><span data-stu-id="63c0d-119">It can also expand the heap if needed during a generation 1 garbage collection.</span></span>

## <a name="background-workstation-vs-server-gc"></a><span data-ttu-id="63c0d-120">Recolección de elementos no utilizados de estación de trabajo en segundo plano frente a GC de servidor</span><span class="sxs-lookup"><span data-stu-id="63c0d-120">Background workstation vs. server GC</span></span>

<span data-ttu-id="63c0d-121">A partir de .NET Framework 4,5, la recolección de elementos no utilizados en segundo plano está disponible para la recolección de elementos no utilizados de servidor.</span><span class="sxs-lookup"><span data-stu-id="63c0d-121">Starting with .NET Framework 4.5, background garbage collection is available for server GC.</span></span> <span data-ttu-id="63c0d-122">La recolección de elementos no utilizados en segundo plano es el modo predeterminado para la recolección de elementos no utilizados de servidor.</span><span class="sxs-lookup"><span data-stu-id="63c0d-122">Background GC is the default mode for server garbage collection.</span></span>

<span data-ttu-id="63c0d-123">La recolección de elementos no utilizados de servidor en segundo plano funciona de forma similar a la recolección de elementos no utilizados de estación de trabajo en segundo plano, pero hay algunas diferencias:</span><span class="sxs-lookup"><span data-stu-id="63c0d-123">Background server garbage collection functions similarly to background workstation garbage collection, but there are a few differences:</span></span>

- <span data-ttu-id="63c0d-124">La recolección de elementos no utilizados de estación de trabajo en segundo plano usa un subproceso dedicado de recolección de elementos no utilizados en segundo plano, mientras que la recolección de elementos no utilizados de servidor en segundo plano utiliza varios subprocesos.</span><span class="sxs-lookup"><span data-stu-id="63c0d-124">Background workstation garbage collection uses one dedicated background garbage collection thread, whereas background server garbage collection uses multiple threads.</span></span> <span data-ttu-id="63c0d-125">Normalmente, hay un subproceso dedicado para cada procesador lógico.</span><span class="sxs-lookup"><span data-stu-id="63c0d-125">Typically, there's a dedicated thread for each logical processor.</span></span>

- <span data-ttu-id="63c0d-126">A diferencia del subproceso de recolección de elementos no utilizados de estación de trabajo en segundo plano, no se agota el tiempo de espera de los subprocesos de recolección de elementos no utilizados de servidor en segundo plano.</span><span class="sxs-lookup"><span data-stu-id="63c0d-126">Unlike the workstation background garbage collection thread, the background server GC threads do not time out.</span></span>

<span data-ttu-id="63c0d-127">En la siguiente ilustración se muestra la recolección de elementos no utilizados de *estación de trabajo* en segundo plano realizada en un subproceso dedicado independiente:</span><span class="sxs-lookup"><span data-stu-id="63c0d-127">The following illustration shows background *workstation* garbage collection performed on a separate, dedicated thread:</span></span>

![Recolección de elementos no utilizados de estación de trabajo en segundo plano](media/fundamentals/background-workstation-garbage-collection.png)

<span data-ttu-id="63c0d-129">En la siguiente ilustración se muestra la recolección de elementos no utilizados de *servidor* en segundo plano realizada en un subproceso dedicado independiente:</span><span class="sxs-lookup"><span data-stu-id="63c0d-129">The following illustration shows background *server* garbage collection performed on separate, dedicated threads:</span></span>

![Recolección de elementos no utilizados de servidor en segundo plano](media/fundamentals/background-server-garbage-collection.png)

## <a name="concurrent-garbage-collection"></a><span data-ttu-id="63c0d-131">Recolección de elementos no utilizados simultánea</span><span class="sxs-lookup"><span data-stu-id="63c0d-131">Concurrent garbage collection</span></span>

> [!TIP]
> <span data-ttu-id="63c0d-132">Esta sección es aplicable a:</span><span class="sxs-lookup"><span data-stu-id="63c0d-132">This section applies to:</span></span>
>
> - <span data-ttu-id="63c0d-133">.NET Framework 3.5 y versiones anteriores para la recolección de elementos no utilizados de estación de trabajo</span><span class="sxs-lookup"><span data-stu-id="63c0d-133">.NET Framework 3.5 and earlier for workstation garbage collection</span></span>
> - <span data-ttu-id="63c0d-134">.NET Framework 4 y versiones anteriores para la recolección de elementos no utilizados de servidor</span><span class="sxs-lookup"><span data-stu-id="63c0d-134">.NET Framework 4 and earlier for server garbage collection</span></span>
>
> <span data-ttu-id="63c0d-135">La recolección de elementos no utilizados en segundo plano reemplaza a la de elementos no utilizados simultánea en versiones posteriores.</span><span class="sxs-lookup"><span data-stu-id="63c0d-135">Concurrent garbage is replaced by background garbage collection in later versions.</span></span>

<span data-ttu-id="63c0d-136">En la recolección de elementos no utilizados de estación de trabajo o de servidor, se puede [habilitar la recolección simultánea de elementos no utilizados](../../framework/configure-apps/file-schema/runtime/gcconcurrent-element.md), que permite ejecutar subprocesos de manera simultánea con un subproceso dedicado que realiza la recolección de elementos no utilizados durante la mayor parte del tiempo que dura la recolección.</span><span class="sxs-lookup"><span data-stu-id="63c0d-136">In workstation or server garbage collection, you can [enable concurrent garbage collection](../../framework/configure-apps/file-schema/runtime/gcconcurrent-element.md), which enables threads to run concurrently with a dedicated thread that performs the garbage collection for most of the duration of the collection.</span></span> <span data-ttu-id="63c0d-137">Esta opción solo afecta a las recolecciones de elementos no utilizados de la generación 2; las generaciones 0 y 1 no son nunca simultáneas porque finalizan rápidamente.</span><span class="sxs-lookup"><span data-stu-id="63c0d-137">This option affects only garbage collections in generation 2; generations 0 and 1 are always non-concurrent because they finish fast.</span></span>

<span data-ttu-id="63c0d-138">La recolección de elementos no utilizados simultánea permite mayor capacidad de respuesta de las aplicaciones interactivas, pues minimiza las pausas en una recolección.</span><span class="sxs-lookup"><span data-stu-id="63c0d-138">Concurrent garbage collection enables interactive applications to be more responsive by minimizing pauses for a collection.</span></span> <span data-ttu-id="63c0d-139">Los subprocesos administrados pueden continuar ejecutándose la mayoría del tiempo mientras se ejecuta el subproceso de recolección de elementos no utilizados simultánea.</span><span class="sxs-lookup"><span data-stu-id="63c0d-139">Managed threads can continue to run most of the time while the concurrent garbage collection thread is running.</span></span> <span data-ttu-id="63c0d-140">Este diseño se traduce en pausas más cortas mientras se produce una recolección de elementos no utilizados.</span><span class="sxs-lookup"><span data-stu-id="63c0d-140">This design results in shorter pauses while a garbage collection is occurring.</span></span>

<span data-ttu-id="63c0d-141">La recolección de elementos no utilizados simultánea se realiza en un subproceso dedicado.</span><span class="sxs-lookup"><span data-stu-id="63c0d-141">Concurrent garbage collection is performed on a dedicated thread.</span></span> <span data-ttu-id="63c0d-142">De forma predeterminada, el CLR ejecuta la recolección de elementos no utilizados de estación de trabajo con la simultaneidad habilitada en equipos de un solo procesador y de varios procesadores.</span><span class="sxs-lookup"><span data-stu-id="63c0d-142">By default, the CLR runs workstation garbage collection with concurrent garbage collection enabled on both single-processor and multi-processor computers.</span></span>

<span data-ttu-id="63c0d-143">En la siguiente se muestra la recolección de elementos no utilizados simultánea realizada en un subproceso dedicado independiente.</span><span class="sxs-lookup"><span data-stu-id="63c0d-143">The following illustration shows concurrent garbage collection performed on a separate dedicated thread.</span></span>

![Subprocesos de recolección simultánea de elementos no utilizados](media/gc-concurrent.png)

## <a name="see-also"></a><span data-ttu-id="63c0d-145">Vea también</span><span class="sxs-lookup"><span data-stu-id="63c0d-145">See also</span></span>

- [<span data-ttu-id="63c0d-146">Recolección de elementos no utilizados de estación de trabajo y de servidor</span><span class="sxs-lookup"><span data-stu-id="63c0d-146">Workstation and server garbage collection</span></span>](workstation-server-gc.md)
- [<span data-ttu-id="63c0d-147">Opciones de configuración del entorno de ejecución para la recolección de elementos no utilizados</span><span class="sxs-lookup"><span data-stu-id="63c0d-147">Run-time configuration options for garbage collection</span></span>](../../core/run-time-config/garbage-collector.md)
